{"version":3,"file":"CyTFS6gW.js","sources":["../../../../../../src/widgets/custom/Seo/components/Heatmap.svelte"],"sourcesContent":["<!--\n@file src/widgets/custom/Seo/components/Heatmap.svelte\n@component\n**Heatmap widget for SEO Widget to manage meta title, description, and robots meta tags**\n\n@example\n<Heatmap content={title + ' ' + description} language={$contentLanguage} keywords={seoKeywords} on:heatmapGenerated={handleHeatmapGenerated} />\n\n#### Props\n- `content` {string} - Content text\n- `language` {string} - Content language\n- `keywords` {string[]} - Array of keywords\n- `on:heatmapGenerated` {function} - Heatmap data handler\n\n#### Features\n- Translatable\n-->\n\n<script lang=\"ts\">\n\timport { debounce } from '@shared/utils/utils';\n\timport { tick } from 'svelte';\n\timport { fade } from 'svelte/transition';\n\n\tinterface HeatmapData {\n\t\theatmapData: Array<{ word: string; heatLevel: number; isKeyword: boolean }>;\n\t\tkeywordDensity: Record<string, number>;\n\t}\n\n\tinterface Props {\n\t\tcontent?: string;\n\t\tlanguage?: string;\n\t\tkeywords?: string[];\n\t\t'on:heatmapGenerated'?: (data: HeatmapData) => void;\n\t}\n\n\t// Props with default values\n\tconst { content = '', language = 'en', keywords = [], 'on:heatmapGenerated': onHeatmapGenerated = () => {} }: Props = $props();\n\n\tlet heatmapData = $state<Array<{ word: string; heatLevel: number; isKeyword: boolean }>>([]);\n\tlet keywordDensity = $state<Record<string, number>>({});\n\n\t// Use global debounce for content analysis\n\tconst debouncedAnalysis = debounce.create(() => {\n\t\tgenerateHeatmap();\n\t}, 300);\n\n\tasync function generateHeatmap() {\n\t\tif (!content) {\n\t\t\theatmapData = [];\n\t\t\tkeywordDensity = {};\n\t\t\tonHeatmapGenerated({ heatmapData, keywordDensity });\n\t\t\treturn;\n\t\t}\n\n\t\tconst words = content.split(/\\s+/);\n\n\t\theatmapData = words.map((word, index) => ({\n\t\t\tword,\n\t\t\theatLevel: calculateHeatLevel(word, index, words.length, language),\n\t\t\tisKeyword: keywords.includes(word.toLowerCase())\n\t\t}));\n\n\t\tanalyzeKeywordDensity(words);\n\t\tonHeatmapGenerated({ heatmapData, keywordDensity });\n\t\tawait tick();\n\t}\n\n\tfunction calculateHeatLevel(word: string, index: number, totalWords: number, lang: string): number {\n\t\tlet score = 0;\n\n\t\t// Position-based scoring\n\t\tconst positionFactor = 1 - index / totalWords;\n\t\tscore += positionFactor * 2;\n\n\t\t// Word length scoring (adjust for different languages)\n\t\tconst idealLength = lang === 'en' ? 5 : 6;\n\t\tscore += Math.max(0, 3 - Math.abs(word.length - idealLength));\n\n\t\t// Keyword bonus\n\t\tif (keywords.includes(word.toLowerCase())) {\n\t\t\tscore += 2;\n\t\t}\n\n\t\t// Normalize score to 1-5 range\n\t\treturn Math.max(1, Math.min(5, Math.round(score)));\n\t}\n\n\tfunction analyzeKeywordDensity(words: string[]) {\n\t\tconst totalWords = words.length;\n\t\tconst result: Record<string, number> = {};\n\n\t\tfor (const keyword of keywords) {\n\t\t\tconst count = words.filter((word) => word.toLowerCase() === keyword.toLowerCase()).length;\n\t\t\tresult[keyword] = (count / totalWords) * 100;\n\t\t}\n\n\t\tkeywordDensity = result;\n\t}\n\n\tfunction getHeatClasses(heatLevel: number): string {\n\t\tconst heatMap = {\n\t\t\t1: 'bg-green-500/20',\n\t\t\t2: 'bg-yellow-500/20',\n\t\t\t3: 'bg-orange-500/20',\n\t\t\t4: 'bg-red-500/20',\n\t\t\t5: 'bg-purple-500/20'\n\t\t};\n\t\treturn heatMap[heatLevel as keyof typeof heatMap] || '';\n\t}\n\n\t// Effect to handle content changes with debounced analysis\n\t$effect(() => {\n\t\t// React to content, language, or keywords changes\n\t\tvoid content;\n\t\tvoid language;\n\t\tvoid keywords;\n\n\t\t// Use the debounced analysis function\n\t\tdebouncedAnalysis();\n\t});\n</script>\n\n<div class=\"wrap-break-word leading-6 max-sm:text-sm max-sm:leading-tight\">\n\t{#if heatmapData.length > 0}\n\t\t{#each heatmapData as { word, heatLevel, isKeyword }}\n\t\t\t<span\n\t\t\t\tclass=\"relative cursor-help {getHeatClasses(heatLevel)} {isKeyword ? 'border-b-2 border-blue-500' : ''} group\"\n\t\t\t\taria-label=\"Heat level {heatLevel}: {word}{isKeyword ? ', keyword' : ''}\"\n\t\t\t\ttransition:fade={{ duration: 200 }}\n\t\t\t>\n\t\t\t\t{word}\n\t\t\t\t<span\n\t\t\t\t\tclass=\"absolute bottom-full left-1/2 hidden -translate-x-1/2 whitespace-nowrap rounded-md bg-gray-800 p-1 text-xs text-white group-hover:block\"\n\t\t\t\t>\n\t\t\t\t\tHeat: {heatLevel}, {isKeyword ? 'Keyword' : 'Regular word'}\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t{/each}\n\t{:else}\n\t\t<p>No content available for heatmap.</p>\n\t{/if}\n</div>\n\n<div class=\"mt-5 text-sm max-sm:text-xs\">\n\t<h4>Keyword Density</h4>\n\t{#if Object.keys(keywordDensity).length > 0}\n\t\t<ul>\n\t\t\t{#each Object.entries(keywordDensity) as [keyword, density]}\n\t\t\t\t<li>{keyword}: {density.toFixed(2)}%</li>\n\t\t\t{/each}\n\t\t</ul>\n\t{:else}\n\t\t<p>No keywords provided or no matching keywords found in content.</p>\n\t{/if}\n</div>\n"],"names":["content","language","keywords","$.prop","$$props","onHeatmapGenerated","heatmapData","$.state","$.proxy","keywordDensity","debouncedAnalysis","debounce","generateHeatmap","words","word","index","calculateHeatLevel","analyzeKeywordDensity","tick","totalWords","lang","score","positionFactor","idealLength","result","keyword","count","$.set","getHeatClasses","heatLevel","$.user_effect","div","$.first_child","fragment","$.index","$$anchor","$$item","isKeyword","span","root_2","text","$.child","span_1","$.sibling","text_1","$.reset","$.set_class","$0","$.set_text","fade","$.append","p","root_3","$$render","consequent","alternate","div_1","ul","root_4","$.each","$.get","$$array","density","li","root_5","$.template_effect","text_2","p_1","root_6","consequent_1","alternate_1"],"mappings":"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"}