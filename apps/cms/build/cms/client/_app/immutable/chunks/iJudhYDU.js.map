{"version":3,"file":"iJudhYDU.js","sources":["../../../../../../../../shared/features/src/dashboard/widgets/Last5MediaWidget.svelte"],"sourcesContent":["<!--\n@file src/routes/(app)/dashboard/widgets/Last5MediaWidget.svelte\n@component\n**A reusable widget component for displaying last 5 media information with improved rendering and error handling**\n\n@example\n<Last5MediaWidget label=\"Last 5 Media\" />\n\n### Props\n- `label`: The label for the widget (default: 'Last 5 Media')\n\n### Features:\n- Responsive doughnut chart visualization\n- Theme-aware rendering (light/dark mode support)\n- Real-time data updates\n- Customizable widget properties (size, position, etc.)\n- Improved error handling and data validation\n- Enhanced debugging and logging\n-->\n<script lang=\"ts\" module>\n\texport const widgetMeta = {\n\t\tname: 'Last 5 Media',\n\t\ticon: 'mdi:image-multiple-outline',\n\t\tdefaultSize: { w: 1, h: 2 }\n\t};\n</script>\n\n<script lang=\"ts\">\n\timport { formatDisplayDate } from '@shared/utils/dateUtils';\n\timport BaseWidget from '../BaseWidget.svelte';\n\timport type { WidgetSize } from '@cms-types';\n\n\tinterface MediaFile {\n\t\tid: string;\n\t\tname: string;\n\t\tsize: number;\n\t\tmodified: string;\n\t\ttype: string;\n\t\turl: string;\n\t\tcreatedBy?: string;\n\t}\n\n\ttype FetchedData = MediaFile[] | undefined;\n\n\tconst {\n\t\tlabel = 'Last 5 Media',\n\t\ttheme = 'light',\n\t\ticon = 'mdi:image-multiple-outline',\n\t\twidgetId = undefined,\n\t\tsize = { w: 1, h: 1 } as WidgetSize,\n\t\tonSizeChange = (_newSize: WidgetSize) => {},\n\t\tonRemove = () => {}\n\t}: {\n\t\tlabel?: string;\n\t\ttheme?: 'light' | 'dark';\n\t\ticon?: string;\n\t\twidgetId?: string;\n\t\tsize?: WidgetSize;\n\t\tonSizeChange?: (newSize: WidgetSize) => void;\n\t\tonRemove?: () => void;\n\t} = $props();\n\n\tfunction formatFileSize(bytes: number): string {\n\t\tif (bytes === 0) return '0 B';\n\t\tconst k = 1024;\n\t\tconst sizes = ['B', 'KB', 'MB', 'GB'];\n\t\tconst i = Math.floor(Math.log(bytes) / Math.log(k));\n\t\treturn `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;\n\t}\n\n\tfunction getFileIcon(type: string): string {\n\t\tif (!type) return 'mdi:file';\n\t\tconst imageTypes = ['jpg', 'jpeg', 'png', 'gif', 'webp'];\n\t\tconst videoTypes = ['mp4', 'mov', 'avi'];\n\t\tif (imageTypes.includes(type.toLowerCase())) {\n\t\t\treturn 'mdi:image';\n\t\t} else if (videoTypes.includes(type.toLowerCase())) {\n\t\t\treturn 'mdi:video';\n\t\t}\n\t\treturn 'mdi:file';\n\t}\n</script>\n\n<BaseWidget\n\t{label}\n\t{theme}\n\tendpoint=\"/api/dashboard/last5media\"\n\tpollInterval={30000}\n\t{icon}\n\t{widgetId}\n\t{size}\n\t{onSizeChange}\n\tonCloseRequest={onRemove}\n>\n\t{#snippet children({ data: fetchedData }: { data: FetchedData })}\n\t\t{#if fetchedData && Array.isArray(fetchedData) && fetchedData.length > 0}\n\t\t\t<div class=\"grid gap-2\" style=\"max-height: 180px; overflow-y: auto;\" role=\"list\" aria-label=\"Last 5 media files\">\n\t\t\t\t{#each fetchedData.slice(0, 5) as file (file.id || file.name)}\n\t\t\t\t\t<div class=\"flex items-center justify-between rounded-lg bg-surface-100/80 px-3 py-2 text-xs dark:bg-surface-700/60\" role=\"listitem\">\n\t\t\t\t\t\t<div class=\"flex min-w-0 items-center gap-2\">\n\t\t\t\t\t\t\t<iconify-icon icon={getFileIcon(file.type)} class=\"shrink-0 text-primary-400\" width=\"18\" aria-label={file.type + ' file icon'}\n\t\t\t\t\t\t\t></iconify-icon>\n\t\t\t\t\t\t\t<div class=\"flex min-w-0 flex-col\">\n\t\t\t\t\t\t\t\t<span class=\"text-text-900 dark:text-text-100 truncate font-medium\" title={file.name}>\n\t\t\t\t\t\t\t\t\t{file.name}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-xs text-surface-500 dark:text-surface-50\" title={`Size: ${formatFileSize(file.size)}`}>\n\t\t\t\t\t\t\t\t\t{formatFileSize(file.size)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t<span class=\"text-xs font-medium uppercase text-surface-600 dark:text-surface-300\">\n\t\t\t\t\t\t\t\t{file.type}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"text-xs text-surface-500 dark:text-surface-50\" title={`Modified: ${formatDisplayDate(file.modified)}`}>\n\t\t\t\t\t\t\t\t{formatDisplayDate(file.modified)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex flex-1 flex-col items-center justify-center py-6 text-xs text-gray-500 dark:text-gray-400\" role=\"status\" aria-live=\"polite\">\n\t\t\t\t<iconify-icon icon=\"mdi:file-remove-outline\" width=\"32\" class=\"mb-2 text-surface-400 dark:text-surface-500\" aria-hidden=\"true\"></iconify-icon>\n\t\t\t\t<span>No media files found</span>\n\t\t\t</div>\n\t\t{/if}\n\t{/snippet}\n</BaseWidget>\n"],"names":["widgetMeta","label","theme","icon","widgetId","size","onSizeChange","$.prop","$$props","_newSize","onRemove","formatFileSize","bytes","k","sizes","i","getFileIcon","type","imageTypes","videoTypes","BaseWidget","$$anchor","$$arg0","fetchedData","div","root_2","$.each","file","div_1","root_3","div_2","iconify_icon","$.template_effect","$.set_custom_element_data","$.get","div_3","span","span_1","div_4","span_2","span_3","$.set_text","text","$0","text_2","$2","formatDisplayDate","div_5","root_4","iconify_icon_1","$$render","consequent","alternate"],"mappings":"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"}