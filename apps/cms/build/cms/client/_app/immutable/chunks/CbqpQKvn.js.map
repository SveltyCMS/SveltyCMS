{"version":3,"file":"CbqpQKvn.js","sources":["../../../../../../src/widgets/custom/Address/Input.svelte"],"sourcesContent":["<!--\n@file src/widgets/custom/Address/Input.svelte\n@component\n**Address Widget Input Component**\n\nProvides comprehensive address input with interactive Mapbox integration and geocoding.\nPart of the Three Pillars Architecture for widget system.\n\n@example\n<AddressInput bind:value={addressData} field={fieldDefinition} />\nInteractive form with map, country selector, and address validation\n\n### Props\n- `field: FieldType` - Widget field definition with map settings and configuration\n- `value: AddressData | null | undefined` - Structured address object (bindable)\n- `error?: string | null` - Validation error message for display\n\n### Features\n- **Interactive Mapping**: Mapbox GL JS integration with draggable markers\n- **Geocoding Support**: Address lookup and coordinate resolution\n- **Country Selection**: Multilingual country dropdown with ISO codes\n- **Field Visibility**: Configurable hidden fields for flexible layouts\n- **Default Values**: Smart defaults from field configuration\n- **Coordinate Tracking**: Automatic latitude/longitude capture\n- **Responsive Design**: Grid-based form layout for optimal UX\n- **Error Handling**: Accessible error display with ARIA attributes\n- **Language Support**: Localized UI based on system language settings\n-->\n\n<script lang=\"ts\">\n\timport { app } from '@shared/stores/store.svelte';\n\n\timport { onDestroy } from 'svelte';\n\timport type { FieldType } from './';\n\timport countries from './countries.json';\n\timport type { AddressData } from './types';\n\timport { tokenTarget } from '@shared/services/token/tokenTarget';\n\n\tlet { field, value = $bindable(), error }: { field: FieldType; value: AddressData | null | undefined; error?: string | null } = $props();\n\n\t// Initialize value if missing\n\t$effect(() => {\n\t\tif (!value) {\n\t\t\tvalue = {\n\t\t\t\tstreet: '',\n\t\t\t\thouseNumber: '',\n\t\t\t\tpostalCode: '',\n\t\t\t\tcity: '',\n\t\t\t\tcountry: (field.defaultCountry as string) || 'DE',\n\t\t\t\tlatitude: (field.mapCenter as { lat: number; lng: number })?.lat || 0,\n\t\t\t\tlongitude: (field.mapCenter as { lat: number; lng: number })?.lng || 0\n\t\t\t};\n\t\t}\n\t});\n\n\t// Get the current system language for the UI.\n\tconst lang = $derived(app.systemLanguage);\n\n\t// Note: Map functionality is placeholder for future Mapbox integration\n\tconst map: any = null; // Placeholder for future Mapbox integration\n\n\tonDestroy(() => {\n\t\tif (map && typeof map.remove === 'function') {\n\t\t\tmap.remove();\n\t\t}\n\t});\n</script>\n\n<div class=\"address-container\" class:invalid={error}>\n\t{#if !(field.hiddenFields as string[])?.includes('latitude')}\n\t\t<div class=\"map\">\n\t\t\t<!-- Map placeholder - Mapbox integration to be implemented -->\n\t\t</div>\n\t{/if}\n\n\t{#if value}\n\t\t<div class=\"form-grid\">\n\t\t\t<div class=\"field relative\">\n\t\t\t\t<label for=\"{field.db_fieldName}-street\">Street</label>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tid=\"{field.db_fieldName}-street\"\n\t\t\t\t\tbind:value={value.street}\n\t\t\t\t\tclass=\"input\"\n\t\t\t\t\tuse:tokenTarget={{\n\t\t\t\t\t\tname: field.db_fieldName,\n\t\t\t\t\t\tlabel: field.label,\n\t\t\t\t\t\tcollection: (field as any).collection\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label for=\"{field.db_fieldName}-houseNumber\">House Number</label>\n\t\t\t\t<input type=\"text\" id=\"{field.db_fieldName}-houseNumber\" bind:value={value.houseNumber} class=\"input\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label for=\"{field.db_fieldName}-postalCode\">Postal Code</label>\n\t\t\t\t<input type=\"text\" id=\"{field.db_fieldName}-postalCode\" bind:value={value.postalCode} class=\"input\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label for=\"{field.db_fieldName}-city\">City</label>\n\t\t\t\t<input type=\"text\" id=\"{field.db_fieldName}-city\" bind:value={value.city} class=\"input\" />\n\t\t\t</div>\n\t\t\t<div class=\"field\">\n\t\t\t\t<label for=\"{field.db_fieldName}-country\">Country</label>\n\t\t\t\t<select id=\"{field.db_fieldName}-country\" bind:value={value.country} class=\"input\">\n\t\t\t\t\t{#each countries as country}\n\t\t\t\t\t\t<option value={country.alpha2}>{country[lang] || country.en}</option>\n\t\t\t\t\t{/each}\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n\n\t{#if error}\n\t\t<p class=\"error-message\" role=\"alert\">{error}</p>\n\t{/if}\n</div>\n"],"names":["value","$.prop","$$props","$.user_effect","lang","$.derived","app","onDestroy","div","root","div_1","root_1","$$render","consequent","div_2","root_2","div_3","label","input","$.sibling","$.remove_input_defaults","$$value","$.action","$$node","$$action_arg","tokenTarget","div_4","label_1","input_1","div_5","label_2","input_2","div_6","label_3","input_3","div_7","label_4","select","countries","$.index","$$anchor","country","option","root_3","$.set_text","text","$.get","option_value","$.set_attribute","consequent_1","p","root_4","classes"],"mappings":"s1iHA6BA,aAScA,EAAKC,GAAAC,EAAA,QAAA,EAAA,EAGlBC,EAAO,IAAO,CACRH,EAAK,GACTA,EAAK,CACJ,OAAQ,GACR,YAAa,GACb,WAAY,GACZ,KAAM,GACN,QAAOE,EAAA,MAAS,gBAA6B,KAC7C,SAAQA,EAAA,MAAS,WAA4C,KAAO,EACpE,UAASA,EAAA,MAAS,WAA4C,KAAO,GAGxE,CAAC,QAGKE,EAAIC,EAAA,IAAYC,GAAI,cAAc,EAKxCC,EAAS,IAAO,CAIhB,CAAC,MAGDC,EAAGC,GAAA,gBAAHD,CAAG,iBAEDE,EAAGC,GAAA,MAAHD,CAAG,mBADQ,cAA2B,SAAS,UAAU,GAAAE,EAAAC,CAAA,gCAOzDC,EAAGC,GAAA,EACFC,IADDF,CAAG,EAEDG,IADDD,CAAG,EAEFE,EAAAC,EADAF,EAAK,CAAA,EACLG,EAAAF,CAAA,UAAAA,EAAA,IAGYlB,EAAK,EAAC,OAAMqB,GAAZrB,EAAAA,EAAK,EAAC,OAAMqB,EAAA,EAAA,CAAA,CAAA,EAHxBC,GAAAJ,EAAA,CAAAK,EAAAC,IAAAC,KAAAF,EAAAC,CAAA,EAAA,KAAA,CAMC,aAAY,aACZ,cAAa,MACb,WAAUtB,EAAA,MAAiB,gBAV7Bc,CAAG,EAcH,IAAAU,IAdAV,EAAG,CAAA,EAeFW,IADDD,CAAG,EAEFE,IADAD,EAAK,CAAA,IACLC,CAAK,IAFNF,CAAG,EAIH,IAAAG,IAJAH,EAAG,CAAA,EAKFI,IADDD,CAAG,EAEFE,IADAD,EAAK,CAAA,IACLC,CAAK,IAFNF,CAAG,EAIH,IAAAG,IAJAH,EAAG,CAAA,EAKFI,IADDD,CAAG,EAEFE,IADAD,EAAK,CAAA,IACLC,CAAK,IAFNF,CAAG,EAIH,IAAAG,IAJAH,EAAG,CAAA,EAKFI,IADDD,CAAG,EAEFE,IADAD,EAAK,CAAA,IACLC,EAAM,GAAA,IACCC,GAASC,EAAA,CAAAC,EAAIC,IAAO,KACzBC,EAAMC,GAAA,MAAND,EAAM,EAAA,IAANA,CAAM,kBAAyBE,EAAAC,EAAAC,EAAAL,CAAO,EAAAK,EAAC1C,CAAI,CAAA,GAAA0C,EAAKL,CAAO,EAAC,EAAE,EAA5CM,KAAAA,EAAAD,EAAAL,CAAO,EAAC,UAAtBC,EAAM,OAANA,EAAM,QAAAI,EAAQL,CAAO,EAAC,SAAM,UAA5BC,CAAM,MAFRL,CAAM,IAFPF,CAAG,IA3BJrB,CAAG,SAEDkC,EAAA/B,mBAAkB,cAAY,EAAA,SAAA,EAC9B+B,EAAA9B,EAAA,KAAA,GAAAhB,EAAA,MAEW,cAAY,EAAA,SAAA,EAWvB8C,EAAArB,mBAAkB,cAAY,EAAA,cAAA,EAC9BqB,EAAApB,kBAA6B,cAAY,EAAA,cAAA,EAGzCoB,EAAAlB,mBAAkB,cAAY,EAAA,aAAA,EAC9BkB,EAAAjB,kBAA6B,cAAY,EAAA,aAAA,EAGzCiB,EAAAf,mBAAkB,cAAY,EAAA,OAAA,EAC9Be,EAAAd,kBAA6B,cAAY,EAAA,OAAA,EAGzCc,EAAAZ,mBAAkB,cAAY,EAAA,UAAA,EAC9BY,EAAAX,kBAAkB,cAAY,EAAA,UAAA,MAZ9BT,EAAK,IAA+D5B,EAAK,EAAC,eAANA,EAAAA,EAAK,EAAC,YAAWqB,EAAA,EAAA,CAAA,IAIrFU,EAAK,IAA8D/B,EAAK,EAAC,cAANA,EAAAA,EAAK,EAAC,WAAUqB,EAAA,EAAA,CAAA,IAInFa,EAAK,IAAwDlC,EAAK,EAAC,QAANA,EAAAA,EAAK,EAAC,KAAIqB,EAAA,EAAA,CAAA,KAIvEgB,EAAM,IAA+CrC,EAAK,EAAC,WAANA,EAAAA,EAAK,EAAC,QAAOqB,EAAA,EAAA,CAAA,MA7BpEP,CAAG,WADAd,EAAK,GAAAY,EAAAqC,CAAA,gCAwCRC,EAACC,GAAA,MAADD,EAAC,EAAA,IAADA,CAAC,0BAADA,CAAC,6BA/CH1C,CAAG,aAAHA,EAAG,EAAA,oBAAA,KAAA4C,EAAA,CAAA,QAAAlD,EAAA,KAAA,CAAA,CAAA,MAAHM,CAAG,KAFI"}