{"version":3,"mappings":"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","names":["RootContext","createContext","props","$.rest_props","$$props","toast","element","children","rest","attributes","mergeProps","$.snippet","node_1","$.get","button","root_2","$.attribute_effect","$.noop","$$render","consequent","alternate","svg","root","x","$$anchor","X","$.derived","$.fallback","root_3","div","GroupContext","id","$.props_id","toaster","service","useMachine","group","api","normalizeProps","node_2","node","toastProps","machine","connect","div_1","$0","div_2","$.sibling","Toast","Root","Group","Message","Title","Description","ActionTrigger","CloseTrigger","ssr","prerender","defaultIconDimensions","defaultIconTransformations","defaultIconProps","defaultExtendedIconProps","defaultIconSizeCustomisations","defaultIconCustomisations","rotateFromString","value","defaultValue","units","cleanup","value$1","num","split","separator","flipFromString","custom","flip","str","defaultCustomisations","getCustomisations","customisations","attr","key","def","haveCustomisationsChanged","value1","value2","matchIconName","stringToIcon","validate","allowSimpleName","provider","colonSeparated","name$1","prefix","result","validateIconName","name","dashSeparated","icon","getIconsTree","data","names","icons","aliases","resolved","resolve","parent","mergeIconTransformations","obj1","obj2","rotate","mergeIconData","child","internalGetIconData","tree","currentProps","parse","parseIconSet","callback","item","optionalPropertyDefaults","checkOptionalProps","defaults","prop","quicklyValidateIconSet","obj","dataStorage","newStorage","getStorage","providerStorage","addIconSet","storage","addIconToStorage","listIcons$1","allIcons","provider$1","prefix$1","simpleNames","allowSimpleNames","allow","getIconData","iconName","addIcon$1","addCollection$1","added","iconLoaded$1","getIcon$1","removeCallback","storages","items","row","updateCallbacks","hasPending","oldLength","idCounter","storeCallback","pendingSources","abort","sortIcons","a","b","lastIcon","localStorage","list","setAPIModule","getAPIModule","listToIcons","createAPIConfig","source","resources","configStorage","fallBackAPISources","fallBackAPI","addAPIProvider$1","customConfig","config","getAPIConfig","listAPIProviders","defaultConfig","sendQuery","payload","query","done","resourcesCount","startIndex","nextIndex","startTime","status","queriesSent","lastError","timer","queue","doneCallbacks","resetTimer","subscribe","overwrite","getQueryStatus","failQuery","clearQueue","moduleResponse","response","isError","queued","execNext","index","resource","status$1","initRedundancy","cfg","queries","queryCallback","doneCallback","query$1","error","find","emptyCallback$1","redundancyCache","getRedundancyCache","sendAPIQuery","target","redundancy","send","cached","emptyCallback","loadedNewIcons","checkIconNamesForAPI","valid","invalid","parseLoaderResponse","checkMissing","pending","err","parsePossiblyAsyncResponse","loadNewIcons","icons$1","customIconLoader","loadIcons$1","sortedIcons","callCallback","newIcons","sources","lastProvider","lastPrefix","providerNewIcons","pendingQueue","loadIcon$1","fulfill","reject","iconObj","loaded","testIconObject","parseIconValue","onload","loading","isBuggedSafari","getRenderMode","body","mode","unitsSplit","unitsTest","calculateSize$1","size","ratio","precision","oldParts","newParts","code","isNumber","splitSVGDefs","content","tag","defs","start","end","endEnd","mergeDefsAndContent","wrapSVGContent","isUnsetKeyword","iconToSVG","fullIcon","fullCustomisations","box","transformations","hFlip","vFlip","rotation","tempValue","customisationsWidth","customisationsHeight","boxWidth","boxHeight","width","height","setAttr","viewBox","iconToHTML$1","renderAttribsHTML","encodeSVGforURL","svgToData","svgToURL$1","detectFetch","fetchModule","setFetch","fetch$1","getFetch","calculateMaxLength","maxHostLength","url","shouldAbort","prepare","results","maxLength","type","length","getPath","host","params","path","iconsList","urlParams","uri","defaultError","fetchAPIModule","setCustomIconsLoader$1","loader","setCustomIconLoader$1","nodeAttr","customStyle","appendCustomStyle","style","updateStyle","inline","styleNode","exportFunctions","_window","preload","providers","monotoneProps","coloredProps","propsToAdd","propsToAddTo","fixSize","renderSPAN","useMask","renderAttribs","html","svgStyle","styles","policy","createPolicy","s","cleanUpInnerHTML","renderSVG","findIconElement","renderIcon","state","iconData","renderData","oldNode","setPendingState","lastState","lastRender","defineIconifyIcon","customElements","ParentClass","ConflictingClass","IconifyIcon","newInline","newIcon","newValue","attrMode","renderedMode","entries","intersecting","entry","functions","IconifyIconComponent","iconLoaded","getIcon","listIcons","addIcon","addCollection","calculateSize","buildIcon","iconToHTML","svgToURL","loadIcons","loadIcon","setCustomIconLoader","setCustomIconsLoader","addAPIProvider","_api","position","showProgress","positionClasses","toastConfig","getToastClasses","getToastIcon","animParams","root_1","Toast_Message","Toast_Title","iconify_icon","root_6","$.template_effect","$.set_custom_element_data","span","node_5","$.set_text","text","consequent_1","Toast_Description","text_1","root_8","Toast_ActionTrigger","consequent_2","Toast_CloseTrigger","iconify_icon_1","root_10","root_11","div_3","consequent_3","$.transition","fade","$1","Toast_Group","validateSchemaWidgets","schema","activeWidgets","logger","missingWidgets","extractWidgetsFromSchema","widget","suggestions","widgets","field","TreeView","TreeViewComponent","k","selectedId","ariaLabel","dir","search","compact","iconColorClass","showBadges","allowDragDrop","onReorder","onExpand","onHover","$.prop","focusedNodeId","$.state","expandedNodeIds","$.proxy","draggedNode","dragOverNode","dropPosition","prefersReducedMotion","isNodeExpanded","nodeId","mapNodesWithDerivedState","nodesToMap","processedNodes","filteredNodes","searchTermLower","filter","nodesToFilter","n","nodeMap","map","collect","depth","parentId","c","toggleNode","newSet","$.set","handleKeyDown","event","action","handleArrowKey","focusNextNode","focusPreviousNode","focusFirstNode","focusLastNode","direction","isRtl","expandKey","collapseKey","nodeData","focusNodeById","getVisibleNodesFlat","visible","traverse","nodesToTraverse","currentId","i","v","$.user_effect","isDescendant","ancestorId","nd","handleDragStart","handleDragOver","rect","y","h","threshold","handleDragLeave","related","handleDrop","handleDragEnd","onMount","mediaQuery","handleChange","e","transitionDuration","ul","$.first_child","fragment","li","$.child","scale","$.append","root_4","root_5","$.reset","$.set_attribute","$.set_class","div_4","root_7","alternate_1","div_5","consequent_4","node_6","div_6","root_9","consequent_5","div_7","div_8","node_9","consequent_6","consequent_7","$.event","preloadData","div_9","consequent_8","debouncedSearch","isSearching","expandedNodes","updateDebounced","debounce","isFullSidebar","ui","currentLanguage","app","collection","activeWidgetList","structure","contentStructure","countCache","countCollections","total","getBadgeColor","StatusTypes","mapToTreeNode","label","t","isCategory","isExpanded","hasInactiveWidgets","badge","selectNode","treeNodes","navigate","force","page","invalidateAll","goto","toggleExpand","same","setMode","set","clearSearch","input","$.remove_input_defaults","iconify_icon_2","p","m.collection_no_collections_found","alternate_2","m.collections_search","m.MediaGallery_Search","$$value","folders","selectedFolderId","isEditMode","isLoading","isSidebarFull","isMobile","screen","loadFolders","res","success","f","selectFolder","showToast","m.media_root_title","orphans","sortAndSetDepth","nodes","reorder","draggedId","targetId","newParentId","refresh","h3","iconify_icon_3","button_1","iconify_icon_4","iconify_icon_5","searchTerm","user","isAdmin","availableGroups","getSettingGroupsByRole","selectedGroupId","filteredGroups","lowerCaseSearchTerm","handleGroupClick","groupId","$.each","span_1","span_2","$groupsNeedingConfig","showTooltip","buttonClass","iconSize","cycleTheme","current","themeStore","setThemePreference","useSystemPreference","getTooltipText","getCurrentIcon","MOBILE_BREAKPOINT","LANGUAGE_DROPDOWN_THRESHOLD","AVATAR_CACHE_BUSTER","TOOLTIP_CLASS","ARROW_CLASS","currentPath","collections","isMediaMode","isSettingsMode","languageTag","getLocale","searchQuery","uiStateManager","firstCollectionPath","availableLanguages","availableLocales","getLanguageName","showLanguageDropdown","filteredLanguages","lang","searchLower","systemLangName","systemLanguage","enLangName","avatarUrl","src","avatarSrc","themeTooltipText","navigateTo","toggleUIElement","globalLoadingStore","loadingOperations","r","currentLocale","pathWithLanguage","handleLanguageSelection","toggleSidebar","newState","userPreferredState","handleUserClick","handleConfigClick","signOut","axios","handleKeyPress","a_1","SveltyCMSLogo","SiteName","a_2","node_3","node_4","SettingsMenu","button_2","fragment_1","m.button_Collections","MediaFolders","node_8","button_3","iconify_icon_6","fragment_4","iconify_icon_7","Collections","node_10","button_4","node_11","iconify_icon_8","fragment_6","span_3","iconify_icon_9","text_2","m.Collections_MediaGallery","iconify_icon_10","fragment_7","span_4","text_3","m.collections_media","alternate_3","alternate_4","alternate_5","Tooltip","node_12","Tooltip_Trigger","button_5","root_14","node_14","Avatar","Avatar_Image","Avatar_Fallback","root_17","text_5","Portal","node_18","Tooltip_Positioner","Tooltip_Content","span_5","fragment_12","Tooltip_Arrow","Tooltip_ArrowTip","text_6","m.applayout_userprofile","node_23","Tooltip_Trigger_1","root_23","ThemeToggle","node_25","node_26","Tooltip_Positioner_1","Tooltip_Content_1","span_6","fragment_17","Tooltip_Arrow_1","Tooltip_ArrowTip_1","node_31","Tooltip_Trigger_2","root_29","Menu","node_33","Menu_Trigger","node_35","Menu_Positioner","Menu_Content","div_10","fragment_24","text_9","node_38","div_11","fragment_25","div_12","Menu_Item","span_7","fragment_27","span_8","node_40","l","Menu_Item_1","span_9","fragment_30","span_10","alternate_6","m.applayout_systemlanguage","node_42","Tooltip_Positioner_2","Tooltip_Content_2","span_11","fragment_33","Tooltip_Arrow_2","Tooltip_ArrowTip_2","text_14","div_13","node_47","Tooltip_Trigger_3","button_6","root_46","iconify_icon_11","node_49","Tooltip_Positioner_3","Tooltip_Content_3","span_12","fragment_38","Tooltip_Arrow_3","Tooltip_ArrowTip_3","text_15","m.applayout_signout","div_14","node_54","Tooltip_Trigger_4","button_7","root_52","iconify_icon_12","node_56","Tooltip_Positioner_4","Tooltip_Content_4","span_13","fragment_43","Tooltip_Arrow_4","Tooltip_ArrowTip_4","text_16","m.applayout_systemconfiguration","div_15","VersionCheck","node_61","div_16","root_57","node_63","Tooltip_Trigger_5","a_3","root_59","iconify_icon_13","node_65","Tooltip_Positioner_5","Tooltip_Content_5","span_14","fragment_48","Tooltip_Arrow_5","Tooltip_ArrowTip_5","text_17","m.applayout_githubdiscussion","ModeStateMachine","newMode","currentMode","transition","dataChangeStore","modeStateMachine","NavigationManager","task","options","setCollectionValue","cleanUrl","entryId","navigationManager","statusState","getIsPublish","cv","isPublish","getCurrentStatus","statusStore","componentName","now","newStatus","updateEntryStatus","currentCollection","currentEntry","collectionValue","currentScreenSize","isFormValid","validationStore","hasChanges","canWrite","canCreate","canDelete","scheduleTimestamp","showSidebar","shouldDisableStatusToggle","isMenuCollection","nextAction","isUUID","getDisplayName","formatDate","dateStr","dates","handleClone","cloneCurrentEntry","handleDelete","deleteCurrentEntry","toggleStatus","openSchedule","showScheduleModal","date","timestamp","save","m.validation_fix_before_save","dataToSave","saveEntry","$$args","m.button_next","header","m.status_publish","m.status_unpublish","Toggles","m.button_delete","main","m.sidebar_will_publish_on","p_1","footer","classes","text_10","text_11","m.button_save","m.siedabar_publish_options","m.sidebar_createdby","isMounted","initPublicEnv","urlLocale","initializeDarkMode","flashMessageJson","flashMessage","__vitePreload","opts","desired","untrack","setLocale","browser","interval","intervalId","initializeThemeStore","siteName","publicEnv","showSidebars","isAuthRoute","isSetupRoute","$.head","$.document","ToastManager","aside","LeftSidebar","aside_1","RightSidebar"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,13],"sources":["../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/root-context.js","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/action-trigger.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/internal/components/x.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/close-trigger.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/description.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/group-context.js","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/group.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/message.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/root-context.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/root.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/title.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/anatomy.js","../../../../../../src/routes/+layout.ts","../../../../../../../../node_modules/.bun/iconify-icon@3.0.2/node_modules/iconify-icon/dist/iconify-icon.mjs","../../../../../../../../shared/components/src/system/ToastManager.svelte","../../../../../../../../shared/utils/src/widgetValidation.ts","../../../../../../../../shared/components/src/system/TreeView.svelte","../../../../../../../../shared/components/src/Collections.svelte","../../../../../../../../shared/components/src/MediaFolders.svelte","../../../../../../../../shared/components/src/SettingsMenu.svelte","../../../../../../../../shared/components/src/ThemeToggle.svelte","../../../../../../../../shared/components/src/LeftSidebar.svelte","../../../../../../../../shared/stores/src/modeStateMachine.svelte.ts","../../../../../../../../shared/utils/src/navigationManager.ts","../../../../../../../../shared/stores/src/statusStore.svelte.ts","../../../../../../../../shared/components/src/RightSidebar.svelte","../../../../../../src/routes/+layout.svelte"],"sourcesContent":["import { createContext } from '../../../internal/create-context.js';\nexport const RootContext = createContext();\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastActionTriggerProps extends PropsWithElement<'button'>, HTMLAttributes<'button'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastActionTriggerProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getActionTriggerProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<button {...attributes}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../html-attributes.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\texport type XProps = HTMLAttributes<'svg', 'children'>;\n</script>\n\n<script lang=\"ts\">\n\tconst props: XProps = $props();\n\n\tconst { ...rest } = $derived(props);\n\n\tconst attributes = $derived(\n\t\tmergeProps(\n\t\t\t{\n\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\n\t\t\t\twidth: '24',\n\t\t\t\theight: '24',\n\t\t\t\tviewBox: '0 0 24 24',\n\t\t\t\tfill: 'none',\n\t\t\t\tstroke: 'currentColor',\n\t\t\t\t'stroke-width': '2',\n\t\t\t\t'stroke-linecap': 'round',\n\t\t\t\t'stroke-linejoin': 'round',\n\t\t\t},\n\t\t\trest,\n\t\t),\n\t);\n</script>\n\n<svg {...attributes}>\n\t<path d=\"M18 6 6 18\" />\n\t<path d=\"m6 6 12 12\" />\n</svg>\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastCloseTriggerProps extends PropsWithElement<'button'>, HTMLAttributes<'button'> {}\n</script>\n\n<script lang=\"ts\">\n\timport X from '../../../internal/components/x.svelte';\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastCloseTriggerProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children = x, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getCloseTriggerProps(), rest));\n</script>\n\n{#snippet x()}\n\t<X />\n{/snippet}\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<button {...attributes}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastDescriptionProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastDescriptionProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getDescriptionProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","import { createContext } from '../../../internal/create-context.js';\nexport const GroupContext = createContext();\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { Props, Store } from '@zag-js/toast';\n\timport type { Snippet } from 'svelte';\n\n\texport interface ToastGroupProps extends PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir' | 'children'> {\n\t\ttoaster: Store;\n\t\tchildren?: Snippet<[Props]>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { GroupContext } from '../modules/group-context.js';\n\timport { mergeProps, normalizeProps, useMachine } from '@zag-js/svelte';\n\timport { group } from '@zag-js/toast';\n\n\tconst props: ToastGroupProps = $props();\n\n\tconst { element, children, toaster, ...rest } = $derived(props);\n\n\tconst id = $props.id();\n\tconst service = useMachine(group.machine, () => ({\n\t\tid: id,\n\t\tstore: toaster,\n\t}));\n\tconst api = $derived(group.connect(service, normalizeProps));\n\n\tconst attributes = $derived(mergeProps(api.getGroupProps(), rest));\n\n\tGroupContext.provide(() => service);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{#each api.getToasts() as toast (toast.id)}\n\t\t\t{@render children?.(toast)}\n\t\t{/each}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastMessageProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastMessageProps = $props();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(\n\t\tmergeProps(\n\t\t\t{\n\t\t\t\t'data-scope': 'toast',\n\t\t\t\t'data-part': 'message',\n\t\t\t},\n\t\t\trest,\n\t\t),\n\t);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { PropTypes } from '@zag-js/svelte';\n\timport type { Api } from '@zag-js/toast';\n\timport type { Snippet } from 'svelte';\n\n\texport interface ToastRootContextProps {\n\t\tchildren: Snippet<[() => Api<PropTypes>]>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\n\tconst props: ToastRootContextProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { children } = $derived(props);\n</script>\n\n{@render children(toast)}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { Options } from '@zag-js/toast';\n\n\texport interface ToastRootProps extends PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir'> {\n\t\ttoast: Options;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { GroupContext } from '../modules/group-context.js';\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps, normalizeProps, useMachine } from '@zag-js/svelte';\n\timport { connect, machine } from '@zag-js/toast';\n\n\tconst props: ToastRootProps = $props();\n\n\tconst group = GroupContext.consume();\n\n\tconst { element, children, toast: toastProps, ...rest } = $derived(props);\n\n\tconst service = useMachine(machine, () => ({\n\t\t...toastProps,\n\t\tparent: group(),\n\t}));\n\tconst toast = $derived(connect(service, normalizeProps));\n\n\tconst attributes = $derived(mergeProps(toast.getRootProps(), rest));\n\n\tRootContext.provide(() => toast);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t<div {...toast.getGhostBeforeProps()}></div>\n\t\t{@render children?.()}\n\t\t<div {...toast.getGhostAfterProps()}></div>\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastTitleProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastTitleProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getTitleProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","import ActionTrigger from '../anatomy/action-trigger.svelte';\nimport CloseTrigger from '../anatomy/close-trigger.svelte';\nimport Description from '../anatomy/description.svelte';\nimport Group from '../anatomy/group.svelte';\nimport Message from '../anatomy/message.svelte';\nimport RootContext from '../anatomy/root-context.svelte';\nimport Root from '../anatomy/root.svelte';\nimport Title from '../anatomy/title.svelte';\nexport const Toast = Object.assign(Root, {\n    Context: RootContext,\n    Group: Group,\n    Message: Message,\n    Title: Title,\n    Description: Description,\n    ActionTrigger: ActionTrigger,\n    CloseTrigger: CloseTrigger,\n});\n","export const ssr = false;\nexport const prerender = false;\n","/**\n* (c) Iconify\n*\n* For the full copyright and license information, please view the license.txt\n* files at https://github.com/iconify/iconify\n*\n* Licensed under MIT.\n*\n* @license MIT\n* @version 3.0.2\n*/\n/** Default values for dimensions */\nconst defaultIconDimensions = Object.freeze({\n\tleft: 0,\n\ttop: 0,\n\twidth: 16,\n\theight: 16\n});\n/** Default values for transformations */\nconst defaultIconTransformations = Object.freeze({\n\trotate: 0,\n\tvFlip: false,\n\thFlip: false\n});\n/** Default values for all optional IconifyIcon properties */\nconst defaultIconProps = Object.freeze({\n\t...defaultIconDimensions,\n\t...defaultIconTransformations\n});\n/** Default values for all properties used in ExtendedIconifyIcon */\nconst defaultExtendedIconProps = Object.freeze({\n\t...defaultIconProps,\n\tbody: \"\",\n\thidden: false\n});\n\n/**\n* Default icon customisations values\n*/\nconst defaultIconSizeCustomisations = Object.freeze({\n\twidth: null,\n\theight: null\n});\nconst defaultIconCustomisations = Object.freeze({\n\t...defaultIconSizeCustomisations,\n\t...defaultIconTransformations\n});\n\n/**\n* Get rotation value\n*/\nfunction rotateFromString(value, defaultValue = 0) {\n\tconst units = value.replace(/^-?[0-9.]*/, \"\");\n\tfunction cleanup(value$1) {\n\t\twhile (value$1 < 0) value$1 += 4;\n\t\treturn value$1 % 4;\n\t}\n\tif (units === \"\") {\n\t\tconst num = parseInt(value);\n\t\treturn isNaN(num) ? 0 : cleanup(num);\n\t} else if (units !== value) {\n\t\tlet split = 0;\n\t\tswitch (units) {\n\t\t\tcase \"%\":\n\t\t\t\tsplit = 25;\n\t\t\t\tbreak;\n\t\t\tcase \"deg\": split = 90;\n\t\t}\n\t\tif (split) {\n\t\t\tlet num = parseFloat(value.slice(0, value.length - units.length));\n\t\t\tif (isNaN(num)) return 0;\n\t\t\tnum = num / split;\n\t\t\treturn num % 1 === 0 ? cleanup(num) : 0;\n\t\t}\n\t}\n\treturn defaultValue;\n}\n\nconst separator = /[\\s,]+/;\n/**\n* Apply \"flip\" string to icon customisations\n*/\nfunction flipFromString(custom, flip) {\n\tflip.split(separator).forEach((str) => {\n\t\tswitch (str.trim()) {\n\t\t\tcase \"horizontal\":\n\t\t\t\tcustom.hFlip = true;\n\t\t\t\tbreak;\n\t\t\tcase \"vertical\":\n\t\t\t\tcustom.vFlip = true;\n\t\t\t\tbreak;\n\t\t}\n\t});\n}\n\nconst defaultCustomisations = {\n    ...defaultIconCustomisations,\n    preserveAspectRatio: '',\n};\n/**\n * Get customisations\n */\nfunction getCustomisations(node) {\n    const customisations = {\n        ...defaultCustomisations,\n    };\n    const attr = (key, def) => node.getAttribute(key) || def;\n    // Dimensions\n    customisations.width = attr('width', null);\n    customisations.height = attr('height', null);\n    // Rotation\n    customisations.rotate = rotateFromString(attr('rotate', ''));\n    // Flip\n    flipFromString(customisations, attr('flip', ''));\n    // SVG attributes\n    customisations.preserveAspectRatio = attr('preserveAspectRatio', attr('preserveaspectratio', ''));\n    return customisations;\n}\n/**\n * Check if customisations have been updated\n */\nfunction haveCustomisationsChanged(value1, value2) {\n    for (const key in defaultCustomisations) {\n        if (value1[key] !== value2[key]) {\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n* Expression to test part of icon name.\n*\n* Used when loading icons from Iconify API due to project naming convension.\n* Ignored when using custom icon sets - convension does not apply.\n*/\nconst matchIconName = /^[a-z0-9]+(-[a-z0-9]+)*$/;\n/**\n* Convert string icon name to IconifyIconName object.\n*/\nconst stringToIcon = (value, validate, allowSimpleName, provider = \"\") => {\n\tconst colonSeparated = value.split(\":\");\n\tif (value.slice(0, 1) === \"@\") {\n\t\tif (colonSeparated.length < 2 || colonSeparated.length > 3) return null;\n\t\tprovider = colonSeparated.shift().slice(1);\n\t}\n\tif (colonSeparated.length > 3 || !colonSeparated.length) return null;\n\tif (colonSeparated.length > 1) {\n\t\tconst name$1 = colonSeparated.pop();\n\t\tconst prefix = colonSeparated.pop();\n\t\tconst result = {\n\t\t\tprovider: colonSeparated.length > 0 ? colonSeparated[0] : provider,\n\t\t\tprefix,\n\t\t\tname: name$1\n\t\t};\n\t\treturn validate && !validateIconName(result) ? null : result;\n\t}\n\tconst name = colonSeparated[0];\n\tconst dashSeparated = name.split(\"-\");\n\tif (dashSeparated.length > 1) {\n\t\tconst result = {\n\t\t\tprovider,\n\t\t\tprefix: dashSeparated.shift(),\n\t\t\tname: dashSeparated.join(\"-\")\n\t\t};\n\t\treturn validate && !validateIconName(result) ? null : result;\n\t}\n\tif (allowSimpleName && provider === \"\") {\n\t\tconst result = {\n\t\t\tprovider,\n\t\t\tprefix: \"\",\n\t\t\tname\n\t\t};\n\t\treturn validate && !validateIconName(result, allowSimpleName) ? null : result;\n\t}\n\treturn null;\n};\n/**\n* Check if icon is valid.\n*\n* This function is not part of stringToIcon because validation is not needed for most code.\n*/\nconst validateIconName = (icon, allowSimpleName) => {\n\tif (!icon) return false;\n\treturn !!((allowSimpleName && icon.prefix === \"\" || !!icon.prefix) && !!icon.name);\n};\n\n/**\n* Resolve icon set icons\n*\n* Returns parent icon for each icon\n*/\nfunction getIconsTree(data, names) {\n\tconst icons = data.icons;\n\tconst aliases = data.aliases || Object.create(null);\n\tconst resolved = Object.create(null);\n\tfunction resolve(name) {\n\t\tif (icons[name]) return resolved[name] = [];\n\t\tif (!(name in resolved)) {\n\t\t\tresolved[name] = null;\n\t\t\tconst parent = aliases[name] && aliases[name].parent;\n\t\t\tconst value = parent && resolve(parent);\n\t\t\tif (value) resolved[name] = [parent].concat(value);\n\t\t}\n\t\treturn resolved[name];\n\t}\n\t(Object.keys(icons).concat(Object.keys(aliases))).forEach(resolve);\n\treturn resolved;\n}\n\n/**\n* Merge transformations\n*/\nfunction mergeIconTransformations(obj1, obj2) {\n\tconst result = {};\n\tif (!obj1.hFlip !== !obj2.hFlip) result.hFlip = true;\n\tif (!obj1.vFlip !== !obj2.vFlip) result.vFlip = true;\n\tconst rotate = ((obj1.rotate || 0) + (obj2.rotate || 0)) % 4;\n\tif (rotate) result.rotate = rotate;\n\treturn result;\n}\n\n/**\n* Merge icon and alias\n*\n* Can also be used to merge default values and icon\n*/\nfunction mergeIconData(parent, child) {\n\tconst result = mergeIconTransformations(parent, child);\n\tfor (const key in defaultExtendedIconProps) if (key in defaultIconTransformations) {\n\t\tif (key in parent && !(key in result)) result[key] = defaultIconTransformations[key];\n\t} else if (key in child) result[key] = child[key];\n\telse if (key in parent) result[key] = parent[key];\n\treturn result;\n}\n\n/**\n* Get icon data, using prepared aliases tree\n*/\nfunction internalGetIconData(data, name, tree) {\n\tconst icons = data.icons;\n\tconst aliases = data.aliases || Object.create(null);\n\tlet currentProps = {};\n\tfunction parse(name$1) {\n\t\tcurrentProps = mergeIconData(icons[name$1] || aliases[name$1], currentProps);\n\t}\n\tparse(name);\n\ttree.forEach(parse);\n\treturn mergeIconData(data, currentProps);\n}\n\n/**\n* Extract icons from an icon set\n*\n* Returns list of icons that were found in icon set\n*/\nfunction parseIconSet(data, callback) {\n\tconst names = [];\n\tif (typeof data !== \"object\" || typeof data.icons !== \"object\") return names;\n\tif (data.not_found instanceof Array) data.not_found.forEach((name) => {\n\t\tcallback(name, null);\n\t\tnames.push(name);\n\t});\n\tconst tree = getIconsTree(data);\n\tfor (const name in tree) {\n\t\tconst item = tree[name];\n\t\tif (item) {\n\t\t\tcallback(name, internalGetIconData(data, name, item));\n\t\t\tnames.push(name);\n\t\t}\n\t}\n\treturn names;\n}\n\n/**\n* Optional properties\n*/\nconst optionalPropertyDefaults = {\n\tprovider: \"\",\n\taliases: {},\n\tnot_found: {},\n\t...defaultIconDimensions\n};\n/**\n* Check props\n*/\nfunction checkOptionalProps(item, defaults) {\n\tfor (const prop in defaults) if (prop in item && typeof item[prop] !== typeof defaults[prop]) return false;\n\treturn true;\n}\n/**\n* Validate icon set, return it as IconifyJSON on success, null on failure\n*\n* Unlike validateIconSet(), this function is very basic.\n* It does not throw exceptions, it does not check metadata, it does not fix stuff.\n*/\nfunction quicklyValidateIconSet(obj) {\n\tif (typeof obj !== \"object\" || obj === null) return null;\n\tconst data = obj;\n\tif (typeof data.prefix !== \"string\" || !obj.icons || typeof obj.icons !== \"object\") return null;\n\tif (!checkOptionalProps(obj, optionalPropertyDefaults)) return null;\n\tconst icons = data.icons;\n\tfor (const name in icons) {\n\t\tconst icon = icons[name];\n\t\tif (!name || typeof icon.body !== \"string\" || !checkOptionalProps(icon, defaultExtendedIconProps)) return null;\n\t}\n\tconst aliases = data.aliases || Object.create(null);\n\tfor (const name in aliases) {\n\t\tconst icon = aliases[name];\n\t\tconst parent = icon.parent;\n\t\tif (!name || typeof parent !== \"string\" || !icons[parent] && !aliases[parent] || !checkOptionalProps(icon, defaultExtendedIconProps)) return null;\n\t}\n\treturn data;\n}\n\n/**\n* Storage by provider and prefix\n*/\nconst dataStorage = Object.create(null);\n/**\n* Create new storage\n*/\nfunction newStorage(provider, prefix) {\n\treturn {\n\t\tprovider,\n\t\tprefix,\n\t\ticons: Object.create(null),\n\t\tmissing: /* @__PURE__ */ new Set()\n\t};\n}\n/**\n* Get storage for provider and prefix\n*/\nfunction getStorage(provider, prefix) {\n\tconst providerStorage = dataStorage[provider] || (dataStorage[provider] = Object.create(null));\n\treturn providerStorage[prefix] || (providerStorage[prefix] = newStorage(provider, prefix));\n}\n/**\n* Add icon set to storage\n*\n* Returns array of added icons\n*/\nfunction addIconSet(storage, data) {\n\tif (!quicklyValidateIconSet(data)) return [];\n\treturn parseIconSet(data, (name, icon) => {\n\t\tif (icon) storage.icons[name] = icon;\n\t\telse storage.missing.add(name);\n\t});\n}\n/**\n* Add icon to storage\n*/\nfunction addIconToStorage(storage, name, icon) {\n\ttry {\n\t\tif (typeof icon.body === \"string\") {\n\t\t\tstorage.icons[name] = { ...icon };\n\t\t\treturn true;\n\t\t}\n\t} catch (err) {}\n\treturn false;\n}\n/**\n* List available icons\n*/\nfunction listIcons$1(provider, prefix) {\n\tlet allIcons = [];\n\t(typeof provider === \"string\" ? [provider] : Object.keys(dataStorage)).forEach((provider$1) => {\n\t\t(typeof provider$1 === \"string\" && typeof prefix === \"string\" ? [prefix] : Object.keys(dataStorage[provider$1] || {})).forEach((prefix$1) => {\n\t\t\tconst storage = getStorage(provider$1, prefix$1);\n\t\t\tallIcons = allIcons.concat(Object.keys(storage.icons).map((name) => (provider$1 !== \"\" ? \"@\" + provider$1 + \":\" : \"\") + prefix$1 + \":\" + name));\n\t\t});\n\t});\n\treturn allIcons;\n}\n\n/**\n* Allow storing icons without provider or prefix, making it possible to store icons like \"home\"\n*/\nlet simpleNames = false;\nfunction allowSimpleNames(allow) {\n\tif (typeof allow === \"boolean\") simpleNames = allow;\n\treturn simpleNames;\n}\n/**\n* Get icon data\n*\n* Returns:\n* - IconifyIcon on success, object directly from storage so don't modify it\n* - null if icon is marked as missing (returned in `not_found` property from API, so don't bother sending API requests)\n* - undefined if icon is missing in storage\n*/\nfunction getIconData(name) {\n\tconst icon = typeof name === \"string\" ? stringToIcon(name, true, simpleNames) : name;\n\tif (icon) {\n\t\tconst storage = getStorage(icon.provider, icon.prefix);\n\t\tconst iconName = icon.name;\n\t\treturn storage.icons[iconName] || (storage.missing.has(iconName) ? null : void 0);\n\t}\n}\n/**\n* Add one icon\n*/\nfunction addIcon$1(name, data) {\n\tconst icon = stringToIcon(name, true, simpleNames);\n\tif (!icon) return false;\n\tconst storage = getStorage(icon.provider, icon.prefix);\n\tif (data) return addIconToStorage(storage, icon.name, data);\n\telse {\n\t\tstorage.missing.add(icon.name);\n\t\treturn true;\n\t}\n}\n/**\n* Add icon set\n*/\nfunction addCollection$1(data, provider) {\n\tif (typeof data !== \"object\") return false;\n\tif (typeof provider !== \"string\") provider = data.provider || \"\";\n\tif (simpleNames && !provider && !data.prefix) {\n\t\tlet added = false;\n\t\tif (quicklyValidateIconSet(data)) {\n\t\t\tdata.prefix = \"\";\n\t\t\tparseIconSet(data, (name, icon) => {\n\t\t\t\tif (addIcon$1(name, icon)) added = true;\n\t\t\t});\n\t\t}\n\t\treturn added;\n\t}\n\tconst prefix = data.prefix;\n\tif (!validateIconName({\n\t\tprefix,\n\t\tname: \"a\"\n\t})) return false;\n\treturn !!addIconSet(getStorage(provider, prefix), data);\n}\n/**\n* Check if icon data is available\n*/\nfunction iconLoaded$1(name) {\n\treturn !!getIconData(name);\n}\n/**\n* Get full icon\n*/\nfunction getIcon$1(name) {\n\tconst result = getIconData(name);\n\treturn result ? {\n\t\t...defaultIconProps,\n\t\t...result\n\t} : result;\n}\n\n/**\n* Remove callback\n*/\nfunction removeCallback(storages, id) {\n\tstorages.forEach((storage) => {\n\t\tconst items = storage.loaderCallbacks;\n\t\tif (items) storage.loaderCallbacks = items.filter((row) => row.id !== id);\n\t});\n}\n/**\n* Update all callbacks for provider and prefix\n*/\nfunction updateCallbacks(storage) {\n\tif (!storage.pendingCallbacksFlag) {\n\t\tstorage.pendingCallbacksFlag = true;\n\t\tsetTimeout(() => {\n\t\t\tstorage.pendingCallbacksFlag = false;\n\t\t\tconst items = storage.loaderCallbacks ? storage.loaderCallbacks.slice(0) : [];\n\t\t\tif (!items.length) return;\n\t\t\tlet hasPending = false;\n\t\t\tconst provider = storage.provider;\n\t\t\tconst prefix = storage.prefix;\n\t\t\titems.forEach((item) => {\n\t\t\t\tconst icons = item.icons;\n\t\t\t\tconst oldLength = icons.pending.length;\n\t\t\t\ticons.pending = icons.pending.filter((icon) => {\n\t\t\t\t\tif (icon.prefix !== prefix) return true;\n\t\t\t\t\tconst name = icon.name;\n\t\t\t\t\tif (storage.icons[name]) icons.loaded.push({\n\t\t\t\t\t\tprovider,\n\t\t\t\t\t\tprefix,\n\t\t\t\t\t\tname\n\t\t\t\t\t});\n\t\t\t\t\telse if (storage.missing.has(name)) icons.missing.push({\n\t\t\t\t\t\tprovider,\n\t\t\t\t\t\tprefix,\n\t\t\t\t\t\tname\n\t\t\t\t\t});\n\t\t\t\t\telse {\n\t\t\t\t\t\thasPending = true;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t\tif (icons.pending.length !== oldLength) {\n\t\t\t\t\tif (!hasPending) removeCallback([storage], item.id);\n\t\t\t\t\titem.callback(icons.loaded.slice(0), icons.missing.slice(0), icons.pending.slice(0), item.abort);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n/**\n* Unique id counter for callbacks\n*/\nlet idCounter = 0;\n/**\n* Add callback\n*/\nfunction storeCallback(callback, icons, pendingSources) {\n\tconst id = idCounter++;\n\tconst abort = removeCallback.bind(null, pendingSources, id);\n\tif (!icons.pending.length) return abort;\n\tconst item = {\n\t\tid,\n\t\ticons,\n\t\tcallback,\n\t\tabort\n\t};\n\tpendingSources.forEach((storage) => {\n\t\t(storage.loaderCallbacks || (storage.loaderCallbacks = [])).push(item);\n\t});\n\treturn abort;\n}\n\n/**\n* Check if icons have been loaded\n*/\nfunction sortIcons(icons) {\n\tconst result = {\n\t\tloaded: [],\n\t\tmissing: [],\n\t\tpending: []\n\t};\n\tconst storage = Object.create(null);\n\ticons.sort((a, b) => {\n\t\tif (a.provider !== b.provider) return a.provider.localeCompare(b.provider);\n\t\tif (a.prefix !== b.prefix) return a.prefix.localeCompare(b.prefix);\n\t\treturn a.name.localeCompare(b.name);\n\t});\n\tlet lastIcon = {\n\t\tprovider: \"\",\n\t\tprefix: \"\",\n\t\tname: \"\"\n\t};\n\ticons.forEach((icon) => {\n\t\tif (lastIcon.name === icon.name && lastIcon.prefix === icon.prefix && lastIcon.provider === icon.provider) return;\n\t\tlastIcon = icon;\n\t\tconst provider = icon.provider;\n\t\tconst prefix = icon.prefix;\n\t\tconst name = icon.name;\n\t\tconst providerStorage = storage[provider] || (storage[provider] = Object.create(null));\n\t\tconst localStorage = providerStorage[prefix] || (providerStorage[prefix] = getStorage(provider, prefix));\n\t\tlet list;\n\t\tif (name in localStorage.icons) list = result.loaded;\n\t\telse if (prefix === \"\" || localStorage.missing.has(name)) list = result.missing;\n\t\telse list = result.pending;\n\t\tconst item = {\n\t\t\tprovider,\n\t\t\tprefix,\n\t\t\tname\n\t\t};\n\t\tlist.push(item);\n\t});\n\treturn result;\n}\n\n/**\n* Local storate types and entries\n*/\nconst storage = Object.create(null);\n/**\n* Set API module\n*/\nfunction setAPIModule(provider, item) {\n\tstorage[provider] = item;\n}\n/**\n* Get API module\n*/\nfunction getAPIModule(provider) {\n\treturn storage[provider] || storage[\"\"];\n}\n\n/**\n* Convert icons list from string/icon mix to icons and validate them\n*/\nfunction listToIcons(list, validate = true, simpleNames = false) {\n\tconst result = [];\n\tlist.forEach((item) => {\n\t\tconst icon = typeof item === \"string\" ? stringToIcon(item, validate, simpleNames) : item;\n\t\tif (icon) result.push(icon);\n\t});\n\treturn result;\n}\n\n/**\n* Create full API configuration from partial data\n*/\nfunction createAPIConfig(source) {\n\tlet resources;\n\tif (typeof source.resources === \"string\") resources = [source.resources];\n\telse {\n\t\tresources = source.resources;\n\t\tif (!(resources instanceof Array) || !resources.length) return null;\n\t}\n\treturn {\n\t\tresources,\n\t\tpath: source.path || \"/\",\n\t\tmaxURL: source.maxURL || 500,\n\t\trotate: source.rotate || 750,\n\t\ttimeout: source.timeout || 5e3,\n\t\trandom: source.random === true,\n\t\tindex: source.index || 0,\n\t\tdataAfterTimeout: source.dataAfterTimeout !== false\n\t};\n}\n/**\n* Local storage\n*/\nconst configStorage = Object.create(null);\n/**\n* Redundancy for API servers.\n*\n* API should have very high uptime because of implemented redundancy at server level, but\n* sometimes bad things happen. On internet 100% uptime is not possible.\n*\n* There could be routing problems. Server might go down for whatever reason, but it takes\n* few minutes to detect that downtime, so during those few minutes API might not be accessible.\n*\n* This script has some redundancy to mitigate possible network issues.\n*\n* If one host cannot be reached in 'rotate' (750 by default) ms, script will try to retrieve\n* data from different host. Hosts have different configurations, pointing to different\n* API servers hosted at different providers.\n*/\nconst fallBackAPISources = [\"https://api.simplesvg.com\", \"https://api.unisvg.com\"];\nconst fallBackAPI = [];\nwhile (fallBackAPISources.length > 0) if (fallBackAPISources.length === 1) fallBackAPI.push(fallBackAPISources.shift());\nelse if (Math.random() > .5) fallBackAPI.push(fallBackAPISources.shift());\nelse fallBackAPI.push(fallBackAPISources.pop());\nconfigStorage[\"\"] = createAPIConfig({ resources: [\"https://api.iconify.design\"].concat(fallBackAPI) });\n/**\n* Add custom config for provider\n*/\nfunction addAPIProvider$1(provider, customConfig) {\n\tconst config = createAPIConfig(customConfig);\n\tif (config === null) return false;\n\tconfigStorage[provider] = config;\n\treturn true;\n}\n/**\n* Get API configuration\n*/\nfunction getAPIConfig(provider) {\n\treturn configStorage[provider];\n}\n/**\n* List API providers\n*/\nfunction listAPIProviders() {\n\treturn Object.keys(configStorage);\n}\n\n/**\n* Default RedundancyConfig for API calls\n*/\nconst defaultConfig = {\n\tresources: [],\n\tindex: 0,\n\ttimeout: 2e3,\n\trotate: 750,\n\trandom: false,\n\tdataAfterTimeout: false\n};\n\n/**\n* Send query\n*/\nfunction sendQuery(config, payload, query, done) {\n\tconst resourcesCount = config.resources.length;\n\tconst startIndex = config.random ? Math.floor(Math.random() * resourcesCount) : config.index;\n\tlet resources;\n\tif (config.random) {\n\t\tlet list = config.resources.slice(0);\n\t\tresources = [];\n\t\twhile (list.length > 1) {\n\t\t\tconst nextIndex = Math.floor(Math.random() * list.length);\n\t\t\tresources.push(list[nextIndex]);\n\t\t\tlist = list.slice(0, nextIndex).concat(list.slice(nextIndex + 1));\n\t\t}\n\t\tresources = resources.concat(list);\n\t} else resources = config.resources.slice(startIndex).concat(config.resources.slice(0, startIndex));\n\tconst startTime = Date.now();\n\tlet status = \"pending\";\n\tlet queriesSent = 0;\n\tlet lastError;\n\tlet timer = null;\n\tlet queue = [];\n\tlet doneCallbacks = [];\n\tif (typeof done === \"function\") doneCallbacks.push(done);\n\t/**\n\t* Reset timer\n\t*/\n\tfunction resetTimer() {\n\t\tif (timer) {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = null;\n\t\t}\n\t}\n\t/**\n\t* Abort everything\n\t*/\n\tfunction abort() {\n\t\tif (status === \"pending\") status = \"aborted\";\n\t\tresetTimer();\n\t\tqueue.forEach((item) => {\n\t\t\tif (item.status === \"pending\") item.status = \"aborted\";\n\t\t});\n\t\tqueue = [];\n\t}\n\t/**\n\t* Add / replace callback to call when execution is complete.\n\t* This can be used to abort pending query implementations when query is complete or aborted.\n\t*/\n\tfunction subscribe(callback, overwrite) {\n\t\tif (overwrite) doneCallbacks = [];\n\t\tif (typeof callback === \"function\") doneCallbacks.push(callback);\n\t}\n\t/**\n\t* Get query status\n\t*/\n\tfunction getQueryStatus() {\n\t\treturn {\n\t\t\tstartTime,\n\t\t\tpayload,\n\t\t\tstatus,\n\t\t\tqueriesSent,\n\t\t\tqueriesPending: queue.length,\n\t\t\tsubscribe,\n\t\t\tabort\n\t\t};\n\t}\n\t/**\n\t* Fail query\n\t*/\n\tfunction failQuery() {\n\t\tstatus = \"failed\";\n\t\tdoneCallbacks.forEach((callback) => {\n\t\t\tcallback(void 0, lastError);\n\t\t});\n\t}\n\t/**\n\t* Clear queue\n\t*/\n\tfunction clearQueue() {\n\t\tqueue.forEach((item) => {\n\t\t\tif (item.status === \"pending\") item.status = \"aborted\";\n\t\t});\n\t\tqueue = [];\n\t}\n\t/**\n\t* Got response from module\n\t*/\n\tfunction moduleResponse(item, response, data) {\n\t\tconst isError = response !== \"success\";\n\t\tqueue = queue.filter((queued) => queued !== item);\n\t\tswitch (status) {\n\t\t\tcase \"pending\": break;\n\t\t\tcase \"failed\":\n\t\t\t\tif (isError || !config.dataAfterTimeout) return;\n\t\t\t\tbreak;\n\t\t\tdefault: return;\n\t\t}\n\t\tif (response === \"abort\") {\n\t\t\tlastError = data;\n\t\t\tfailQuery();\n\t\t\treturn;\n\t\t}\n\t\tif (isError) {\n\t\t\tlastError = data;\n\t\t\tif (!queue.length) if (!resources.length) failQuery();\n\t\t\telse execNext();\n\t\t\treturn;\n\t\t}\n\t\tresetTimer();\n\t\tclearQueue();\n\t\tif (!config.random) {\n\t\t\tconst index = config.resources.indexOf(item.resource);\n\t\t\tif (index !== -1 && index !== config.index) config.index = index;\n\t\t}\n\t\tstatus = \"completed\";\n\t\tdoneCallbacks.forEach((callback) => {\n\t\t\tcallback(data);\n\t\t});\n\t}\n\t/**\n\t* Execute next query\n\t*/\n\tfunction execNext() {\n\t\tif (status !== \"pending\") return;\n\t\tresetTimer();\n\t\tconst resource = resources.shift();\n\t\tif (resource === void 0) {\n\t\t\tif (queue.length) {\n\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\tresetTimer();\n\t\t\t\t\tif (status === \"pending\") {\n\t\t\t\t\t\tclearQueue();\n\t\t\t\t\t\tfailQuery();\n\t\t\t\t\t}\n\t\t\t\t}, config.timeout);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfailQuery();\n\t\t\treturn;\n\t\t}\n\t\tconst item = {\n\t\t\tstatus: \"pending\",\n\t\t\tresource,\n\t\t\tcallback: (status$1, data) => {\n\t\t\t\tmoduleResponse(item, status$1, data);\n\t\t\t}\n\t\t};\n\t\tqueue.push(item);\n\t\tqueriesSent++;\n\t\ttimer = setTimeout(execNext, config.rotate);\n\t\tquery(resource, payload, item.callback);\n\t}\n\tsetTimeout(execNext);\n\treturn getQueryStatus;\n}\n\n/**\n* Redundancy instance\n*/\nfunction initRedundancy(cfg) {\n\tconst config = {\n\t\t...defaultConfig,\n\t\t...cfg\n\t};\n\tlet queries = [];\n\t/**\n\t* Remove aborted and completed queries\n\t*/\n\tfunction cleanup() {\n\t\tqueries = queries.filter((item) => item().status === \"pending\");\n\t}\n\t/**\n\t* Send query\n\t*/\n\tfunction query(payload, queryCallback, doneCallback) {\n\t\tconst query$1 = sendQuery(config, payload, queryCallback, (data, error) => {\n\t\t\tcleanup();\n\t\t\tif (doneCallback) doneCallback(data, error);\n\t\t});\n\t\tqueries.push(query$1);\n\t\treturn query$1;\n\t}\n\t/**\n\t* Find instance\n\t*/\n\tfunction find(callback) {\n\t\treturn queries.find((value) => {\n\t\t\treturn callback(value);\n\t\t}) || null;\n\t}\n\treturn {\n\t\tquery,\n\t\tfind,\n\t\tsetIndex: (index) => {\n\t\t\tconfig.index = index;\n\t\t},\n\t\tgetIndex: () => config.index,\n\t\tcleanup\n\t};\n}\n\nfunction emptyCallback$1() {}\nconst redundancyCache = Object.create(null);\n/**\n* Get Redundancy instance for provider\n*/\nfunction getRedundancyCache(provider) {\n\tif (!redundancyCache[provider]) {\n\t\tconst config = getAPIConfig(provider);\n\t\tif (!config) return;\n\t\tredundancyCache[provider] = {\n\t\t\tconfig,\n\t\t\tredundancy: initRedundancy(config)\n\t\t};\n\t}\n\treturn redundancyCache[provider];\n}\n/**\n* Send API query\n*/\nfunction sendAPIQuery(target, query, callback) {\n\tlet redundancy;\n\tlet send;\n\tif (typeof target === \"string\") {\n\t\tconst api = getAPIModule(target);\n\t\tif (!api) {\n\t\t\tcallback(void 0, 424);\n\t\t\treturn emptyCallback$1;\n\t\t}\n\t\tsend = api.send;\n\t\tconst cached = getRedundancyCache(target);\n\t\tif (cached) redundancy = cached.redundancy;\n\t} else {\n\t\tconst config = createAPIConfig(target);\n\t\tif (config) {\n\t\t\tredundancy = initRedundancy(config);\n\t\t\tconst api = getAPIModule(target.resources ? target.resources[0] : \"\");\n\t\t\tif (api) send = api.send;\n\t\t}\n\t}\n\tif (!redundancy || !send) {\n\t\tcallback(void 0, 424);\n\t\treturn emptyCallback$1;\n\t}\n\treturn redundancy.query(query, send, callback)().abort;\n}\n\nfunction emptyCallback() {}\n/**\n* Function called when new icons have been loaded\n*/\nfunction loadedNewIcons(storage) {\n\tif (!storage.iconsLoaderFlag) {\n\t\tstorage.iconsLoaderFlag = true;\n\t\tsetTimeout(() => {\n\t\t\tstorage.iconsLoaderFlag = false;\n\t\t\tupdateCallbacks(storage);\n\t\t});\n\t}\n}\n/**\n* Check icon names for API\n*/\nfunction checkIconNamesForAPI(icons) {\n\tconst valid = [];\n\tconst invalid = [];\n\ticons.forEach((name) => {\n\t\t(name.match(matchIconName) ? valid : invalid).push(name);\n\t});\n\treturn {\n\t\tvalid,\n\t\tinvalid\n\t};\n}\n/**\n* Parse loader response\n*/\nfunction parseLoaderResponse(storage, icons, data) {\n\tfunction checkMissing() {\n\t\tconst pending = storage.pendingIcons;\n\t\ticons.forEach((name) => {\n\t\t\tif (pending) pending.delete(name);\n\t\t\tif (!storage.icons[name]) storage.missing.add(name);\n\t\t});\n\t}\n\tif (data && typeof data === \"object\") try {\n\t\tif (!addIconSet(storage, data).length) {\n\t\t\tcheckMissing();\n\t\t\treturn;\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t}\n\tcheckMissing();\n\tloadedNewIcons(storage);\n}\n/**\n* Handle response that can be async\n*/\nfunction parsePossiblyAsyncResponse(response, callback) {\n\tif (response instanceof Promise) response.then((data) => {\n\t\tcallback(data);\n\t}).catch(() => {\n\t\tcallback(null);\n\t});\n\telse callback(response);\n}\n/**\n* Load icons\n*/\nfunction loadNewIcons(storage, icons) {\n\tif (!storage.iconsToLoad) storage.iconsToLoad = icons;\n\telse storage.iconsToLoad = storage.iconsToLoad.concat(icons).sort();\n\tif (!storage.iconsQueueFlag) {\n\t\tstorage.iconsQueueFlag = true;\n\t\tsetTimeout(() => {\n\t\t\tstorage.iconsQueueFlag = false;\n\t\t\tconst { provider, prefix } = storage;\n\t\t\tconst icons$1 = storage.iconsToLoad;\n\t\t\tdelete storage.iconsToLoad;\n\t\t\tif (!icons$1 || !icons$1.length) return;\n\t\t\tconst customIconLoader = storage.loadIcon;\n\t\t\tif (storage.loadIcons && (icons$1.length > 1 || !customIconLoader)) {\n\t\t\t\tparsePossiblyAsyncResponse(storage.loadIcons(icons$1, prefix, provider), (data) => {\n\t\t\t\t\tparseLoaderResponse(storage, icons$1, data);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (customIconLoader) {\n\t\t\t\ticons$1.forEach((name) => {\n\t\t\t\t\tparsePossiblyAsyncResponse(customIconLoader(name, prefix, provider), (data) => {\n\t\t\t\t\t\tparseLoaderResponse(storage, [name], data ? {\n\t\t\t\t\t\t\tprefix,\n\t\t\t\t\t\t\ticons: { [name]: data }\n\t\t\t\t\t\t} : null);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { valid, invalid } = checkIconNamesForAPI(icons$1);\n\t\t\tif (invalid.length) parseLoaderResponse(storage, invalid, null);\n\t\t\tif (!valid.length) return;\n\t\t\tconst api = prefix.match(matchIconName) ? getAPIModule(provider) : null;\n\t\t\tif (!api) {\n\t\t\t\tparseLoaderResponse(storage, valid, null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tapi.prepare(provider, prefix, valid).forEach((item) => {\n\t\t\t\tsendAPIQuery(provider, item, (data) => {\n\t\t\t\t\tparseLoaderResponse(storage, item.icons, data);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n}\n/**\n* Load icons\n*/\nconst loadIcons$1 = (icons, callback) => {\n\tconst sortedIcons = sortIcons(listToIcons(icons, true, allowSimpleNames()));\n\tif (!sortedIcons.pending.length) {\n\t\tlet callCallback = true;\n\t\tif (callback) setTimeout(() => {\n\t\t\tif (callCallback) callback(sortedIcons.loaded, sortedIcons.missing, sortedIcons.pending, emptyCallback);\n\t\t});\n\t\treturn () => {\n\t\t\tcallCallback = false;\n\t\t};\n\t}\n\tconst newIcons = Object.create(null);\n\tconst sources = [];\n\tlet lastProvider, lastPrefix;\n\tsortedIcons.pending.forEach((icon) => {\n\t\tconst { provider, prefix } = icon;\n\t\tif (prefix === lastPrefix && provider === lastProvider) return;\n\t\tlastProvider = provider;\n\t\tlastPrefix = prefix;\n\t\tsources.push(getStorage(provider, prefix));\n\t\tconst providerNewIcons = newIcons[provider] || (newIcons[provider] = Object.create(null));\n\t\tif (!providerNewIcons[prefix]) providerNewIcons[prefix] = [];\n\t});\n\tsortedIcons.pending.forEach((icon) => {\n\t\tconst { provider, prefix, name } = icon;\n\t\tconst storage = getStorage(provider, prefix);\n\t\tconst pendingQueue = storage.pendingIcons || (storage.pendingIcons = /* @__PURE__ */ new Set());\n\t\tif (!pendingQueue.has(name)) {\n\t\t\tpendingQueue.add(name);\n\t\t\tnewIcons[provider][prefix].push(name);\n\t\t}\n\t});\n\tsources.forEach((storage) => {\n\t\tconst list = newIcons[storage.provider][storage.prefix];\n\t\tif (list.length) loadNewIcons(storage, list);\n\t});\n\treturn callback ? storeCallback(callback, sortedIcons, sources) : emptyCallback;\n};\n/**\n* Load one icon using Promise\n*/\nconst loadIcon$1 = (icon) => {\n\treturn new Promise((fulfill, reject) => {\n\t\tconst iconObj = typeof icon === \"string\" ? stringToIcon(icon, true) : icon;\n\t\tif (!iconObj) {\n\t\t\treject(icon);\n\t\t\treturn;\n\t\t}\n\t\tloadIcons$1([iconObj || icon], (loaded) => {\n\t\t\tif (loaded.length && iconObj) {\n\t\t\t\tconst data = getIconData(iconObj);\n\t\t\t\tif (data) {\n\t\t\t\t\tfulfill({\n\t\t\t\t\t\t...defaultIconProps,\n\t\t\t\t\t\t...data\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\treject(icon);\n\t\t});\n\t});\n};\n\n/**\n * Test icon string\n */\nfunction testIconObject(value) {\n    try {\n        const obj = typeof value === 'string' ? JSON.parse(value) : value;\n        if (typeof obj.body === 'string') {\n            return {\n                ...obj,\n            };\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    }\n    catch (err) {\n        //\n    }\n}\n\n/**\n * Parse icon value, load if needed\n */\nfunction parseIconValue(value, onload) {\n    if (typeof value === 'object') {\n        const data = testIconObject(value);\n        return {\n            data,\n            value,\n        };\n    }\n    if (typeof value !== 'string') {\n        // Invalid value\n        return {\n            value,\n        };\n    }\n    // Check for JSON\n    if (value.includes('{')) {\n        const data = testIconObject(value);\n        if (data) {\n            return {\n                data,\n                value,\n            };\n        }\n    }\n    // Parse icon name\n    const name = stringToIcon(value, true, true);\n    if (!name) {\n        return {\n            value,\n        };\n    }\n    // Valid icon name: check if data is available\n    const data = getIconData(name);\n    // Icon data exists or icon has no prefix. Do not load icon from API if icon has no prefix\n    if (data !== undefined || !name.prefix) {\n        return {\n            value,\n            name,\n            data, // could be 'null' -> icon is missing\n        };\n    }\n    // Load icon\n    const loading = loadIcons$1([name], () => onload(value, name, getIconData(name)));\n    return {\n        value,\n        name,\n        loading,\n    };\n}\n\n// Check for Safari\nlet isBuggedSafari = false;\ntry {\n    isBuggedSafari = navigator.vendor.indexOf('Apple') === 0;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n}\ncatch (err) {\n    //\n}\n/**\n * Get render mode\n */\nfunction getRenderMode(body, mode) {\n    switch (mode) {\n        // Force mode\n        case 'svg':\n        case 'bg':\n        case 'mask':\n            return mode;\n    }\n    // Check for animation, use 'style' for animated icons, unless browser is Safari\n    // (only <a>, which should be ignored or animations start with '<a')\n    if (mode !== 'style' &&\n        (isBuggedSafari || body.indexOf('<a') === -1)) {\n        // Render <svg>\n        return 'svg';\n    }\n    // Use background or mask\n    return body.indexOf('currentColor') === -1 ? 'bg' : 'mask';\n}\n\n/**\n* Regular expressions for calculating dimensions\n*/\nconst unitsSplit = /(-?[0-9.]*[0-9]+[0-9.]*)/g;\nconst unitsTest = /^-?[0-9.]*[0-9]+[0-9.]*$/g;\nfunction calculateSize$1(size, ratio, precision) {\n\tif (ratio === 1) return size;\n\tprecision = precision || 100;\n\tif (typeof size === \"number\") return Math.ceil(size * ratio * precision) / precision;\n\tif (typeof size !== \"string\") return size;\n\tconst oldParts = size.split(unitsSplit);\n\tif (oldParts === null || !oldParts.length) return size;\n\tconst newParts = [];\n\tlet code = oldParts.shift();\n\tlet isNumber = unitsTest.test(code);\n\twhile (true) {\n\t\tif (isNumber) {\n\t\t\tconst num = parseFloat(code);\n\t\t\tif (isNaN(num)) newParts.push(code);\n\t\t\telse newParts.push(Math.ceil(num * ratio * precision) / precision);\n\t\t} else newParts.push(code);\n\t\tcode = oldParts.shift();\n\t\tif (code === void 0) return newParts.join(\"\");\n\t\tisNumber = !isNumber;\n\t}\n}\n\nfunction splitSVGDefs(content, tag = \"defs\") {\n\tlet defs = \"\";\n\tconst index = content.indexOf(\"<\" + tag);\n\twhile (index >= 0) {\n\t\tconst start = content.indexOf(\">\", index);\n\t\tconst end = content.indexOf(\"</\" + tag);\n\t\tif (start === -1 || end === -1) break;\n\t\tconst endEnd = content.indexOf(\">\", end);\n\t\tif (endEnd === -1) break;\n\t\tdefs += content.slice(start + 1, end).trim();\n\t\tcontent = content.slice(0, index).trim() + content.slice(endEnd + 1);\n\t}\n\treturn {\n\t\tdefs,\n\t\tcontent\n\t};\n}\n/**\n* Merge defs and content\n*/\nfunction mergeDefsAndContent(defs, content) {\n\treturn defs ? \"<defs>\" + defs + \"</defs>\" + content : content;\n}\n/**\n* Wrap SVG content, without wrapping definitions\n*/\nfunction wrapSVGContent(body, start, end) {\n\tconst split = splitSVGDefs(body);\n\treturn mergeDefsAndContent(split.defs, start + split.content + end);\n}\n\n/**\n* Check if value should be unset. Allows multiple keywords\n*/\nconst isUnsetKeyword = (value) => value === \"unset\" || value === \"undefined\" || value === \"none\";\n/**\n* Get SVG attributes and content from icon + customisations\n*\n* Does not generate style to make it compatible with frameworks that use objects for style, such as React.\n* Instead, it generates 'inline' value. If true, rendering engine should add verticalAlign: -0.125em to icon.\n*\n* Customisations should be normalised by platform specific parser.\n* Result should be converted to <svg> by platform specific parser.\n* Use replaceIDs to generate unique IDs for body.\n*/\nfunction iconToSVG(icon, customisations) {\n\tconst fullIcon = {\n\t\t...defaultIconProps,\n\t\t...icon\n\t};\n\tconst fullCustomisations = {\n\t\t...defaultIconCustomisations,\n\t\t...customisations\n\t};\n\tconst box = {\n\t\tleft: fullIcon.left,\n\t\ttop: fullIcon.top,\n\t\twidth: fullIcon.width,\n\t\theight: fullIcon.height\n\t};\n\tlet body = fullIcon.body;\n\t[fullIcon, fullCustomisations].forEach((props) => {\n\t\tconst transformations = [];\n\t\tconst hFlip = props.hFlip;\n\t\tconst vFlip = props.vFlip;\n\t\tlet rotation = props.rotate;\n\t\tif (hFlip) if (vFlip) rotation += 2;\n\t\telse {\n\t\t\ttransformations.push(\"translate(\" + (box.width + box.left).toString() + \" \" + (0 - box.top).toString() + \")\");\n\t\t\ttransformations.push(\"scale(-1 1)\");\n\t\t\tbox.top = box.left = 0;\n\t\t}\n\t\telse if (vFlip) {\n\t\t\ttransformations.push(\"translate(\" + (0 - box.left).toString() + \" \" + (box.height + box.top).toString() + \")\");\n\t\t\ttransformations.push(\"scale(1 -1)\");\n\t\t\tbox.top = box.left = 0;\n\t\t}\n\t\tlet tempValue;\n\t\tif (rotation < 0) rotation -= Math.floor(rotation / 4) * 4;\n\t\trotation = rotation % 4;\n\t\tswitch (rotation) {\n\t\t\tcase 1:\n\t\t\t\ttempValue = box.height / 2 + box.top;\n\t\t\t\ttransformations.unshift(\"rotate(90 \" + tempValue.toString() + \" \" + tempValue.toString() + \")\");\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\ttransformations.unshift(\"rotate(180 \" + (box.width / 2 + box.left).toString() + \" \" + (box.height / 2 + box.top).toString() + \")\");\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\ttempValue = box.width / 2 + box.left;\n\t\t\t\ttransformations.unshift(\"rotate(-90 \" + tempValue.toString() + \" \" + tempValue.toString() + \")\");\n\t\t\t\tbreak;\n\t\t}\n\t\tif (rotation % 2 === 1) {\n\t\t\tif (box.left !== box.top) {\n\t\t\t\ttempValue = box.left;\n\t\t\t\tbox.left = box.top;\n\t\t\t\tbox.top = tempValue;\n\t\t\t}\n\t\t\tif (box.width !== box.height) {\n\t\t\t\ttempValue = box.width;\n\t\t\t\tbox.width = box.height;\n\t\t\t\tbox.height = tempValue;\n\t\t\t}\n\t\t}\n\t\tif (transformations.length) body = wrapSVGContent(body, \"<g transform=\\\"\" + transformations.join(\" \") + \"\\\">\", \"</g>\");\n\t});\n\tconst customisationsWidth = fullCustomisations.width;\n\tconst customisationsHeight = fullCustomisations.height;\n\tconst boxWidth = box.width;\n\tconst boxHeight = box.height;\n\tlet width;\n\tlet height;\n\tif (customisationsWidth === null) {\n\t\theight = customisationsHeight === null ? \"1em\" : customisationsHeight === \"auto\" ? boxHeight : customisationsHeight;\n\t\twidth = calculateSize$1(height, boxWidth / boxHeight);\n\t} else {\n\t\twidth = customisationsWidth === \"auto\" ? boxWidth : customisationsWidth;\n\t\theight = customisationsHeight === null ? calculateSize$1(width, boxHeight / boxWidth) : customisationsHeight === \"auto\" ? boxHeight : customisationsHeight;\n\t}\n\tconst attributes = {};\n\tconst setAttr = (prop, value) => {\n\t\tif (!isUnsetKeyword(value)) attributes[prop] = value.toString();\n\t};\n\tsetAttr(\"width\", width);\n\tsetAttr(\"height\", height);\n\tconst viewBox = [\n\t\tbox.left,\n\t\tbox.top,\n\t\tboxWidth,\n\t\tboxHeight\n\t];\n\tattributes.viewBox = viewBox.join(\" \");\n\treturn {\n\t\tattributes,\n\t\tviewBox,\n\t\tbody\n\t};\n}\n\n/**\n* Generate <svg>\n*/\nfunction iconToHTML$1(body, attributes) {\n\tlet renderAttribsHTML = body.indexOf(\"xlink:\") === -1 ? \"\" : \" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"\";\n\tfor (const attr in attributes) renderAttribsHTML += \" \" + attr + \"=\\\"\" + attributes[attr] + \"\\\"\";\n\treturn \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\"\" + renderAttribsHTML + \">\" + body + \"</svg>\";\n}\n\n/**\n* Encode SVG for use in url()\n*\n* Short alternative to encodeURIComponent() that encodes only stuff used in SVG, generating\n* smaller code.\n*/\nfunction encodeSVGforURL(svg) {\n\treturn svg.replace(/\"/g, \"'\").replace(/%/g, \"%25\").replace(/#/g, \"%23\").replace(/</g, \"%3C\").replace(/>/g, \"%3E\").replace(/\\s+/g, \" \");\n}\n/**\n* Generate data: URL from SVG\n*/\nfunction svgToData(svg) {\n\treturn \"data:image/svg+xml,\" + encodeSVGforURL(svg);\n}\n/**\n* Generate url() from SVG\n*/\nfunction svgToURL$1(svg) {\n\treturn \"url(\\\"\" + svgToData(svg) + \"\\\")\";\n}\n\nconst detectFetch = () => {\n\tlet callback;\n\ttry {\n\t\tcallback = fetch;\n\t\tif (typeof callback === \"function\") return callback;\n\t} catch (err) {}\n};\n/**\n* Fetch function\n*/\nlet fetchModule = detectFetch();\n/**\n* Set custom fetch() function\n*/\nfunction setFetch(fetch$1) {\n\tfetchModule = fetch$1;\n}\n/**\n* Get fetch() function. Used by Icon Finder Core\n*/\nfunction getFetch() {\n\treturn fetchModule;\n}\n/**\n* Calculate maximum icons list length for prefix\n*/\nfunction calculateMaxLength(provider, prefix) {\n\tconst config = getAPIConfig(provider);\n\tif (!config) return 0;\n\tlet result;\n\tif (!config.maxURL) result = 0;\n\telse {\n\t\tlet maxHostLength = 0;\n\t\tconfig.resources.forEach((item) => {\n\t\t\tconst host = item;\n\t\t\tmaxHostLength = Math.max(maxHostLength, host.length);\n\t\t});\n\t\tconst url = prefix + \".json?icons=\";\n\t\tresult = config.maxURL - maxHostLength - config.path.length - url.length;\n\t}\n\treturn result;\n}\n/**\n* Should query be aborted, based on last HTTP status\n*/\nfunction shouldAbort(status) {\n\treturn status === 404;\n}\n/**\n* Prepare params\n*/\nconst prepare = (provider, prefix, icons) => {\n\tconst results = [];\n\tconst maxLength = calculateMaxLength(provider, prefix);\n\tconst type = \"icons\";\n\tlet item = {\n\t\ttype,\n\t\tprovider,\n\t\tprefix,\n\t\ticons: []\n\t};\n\tlet length = 0;\n\ticons.forEach((name, index) => {\n\t\tlength += name.length + 1;\n\t\tif (length >= maxLength && index > 0) {\n\t\t\tresults.push(item);\n\t\t\titem = {\n\t\t\t\ttype,\n\t\t\t\tprovider,\n\t\t\t\tprefix,\n\t\t\t\ticons: []\n\t\t\t};\n\t\t\tlength = name.length;\n\t\t}\n\t\titem.icons.push(name);\n\t});\n\tresults.push(item);\n\treturn results;\n};\n/**\n* Get path\n*/\nfunction getPath(provider) {\n\tif (typeof provider === \"string\") {\n\t\tconst config = getAPIConfig(provider);\n\t\tif (config) return config.path;\n\t}\n\treturn \"/\";\n}\n/**\n* Load icons\n*/\nconst send = (host, params, callback) => {\n\tif (!fetchModule) {\n\t\tcallback(\"abort\", 424);\n\t\treturn;\n\t}\n\tlet path = getPath(params.provider);\n\tswitch (params.type) {\n\t\tcase \"icons\": {\n\t\t\tconst prefix = params.prefix;\n\t\t\tconst iconsList = params.icons.join(\",\");\n\t\t\tconst urlParams = new URLSearchParams({ icons: iconsList });\n\t\t\tpath += prefix + \".json?\" + urlParams.toString();\n\t\t\tbreak;\n\t\t}\n\t\tcase \"custom\": {\n\t\t\tconst uri = params.uri;\n\t\t\tpath += uri.slice(0, 1) === \"/\" ? uri.slice(1) : uri;\n\t\t\tbreak;\n\t\t}\n\t\tdefault:\n\t\t\tcallback(\"abort\", 400);\n\t\t\treturn;\n\t}\n\tlet defaultError = 503;\n\tfetchModule(host + path).then((response) => {\n\t\tconst status = response.status;\n\t\tif (status !== 200) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tcallback(shouldAbort(status) ? \"abort\" : \"next\", status);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tdefaultError = 501;\n\t\treturn response.json();\n\t}).then((data) => {\n\t\tif (typeof data !== \"object\" || data === null) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (data === 404) callback(\"abort\", data);\n\t\t\t\telse callback(\"next\", defaultError);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tcallback(\"success\", data);\n\t\t});\n\t}).catch(() => {\n\t\tcallback(\"next\", defaultError);\n\t});\n};\n/**\n* Export module\n*/\nconst fetchAPIModule = {\n\tprepare,\n\tsend\n};\n\n/**\n* Set custom loader for multiple icons\n*/\nfunction setCustomIconsLoader$1(loader, prefix, provider) {\n\tgetStorage(provider || \"\", prefix).loadIcons = loader;\n}\n/**\n* Set custom loader for one icon\n*/\nfunction setCustomIconLoader$1(loader, prefix, provider) {\n\tgetStorage(provider || \"\", prefix).loadIcon = loader;\n}\n\n/**\n * Attribute to add\n */\nconst nodeAttr = 'data-style';\n/**\n * Custom style to add to each node\n */\nlet customStyle = '';\n/**\n * Set custom style to add to all components\n *\n * Affects only components rendered after function call\n */\nfunction appendCustomStyle(style) {\n    customStyle = style;\n}\n/**\n * Add/update style node\n */\nfunction updateStyle(parent, inline) {\n    // Get node, create if needed\n    let styleNode = Array.from(parent.childNodes).find((node) => node.hasAttribute &&\n        node.hasAttribute(nodeAttr));\n    if (!styleNode) {\n        styleNode = document.createElement('style');\n        styleNode.setAttribute(nodeAttr, nodeAttr);\n        parent.appendChild(styleNode);\n    }\n    // Update content\n    styleNode.textContent =\n        ':host{display:inline-block;vertical-align:' +\n            (inline ? '-0.125em' : '0') +\n            '}span,svg{display:block;margin:auto}' +\n            customStyle;\n}\n\n// Core\n/**\n * Get functions and initialise stuff\n */\nfunction exportFunctions() {\n    /**\n     * Initialise stuff\n     */\n    // Set API module\n    setAPIModule('', fetchAPIModule);\n    // Allow simple icon names\n    allowSimpleNames(true);\n    let _window;\n    try {\n        _window = window;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    }\n    catch (err) {\n        //\n    }\n    if (_window) {\n        // Load icons from global \"IconifyPreload\"\n        if (_window.IconifyPreload !== void 0) {\n            const preload = _window.IconifyPreload;\n            const err = 'Invalid IconifyPreload syntax.';\n            if (typeof preload === 'object' && preload !== null) {\n                (preload instanceof Array ? preload : [preload]).forEach((item) => {\n                    try {\n                        if (\n                        // Check if item is an object and not null/array\n                        typeof item !== 'object' ||\n                            item === null ||\n                            item instanceof Array ||\n                            // Check for 'icons' and 'prefix'\n                            typeof item.icons !== 'object' ||\n                            typeof item.prefix !== 'string' ||\n                            // Add icon set\n                            !addCollection$1(item)) {\n                            console.error(err);\n                        }\n                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    }\n                    catch (e) {\n                        console.error(err);\n                    }\n                });\n            }\n        }\n        // Set API from global \"IconifyProviders\"\n        if (_window.IconifyProviders !== void 0) {\n            const providers = _window.IconifyProviders;\n            if (typeof providers === 'object' && providers !== null) {\n                for (const key in providers) {\n                    const err = 'IconifyProviders[' + key + '] is invalid.';\n                    try {\n                        const value = providers[key];\n                        if (typeof value !== 'object' ||\n                            !value ||\n                            value.resources === void 0) {\n                            continue;\n                        }\n                        if (!addAPIProvider$1(key, value)) {\n                            console.error(err);\n                        }\n                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    }\n                    catch (e) {\n                        console.error(err);\n                    }\n                }\n            }\n        }\n    }\n    const _api = {\n        getAPIConfig,\n        setAPIModule,\n        sendAPIQuery,\n        setFetch,\n        getFetch,\n        listAPIProviders,\n    };\n    return {\n        iconLoaded: iconLoaded$1,\n        getIcon: getIcon$1,\n        listIcons: listIcons$1,\n        addIcon: addIcon$1,\n        addCollection: addCollection$1,\n        calculateSize: calculateSize$1,\n        buildIcon: iconToSVG,\n        iconToHTML: iconToHTML$1,\n        svgToURL: svgToURL$1,\n        loadIcons: loadIcons$1,\n        loadIcon: loadIcon$1,\n        addAPIProvider: addAPIProvider$1,\n        setCustomIconLoader: setCustomIconLoader$1,\n        setCustomIconsLoader: setCustomIconsLoader$1,\n        appendCustomStyle,\n        _api,\n    };\n}\n\n// List of properties to apply\nconst monotoneProps = {\n    'background-color': 'currentColor',\n};\nconst coloredProps = {\n    'background-color': 'transparent',\n};\n// Dynamically add common props to variables above\nconst propsToAdd = {\n    image: 'var(--svg)',\n    repeat: 'no-repeat',\n    size: '100% 100%',\n};\nconst propsToAddTo = {\n    '-webkit-mask': monotoneProps,\n    'mask': monotoneProps,\n    'background': coloredProps,\n};\nfor (const prefix in propsToAddTo) {\n    const list = propsToAddTo[prefix];\n    for (const prop in propsToAdd) {\n        list[prefix + '-' + prop] = propsToAdd[prop];\n    }\n}\n/**\n * Fix size: add 'px' to numbers\n */\nfunction fixSize(value) {\n    return value ? value + (value.match(/^[-0-9.]+$/) ? 'px' : '') : 'inherit';\n}\n/**\n * Render node as <span>\n */\nfunction renderSPAN(data, icon, useMask) {\n    const node = document.createElement('span');\n    // Body\n    let body = data.body;\n    if (body.indexOf('<a') !== -1) {\n        // Animated SVG: add something to fix timing bug\n        body += '<!-- ' + Date.now() + ' -->';\n    }\n    // Generate SVG as URL\n    const renderAttribs = data.attributes;\n    const html = iconToHTML$1(body, {\n        ...renderAttribs,\n        width: icon.width + '',\n        height: icon.height + '',\n    });\n    const url = svgToURL$1(html);\n    // Generate style\n    const svgStyle = node.style;\n    const styles = {\n        '--svg': url,\n        'width': fixSize(renderAttribs.width),\n        'height': fixSize(renderAttribs.height),\n        ...(useMask ? monotoneProps : coloredProps),\n    };\n    // Apply style\n    for (const prop in styles) {\n        svgStyle.setProperty(prop, styles[prop]);\n    }\n    return node;\n}\n\nlet policy;\n/**\n* Attempt to create policy\n*/\nfunction createPolicy() {\n\ttry {\n\t\tpolicy = window.trustedTypes.createPolicy(\"iconify\", { createHTML: (s) => s });\n\t} catch (err) {\n\t\tpolicy = null;\n\t}\n}\n/**\n* Clean up value for innerHTML assignment\n*\n* This code doesn't actually clean up anything.\n* It is intended be used with Iconify icon data, which has already been validated\n*/\nfunction cleanUpInnerHTML(html) {\n\tif (policy === void 0) createPolicy();\n\treturn policy ? policy.createHTML(html) : html;\n}\n\n/**\n * Render node as <svg>\n */\nfunction renderSVG(data) {\n    const node = document.createElement('span');\n    // Add style if needed\n    const attr = data.attributes;\n    let style = '';\n    if (!attr.width) {\n        style = 'width: inherit;';\n    }\n    if (!attr.height) {\n        style += 'height: inherit;';\n    }\n    if (style) {\n        attr.style = style;\n    }\n    // Generate SVG\n    const html = iconToHTML$1(data.body, attr);\n    node.innerHTML = cleanUpInnerHTML(html);\n    return node.firstChild;\n}\n\n/**\n * Find icon node\n */\nfunction findIconElement(parent) {\n    return Array.from(parent.childNodes).find((node) => {\n        const tag = node.tagName &&\n            node.tagName.toUpperCase();\n        return tag === 'SPAN' || tag === 'SVG';\n    });\n}\n/**\n * Render icon\n */\nfunction renderIcon(parent, state) {\n    const iconData = state.icon.data;\n    const customisations = state.customisations;\n    // Render icon\n    const renderData = iconToSVG(iconData, customisations);\n    if (customisations.preserveAspectRatio) {\n        renderData.attributes['preserveAspectRatio'] =\n            customisations.preserveAspectRatio;\n    }\n    const mode = state.renderedMode;\n    let node;\n    switch (mode) {\n        case 'svg':\n            node = renderSVG(renderData);\n            break;\n        default:\n            node = renderSPAN(renderData, {\n                ...defaultIconProps,\n                ...iconData,\n            }, mode === 'mask');\n    }\n    // Set element\n    const oldNode = findIconElement(parent);\n    if (oldNode) {\n        // Replace old element\n        if (node.tagName === 'SPAN' && oldNode.tagName === node.tagName) {\n            // Swap style instead of whole node\n            oldNode.setAttribute('style', node.getAttribute('style'));\n        }\n        else {\n            parent.replaceChild(node, oldNode);\n        }\n    }\n    else {\n        // Add new element\n        parent.appendChild(node);\n    }\n}\n\n/**\n * Set state to PendingState\n */\nfunction setPendingState(icon, inline, lastState) {\n    const lastRender = lastState &&\n        (lastState.rendered\n            ? lastState\n            : lastState.lastRender);\n    return {\n        rendered: false,\n        inline,\n        icon,\n        lastRender,\n    };\n}\n\n/**\n * Register 'iconify-icon' component, if it does not exist\n */\nfunction defineIconifyIcon(name = 'iconify-icon') {\n    // Check for custom elements registry and HTMLElement\n    let customElements;\n    let ParentClass;\n    try {\n        customElements = window.customElements;\n        ParentClass = window.HTMLElement;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    }\n    catch (err) {\n        return;\n    }\n    // Make sure registry and HTMLElement exist\n    if (!customElements || !ParentClass) {\n        return;\n    }\n    // Check for duplicate\n    const ConflictingClass = customElements.get(name);\n    if (ConflictingClass) {\n        return ConflictingClass;\n    }\n    // All attributes\n    const attributes = [\n        // Icon\n        'icon',\n        // Mode\n        'mode',\n        'inline',\n        'noobserver',\n        // Customisations\n        'width',\n        'height',\n        'rotate',\n        'flip',\n    ];\n    /**\n     * Component class\n     */\n    const IconifyIcon = class extends ParentClass {\n        // Root\n        _shadowRoot;\n        // Initialised\n        _initialised = false;\n        // Icon state\n        _state;\n        // Attributes check queued\n        _checkQueued = false;\n        // Connected\n        _connected = false;\n        // Observer\n        _observer = null;\n        _visible = true;\n        /**\n         * Constructor\n         */\n        constructor() {\n            super();\n            // Attach shadow DOM\n            const root = (this._shadowRoot = this.attachShadow({\n                mode: 'open',\n            }));\n            // Add style\n            const inline = this.hasAttribute('inline');\n            updateStyle(root, inline);\n            // Create empty state\n            this._state = setPendingState({\n                value: '',\n            }, inline);\n            // Queue icon render\n            this._queueCheck();\n        }\n        /**\n         * Connected to DOM\n         */\n        connectedCallback() {\n            this._connected = true;\n            this.startObserver();\n        }\n        /**\n         * Disconnected from DOM\n         */\n        disconnectedCallback() {\n            this._connected = false;\n            this.stopObserver();\n        }\n        /**\n         * Observed attributes\n         */\n        static get observedAttributes() {\n            return attributes.slice(0);\n        }\n        /**\n         * Observed properties that are different from attributes\n         *\n         * Experimental! Need to test with various frameworks that support it\n         */\n        /*\n        static get properties() {\n            return {\n                inline: {\n                    type: Boolean,\n                    reflect: true,\n                },\n                // Not listing other attributes because they are strings or combination\n                // of string and another type. Cannot have multiple types\n            };\n        }\n        */\n        /**\n         * Attribute has changed\n         */\n        attributeChangedCallback(name) {\n            switch (name) {\n                case 'inline': {\n                    // Update immediately: not affected by other attributes\n                    const newInline = this.hasAttribute('inline');\n                    const state = this._state;\n                    if (newInline !== state.inline) {\n                        // Update style if inline mode changed\n                        state.inline = newInline;\n                        updateStyle(this._shadowRoot, newInline);\n                    }\n                    break;\n                }\n                case 'noobserver': {\n                    const value = this.hasAttribute('noobserver');\n                    if (value) {\n                        this.startObserver();\n                    }\n                    else {\n                        this.stopObserver();\n                    }\n                    break;\n                }\n                default:\n                    // Queue check for other attributes\n                    this._queueCheck();\n            }\n        }\n        /**\n         * Get/set icon\n         */\n        get icon() {\n            const value = this.getAttribute('icon');\n            if (value && value.slice(0, 1) === '{') {\n                try {\n                    return JSON.parse(value);\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                }\n                catch (err) {\n                    //\n                }\n            }\n            return value;\n        }\n        set icon(value) {\n            if (typeof value === 'object') {\n                value = JSON.stringify(value);\n            }\n            this.setAttribute('icon', value);\n        }\n        /**\n         * Get/set inline\n         */\n        get inline() {\n            return this.hasAttribute('inline');\n        }\n        set inline(value) {\n            if (value) {\n                this.setAttribute('inline', 'true');\n            }\n            else {\n                this.removeAttribute('inline');\n            }\n        }\n        /**\n         * Get/set observer\n         */\n        get observer() {\n            return this.hasAttribute('observer');\n        }\n        set observer(value) {\n            if (value) {\n                this.setAttribute('observer', 'true');\n            }\n            else {\n                this.removeAttribute('observer');\n            }\n        }\n        /**\n         * Restart animation\n         */\n        restartAnimation() {\n            const state = this._state;\n            if (state.rendered) {\n                const root = this._shadowRoot;\n                if (state.renderedMode === 'svg') {\n                    // Update root node\n                    try {\n                        root.lastChild.setCurrentTime(0);\n                        return;\n                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                    }\n                    catch (err) {\n                        // Failed: setCurrentTime() is not supported\n                    }\n                }\n                renderIcon(root, state);\n            }\n        }\n        /**\n         * Get status\n         */\n        get status() {\n            const state = this._state;\n            return state.rendered\n                ? 'rendered'\n                : state.icon.data === null\n                    ? 'failed'\n                    : 'loading';\n        }\n        /**\n         * Queue attributes re-check\n         */\n        _queueCheck() {\n            if (!this._checkQueued) {\n                this._checkQueued = true;\n                setTimeout(() => {\n                    this._check();\n                });\n            }\n        }\n        /**\n         * Check for changes\n         */\n        _check() {\n            if (!this._checkQueued) {\n                return;\n            }\n            this._checkQueued = false;\n            const state = this._state;\n            // Get icon\n            const newIcon = this.getAttribute('icon');\n            if (newIcon !== state.icon.value) {\n                this._iconChanged(newIcon);\n                return;\n            }\n            // Ignore other attributes if icon is not rendered\n            if (!state.rendered || !this._visible) {\n                return;\n            }\n            // Check for mode and attribute changes\n            const mode = this.getAttribute('mode');\n            const customisations = getCustomisations(this);\n            if (state.attrMode !== mode ||\n                haveCustomisationsChanged(state.customisations, customisations) ||\n                !findIconElement(this._shadowRoot)) {\n                this._renderIcon(state.icon, customisations, mode);\n            }\n        }\n        /**\n         * Icon value has changed\n         */\n        _iconChanged(newValue) {\n            const icon = parseIconValue(newValue, (value, name, data) => {\n                // Asynchronous callback: re-check values to make sure stuff wasn't changed\n                const state = this._state;\n                if (state.rendered || this.getAttribute('icon') !== value) {\n                    // Icon data is already available or icon attribute was changed\n                    return;\n                }\n                // Change icon\n                const icon = {\n                    value,\n                    name,\n                    data,\n                };\n                if (icon.data) {\n                    // Render icon\n                    this._gotIconData(icon);\n                }\n                else {\n                    // Nothing to render: update icon in state\n                    state.icon = icon;\n                }\n            });\n            if (icon.data) {\n                // Icon is ready to render\n                this._gotIconData(icon);\n            }\n            else {\n                // Pending icon\n                this._state = setPendingState(icon, this._state.inline, this._state);\n            }\n        }\n        /**\n         * Force render icon on state change\n         */\n        _forceRender() {\n            if (!this._visible) {\n                // Remove icon\n                const node = findIconElement(this._shadowRoot);\n                if (node) {\n                    this._shadowRoot.removeChild(node);\n                }\n                return;\n            }\n            // Re-render icon\n            this._queueCheck();\n        }\n        /**\n         * Got new icon data, icon is ready to (re)render\n         */\n        _gotIconData(icon) {\n            this._checkQueued = false;\n            this._renderIcon(icon, getCustomisations(this), this.getAttribute('mode'));\n        }\n        /**\n         * Re-render based on icon data\n         */\n        _renderIcon(icon, customisations, attrMode) {\n            // Get mode\n            const renderedMode = getRenderMode(icon.data.body, attrMode);\n            // Inline was not changed\n            const inline = this._state.inline;\n            // Set state and render\n            renderIcon(this._shadowRoot, (this._state = {\n                rendered: true,\n                icon,\n                inline,\n                customisations,\n                attrMode,\n                renderedMode,\n            }));\n        }\n        /**\n         * Start observer\n         */\n        startObserver() {\n            if (!this._observer && !this.hasAttribute('noobserver')) {\n                try {\n                    this._observer = new IntersectionObserver((entries) => {\n                        const intersecting = entries.some((entry) => entry.isIntersecting);\n                        if (intersecting !== this._visible) {\n                            this._visible = intersecting;\n                            this._forceRender();\n                        }\n                    });\n                    this._observer.observe(this);\n                    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                }\n                catch (err) {\n                    // Something went wrong, possibly observer is not supported\n                    if (this._observer) {\n                        try {\n                            this._observer.disconnect();\n                            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                        }\n                        catch (err) {\n                            //\n                        }\n                        this._observer = null;\n                    }\n                }\n            }\n        }\n        /**\n         * Stop observer\n         */\n        stopObserver() {\n            if (this._observer) {\n                this._observer.disconnect();\n                this._observer = null;\n                this._visible = true;\n                if (this._connected) {\n                    // Render icon\n                    this._forceRender();\n                }\n            }\n        }\n    };\n    // Add getters and setters\n    attributes.forEach((attr) => {\n        if (!(attr in IconifyIcon.prototype)) {\n            Object.defineProperty(IconifyIcon.prototype, attr, {\n                get: function () {\n                    return this.getAttribute(attr);\n                },\n                set: function (value) {\n                    if (value !== null) {\n                        this.setAttribute(attr, value);\n                    }\n                    else {\n                        this.removeAttribute(attr);\n                    }\n                },\n            });\n        }\n    });\n    // Add exported functions: both as static and instance methods\n    const functions = exportFunctions();\n    for (const key in functions) {\n        IconifyIcon[key] = IconifyIcon.prototype[key] = functions[key];\n    }\n    // Define new component\n    customElements.define(name, IconifyIcon);\n    return IconifyIcon;\n}\n\n/**\n * Create exported data: either component instance or functions\n */\nconst IconifyIconComponent = defineIconifyIcon() || exportFunctions();\n/**\n * Export functions\n */\nconst { iconLoaded, getIcon, listIcons, addIcon, addCollection, calculateSize, buildIcon, iconToHTML, svgToURL, loadIcons, loadIcon, setCustomIconLoader, setCustomIconsLoader, addAPIProvider, _api, } = IconifyIconComponent;\n\nexport { IconifyIconComponent, _api, addAPIProvider, addCollection, addIcon, appendCustomStyle, buildIcon, calculateSize, getIcon, iconLoaded, iconToHTML, listIcons, loadIcon, loadIcons, setCustomIconLoader, setCustomIconsLoader, svgToURL };\n","<!--\n@file src/components/system/ToastManager.svelte\n@component\n**Enterprise-Ready Toast Notification Manager**\n\nA flexible, accessible toast notification system built on Skeleton v4.\nSupports multiple toast types with gradient styling, progress indicators,\noptional actions, and smooth animations.\n\n@example\n<ToastManager position=\"bottom-right\" />\n\n@features\n- Type-based gradient styling (success, warning, error, info)\n- Auto-dismiss with optional progress bar\n- Optional action buttons in toasts\n- Configurable positioning (top-right, bottom-right, etc.)\n- Accessible with proper ARIA attributes\n- Smooth enter/exit animations\n- Dark mode support\n-->\n\n<script lang=\"ts\">\n\timport { Toast } from '@skeletonlabs/skeleton-svelte';\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { fly, fade } from 'svelte/transition';\n\n\tinterface Props {\n\t\t/** Position of the toast container */\n\t\tposition?: 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left' | 'top-center' | 'bottom-center';\n\t\t/** Show progress bar for auto-dismiss */\n\t\tshowProgress?: boolean;\n\t}\n\n\tconst { position = 'top-right', showProgress = true }: Props = $props();\n\n\t// Position classes mapping - fixed inset ensures proper viewport positioning\n\tconst positionClasses: Record<string, string> = {\n\t\t'top-right': 'top-4 right-4 inset-auto items-end',\n\t\t'top-left': 'top-4 left-4 inset-auto items-start',\n\t\t'bottom-right': 'bottom-4 right-4 inset-auto items-end justify-end',\n\t\t'bottom-left': 'bottom-4 left-4 inset-auto items-start justify-end',\n\t\t'top-center': 'top-4 left-1/2 -translate-x-1/2 inset-auto items-center',\n\t\t'bottom-center': 'bottom-4 left-1/2 -translate-x-1/2 inset-auto items-center justify-end'\n\t};\n\n\t// Toast type configuration\n\tconst toastConfig = {\n\t\tsuccess: {\n\t\t\tgradient: 'gradient-primary',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:check-circle',\n\t\t\tdefaultTitle: 'Success'\n\t\t},\n\t\twarning: {\n\t\t\tgradient: 'gradient-warning',\n\t\t\ttextColor: 'text-black',\n\t\t\ticon: 'mdi:alert',\n\t\t\tdefaultTitle: 'Warning'\n\t\t},\n\t\terror: {\n\t\t\tgradient: 'gradient-error',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:alert-circle',\n\t\t\tdefaultTitle: 'Error'\n\t\t},\n\t\tinfo: {\n\t\t\tgradient: 'gradient-tertiary',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:information',\n\t\t\tdefaultTitle: 'Info'\n\t\t}\n\t} as const;\n\n\ttype ToastType = keyof typeof toastConfig;\n\n\t// Get toast styling based on type\n\tfunction getToastClasses(type: string | undefined): string {\n\t\tif (!type || !(type in toastConfig)) {\n\t\t\treturn 'bg-surface-100 dark:bg-surface-800 text-surface-900 dark:text-surface-100 border border-surface-300 dark:border-surface-600';\n\t\t}\n\t\tconst config = toastConfig[type as ToastType];\n\t\treturn `${config.gradient} ${config.textColor}`;\n\t}\n\n\t// Get icon for toast type\n\tfunction getToastIcon(type: string | undefined): string | null {\n\t\tif (!type || !(type in toastConfig)) return null;\n\t\treturn toastConfig[type as ToastType].icon;\n\t}\n\n\t// Get animation direction based on position (reactive)\n\tconst animParams = $derived.by(() => {\n\t\tif (position.includes('right')) return { x: 100, duration: 300 };\n\t\tif (position.includes('left')) return { x: -100, duration: 300 };\n\t\tif (position.includes('top')) return { y: -50, duration: 300 };\n\t\treturn { y: 50, duration: 300 };\n\t});\n</script>\n\n<Toast.Group {toaster} class=\"fixed z-9999 flex {position.includes('bottom') ? 'flex-col-reverse' : 'flex-col'} gap-3 {positionClasses[position]}\">\n\t{#snippet children(toast)}\n\t\t<div in:fly={animParams} out:fade={{ duration: 200 }} class=\"relative\" role=\"alert\" aria-live=\"polite\">\n\t\t\t<Toast {toast} class=\"card min-w-80 max-w-100 shadow-2xl rounded-xl overflow-hidden {getToastClasses(toast.type)}\">\n\t\t\t\t<!-- Toast Message Container (Skeleton v4 anatomy) -->\n\t\t\t\t<Toast.Message class=\"flex flex-col gap-1 p-4 pr-10 relative\">\n\t\t\t\t\t<!-- Header with Icon and Title -->\n\t\t\t\t\t{#if toast.title}\n\t\t\t\t\t\t<Toast.Title class=\"font-bold text-base flex items-center gap-2\">\n\t\t\t\t\t\t\t{#if getToastIcon(toast.type)}\n\t\t\t\t\t\t\t\t<iconify-icon icon={getToastIcon(toast.type)} width=\"22\" class=\"shrink-0\"></iconify-icon>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<span>{toast.title}</span>\n\t\t\t\t\t\t</Toast.Title>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<!-- Description -->\n\t\t\t\t\t<Toast.Description class=\"text-sm opacity-95 leading-relaxed\">\n\t\t\t\t\t\t{toast.description}\n\t\t\t\t\t</Toast.Description>\n\n\t\t\t\t\t<!-- Optional Action Buttons -->\n\t\t\t\t\t{#if toast.action}\n\t\t\t\t\t\t<div class=\"mt-3 flex gap-2\">\n\t\t\t\t\t\t\t<Toast.ActionTrigger\n\t\t\t\t\t\t\t\tclass=\"btn-sm {toast.type === 'warning' ? 'preset-filled-surface-900' : 'preset-filled-surface-50'} text-xs font-medium\"\n\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\ttoast.action?.onClick?.();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{toast.action.label}\n\t\t\t\t\t\t\t</Toast.ActionTrigger>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</Toast.Message>\n\n\t\t\t\t<!-- Close Button -->\n\t\t\t\t<Toast.CloseTrigger\n\t\t\t\t\tclass=\"absolute right-2 top-2 p-1.5 rounded-full opacity-70 hover:opacity-100 hover:bg-black/10 dark:hover:bg-white/10 transition-opacity\"\n\t\t\t\t\taria-label=\"Dismiss notification\"\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"mdi:close\" width=\"18\"></iconify-icon>\n\t\t\t\t</Toast.CloseTrigger>\n\n\t\t\t\t<!-- Progress Bar for Auto-dismiss -->\n\t\t\t\t{#if showProgress && toast.duration && toast.duration > 0}\n\t\t\t\t\t<div class=\"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10\">\n\t\t\t\t\t\t<div class=\"h-full bg-current opacity-50 animate-shrink\" style=\"animation-duration: {toast.duration}ms;\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</Toast>\n\t\t</div>\n\t{/snippet}\n</Toast.Group>\n\n<style>\n\t/* Progress bar shrink animation */\n\t@keyframes shrink {\n\t\tfrom {\n\t\t\twidth: 100%;\n\t\t}\n\t\tto {\n\t\t\twidth: 0%;\n\t\t}\n\t}\n\n\t.animate-shrink {\n\t\tanimation: shrink linear forwards;\n\t}\n</style>\n","/**\n * @file src/utils/widgetValidation.ts\n * @description Widget validation utilities for collections and preferences\n *\n * These utilities work directly with your existing:\n * - systemPreferences for user settings\n * - widgetStore for dynamic widgets\n * - database interface for collections\n *\n * Validation checks:\n * - Widget availability (exists in filesystem)\n * - Widget activation status (active in database)\n * - Collection rendering safety (all required widgets active)\n * - Dependency validation (required widgets available)\n */\n\nimport { logger } from '@shared/utils/logger';\nimport type { Layout, Schema, FieldInstance } from '@cms-types/content';\n\n/**\n * Validate widgets in a collection schema\n * Logs at DEBUG level for validation results\n */\nexport function validateSchemaWidgets(\n\tschema: Schema,\n\tactiveWidgets: string[]\n): {\n\tvalid: boolean;\n\tmissingWidgets: string[];\n\tsuggestions: string[];\n} {\n\tlogger.trace('[WidgetValidation] Validating schema widgets', {\n\t\tschema: schema.name,\n\t\tactiveWidgetsCount: activeWidgets.length\n\t});\n\n\tconst usedWidgets = extractWidgetsFromSchema(schema);\n\tconst missingWidgets = usedWidgets.filter((widget) => !activeWidgets.includes(widget));\n\n\tconst suggestions = missingWidgets.map((widget) => `Activate widget '${widget}' or replace with available alternative`);\n\n\tconst valid = missingWidgets.length === 0;\n\n\tlogger.debug(`[WidgetValidation] Schema \"${schema.name}\" validation result`, {\n\t\tvalid,\n\t\tmissingWidgetsCount: missingWidgets.length,\n\t\tmissingWidgets\n\t});\n\n\treturn {\n\t\tvalid,\n\t\tmissingWidgets,\n\t\tsuggestions\n\t};\n}\n\n// Validate widgets in a dashboard layout\nexport function validateLayoutWidgets(\n\tlayout: Layout,\n\tactiveWidgets: string[]\n): {\n\tvalid: boolean;\n\tinvalidWidgets: string[];\n\tcleanedLayout: Layout;\n} {\n\tconst invalidWidgets: string[] = [];\n\tconst validPreferences = layout.preferences.filter((widget) => {\n\t\tif (!activeWidgets.includes(widget.component)) {\n\t\t\tinvalidWidgets.push(widget.component);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\treturn {\n\t\tvalid: invalidWidgets.length === 0,\n\t\tinvalidWidgets,\n\t\tcleanedLayout: {\n\t\t\t...layout,\n\t\t\tpreferences: validPreferences\n\t\t}\n\t};\n}\n\n// Extract widget names from schema fields\nfunction extractWidgetsFromSchema(schema: Schema): string[] {\n\tconst widgets: string[] = [];\n\n\tfor (const field of schema.fields as FieldInstance[]) {\n\t\tif (field.widget) {\n\t\t\tif (typeof field.widget === 'string') {\n\t\t\t\twidgets.push(field.widget);\n\t\t\t} else if (typeof field.widget === 'object' && 'Name' in field.widget) {\n\t\t\t\twidgets.push(field.widget.Name);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn Array.from(new Set(widgets));\n}\n\n// Get widget dependencies for a collection\nexport function getCollectionWidgetDependencies(schema: Schema): {\n\twidgets: string[];\n\ttotalCount: number;\n} {\n\tconst widgets = extractWidgetsFromSchema(schema);\n\n\treturn {\n\t\twidgets,\n\t\ttotalCount: widgets.length\n\t};\n}\n\n/**\n * Check if a widget can be safely deactivated\n * Logs at WARN level if widget is in use\n */\nexport function canSafelyDeactivateWidget(\n\twidgetName: string,\n\tallSchemas: Schema[],\n\tallLayouts: Layout[]\n): {\n\tcanDeactivate: boolean;\n\tusedInCollections: string[];\n\tusedInLayouts: string[];\n} {\n\tlogger.trace('[WidgetValidation] Checking if widget can be safely deactivated', { widgetName });\n\n\tconst usedInCollections: string[] = [];\n\tconst usedInLayouts: string[] = [];\n\n\t// Check collections\n\tfor (const schema of allSchemas) {\n\t\tconst schemaWidgets = extractWidgetsFromSchema(schema);\n\t\tif (widgetName && schemaWidgets.includes(widgetName)) {\n\t\t\tif (schema.name) {\n\t\t\t\tusedInCollections.push(schema.name);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check layouts\n\tfor (const layout of allLayouts) {\n\t\tconst layoutWidgets = layout.preferences.map((p) => p.component);\n\t\tif (layoutWidgets.includes(widgetName)) {\n\t\t\tusedInLayouts.push(layout.name);\n\t\t}\n\t}\n\n\tconst canDeactivate = usedInCollections.length === 0 && usedInLayouts.length === 0;\n\n\tif (!canDeactivate) {\n\t\tlogger.warn(`[WidgetValidation] Widget \"${widgetName}\" cannot be safely deactivated`, {\n\t\t\tcollectionsCount: usedInCollections.length,\n\t\t\tlayoutsCount: usedInLayouts.length,\n\t\t\tcollections: usedInCollections,\n\t\t\tlayouts: usedInLayouts\n\t\t});\n\t} else {\n\t\tlogger.debug(`[WidgetValidation] Widget \"${widgetName}\" can be safely deactivated`);\n\t}\n\n\treturn {\n\t\tcanDeactivate,\n\t\tusedInCollections,\n\t\tusedInLayouts\n\t};\n}\n\n/**\n * Get affected collections when deactivating a widget\n * Useful for showing warnings to users before deactivation\n *\n * Logs at DEBUG level for troubleshooting\n */\nexport function getAffectedCollections(widgetName: string, schemas: Schema[]): string[] {\n\tlogger.trace('[WidgetValidation] Checking affected collections for widget', { widgetName });\n\n\tconst affected: string[] = [];\n\n\tfor (const schema of schemas) {\n\t\tconst schemaWidgets = extractWidgetsFromSchema(schema);\n\t\tif (widgetName && schemaWidgets.includes(widgetName)) {\n\t\t\tif (schema.name) {\n\t\t\t\taffected.push(schema.name);\n\t\t\t\tlogger.trace('[WidgetValidation] Widget used in collection', {\n\t\t\t\t\twidget: widgetName,\n\t\t\t\t\tcollection: schema.name\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tif (affected.length > 0) {\n\t\tlogger.debug(`[WidgetValidation] Widget \"${widgetName}\" is used in ${affected.length} collection(s)`, {\n\t\t\tcollections: affected\n\t\t});\n\t} else {\n\t\tlogger.debug(`[WidgetValidation] Widget \"${widgetName}\" is not used in any collections`);\n\t}\n\n\treturn affected;\n}\n\n/**\n * Validate that a collection can render properly with current active widgets\n * Returns detailed information about missing/inactive widgets\n *\n * Logs at appropriate levels:\n * - WARN: User-facing issues (inactive widgets blocking rendering)\n * - DEBUG: Validation results for troubleshooting\n * - TRACE: Detailed validation flow\n */\nexport function validateCollectionForRendering(\n\tschema: Schema,\n\tactiveWidgets: string[]\n): {\n\tcanRender: boolean;\n\tmissingWidgets: string[];\n\tfieldsWithIssues: Array<{ fieldName: string; widget: string; issue: string }>;\n} {\n\tlogger.trace('[WidgetValidation] Validating collection for rendering', {\n\t\tcollection: schema.name,\n\t\tactiveWidgetsCount: activeWidgets.length,\n\t\tfieldsCount: schema.fields?.length || 0\n\t});\n\n\tconst usedWidgets = extractWidgetsFromSchema(schema);\n\tconst missingWidgets = usedWidgets.filter((widget) => !activeWidgets.includes(widget));\n\tconst fieldsWithIssues: Array<{ fieldName: string; widget: string; issue: string }> = [];\n\n\t// Check each field for widget issues\n\tfor (const field of (schema.fields || []) as FieldInstance[]) {\n\t\tconst widgetName = typeof field.widget === 'string' ? field.widget : field.widget?.Name;\n\t\tif (widgetName && !activeWidgets.includes(widgetName)) {\n\t\t\tconst fieldName = field.db_fieldName || field.label || 'unknown';\n\t\t\tconst issue = `Widget \"${widgetName}\" is inactive or missing. Content for this field cannot be rendered.`;\n\n\t\t\tfieldsWithIssues.push({\n\t\t\t\tfieldName,\n\t\t\t\twidget: widgetName,\n\t\t\t\tissue\n\t\t\t});\n\n\t\t\t// Log warning for each inactive widget (user-facing issue)\n\t\t\tlogger.warn(`[WidgetValidation] Inactive widget in collection \"${schema.name}\"`, {\n\t\t\t\tfield: fieldName,\n\t\t\t\twidget: field.widget,\n\t\t\t\treason: 'Widget is not in active widgets list'\n\t\t\t});\n\t\t}\n\t}\n\n\tconst canRender = missingWidgets.length === 0;\n\n\t// Log validation result\n\tif (!canRender) {\n\t\tlogger.warn(`[WidgetValidation] Collection \"${schema.name}\" cannot render safely`, {\n\t\t\tmissingWidgets,\n\t\t\taffectedFieldsCount: fieldsWithIssues.length\n\t\t});\n\t} else {\n\t\tlogger.debug(`[WidgetValidation] Collection \"${schema.name}\" validation passed`, {\n\t\t\tusedWidgetsCount: usedWidgets.length\n\t\t});\n\t}\n\n\treturn {\n\t\tcanRender,\n\t\tmissingWidgets,\n\t\tfieldsWithIssues\n\t};\n}\n","<!--\n  @file src/components/system/TreeView.svelte\n  @component **Enhanced TreeView - Svelte 5 Optimized**\n\n  A recursive, accessible tree view component with drag-drop, keyboard navigation,\n  and advanced features.\n\n  @example\n  <TreeView \n    {nodes} \n    selectedId={currentId}\n    allowDragDrop\n    onReorder={handleReorder}\n  />\n\n  ### Features\n  - Full keyboard navigation (Arrow keys, Home, End, Enter, Space)\n  - Drag and drop support with visual feedback\n  - Search/filter functionality\n  - RTL/LTR support\n  - Lazy loading children\n  - Badge indicators\n  - Preloading on hover\n  - Accessibility compliant (WCAG 2.1 AA)\n  - Reduced motion support\n  - Performance optimized with memoization\n -->\n\n<script lang=\"ts\" module>\n\texport interface TreeNode {\n\t\tid: string; // Unique identifier for the node\n\t\tname: string; // Name of the node\n\t\tchildren?: TreeNode[]; // Optional children nodes\n\t\tisExpanded?: boolean; // Whether the node is expanded\n\t\ticon?: string; // Optional icon for the node\n\t\tariaLabel?: string; // Optional aria label for the node\n\t\tonClick?: (node: TreeNode) => void;\n\t\tisCollection?: boolean; // Whether the node is a collection\n\t\tbadge?: {\n\t\t\tvisible?: boolean; // Whether the badge is visible\n\t\t\tcount?: number; // Count for the badge\n\t\t\tstatus?: 'draft' | 'publish' | 'archive' | 'schedule' | 'delete' | 'clone' | 'test'; // Status for the badge\n\t\t\tcolor?: string; // Color for the badge\n\t\t};\n\t\tdepth?: number; // Depth of the node\n\t\torder?: number; // Order of the node\n\t\tnodeType?: string; // Type of the node\n\t\tpath?: string; // Path of the node\n\t\tisLoading?: boolean; // Whether the node is loading\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport TreeViewComponent from './TreeView.svelte';\n\tconst TreeView = TreeViewComponent;\n\timport { fly, scale } from 'svelte/transition';\n\timport { preloadData } from '$app/navigation';\n\timport { onMount } from 'svelte';\n\n\tinterface TreeViewProps {\n\t\tk?: any;\n\t\tnodes: TreeNode[];\n\t\tselectedId?: string | null;\n\t\tariaLabel?: string;\n\t\tdir?: 'ltr' | 'rtl' | 'auto';\n\t\tsearch?: string;\n\t\tcompact?: boolean;\n\t\ticonColorClass?: string;\n\t\tshowBadges?: boolean;\n\t\tallowDragDrop?: boolean;\n\t\tonReorder?: ((draggedId: string, targetId: string, position: 'before' | 'after' | 'inside') => void) | null;\n\t\tonExpand?: ((node: TreeNode) => void) | null;\n\t\tonHover?: ((node: TreeNode) => void) | null;\n\t}\n\n\t// Destructure props with clearer names and defaults\n\tconst {\n\t\tk = undefined,\n\t\tnodes: initialNodes,\n\t\tselectedId = null,\n\t\tariaLabel = 'Navigation tree',\n\t\tdir = 'ltr',\n\t\tsearch = '',\n\t\tcompact = false,\n\t\ticonColorClass = 'text-error-500',\n\t\tshowBadges = false,\n\t\tallowDragDrop = false,\n\t\tonReorder = null,\n\t\tonExpand = null,\n\t\tonHover = null\n\t}: TreeViewProps = $props();\n\n\t// State\n\tlet focusedNodeId = $state<string | null>(null);\n\tlet expandedNodeIds = $state(new Set<string>());\n\tlet draggedNode = $state<TreeNode | null>(null);\n\tlet dragOverNode = $state<TreeNode | null>(null);\n\tlet dropPosition = $state<'before' | 'after' | 'inside' | null>(null);\n\tlet prefersReducedMotion = $state(false);\n\n\t// Helper: check expansion\n\tfunction isNodeExpanded(nodeId: string): boolean {\n\t\treturn expandedNodeIds.has(nodeId);\n\t}\n\n\t// Map nodes with derived expansion state\n\tfunction mapNodesWithDerivedState(nodesToMap: TreeNode[]): TreeNode[] {\n\t\treturn nodesToMap.map((node) => ({\n\t\t\t...node,\n\t\t\tisExpanded: isNodeExpanded(node.id),\n\t\t\tchildren: node.children ? mapNodesWithDerivedState(node.children) : undefined\n\t\t}));\n\t}\n\n\tconst processedNodes = $derived(mapNodesWithDerivedState(initialNodes));\n\n\t// Filter nodes based on search\n\tconst filteredNodes = $derived.by(() => {\n\t\tconst searchTermLower = (search || '').toLowerCase().trim();\n\t\tif (!searchTermLower) return processedNodes;\n\n\t\tconst filter = (nodesToFilter: TreeNode[]): TreeNode[] => {\n\t\t\treturn nodesToFilter\n\t\t\t\t.map((node) => {\n\t\t\t\t\tconst nameMatch = node.name.toLowerCase().includes(searchTermLower);\n\t\t\t\t\tif (nameMatch) return node;\n\n\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\tconst children = filter(node.children);\n\t\t\t\t\t\tif (children.length > 0) {\n\t\t\t\t\t\t\treturn { ...node, children, isExpanded: true }; // Auto-expand matches\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t})\n\t\t\t\t.filter((n): n is TreeNode => n !== null);\n\t\t};\n\t\treturn filter(processedNodes);\n\t});\n\n\t// Node map for lookups\n\tconst nodeMap = $derived.by(() => {\n\t\tconst map = new Map<string, TreeNode & { depth: number; parentId?: string }>();\n\n\t\tfunction collect(node: TreeNode, depth = 0, parentId?: string) {\n\t\t\tmap.set(node.id, { ...node, depth, parentId });\n\t\t\tif (node.children) {\n\t\t\t\tnode.children.forEach((c) => collect(c, depth + 1, node.id));\n\t\t\t}\n\t\t}\n\n\t\tinitialNodes.forEach((n: TreeNode) => collect(n));\n\t\treturn map;\n\t});\n\n\t// Toggle expansion\n\tfunction toggleNode(node: TreeNode) {\n\t\tlogger.debug('[TreeView] toggleNode:', node.name);\n\n\t\t// Toggle expansion if node has children\n\t\tif (node.children) {\n\t\t\tconst newSet = new Set(expandedNodeIds);\n\t\t\tif (newSet.has(node.id)) {\n\t\t\t\tnewSet.delete(node.id);\n\t\t\t} else {\n\t\t\t\tnewSet.add(node.id);\n\t\t\t\tif (onExpand) onExpand(node);\n\t\t\t}\n\t\t\texpandedNodeIds = newSet;\n\t\t}\n\n\t\t// Always call onClick if it exists (even for leaf nodes without children)\n\t\tif (node.onClick) {\n\t\t\tlogger.debug('[TreeView] Calling node.onClick');\n\t\t\tnode.onClick(node);\n\t\t}\n\t}\n\n\t// Keyboard handling\n\tfunction handleKeyDown(event: KeyboardEvent, node: TreeNode) {\n\t\tconst actions: Record<string, () => void> = {\n\t\t\tEnter: () => toggleNode(node),\n\t\t\t' ': () => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\ttoggleNode(node);\n\t\t\t},\n\t\t\tArrowRight: () => handleArrowKey(node, 'right'),\n\t\t\tArrowLeft: () => handleArrowKey(node, 'left'),\n\t\t\tArrowDown: () => focusNextNode(node.id),\n\t\t\tArrowUp: () => focusPreviousNode(node.id),\n\t\t\tHome: () => focusFirstNode(),\n\t\t\tEnd: () => focusLastNode()\n\t\t};\n\n\t\tconst action = actions[event.key];\n\t\tif (action) {\n\t\t\taction();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\tfunction handleArrowKey(node: TreeNode, direction: 'left' | 'right') {\n\t\tconst isRtl = dir === 'rtl';\n\t\tconst expandKey = isRtl ? 'left' : 'right';\n\t\tconst collapseKey = isRtl ? 'right' : 'left';\n\t\tconst nodeData = nodeMap.get(node.id);\n\n\t\tif (direction === expandKey) {\n\t\t\tif (node.children && !isNodeExpanded(node.id)) {\n\t\t\t\ttoggleNode(node);\n\t\t\t} else if (node.children && isNodeExpanded(node.id)) {\n\t\t\t\tfocusNextNode(node.id);\n\t\t\t}\n\t\t} else if (direction === collapseKey) {\n\t\t\tif (node.children && isNodeExpanded(node.id)) {\n\t\t\t\ttoggleNode(node);\n\t\t\t} else if (nodeData?.parentId) {\n\t\t\t\tfocusNodeById(nodeData.parentId);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Get visible nodes\n\tfunction getVisibleNodesFlat(): string[] {\n\t\tconst visible: string[] = [];\n\n\t\tfunction traverse(nodesToTraverse: TreeNode[]) {\n\t\t\tnodesToTraverse.forEach((n) => {\n\t\t\t\tvisible.push(n.id);\n\t\t\t\tif (n.children && isNodeExpanded(n.id)) {\n\t\t\t\t\ttraverse(n.children);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\ttraverse(filteredNodes);\n\t\treturn visible;\n\t}\n\n\tfunction focusNodeById(nodeId: string | null) {\n\t\tif (nodeId && nodeMap.has(nodeId)) {\n\t\t\tfocusedNodeId = nodeId;\n\t\t}\n\t}\n\n\tfunction focusNextNode(currentId: string) {\n\t\tconst v = getVisibleNodesFlat();\n\t\tconst i = v.indexOf(currentId);\n\t\tif (i >= 0 && i < v.length - 1) {\n\t\t\tfocusNodeById(v[i + 1]);\n\t\t}\n\t}\n\n\tfunction focusPreviousNode(currentId: string) {\n\t\tconst v = getVisibleNodesFlat();\n\t\tconst i = v.indexOf(currentId);\n\t\tif (i > 0) {\n\t\t\tfocusNodeById(v[i - 1]);\n\t\t}\n\t}\n\n\tfunction focusFirstNode() {\n\t\tconst v = getVisibleNodesFlat();\n\t\tif (v.length) focusNodeById(v[0]);\n\t}\n\n\tfunction focusLastNode() {\n\t\tconst v = getVisibleNodesFlat();\n\t\tif (v.length) focusNodeById(v[v.length - 1]);\n\t}\n\n\t// Auto-focus effect\n\t$effect(() => {\n\t\tif (focusedNodeId) {\n\t\t\tconst el = document.getElementById(`node-${focusedNodeId}`);\n\t\t\tel?.focus({ preventScroll: true });\n\t\t}\n\t});\n\n\t// Drag/drop helpers\n\tfunction isDescendant(ancestorId: string, nodeId: string): boolean {\n\t\tlet currentId: string | undefined = nodeId;\n\t\twhile (currentId) {\n\t\t\tconst nd = nodeMap.get(currentId);\n\t\t\tif (nd?.parentId === ancestorId) return true;\n\t\t\tcurrentId = nd?.parentId;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction handleDragStart(event: DragEvent, node: TreeNode) {\n\t\tif (!allowDragDrop || node.id === 'root') return;\n\n\t\tdraggedNode = node;\n\t\tif (event.dataTransfer) {\n\t\t\tevent.dataTransfer.effectAllowed = 'move';\n\t\t\tevent.dataTransfer.setData('text/plain', node.id);\n\t\t}\n\t}\n\n\tfunction handleDragOver(event: DragEvent, node: TreeNode) {\n\t\tif (!allowDragDrop || !draggedNode || draggedNode.id === node.id) return;\n\n\t\tif (isDescendant(draggedNode.id, node.id)) {\n\t\t\tdropPosition = null;\n\t\t\tdragOverNode = node;\n\t\t\tif (event.dataTransfer) event.dataTransfer.dropEffect = 'none';\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tif (event.dataTransfer) event.dataTransfer.dropEffect = 'move';\n\n\t\tdragOverNode = node;\n\t\tconst rect = (event.currentTarget as HTMLElement).getBoundingClientRect();\n\t\tconst y = event.clientY - rect.top;\n\t\tconst h = rect.height;\n\t\tconst threshold = 0.25;\n\n\t\tif (y < h * threshold) {\n\t\t\tdropPosition = 'before';\n\t\t} else if (y > h * (1 - threshold)) {\n\t\t\tdropPosition = 'after';\n\t\t} else {\n\t\t\tdropPosition = (node.nodeType === 'virtual' || node.nodeType === 'category') && node.id !== 'root' ? 'inside' : 'after';\n\t\t}\n\t}\n\n\tfunction handleDragLeave(event?: DragEvent) {\n\t\tif (!allowDragDrop) return;\n\n\t\tconst related = event?.relatedTarget as Node | null;\n\t\tif (!related || !(event?.currentTarget as Node).contains(related)) {\n\t\t\tdragOverNode = null;\n\t\t\tdropPosition = null;\n\t\t}\n\t}\n\n\tfunction handleDrop(event: DragEvent, node: TreeNode) {\n\t\tif (!allowDragDrop || !draggedNode || !dropPosition || draggedNode.id === node.id || isDescendant(draggedNode.id, node.id)) {\n\t\t\thandleDragEnd();\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tif (onReorder) {\n\t\t\tonReorder(draggedNode.id, node.id, dropPosition);\n\t\t}\n\t\thandleDragEnd();\n\t}\n\n\tfunction handleDragEnd() {\n\t\tif (!allowDragDrop) return;\n\t\tdraggedNode = null;\n\t\tdragOverNode = null;\n\t\tdropPosition = null;\n\t}\n\n\t// Lifecycle\n\tonMount(() => {\n\t\tconst mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n\t\tprefersReducedMotion = mediaQuery.matches;\n\n\t\tconst handleChange = (e: MediaQueryListEvent) => {\n\t\t\tprefersReducedMotion = e.matches;\n\t\t};\n\n\t\tmediaQuery.addEventListener('change', handleChange);\n\t\treturn () => mediaQuery.removeEventListener('change', handleChange);\n\t});\n\n\t// Get transition duration\n\tconst transitionDuration = $derived(prefersReducedMotion ? 0 : 200);\n</script>\n\n<ul role=\"tree\" aria-label={ariaLabel} {dir} class=\"scrollbar-thin scrollbar-thumb-primary-500 max-h-[80vh] w-full space-y-1 overflow-y-auto\">\n\t{#each filteredNodes as node (node.id)}\n\t\t<li\n\t\t\trole=\"treeitem\"\n\t\t\taria-expanded={node.children ? node.isExpanded : undefined}\n\t\t\taria-label={node.ariaLabel || node.name}\n\t\t\taria-selected={selectedId === node.id}\n\t\t\tclass=\"group relative\"\n\t\t\ttransition:scale={{ duration: transitionDuration, start: 0.95 }}\n\t\t>\n\t\t\t<!-- Drop indicator: before -->\n\t\t\t{#if dragOverNode?.id === node.id && dropPosition === 'before'}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"absolute -top-0.5 left-0 right-0 z-10 h-1 rounded-full bg-primary-500\"\n\t\t\t\t\ttransition:scale={{ duration: transitionDuration, start: 0.8 }}\n\t\t\t\t></div>\n\t\t\t{/if}\n\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tid={`node-${node.id}`}\n\t\t\t\tclass=\"relative flex w-full items-center gap-1.5 rounded\n\t\t\t\t       border border-surface-400 px-2 py-3 transition-all duration-200\n\t\t\t\t       hover:bg-surface-50 focus:bg-surface-50 focus-visible:outline-none\n\t\t\t\t       focus-visible:ring-2 focus-visible:ring-primary-500\n\t\t\t\t       dark:border-transparent dark:bg-surface-500\n\t\t\t\t       dark:text-surface-200 dark:hover:bg-surface-400\n\t\t\t\t       {node.children ? '' : 'bg-surface-300 dark:bg-surface-700'}\n\t\t\t\t       {draggedNode?.id === node.id ? 'opacity-50' : ''}\n\t\t\t\t       {dragOverNode?.id === node.id && dropPosition === 'inside' ? 'border-primary-500 bg-primary-100 dark:bg-primary-900' : ''}\n\t\t\t\t       {allowDragDrop && node.nodeType === 'virtual' && node.id !== 'root' ? 'cursor-move' : ''}\"\n\t\t\t\taria-expanded={node.children ? node.isExpanded : undefined}\n\t\t\t\ttabindex={focusedNodeId === node.id ? 0 : -1}\n\t\t\t\tdraggable={allowDragDrop && node.nodeType === 'virtual' && node.id !== 'root'}\n\t\t\t\tonclick={() => toggleNode(node)}\n\t\t\t\tonkeydown={(event) => handleKeyDown(event, node)}\n\t\t\t\tondragstart={(event) => handleDragStart(event, node)}\n\t\t\t\tondragover={(event) => handleDragOver(event, node)}\n\t\t\t\tondragleave={handleDragLeave}\n\t\t\t\tondrop={(event) => handleDrop(event, node)}\n\t\t\t\tondragend={handleDragEnd}\n\t\t\t\taria-controls={node.children ? `node-${node.id}-children` : undefined}\n\t\t\t\tonmouseenter={() => {\n\t\t\t\t\tif (node.path) preloadData(node.path);\n\t\t\t\t\tif (onHover) onHover(node);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<!-- Expand/Collapse icon with RTL support -->\n\t\t\t\t{#if node.children}\n\t\t\t\t\t{#if node.isLoading}\n\t\t\t\t\t\t<div class=\"flex h-4 w-4 items-center justify-center\">\n\t\t\t\t\t\t\t<div class=\"h-3 w-3 animate-spin rounded-full border-2 border-surface-400 border-t-transparent\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\taria-label={node.isExpanded ? 'Collapse' : 'Expand'}\n\t\t\t\t\t\t\tclass=\"h-4 w-4 transform transition-transform duration-{transitionDuration}\n\t\t\t\t\t\t\t       {node.isExpanded ? '' : dir === 'rtl' ? 'rotate-180' : '-rotate-90'}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" class={dir === 'rtl' ? 'scale-x-[-1]' : ''} aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<!-- Badge overlay -->\n\t\t\t\t\t{#if showBadges && !node.isExpanded && node.badge?.count && node.badge.count > 0}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"absolute right-0 top-0 flex h-5 min-w-5 items-center justify-center rounded px-1.5 text-xs font-medium text-white shadow-sm\n\t\t\t\t\t\t\t       {node.badge.color || 'bg-tertiary-500 dark:bg-primary-500'}\"\n\t\t\t\t\t\t\ttransition:scale={{ duration: transitionDuration, start: 0.8 }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{node.badge.count}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"h-4 w-4\" aria-hidden=\"true\"></div>\n\t\t\t\t{/if}\n\n\t\t\t\t<!-- Icon -->\n\t\t\t\t{#if node.icon}\n\t\t\t\t\t<div class=\"relative flex shrink-0 items-center\">\n\t\t\t\t\t\t<iconify-icon icon={node.icon} width={compact ? '20' : '24'} height={compact ? '20' : '24'} class={iconColorClass} aria-hidden=\"true\"\n\t\t\t\t\t\t></iconify-icon>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<!-- Node label -->\n\t\t\t\t<span\n\t\t\t\t\tclass=\"flex-1 select-none overflow-hidden text-ellipsis whitespace-nowrap text-left dark:text-white\n\t\t\t\t\t       {compact ? 'text-xs' : 'text-sm'}\n\t\t\t\t\t       {selectedId === node.id ? 'font-semibold' : ''}\"\n\t\t\t\t\tstyle=\"margin-left: {node.depth ? node.depth * 8 : 0}px\"\n\t\t\t\t>\n\t\t\t\t\t{node.name}\n\t\t\t\t</span>\n\t\t\t</button>\n\n\t\t\t<!-- Drop indicator: after -->\n\t\t\t{#if dragOverNode?.id === node.id && dropPosition === 'after'}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"absolute -bottom-0.5 left-0 right-0 z-10 h-1 rounded-full bg-primary-500\"\n\t\t\t\t\ttransition:scale={{ duration: transitionDuration, start: 0.8 }}\n\t\t\t\t></div>\n\t\t\t{/if}\n\n\t\t\t<!-- Children nodes -->\n\t\t\t{#if node.children}\n\t\t\t\t<div id={`node-${node.id}-children`} class=\"relative {compact ? 'ms-1' : 'ms-4'}\" role=\"group\" aria-labelledby={`node-${node.id}`}>\n\t\t\t\t\t<!-- Vertical line -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"absolute -left-0.5 top-0 h-full w-0.5 bg-linear-to-b\n\t\t\t\t\t\t       from-surface-100 from-20% to-transparent dark:from-surface-400\"\n\t\t\t\t\t></div>\n\n\t\t\t\t\t<!-- Recursive children -->\n\t\t\t\t\t{#if node.isExpanded}\n\t\t\t\t\t\t<div transition:fly|local={{ y: -10, duration: transitionDuration }}>\n\t\t\t\t\t\t\t<TreeView\n\t\t\t\t\t\t\t\t{k}\n\t\t\t\t\t\t\t\tnodes={node.children}\n\t\t\t\t\t\t\t\t{selectedId}\n\t\t\t\t\t\t\t\tariaLabel={`Children of ${node.name}`}\n\t\t\t\t\t\t\t\t{dir}\n\t\t\t\t\t\t\t\t{search}\n\t\t\t\t\t\t\t\t{compact}\n\t\t\t\t\t\t\t\t{iconColorClass}\n\t\t\t\t\t\t\t\t{showBadges}\n\t\t\t\t\t\t\t\t{allowDragDrop}\n\t\t\t\t\t\t\t\t{onReorder}\n\t\t\t\t\t\t\t\t{onExpand}\n\t\t\t\t\t\t\t\t{onHover}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</li>\n\t{/each}\n</ul>\n\n<!-- Screen reader announcements -->\n<div class=\"sr-only\" role=\"status\" aria-live=\"polite\" aria-atomic=\"true\">\n\t{#if search}\n\t\tFiltered to {filteredNodes.length} item{filteredNodes.length !== 1 ? 's' : ''}\n\t{/if}\n</div>\n","<!--\n@file src/components/Collections.svelte\n@component Collections  Tree navigation for content categories & collections\n\n@features\n- Hierarchical tree with categories/collections\n- Debounced search with clear button\n- Widget validation warnings (inactive widgets)\n- Badges: collection count (categories), status/warning (collections)\n- Click navigation with proper routing\n- Expand/collapse persistence\n- Responsive compact mode\n-->\n\n<script lang=\"ts\">\n\timport { goto, invalidateAll } from '$app/navigation';\n\timport { page } from '$app/state';\n\n\timport type { ContentNode, Schema, StatusType } from '@cms-types/content';\n\timport { StatusTypes } from '@cms-types/content';\n\n\timport { collection, contentStructure, setMode } from '@shared/stores/collectionStore.svelte';\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\timport { app } from '@shared/stores/store.svelte';\n\timport { widgets } from '@shared/stores/widgetStore.svelte';\n\n\timport { validateSchemaWidgets } from '@shared/utils/widgetValidation';\n\timport { debounce } from '@shared/utils/utils';\n\n\timport TreeView from '@cms/components/system/TreeView.svelte';\n\timport * as m from '@shared/paraglide/messages';\n\n\tinterface ExtendedContentNode extends ContentNode {\n\t\tchildren?: ExtendedContentNode[];\n\t\tlastModified?: Date;\n\t\tfileCount?: number;\n\t}\n\n\tinterface CollectionTreeNode {\n\t\tid: string;\n\t\tname: string;\n\t\tisExpanded: boolean;\n\t\tonClick: () => void;\n\t\tchildren?: CollectionTreeNode[];\n\t\ticon?: string;\n\t\tbadge?: {\n\t\t\tcount?: number;\n\t\t\tstatus?: 'archive' | 'draft' | 'publish' | 'schedule' | 'clone' | 'test' | 'delete';\n\t\t\tcolor?: string;\n\t\t\tvisible?: boolean;\n\t\t\ticon?: string;\n\t\t\ttitle?: string;\n\t\t};\n\t\tpath?: string;\n\t\tdepth: number;\n\t\torder: number;\n\t}\n\n\t// Mutable state\n\tlet search = $state('');\n\tlet debouncedSearch = $state('');\n\tlet isSearching = $state(false);\n\tlet expandedNodes = $state<Set<string>>(new Set());\n\n\tlet updateDebounced = debounce.create((value: unknown) => {\n\t\tdebouncedSearch = (value as string).toLowerCase().trim();\n\t\tisSearching = false;\n\t}, 300);\n\n\t$effect(() => {\n\t\tif (search) isSearching = true;\n\t\tupdateDebounced(search);\n\t});\n\n\t// Derived UI & data\n\tlet isFullSidebar = $derived(ui.state.leftSidebar === 'full');\n\tlet currentLanguage = $derived(app.contentLanguage);\n\tlet selectedId = $derived(collection.value?._id ?? null);\n\tlet activeWidgetList = $derived(widgets.activeWidgets);\n\tlet structure = $derived(contentStructure.value ?? []);\n\n\t// Collection count cache\n\tlet countCache = new Map<string, number>();\n\n\tfunction countCollections(node: ExtendedContentNode): number {\n\t\tconst key = node._id;\n\t\tif (countCache.has(key)) return countCache.get(key)!;\n\n\t\tif (!node.children || node.nodeType !== 'category') {\n\t\t\tcountCache.set(key, 0);\n\t\t\treturn 0;\n\t\t}\n\n\t\tlet total = 0;\n\t\tfor (const child of node.children) {\n\t\t\tif (child.nodeType === 'collection') total++;\n\t\t\telse if (child.nodeType === 'category') total += countCollections(child);\n\t\t}\n\t\tcountCache.set(key, total);\n\t\treturn total;\n\t}\n\n\tfunction getBadgeColor(status?: StatusType): string {\n\t\tconst map: Record<StatusType, string> = {\n\t\t\t[StatusTypes.publish]: 'bg-success-500',\n\t\t\t[StatusTypes.draft]: 'bg-warning-500',\n\t\t\t[StatusTypes.archive]: 'bg-surface-500',\n\t\t\t[StatusTypes.schedule]: 'bg-primary-500',\n\t\t\t[StatusTypes.clone]: 'bg-secondary-500',\n\t\t\t[StatusTypes.delete]: 'bg-error-500',\n\t\t\t[StatusTypes.unpublish]: 'bg-warning-400'\n\t\t};\n\t\treturn status ? (map[status] ?? 'bg-primary-500') : 'bg-primary-500';\n\t}\n\n\tfunction mapToTreeNode(node: ExtendedContentNode, depth = 0): CollectionTreeNode {\n\t\tconst translation = node.translations?.find((t) => t.languageTag === currentLanguage);\n\t\tconst label = translation?.translationName || node.name;\n\t\tconst isCategory = node.nodeType === 'category';\n\t\tconst isExpanded = expandedNodes.has(node._id) || selectedId === node._id;\n\n\t\t// Inactive widget warning for collections\n\t\tlet hasInactiveWidgets = false;\n\t\tif (!isCategory && node.collectionDef?.fields) {\n\t\t\tconst validation = validateSchemaWidgets(node.collectionDef as Schema, activeWidgetList);\n\t\t\thasInactiveWidgets = !validation.valid;\n\t\t}\n\n\t\t// Children\n\t\tlet children: CollectionTreeNode[] | undefined;\n\t\tif (isCategory && node.children) {\n\t\t\tconst sorted = [...node.children].sort((a, b) => (a.order ?? 0) - (b.order ?? 0));\n\t\t\tchildren = sorted.map((child) => mapToTreeNode(child, depth + 1));\n\t\t}\n\n\t\t// Badge\n\t\tlet badge: CollectionTreeNode['badge'];\n\t\tif (isCategory) {\n\t\t\tbadge = {\n\t\t\t\tcount: countCollections(node),\n\t\t\t\tvisible: true,\n\t\t\t\tcolor: isExpanded ? 'bg-surface-400' : getBadgeColor(node.collectionDef?.status)\n\t\t\t};\n\t\t} else if (hasInactiveWidgets) {\n\t\t\tbadge = {\n\t\t\t\tvisible: true,\n\t\t\t\tcolor: 'bg-warning-500',\n\t\t\t\ticon: 'mdi:alert-circle',\n\t\t\t\ttitle: 'This collection uses inactive widgets'\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tid: node._id,\n\t\t\tname: label,\n\t\t\tisExpanded,\n\t\t\tonClick: () => selectNode(node),\n\t\t\tchildren,\n\t\t\ticon: isCategory ? 'bi:folder' : 'bi:collection',\n\t\t\tbadge,\n\t\t\tpath: !isCategory ? `/${currentLanguage}${node.path || '/' + node._id}` : undefined,\n\t\t\tdepth,\n\t\t\torder: node.order ?? 0\n\t\t};\n\t}\n\n\tlet treeNodes = $derived.by(() => {\n\t\tcountCache.clear();\n\t\tconst sorted = [...structure].sort((a, b) => (a.order ?? 0) - (b.order ?? 0));\n\t\treturn sorted.map((n) => mapToTreeNode(n));\n\t});\n\n\tasync function navigate(path: string, force = false): Promise<void> {\n\t\tif (page.url.pathname === path && !force) return;\n\t\tif (force || page.url.pathname === path) await invalidateAll();\n\t\tawait goto(path, { invalidateAll: true });\n\t}\n\n\tfunction selectNode(node: ExtendedContentNode): void {\n\t\tif (node.nodeType === 'category') {\n\t\t\ttoggleExpand(node._id);\n\t\t\treturn;\n\t\t}\n\n\t\t// Collection selected\n\t\tconst same = selectedId === node._id;\n\t\tsetMode('view');\n\t\tapp.shouldShowNextButton = true;\n\n\t\tdocument.dispatchEvent(\n\t\t\tnew CustomEvent('clearEntryListCache', {\n\t\t\t\tdetail: { resetState: true, reason: 'collection-switch' }\n\t\t\t})\n\t\t);\n\n\t\tconst target = `/${currentLanguage}${node.path || '/' + node._id}`;\n\t\tnavigate(target, same);\n\t}\n\n\tfunction toggleExpand(id: string): void {\n\t\tconst set = new Set(expandedNodes);\n\t\tset.has(id) ? set.delete(id) : set.add(id);\n\t\texpandedNodes = set;\n\t}\n\n\tfunction clearSearch(): void {\n\t\tsearch = '';\n\t\tdebouncedSearch = '';\n\t}\n</script>\n\n<div class=\"mt-2 space-y-2\" role=\"navigation\" aria-label=\"Collections\">\n\t<!-- Search -->\n\t<div class=\"relative {isFullSidebar ? 'w-full' : 'max-w-[135px]'}\">\n\t\t<input\n\t\t\ttype=\"text\"\n\t\t\tbind:value={search}\n\t\t\tplaceholder={isFullSidebar ? m.collections_search() : m.MediaGallery_Search()}\n\t\t\tclass=\"w-full rounded border border-surface-300 bg-surface-50 px-3 pr-11 text-sm outline-none transition-all hover:border-surface-400 focus:border-tertiary-500 dark:border-surface-600 dark:bg-surface-800 {isFullSidebar\n\t\t\t\t? 'h-12 py-3'\n\t\t\t\t: 'h-10 py-2'}\"\n\t\t\taria-label=\"Search collections\"\n\t\t/>\n\n\t\t<div class=\"absolute right-0 top-0 flex h-full items-center\">\n\t\t\t{#if isSearching}\n\t\t\t\t<div class=\"flex h-12 w-12 items-center justify-center\">\n\t\t\t\t\t<div class=\"h-2 w-2 animate-pulse rounded-full bg-tertiary-500 dark:bg-primary-500\"></div>\n\t\t\t\t</div>\n\t\t\t{:else if search}\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonclick={clearSearch}\n\t\t\t\t\tclass=\"btn rounded-full preset-outline-surface-500 {isFullSidebar ? 'h-11 w-11' : 'h-10 w-10'}\"\n\t\t\t\t\taria-label=\"Clear search\"\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"ic:round-close\" width=\"16\"></iconify-icon>\n\t\t\t\t</button>\n\t\t\t{:else}\n\t\t\t\t<!-- Search with icon -->\n\t\t\t\t<div\n\t\t\t\t\tclass=\"flex items-center justify-center rounded-r bg-secondary-100 dark:bg-surface-700 {isFullSidebar\n\t\t\t\t\t\t? 'h-11 w-11 mt-px mr-px'\n\t\t\t\t\t\t: 'h-8 w-8'}\"\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"ic:outline-search\" width=\"24\"></iconify-icon>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t<!-- Tree -->\n\t<div class=\"collections-list\" role=\"tree\" aria-label=\"Collection tree\">\n\t\t{#if treeNodes.length === 0}\n\t\t\t<div class=\"flex flex-col items-center justify-center gap-2 p-6 text-center\">\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"32\" class=\"text-surface-400 opacity-50\"></iconify-icon>\n\t\t\t\t<p class=\"text-sm text-surface-500 dark:text-surface-50\">{m.collection_no_collections_found()}</p>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<TreeView nodes={treeNodes} {selectedId} compact={!isFullSidebar} search={debouncedSearch} iconColorClass=\"text-error-500\" showBadges={true} />\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.collections-list {\n\t\tscrollbar-width: thin;\n\t\tscrollbar-color: rgb(var(--color-primary-500) / 0.3) transparent;\n\t}\n\t.collections-list::-webkit-scrollbar {\n\t\twidth: 4px;\n\t}\n\t.collections-list::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgb(var(--color-primary-500) / 0.3);\n\t\tborder-radius: 2px;\n\t}\n\t.collections-list::-webkit-scrollbar-thumb:hover {\n\t\tbackground-color: rgb(var(--color-primary-500) / 0.5);\n\t}\n</style>\n","<!--\n@file src/components/MediaFolders.svelte\n@component MediaFolders  Tree-based media folder navigation & management\n\n@features\n- Hierarchical tree view with root node\n- Click navigation (closes sidebar on mobile)\n- Edit mode: drag & drop reordering, rename/delete via TreeView\n- Persistent loading/error/empty states\n- Responsive (compact mode when sidebar narrow)\n- Event-driven refresh on folder changes\n-->\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { showToast } from '@shared/utils/toast';\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\timport { screen } from '@shared/stores/screenSizeStore.svelte';\n\timport TreeView from '@cms/components/system/TreeView.svelte';\n\timport * as m from '@shared/paraglide/messages';\n\n\tinterface RawFolder {\n\t\t_id: string;\n\t\tname: string;\n\t\tpath: string;\n\t\tparentId?: string | null;\n\t\torder?: number;\n\t}\n\n\tinterface FolderNode {\n\t\tid: string;\n\t\tname: string;\n\t\tpath: string;\n\t\tparentId?: string | null;\n\t\tisExpanded: boolean;\n\t\tonClick: () => void;\n\t\tchildren?: FolderNode[];\n\t\ticon?: string;\n\t\tnodeType: 'virtual';\n\t\torder: number;\n\t\tdepth?: number;\n\t}\n\n\t// Mutable state\n\tlet folders = $state<FolderNode[]>([]);\n\tlet expandedNodes = $state<Set<string>>(new Set());\n\tlet selectedFolderId = $state<string | null>(null);\n\tlet isEditMode = $state(false);\n\tlet isLoading = $state(true);\n\tlet error = $state<string | null>(null);\n\n\t// Derived UI state\n\tlet isSidebarFull = $derived(ui.state.leftSidebar === 'full');\n\tlet isMobile = $derived(screen.isMobile);\n\n\t// Fetch folders from API\n\tasync function loadFolders(): Promise<void> {\n\t\tisLoading = true;\n\t\terror = null;\n\t\ttry {\n\t\t\tconst res = await fetch('/api/systemVirtualFolder');\n\t\t\tif (!res.ok) throw new Error('Network error');\n\t\t\tconst { success, data } = await res.json();\n\t\t\tif (!success || !data) throw new Error('Invalid response');\n\n\t\t\tfolders = data\n\t\t\t\t.filter((f: RawFolder) => f.path?.startsWith('/'))\n\t\t\t\t.map((f: RawFolder) => ({\n\t\t\t\t\tid: f._id,\n\t\t\t\t\tname: f.name,\n\t\t\t\t\tpath: f.path,\n\t\t\t\t\tparentId: f.parentId,\n\t\t\t\t\tisExpanded: expandedNodes.has(f._id),\n\t\t\t\t\tonClick: () => selectFolder(f._id),\n\t\t\t\t\ticon: 'bi:folder',\n\t\t\t\t\tnodeType: 'virtual' as const,\n\t\t\t\t\torder: f.order ?? 0\n\t\t\t\t}));\n\t\t} catch (err) {\n\t\t\terror = 'Failed to load folders';\n\t\t\tlogger.error('[MediaFolders] Load error:', err);\n\t\t\tshowToast('Failed to load folders', 'error');\n\t\t} finally {\n\t\t\tisLoading = false;\n\t\t}\n\t}\n\n\t// Build hierarchical tree\n\tlet tree = $derived.by(() => {\n\t\tconst root: FolderNode = {\n\t\t\tid: 'root',\n\t\t\tname: m.media_root_title(),\n\t\t\tpath: '/',\n\t\t\tisExpanded: true,\n\t\t\tonClick: () => selectFolder('root'),\n\t\t\ticon: 'bi:house-door',\n\t\t\tnodeType: 'virtual',\n\t\t\torder: 0,\n\t\t\tdepth: 0,\n\t\t\tchildren: []\n\t\t};\n\n\t\tif (folders.length === 0) return [root];\n\n\t\tconst map = new Map<string, FolderNode>();\n\t\tfolders.forEach((f) => map.set(f.id, { ...f, children: [], depth: 0 }));\n\n\t\tconst orphans: FolderNode[] = [];\n\t\tfolders.forEach((f) => {\n\t\t\tconst node = map.get(f.id)!;\n\t\t\tif (f.parentId && map.has(f.parentId)) {\n\t\t\t\tmap.get(f.parentId)!.children!.push(node);\n\t\t\t} else {\n\t\t\t\torphans.push(node);\n\t\t\t}\n\t\t});\n\n\t\tfunction sortAndSetDepth(nodes: FolderNode[], depth: number): void {\n\t\t\tnodes.sort((a, b) => a.order - b.order);\n\t\t\tnodes.forEach((n) => {\n\t\t\t\tn.depth = depth;\n\t\t\t\tif (n.children?.length) sortAndSetDepth(n.children, depth + 1);\n\t\t\t});\n\t\t}\n\n\t\tsortAndSetDepth(orphans, 1);\n\t\troot.children = orphans;\n\t\treturn [root];\n\t});\n\n\tfunction selectFolder(id: string): void {\n\t\tselectedFolderId = id;\n\t\tif (id !== 'root') expandedNodes.add(id);\n\t\tif (isMobile) ui.toggle('leftSidebar', 'hidden');\n\t}\n\n\t// Drag & drop reordering\n\tasync function reorder(draggedId: string, targetId: string, position: 'before' | 'after' | 'inside'): Promise<void> {\n\t\tif (!isEditMode) return;\n\n\t\tlet newParentId: string | null = null;\n\t\tif (position === 'inside') {\n\t\t\tnewParentId = targetId === 'root' ? null : targetId;\n\t\t} else {\n\t\t\tconst target = folders.find((f) => f.id === targetId);\n\t\t\tnewParentId = target?.parentId ?? null;\n\t\t}\n\n\t\ttry {\n\t\t\tconst res = await fetch('/api/systemVirtualFolder', {\n\t\t\t\tmethod: 'PATCH',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\taction: 'reorder',\n\t\t\t\t\tparentId: newParentId,\n\t\t\t\t\torderUpdates: [{ folderId: draggedId, order: 0, parentId: newParentId }]\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tif (!res.ok) throw new Error('Failed');\n\t\t\tshowToast('Folder moved', 'success');\n\t\t\tawait loadFolders();\n\t\t} catch (e) {\n\t\t\tshowToast('Move failed', 'error');\n\t\t\tlogger.error('[MediaFolders] Reorder error:', e);\n\t\t}\n\t}\n\n\t// Initial load + refresh on global events\n\t$effect(() => {\n\t\tloadFolders();\n\n\t\tconst refresh = () => loadFolders();\n\t\tdocument.addEventListener('folderCreated', refresh);\n\t\tdocument.addEventListener('folderUpdated', refresh);\n\t\tdocument.addEventListener('folderDeleted', refresh);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('folderCreated', refresh);\n\t\t\tdocument.removeEventListener('folderUpdated', refresh);\n\t\t\tdocument.removeEventListener('folderDeleted', refresh);\n\t\t};\n\t});\n</script>\n\n<div class=\"space-y-2\" role=\"navigation\" aria-label=\"Media folders\">\n\t<!-- Header -->\n\t<div class=\"flex items-center justify-between\">\n\t\t<h3 class=\"flex items-center text-sm font-semibold text-tertiary-500 dark:text-primary-500\">\n\t\t\t<iconify-icon icon=\"bi:folder\" width=\"18\" class=\"mr-1 text-primary-500\"></iconify-icon>\n\t\t\tMedia Folders\n\t\t</h3>\n\n\t\t{#if isSidebarFull}\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={() => (isEditMode = !isEditMode)}\n\t\t\t\tclass=\"btn-sm {isEditMode ? 'variant-filled-warning' : 'preset-outlined-surface-500'}\"\n\t\t\t\taria-pressed={isEditMode}\n\t\t\t>\n\t\t\t\t<iconify-icon icon={isEditMode ? 'bi:check-circle' : 'bi:pencil'} width=\"16\"></iconify-icon>\n\t\t\t\t<span class=\"ml-1\">{isEditMode ? 'Done' : 'Edit'}</span>\n\t\t\t</button>\n\t\t{/if}\n\t</div>\n\n\t<!-- Edit mode hint -->\n\t{#if isEditMode && isSidebarFull}\n\t\t<div class=\"flex items-start gap-2 rounded-lg bg-warning-500/10 p-3 text-xs text-warning-700 dark:text-warning-400\">\n\t\t\t<iconify-icon icon=\"bi:info-circle\" width=\"14\" class=\"mt-0.5 shrink-0\"></iconify-icon>\n\t\t\t<p>Drag folders to reorder or move. Use node actions for rename/delete.</p>\n\t\t</div>\n\t{/if}\n\n\t<!-- Content -->\n\t<div class=\"media-folders-list\" role=\"tree\" aria-label=\"Folder tree\">\n\t\t{#if isLoading}\n\t\t\t<div class=\"flex flex-col items-center justify-center gap-3 p-6\">\n\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t<div class=\"h-3 w-3 animate-bounce rounded-full bg-primary-500\"></div>\n\t\t\t\t\t<div class=\"h-3 w-3 animate-bounce rounded-full bg-primary-500 [animation-delay:0.1s]\"></div>\n\t\t\t\t\t<div class=\"h-3 w-3 animate-bounce rounded-full bg-primary-500 [animation-delay:0.2s]\"></div>\n\t\t\t\t</div>\n\t\t\t\t<p class=\"text-sm text-surface-600 dark:text-surface-50\">Loading folders...</p>\n\t\t\t</div>\n\t\t{:else if error}\n\t\t\t<div class=\"flex flex-col items-center justify-center gap-3 p-6 text-center\">\n\t\t\t\t<iconify-icon icon=\"ic:outline-error\" width=\"32\" class=\"text-error-500\"></iconify-icon>\n\t\t\t\t<p class=\"text-sm text-error-500\">{error}</p>\n\t\t\t\t<button type=\"button\" onclick={loadFolders} class=\"btn-sm preset-filled-error-500\">\n\t\t\t\t\t<iconify-icon icon=\"ic:outline-refresh\" width=\"16\" class=\"mr-1\"></iconify-icon>\n\t\t\t\t\tRetry\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t{:else if tree.length > 0}\n\t\t\t<TreeView\n\t\t\t\tnodes={tree}\n\t\t\t\tselectedId={selectedFolderId}\n\t\t\t\tcompact={!isSidebarFull}\n\t\t\t\ticonColorClass=\"text-primary-500\"\n\t\t\t\tshowBadges={false}\n\t\t\t\tallowDragDrop={isEditMode}\n\t\t\t\tonReorder={reorder}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<div class=\"flex flex-col items-center justify-center gap-2 p-6 text-center\">\n\t\t\t\t<iconify-icon icon=\"bi:folder\" width=\"32\" class=\"text-surface-400 opacity-50\"></iconify-icon>\n\t\t\t\t<p class=\"text-sm text-surface-500 dark:text-surface-50\">No folders yet</p>\n\t\t\t\t<p class=\"text-xs text-surface-400\">Create your first media folder to get started</p>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.media-folders-list {\n\t\tscrollbar-width: thin;\n\t\tscrollbar-color: rgb(var(--color-primary-500) / 0.3) transparent;\n\t}\n\t.media-folders-list::-webkit-scrollbar {\n\t\twidth: 4px;\n\t}\n\t.media-folders-list::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgb(var(--color-primary-500) / 0.3);\n\t\tborder-radius: 2px;\n\t}\n\t.media-folders-list::-webkit-scrollbar-thumb:hover {\n\t\tbackground-color: rgb(var(--color-primary-500) / 0.5);\n\t}\n</style>\n","<!--\n@file src/components/SettingsMenu.svelte\n@component\n**Settings Menu Sidebar**\nSidebar navigation for System Settings\n-->\n\n<script lang=\"ts\">\n\timport { page } from '$app/state';\n\timport { goto } from '$app/navigation';\n\timport { getSettingGroupsByRole } from '@cms/config/settingsGroups';\n\timport type { SettingGroup, SettingField } from '@cms/config/settingsGroups';\n\timport { groupsNeedingConfig } from '@shared/stores/configStore.svelte';\n\n\t// Props\n\tlet { isFullSidebar = true } = $props();\n\n\t// State\n\tlet searchTerm = $state('');\n\n\t// Derived\n\tconst user = $derived(page.data.user);\n\tconst isAdmin = $derived(user?.role === 'admin' || user?.role === 'sudo'); // Simple admin check, should match +page logic\n\tconst availableGroups: SettingGroup[] = $derived(\n\t\tgetSettingGroupsByRole(isAdmin).sort((a: SettingGroup, b: SettingGroup) => a.name.localeCompare(b.name))\n\t);\n\tconst selectedGroupId = $derived(page.url.searchParams.get('group'));\n\n\t// Filter logic\n\tconst filteredGroups = $derived.by(() => {\n\t\tif (!searchTerm) {\n\t\t\treturn availableGroups;\n\t\t}\n\t\tconst lowerCaseSearchTerm = searchTerm.toLowerCase();\n\t\treturn availableGroups.filter((group) => {\n\t\t\tif (group.name.toLowerCase().includes(lowerCaseSearchTerm)) return true;\n\t\t\tif (group.description?.toLowerCase().includes(lowerCaseSearchTerm)) return true;\n\t\t\tif (\n\t\t\t\tgroup.fields.some(\n\t\t\t\t\t(field: SettingField) => field.label.toLowerCase().includes(lowerCaseSearchTerm) || field.key.toLowerCase().includes(lowerCaseSearchTerm)\n\t\t\t\t)\n\t\t\t)\n\t\t\t\treturn true;\n\t\t\treturn false;\n\t\t});\n\t});\n\n\tfunction handleGroupClick(groupId: string) {\n\t\t// Update URL query param to switch groups\n\t\tconst url = new URL(page.url);\n\t\turl.searchParams.set('group', groupId);\n\t\tgoto(url.toString());\n\t}\n</script>\n\n<div class=\"mt-2 flex flex-col h-full bg-transparent\">\n\t<!-- Search -->\n\t<div class=\"relative mb-2 {isFullSidebar ? 'w-full' : 'max-w-[135px]'}\">\n\t\t<input\n\t\t\ttype=\"text\"\n\t\t\tbind:value={searchTerm}\n\t\t\tplaceholder={isFullSidebar ? 'Search settings...' : 'Search'}\n\t\t\tclass=\"w-full rounded border border-surface-300 bg-surface-50 px-3 pr-11 text-sm outline-none transition-all hover:border-surface-400 focus:border-tertiary-500 dark:border-surface-600 dark:bg-surface-800 {isFullSidebar\n\t\t\t\t? 'h-12 py-3'\n\t\t\t\t: 'h-10 py-2'}\"\n\t\t\taria-label=\"Search settings\"\n\t\t/>\n\t\t<div class=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-surface-400\">\n\t\t\t<iconify-icon icon=\"ic:outline-search\" width=\"20\"></iconify-icon>\n\t\t</div>\n\t</div>\n\n\t<!-- Groups List -->\n\t<div class=\"flex-1 overflow-y-auto px-1 space-y-1 settings-list\">\n\t\t{#each filteredGroups as group (group.id)}\n\t\t\t<button\n\t\t\t\tclass=\"w-full cursor-pointer rounded-lg p-2 text-left transition-colors flex items-center justify-between {selectedGroupId === group.id\n\t\t\t\t\t? 'bg-primary-500 text-white'\n\t\t\t\t\t: 'hover:bg-surface-200 dark:hover:bg-surface-700'}\"\n\t\t\t\tonclick={() => handleGroupClick(group.id)}\n\t\t\t\ttitle={group.name}\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center gap-3 overflow-hidden\">\n\t\t\t\t\t<span class=\"text-xl shrink-0\">{group.icon}</span>\n\t\t\t\t\t{#if isFullSidebar}\n\t\t\t\t\t\t<span class=\"text-sm font-medium truncate\">{group.name}</span>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t{#if isFullSidebar}\n\t\t\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t\t\t{#if $groupsNeedingConfig.has(group.id)}\n\t\t\t\t\t\t\t<span class=\"text-lg text-warning-500\" title=\"Needs configuration\"></span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{:else if $groupsNeedingConfig.has(group.id)}\n\t\t\t\t\t<!-- Dot for collapsed state -->\n\t\t\t\t\t<div class=\"w-2 h-2 rounded-full bg-warning-500 absolute top-1 right-1\"></div>\n\t\t\t\t{/if}\n\t\t\t</button>\n\t\t{/each}\n\n\t\t{#if filteredGroups.length === 0}\n\t\t\t<div class=\"p-4 text-center text-sm text-surface-500\">\n\t\t\t\t<p>No results</p>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.settings-list {\n\t\tscrollbar-width: thin;\n\t\tscrollbar-color: rgb(var(--color-surface-500)) transparent;\n\t}\n\t.settings-list::-webkit-scrollbar {\n\t\twidth: 4px;\n\t}\n\t.settings-list::-webkit-scrollbar-track {\n\t\tbackground: transparent;\n\t}\n\t.settings-list::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgb(var(--color-surface-500));\n\t\tborder-radius: 4px;\n\t}\n</style>\n","<!--\n@file src/components/ThemeToggle.svelte\n@component\n**A component for cycling through all application theme states.**\nIt relies entirely on the centralized `themeStore` for its state and logic.\n### Features\n- Three-way theme cycle: System  Light  Dark  System\n- Icons represent current theme preference (system/light/dark)\n- Optional tooltip for user guidance\n-->\n<script lang=\"ts\">\n\timport { themeStore, setThemePreference, useSystemPreference } from '@shared/stores/themeStore.svelte.ts';\n\n\tinterface Props {\n\t\tshowTooltip?: boolean;\n\t\ttooltipPlacement?: 'top' | 'bottom' | 'left' | 'right';\n\t\tbuttonClass?: string;\n\t\ticonSize?: number;\n\t}\n\n\tconst {\n\t\tshowTooltip = true,\n\t\ttooltipPlacement = 'bottom',\n\t\tbuttonClass = 'preset-outline-surface-500 btn-icon rounded-full',\n\t\ticonSize = 22\n\t}: Props = $props();\n\n\t// Cycle through system -> light -> dark -> system\n\tfunction cycleTheme() {\n\t\tconst current = themeStore.themePreference;\n\t\tif (current === 'system') {\n\t\t\tsetThemePreference('light');\n\t\t} else if (current === 'light') {\n\t\t\tsetThemePreference('dark');\n\t\t} else {\n\t\t\tuseSystemPreference();\n\t\t}\n\t}\n\n\t// Get tooltip text based on current preference\n\tconst getTooltipText = $derived(() => {\n\t\tconst current = themeStore.themePreference;\n\t\tif (current === 'system') return 'System theme (click for Light)';\n\t\tif (current === 'light') return 'Light theme (click for Dark)';\n\t\treturn 'Dark theme (click for System)';\n\t});\n\n\t// Get icon based on current preference\n\tconst getCurrentIcon = $derived(() => {\n\t\tconst current = themeStore.themePreference;\n\t\tif (current === 'system') return 'bi:circle-half';\n\t\tif (current === 'light') return 'bi:sun';\n\t\treturn 'bi:moon-fill';\n\t});\n</script>\n\n<button onclick={cycleTheme} aria-label=\"Toggle theme\" class={buttonClass} title={showTooltip ? getTooltipText() : undefined}>\n\t<iconify-icon icon={getCurrentIcon()} width={iconSize}></iconify-icon>\n</button>\n","<!--\n@file src/components/LeftSidebar.svelte\n\n@component\n**LeftSidebar component displaying collection fields, publish options and translation status.**\n\n@example\n<LeftSidebar />\n\n#### Props\n- `mode` {object} - The current mode object from the mode store\n- `collection` {object} - The current collection object from the collection store\n\n#### Features\n- Displays collection fields\n- Displays publish options\n- Displays translation status\n- Optimized event handlers\n-->\n\n<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\timport axios from 'axios';\n\timport { browser } from '$app/environment';\n\timport { logger } from '@shared/utils/logger';\n\n\t// Import necessary utilities and types\n\timport { page } from '$app/state';\n\timport type { Schema } from '@cms-types/content'; // Import Schema type (collection definition)\n\timport { getLanguageName } from '@shared/utils/languageUtils';\n\timport { locales as availableLocales } from '@shared/paraglide/runtime';\n\n\t// Stores\n\timport { setMode } from '@shared/stores/collectionStore.svelte';\n\timport { avatarSrc, systemLanguage } from '@shared/stores/store.svelte';\n\timport { toggleUIElement, uiStateManager, userPreferredState } from '@shared/stores/UIStore.svelte';\n\timport { globalLoadingStore, loadingOperations } from '@shared/stores/loadingStore.svelte';\n\timport { themeStore } from '@shared/stores/themeStore.svelte';\n\n\t// Import components\n\timport VersionCheck from '@shared/components/VersionCheck.svelte';\n\timport Collections from '@cms/components/Collections.svelte';\n\timport MediaFolders from '@cms/components/MediaFolders.svelte';\n\timport SettingsMenu from '@cms/components/SettingsMenu.svelte';\n\timport SiteName from '@shared/components/SiteName.svelte';\n\timport SveltyCMSLogo from '@cms/components/system/icons/SveltyCMS_Logo.svelte';\n\timport ThemeToggle from '@shared/components/ThemeToggle.svelte';\n\n\t// Skeleton components\n\timport { Avatar, Portal, Tooltip, Menu } from '@skeletonlabs/skeleton-svelte';\n\n\t// Language and messaging\n\timport * as m from '@shared/paraglide/messages';\n\timport { getLocale } from '@shared/paraglide/runtime';\n\n\t// Constants\n\tconst MOBILE_BREAKPOINT = 768;\n\tconst LANGUAGE_DROPDOWN_THRESHOLD = 5;\n\tconst AVATAR_CACHE_BUSTER = Date.now();\n\tconst TOOLTIP_CLASS =\n\t\t'card w-48 rounded-md border border-slate-300/50 bg-surface-50 p-2 text-xs shadow-xl dark:border-slate-600 dark:bg-surface-700 text-black dark:text-white';\n\tconst ARROW_CLASS = '[--arrow-size:--spacing(2)] [--arrow-background:var(--color-surface-100-900)]';\n\n\t// Types\n\ttype AvailableLanguage = string;\n\ttype SidebarState = 'full' | 'collapsed' | 'hidden';\n\n\t// Reactive user data\n\tconst user = $derived(page.data.user);\n\tconst currentPath = $derived(page.url.pathname);\n\tconst collections: Schema[] = $derived(page.data.collections);\n\t// Check if we're in media mode\n\tconst isMediaMode = $derived(currentPath.includes('/mediagallery'));\n\t// Check if we're in settings mode\n\tconst isSettingsMode = $derived(currentPath.includes('/config/systemsetting'));\n\n\t// Language state\n\tlet languageTag = $state(getLocale() as AvailableLanguage);\n\tlet searchQuery = $state('');\n\t// Removed isDropdownOpen and dropdownRef as Menu handles this\n\n\t// Derived values\n\tconst isSidebarFull = $derived(uiStateManager.uiState.value.leftSidebar === 'full');\n\n\tconst firstCollectionPath = $derived(collections?.[0] ? `/Collections/${collections[0].name}` : '/Collections');\n\n\tconst availableLanguages = $derived([...availableLocales].sort((a, b) => getLanguageName(a, 'en').localeCompare(getLanguageName(b, 'en'))));\n\n\tconst showLanguageDropdown = $derived(availableLanguages.length > LANGUAGE_DROPDOWN_THRESHOLD);\n\n\tconst filteredLanguages = $derived(\n\t\tavailableLanguages\n\t\t\t.filter((lang) => lang !== languageTag) // Hide current language\n\t\t\t.filter((lang: string) => {\n\t\t\t\tconst searchLower = searchQuery.toLowerCase();\n\t\t\t\tconst systemLangName = getLanguageName(lang, systemLanguage.value).toLowerCase();\n\t\t\t\tconst enLangName = getLanguageName(lang, 'en').toLowerCase();\n\t\t\t\treturn systemLangName.includes(searchLower) || enLangName.includes(searchLower);\n\t\t\t}) as AvailableLanguage[]\n\t);\n\n\tconst avatarUrl = $derived.by(() => {\n\t\tlet src = avatarSrc.value;\n\t\tif (!src) return '/Default_User.svg';\n\t\tif (src.startsWith('data:')) return src;\n\n\t\t// Normalize path\n\t\t// 1. Remove leading slashes\n\t\tsrc = src.replace(/^\\/+/, '');\n\t\t// 2. Remove prefixes\n\t\tsrc = src.replace(/^mediaFolder\\//, '').replace(/^files\\//, '');\n\t\t// 3. Remove leading slashes again just in case\n\t\tsrc = src.replace(/^\\/+/, '');\n\n\t\treturn `/files/${src}?t=${AVATAR_CACHE_BUSTER}`;\n\t});\n\n\tconst themeTooltipText = $derived.by(() => {\n\t\tconst current = themeStore.themePreference;\n\t\tif (current === 'system') return 'System theme (click for Light)';\n\t\tif (current === 'light') return 'Light theme (click for Dark)';\n\t\treturn 'Dark theme (click for System)';\n\t});\n\n\t// Helper functions\n\tfunction isMobile(): boolean {\n\t\treturn browser && window.innerWidth < MOBILE_BREAKPOINT;\n\t}\n\n\tasync function navigateTo(path: string): Promise<void> {\n\t\tif (currentPath === path) return;\n\n\t\tif (isMobile()) {\n\t\t\ttoggleUIElement('leftSidebar', 'hidden');\n\t\t}\n\n\t\tsetMode('view');\n\n\t\t// Start loading state for navigation\n\t\tglobalLoadingStore.startLoading(loadingOperations.navigation, `LeftSidebar.navigateTo(${path})`);\n\n\t\ttry {\n\t\t\t// Special handling: System routes that don't use language prefixes\n\t\t\tconst unlocalizedRoutes = ['/mediagallery', '/config', '/user', '/dashboard', '/setup'];\n\t\t\tconst isUnlocalized = unlocalizedRoutes.some((r) => path === r || path.startsWith(r + '/'));\n\n\t\t\tif (isUnlocalized) {\n\t\t\t\tawait goto(path, { replaceState: false });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Ensure path includes language prefix for collection routes\n\t\t\tconst currentLocale = getLocale();\n\t\t\tconst pathWithLanguage = path.startsWith(`/${currentLocale}`) ? path : `/${currentLocale}${path}`;\n\n\t\t\tawait goto(pathWithLanguage, { replaceState: false });\n\t\t} finally {\n\t\t\t// Stop loading after navigation completes\n\t\t\t// Note: SvelteKit will handle the actual page load, this just shows initial navigation\n\t\t\tsetTimeout(() => {\n\t\t\t\tglobalLoadingStore.stopLoading(loadingOperations.navigation);\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\t// Event handlers\n\tfunction handleLanguageSelection(lang: AvailableLanguage): void {\n\t\tsystemLanguage.set(lang as any);\n\t\tlanguageTag = lang;\n\t\tsearchQuery = '';\n\t}\n\n\tfunction toggleSidebar(): void {\n\t\tconst current = uiStateManager.uiState.value.leftSidebar;\n\t\tconst newState: SidebarState = current === 'full' ? 'collapsed' : 'full';\n\t\ttoggleUIElement('leftSidebar', newState);\n\t\tuserPreferredState.set(newState);\n\t}\n\n\tasync function handleUserClick(event?: Event): Promise<void> {\n\t\tevent?.stopPropagation();\n\t\tawait navigateTo('/user');\n\t}\n\n\tasync function handleConfigClick(event?: Event): Promise<void> {\n\t\tevent?.stopPropagation();\n\t\tawait navigateTo('/config');\n\t}\n\n\tasync function signOut(): Promise<void> {\n\t\ttry {\n\t\t\tawait axios.post('/api/user/logout', {}, { withCredentials: true });\n\t\t} catch (error) {\n\t\t\tlogger.error('Error during sign-out:', error instanceof Error ? error.message : 'Unknown error');\n\t\t} finally {\n\t\t\t// Always redirect to login, even if logout fails\n\t\t\tif (browser) {\n\t\t\t\twindow.location.href = '/login';\n\t\t\t}\n\t\t}\n\t}\n\n\t// Keyboard handlers\n\tfunction handleKeyPress(event: KeyboardEvent, callback: () => void | Promise<void>): void {\n\t\tif (event.key === 'Enter' || event.key === ' ') {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\tcallback();\n\t\t}\n\t}\n</script>\n\n<div class=\"flex h-full w-full flex-col justify-between bg-transparent px-3 py-4\">\n\t<!-- Corporate Identity -->\n\t{#if isSidebarFull}\n\t\t<a href=\"/\" aria-label=\"SveltyCMS Logo\" class=\"flex pt-2 no-underline!\" data-sveltekit-preload-data=\"hover\">\n\t\t\t<SveltyCMSLogo fill=\"red\" className=\"h-9 -ml-2\" />\n\t\t\t<span class=\"base-font-color relative text-2xl font-bold\">\n\t\t\t\t<SiteName highlight=\"CMS\" />\n\t\t\t</span>\n\t\t</a>\n\t{:else}\n\t\t<div class=\"flex justify-start gap-2\">\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={() => toggleUIElement('leftSidebar', 'hidden')}\n\t\t\t\taria-label=\"Close Sidebar\"\n\t\t\t\tclass=\"preset-outline-surface-500 btn-icon mt-1\"\n\t\t\t>\n\t\t\t\t<iconify-icon icon=\"mingcute:menu-fill\" width=\"24\"></iconify-icon>\n\t\t\t</button>\n\n\t\t\t<a href=\"/\" aria-label=\"SveltyCMS Logo\" class=\"flex justify-center pt-2 no-underline!\">\n\t\t\t\t<SveltyCMSLogo fill=\"red\" className=\"h-9 -ml-2 ltr:mr-2 rtl:ml-2 rtl:-mr-2\" />\n\t\t\t</a>\n\t\t</div>\n\t{/if}\n\n\t<!-- Expand/Collapse Button -->\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={toggleSidebar}\n\t\taria-label={isSidebarFull ? 'Collapse Sidebar' : 'Expand Sidebar'}\n\t\taria-expanded={isSidebarFull}\n\t\tclass=\"absolute top-2 z-20 flex h-10 w-10 items-center justify-center rounded-full! border border-black p-0 dark:border-black ltr:-right-4 rtl:-left-4\"\n\t>\n\t\t<iconify-icon\n\t\t\ticon=\"bi:arrow-left-circle-fill\"\n\t\t\twidth=\"34\"\n\t\t\tclass=\"rounded-full bg-surface-500 text-white transition-transform hover:cursor-pointer hover:bg-error-600 dark:bg-white dark:text-surface-600 dark:hover:bg-error-600 {isSidebarFull\n\t\t\t\t? 'rotate-0 rtl:rotate-180'\n\t\t\t\t: 'rotate-180 rtl:rotate-0'}\"\n\t\t></iconify-icon>\n\t</button>\n\n\t<!-- Navigation: Collections, Media Folders, or Settings -->\n\t{#if isSettingsMode}\n\t\t<SettingsMenu isFullSidebar={isSidebarFull} />\n\n\t\t<!-- Toggle to Collections Button -->\n\t\t<button\n\t\t\tclass=\"btn mt-2 flex w-full items-center justify-center gap-2 rounded-sm border border-surface-500 py-4 transition-all duration-200 hover:bg-surface-200 dark:bg-surface-500 hover:dark:bg-surface-400\"\n\t\t\tonclick={() => {\n\t\t\t\tsetMode('view');\n\t\t\t\tnavigateTo(firstCollectionPath);\n\t\t\t}}\n\t\t\taria-label=\"Switch to Collections\"\n\t\t>\n\t\t\t<iconify-icon icon=\"bi:arrow-left\" width=\"18\" class=\"text-error-500\"></iconify-icon>\n\t\t\t{#if isSidebarFull}\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"20\" class=\"text-error-500\"></iconify-icon>\n\t\t\t\t<span class=\"\">{m.button_Collections()} </span>\n\t\t\t{:else}\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"18\" class=\"text-error-500\"></iconify-icon>\n\t\t\t{/if}\n\t\t</button>\n\t{:else if isMediaMode}\n\t\t<MediaFolders />\n\n\t\t<!-- Toggle to Collections Button -->\n\t\t<button\n\t\t\tclass=\"btn mt-2 flex w-full items-center justify-center gap-2 rounded-sm border border-surface-500 py-4 transition-all duration-200 hover:bg-surface-200 dark:bg-surface-500 hover:dark:bg-surface-400\"\n\t\t\tonclick={() => {\n\t\t\t\tsetMode('view');\n\t\t\t\tnavigateTo(firstCollectionPath);\n\t\t\t}}\n\t\t\taria-label=\"Switch to Collections\"\n\t\t>\n\t\t\t<iconify-icon icon=\"bi:arrow-left\" width=\"18\" class=\"text-error-500\"></iconify-icon>\n\t\t\t{#if isSidebarFull}\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"20\" class=\"text-error-500\"></iconify-icon>\n\t\t\t\t<span class=\"\">{m.button_Collections()} </span>\n\t\t\t{:else}\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"18\" class=\"text-error-500\"></iconify-icon>\n\t\t\t{/if}\n\t\t</button>\n\t{:else}\n\t\t<Collections />\n\n\t\t<!-- Toggle to Media Gallery Button -->\n\t\t<button\n\t\t\tclass=\"btn preset-outlined-surface-500 dark:preset-filled-surface-500 mt-2 flex h-14 w-full items-center justify-center gap-2 rounded\"\n\t\t\tonclick={() => {\n\t\t\t\tsetMode('media');\n\t\t\t\tnavigateTo('/mediagallery');\n\t\t\t}}\n\t\t\taria-label=\"Switch to Media Gallery\"\n\t\t>\n\t\t\t{#if isSidebarFull}\n\t\t\t\t<iconify-icon icon=\"bi:images\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t<span class=\"\">{m.Collections_MediaGallery()}</span>\n\t\t\t\t<iconify-icon icon=\"bi:arrow-right\" width=\"18\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t{:else}\n\t\t\t\t<iconify-icon icon=\"bi:images\" width=\"18\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t<span class=\"text-sm\">{m.collections_media()}</span>\n\t\t\t{/if}\n\t\t</button>\n\t{/if}\n\n\t<!-- Footer -->\n\t<div class=\"mb-2 mt-auto w-full px-1\">\n\t\t<div class=\"mx-1 mb-2 border-0 border-t border-surface-500\"></div>\n\n\t\t<div class=\"grid w-full items-center justify-center gap-2 {isSidebarFull ? 'grid-cols-3' : 'grid-cols-2'}\">\n\t\t\t<!-- Avatar -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-1 row-span-2' : 'order-1'} flex items-center justify-center\">\n\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonclick={handleUserClick}\n\t\t\t\t\t\t\tonkeypress={(e) => handleKeyPress(e, handleUserClick)}\n\t\t\t\t\t\t\taria-label=\"User Profile\"\n\t\t\t\t\t\t\tclass=\"{isSidebarFull\n\t\t\t\t\t\t\t\t? 'flex w-full flex-col items-center justify-center rounded-lg p-2 hover:bg-surface-500/20'\n\t\t\t\t\t\t\t\t: 'btn-icon flex-col items-center justify-center'} relative text-center no-underline!\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Avatar class=\"mx-auto overflow-hidden rounded-full {isSidebarFull ? 'size-10' : 'size-9'}\">\n\t\t\t\t\t\t\t\t<Avatar.Image src={avatarUrl} alt=\"User Avatar\" class=\"h-full w-full object-cover\" />\n\t\t\t\t\t\t\t\t<Avatar.Fallback>AV</Avatar.Fallback>\n\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t{#if isSidebarFull && user?.username}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"mt-1 w-full overflow-hidden text-ellipsis whitespace-nowrap text-center text-[11px] font-medium leading-tight\"\n\t\t\t\t\t\t\t\t\ttitle={user.username}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t<Portal>\n\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t<span>{m.applayout_userprofile()}</span>\n\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t</Portal>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<!-- Theme Toggle -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-2' : 'order-2'} flex items-center justify-center\">\n\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t<!-- Wrapper div needed because ThemeToggle might not forward all events/props or to serve as reliable trigger anchor -->\n\t\t\t\t\t\t<div class=\"flex items-center justify-center\">\n\t\t\t\t\t\t\t<ThemeToggle showTooltip={false} buttonClass=\"btn-icon hover:bg-surface-500/20\" iconSize={22} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t<Portal>\n\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t<span>{themeTooltipText}</span>\n\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t</Portal>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<!-- Language Selector -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-3 row-span-2' : 'order-4'} flex items-center justify-center px-1\">\n\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t<div class=\"language-selector relative\">\n\t\t\t\t\t\t\t<Menu positioning={{ placement: 'right-start', gutter: 10 }}>\n\t\t\t\t\t\t\t\t<Menu.Trigger\n\t\t\t\t\t\t\t\t\tclass=\"preset-filled-surface-500 hover:bg-surface-400 rounded-full btn-icon flex items-center justify-center uppercase transition-colors {isSidebarFull\n\t\t\t\t\t\t\t\t\t\t? 'mb-3 w-8 h-8 text-sm'\n\t\t\t\t\t\t\t\t\t\t: 'w-8 h-8 text-xs'}\"\n\t\t\t\t\t\t\t\t\taria-label=\"Select language\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{languageTag}\n\t\t\t\t\t\t\t\t</Menu.Trigger>\n\n\t\t\t\t\t\t\t\t<Portal>\n\t\t\t\t\t\t\t\t\t<Menu.Positioner>\n\t\t\t\t\t\t\t\t\t\t<Menu.Content\n\t\t\t\t\t\t\t\t\t\t\tclass=\"card p-2 shadow-xl preset-filled-surface-100-900 z-9999 w-56 border border-surface-200 dark:border-surface-500\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<!-- Header to inform user about System Language context -->\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"px-3 py-2 text-xs font-bold text-tertiary-500 dark:text-primary-500 uppercase tracking-wider text-center border-b border-surface-200 dark:border-surface-50 mb-1\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{m.applayout_systemlanguage()}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t{#if showLanguageDropdown}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"px-2 pb-2 mb-1 border-b border-surface-200 dark:border-surface-50\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbind:value={searchQuery}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search language...\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full rounded-md bg-surface-200 dark:bg-surface-800 px-3 py-2 text-sm placeholder:text-surface-400 focus:outline-none focus:ring-2 focus:ring-primary-500 text-surface-900 dark:text-white border-none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Search languages\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"max-h-64 divide-y divide-surface-200 dark:divide-surface-700 overflow-y-auto\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#each filteredLanguages as lang (lang)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={lang}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => handleLanguageSelection(lang)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"flex w-full items-center justify-between px-3 py-2 text-left rounded-sm cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm font-medium text-surface-900 dark:text-surface-200\">{getLanguageName(lang)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs font-normal text-tertiary-500 dark:text-primary-500 ml-2\">{lang.toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t{#each availableLanguages.filter((l) => l !== languageTag) as lang (lang)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Menu.Item\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={lang}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick={() => handleLanguageSelection(lang)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"flex w-full items-center justify-between px-3 py-2 text-left  rounded-sm cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-sm font-medium\">{getLanguageName(lang)}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs font-normal text-tertiary-500 dark:text-primary-500 ml-2\">{lang.toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</Menu.Content>\n\t\t\t\t\t\t\t\t\t</Menu.Positioner>\n\t\t\t\t\t\t\t\t</Portal>\n\t\t\t\t\t\t\t</Menu>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t<Portal>\n\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t<span>{m.applayout_systemlanguage()}</span>\n\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t</Portal>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<!-- Sign Out -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-4' : 'order-3'} flex items-center justify-center\">\n\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t<button onclick={signOut} type=\"button\" aria-label=\"Sign Out\" class=\"btn-icon hover:bg-surface-500/20\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"uil:signout\" width=\"26\" class=\"\"></iconify-icon>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t<Portal>\n\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t<span>{m.applayout_signout()}</span>\n\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t</Portal>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<!-- Config -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-5' : 'order-6'} flex items-center justify-center\">\n\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonclick={handleConfigClick}\n\t\t\t\t\t\t\tonkeypress={(e) => handleKeyPress(e, handleConfigClick)}\n\t\t\t\t\t\t\taria-label=\"System Configuration\"\n\t\t\t\t\t\t\tclass=\"btn-icon hover:bg-surface-500/20\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<iconify-icon icon=\"material-symbols:build-circle\" width=\"34\" class=\"\"></iconify-icon>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip.Trigger>\n\n\t\t\t\t\t<Portal>\n\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t<span>{m.applayout_systemconfiguration()}</span>\n\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t</Portal>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\n\t\t\t<!-- Version -->\n\t\t\t<div class=\"{isSidebarFull ? 'order-6' : 'order-5'} flex items-center justify-center\">\n\t\t\t\t<VersionCheck compact={!isSidebarFull} />\n\t\t\t</div>\n\n\t\t\t<!-- GitHub (only when expanded) -->\n\t\t\t{#if isSidebarFull}\n\t\t\t\t<div class=\"order-7 flex items-center justify-center {isSidebarFull ? '' : 'col-span-2'}\">\n\t\t\t\t\t<Tooltip positioning={{ placement: 'right' }}>\n\t\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"https://github.com/SveltyCMS/SveltyCMS/discussions\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t\t\t\taria-label=\"GitHub Discussions\"\n\t\t\t\t\t\t\t\tclass=\"btn-icon flex items-center justify-center hover:bg-surface-500/20\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<iconify-icon icon=\"grommet-icons:github\" width=\"30\" class=\"\"></iconify-icon>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t\t<Portal>\n\t\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t\t<Tooltip.Content class={TOOLTIP_CLASS}>\n\t\t\t\t\t\t\t\t\t<span>{m.applayout_githubdiscussion()}</span>\n\t\t\t\t\t\t\t\t\t<Tooltip.Arrow class={ARROW_CLASS}>\n\t\t\t\t\t\t\t\t\t\t<Tooltip.ArrowTip />\n\t\t\t\t\t\t\t\t\t</Tooltip.Arrow>\n\t\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t\t</Portal>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* Scrollbar styling */\n\t.overflow-y-auto {\n\t\tscrollbar-width: thin;\n\t\tscrollbar-color: rgb(var(--color-surface-500)) transparent;\n\t}\n\n\t.overflow-y-auto::-webkit-scrollbar {\n\t\twidth: 6px;\n\t}\n\n\t.overflow-y-auto::-webkit-scrollbar-track {\n\t\tbackground: transparent;\n\t}\n\n\t.overflow-y-auto::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgb(var(--color-surface-500));\n\t\tborder-radius: 3px;\n\t}\n</style>\n","/**\n * @file src/stores/modeStateMachine.svelte.ts\n * @description Centralized state machine for managing UI modes\n *\n * Features:\n * - Standardized mode transitions (view, edit, create, modify, media)\n * - URL/State consistency\n * - Global mode store management\n */\nimport { logger } from '@shared/utils/logger';\nimport { mode, setMode } from './collectionStore.svelte';\nimport { dataChangeStore } from './store.svelte';\n\ntype Mode = 'view' | 'edit' | 'create' | 'modify' | 'media';\n\ninterface ModeTransition {\n\tfrom: Mode;\n\tto: Mode;\n\tvalidate?: () => boolean;\n\tbeforeTransition?: () => void | Promise<void>;\n\tafterTransition?: () => void | Promise<void>;\n}\n\n/**\n * Validated State Machine for UI Modes\n * Ensures transitions between View, Edit, and Create are safe and valid.\n */\nclass ModeStateMachine {\n\t// We use the existing mode store as the source of truth for now to maintain compatibility\n\t// In the future, this class should own the state directly.\n\n\tprivate transitions: ModeTransition[] = [\n\t\t{ from: 'view', to: 'create' },\n\t\t{ from: 'view', to: 'edit' },\n\t\t{ from: 'view', to: 'media' },\n\t\t{ from: 'media', to: 'view' },\n\n\t\t// Transitions from Edit/Create to View require valid state (e.g. no unsaved changes or explicit discard)\n\t\t// But often \"discard\" is the action that triggers the transition.\n\t\t// Validation here checks if we *can* transition.\n\t\t{\n\t\t\tfrom: 'create',\n\t\t\tto: 'view',\n\t\t\tvalidate: () => this.checkUnsavedChanges()\n\t\t},\n\t\t{\n\t\t\tfrom: 'edit',\n\t\t\tto: 'view',\n\t\t\tvalidate: () => this.checkUnsavedChanges()\n\t\t},\n\n\t\t// Mode switching\n\t\t{ from: 'create', to: 'edit' }, // e.g. after save?\n\t\t{ from: 'edit', to: 'create' } // clone?\n\t];\n\n\t/**\n\t * Attempt to transition to a new mode.\n\t * @returns true if transition successful, false if blocked/invalid.\n\t */\n\tasync transitionTo(newMode: Mode): Promise<boolean> {\n\t\tconst currentMode = mode.value as Mode;\n\n\t\t// Idempotent check\n\t\tif (currentMode === newMode) return true;\n\n\t\tconst transition = this.transitions.find((t) => t.from === currentMode && t.to === newMode);\n\n\t\tif (!transition) {\n\t\t\t// Allow force-reset to view from weird states, or log warning\n\t\t\tif (newMode === 'view') {\n\t\t\t\tlogger.warn(`[ModeStateMachine] Forcing transition to 'view' from unexpected state '${currentMode}'`);\n\t\t\t} else {\n\t\t\t\tlogger.error(`[ModeStateMachine] Invalid transition: ${currentMode} -> ${newMode}`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (transition?.validate && !transition.validate()) {\n\t\t\tlogger.warn(`[ModeStateMachine] Transition blocked by validation: ${currentMode} -> ${newMode}`);\n\t\t\treturn false;\n\t\t}\n\n\t\tif (transition?.beforeTransition) {\n\t\t\tawait transition.beforeTransition();\n\t\t}\n\n\t\t// Perform the state change\n\t\tsetMode(newMode);\n\n\t\tif (transition?.afterTransition) {\n\t\t\tawait transition.afterTransition();\n\t\t}\n\n\t\tlogger.debug(`[ModeStateMachine] Transitioned: ${currentMode} -> ${newMode}`);\n\t\treturn true;\n\t}\n\n\tprivate checkUnsavedChanges() {\n\t\t// If there are changes, we technically shouldn't just \"switch\" mode without saving or discarding.\n\t\t// However, this validation is strict.\n\t\t// If the user clicks \"Cancel\", we discard changes first, THEN transition.\n\t\t// So this check is correct: if changes exist, we block.\n\t\treturn !dataChangeStore.hasChanges;\n\t}\n}\n\nexport const modeStateMachine = new ModeStateMachine();\n","/**\n * @file src/utils/navigationManager.ts\n * @description Centralized navigation manager for consistent state transitions\n *\n * Features:\n * - Prevents concurrent navigation\n * - Coordinated mode transitions\n * - Loading state management\n * - Clean URL handling\n * - Event dispatch for save coordination\n */\n\nimport { goto } from '$app/navigation';\nimport { page } from '$app/state';\n\n// Stores\nimport { modeStateMachine } from '@shared/stores/modeStateMachine.svelte';\nimport { setCollectionValue } from '@shared/stores/collectionStore.svelte';\nimport { dataChangeStore } from '@shared/stores/store.svelte';\nimport { globalLoadingStore, loadingOperations } from '@shared/stores/loadingStore.svelte';\n\n// Utils\nimport { logger } from '@shared/utils/logger';\n\nexport class NavigationManager {\n\tprivate navigating = false;\n\n\tget isNavigating(): boolean {\n\t\treturn this.navigating;\n\t}\n\n\t/**\n\t * Generic wrapper to handle navigation locking, logging, and error handling\n\t */\n\tprivate async executeNavigation(action: string, task: () => Promise<void>): Promise<void> {\n\t\tif (this.navigating) {\n\t\t\tlogger.warn(`[NavigationManager] ${action} blocked - navigation in progress`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.navigating = true;\n\t\tglobalLoadingStore.startLoading(loadingOperations.navigation, action);\n\n\t\ttry {\n\t\t\tawait task();\n\t\t} catch (err) {\n\t\t\tlogger.error(`[NavigationManager] ${action} failed`, err);\n\t\t\t// We choose not to re-throw here to prevent unhandled promise rejections in UI handlers,\n\t\t\t// unless the caller specificially awaits and needs to know.\n\t\t\t// But for consistency with previous implementation, we re-throw.\n\t\t\tthrow err;\n\t\t} finally {\n\t\t\tglobalLoadingStore.stopLoading(loadingOperations.navigation);\n\t\t\tthis.navigating = false;\n\t\t}\n\t}\n\n\t// Navigate to list view (clean state)\n\tasync toList(options?: { invalidate?: boolean }): Promise<void> {\n\t\tawait this.executeNavigation('toList', async () => {\n\t\t\t// Signal save completion (prevents auto-draft/save triggers)\n\t\t\tif (typeof document !== 'undefined') {\n\t\t\t\tdocument.dispatchEvent(\n\t\t\t\t\tnew CustomEvent('entrySaved', {\n\t\t\t\t\t\tbubbles: true,\n\t\t\t\t\t\tdetail: { timestamp: Date.now() }\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Reset changes & clear entry\n\t\t\tdataChangeStore.reset();\n\t\t\tsetCollectionValue({});\n\n\t\t\t// Transition mode\n\t\t\tconst ok = await modeStateMachine.transitionTo('view');\n\t\t\tif (!ok) {\n\t\t\t\tlogger.error('[NavigationManager] Failed to transition to view mode');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cleanUrl = page.url.pathname;\n\t\t\tawait goto(cleanUrl, {\n\t\t\t\tinvalidateAll: options?.invalidate ?? true,\n\t\t\t\treplaceState: false\n\t\t\t});\n\t\t\tlogger.debug('[NavigationManager] Navigated to list view');\n\t\t});\n\t}\n\n\t// Alias for backward compatibility\n\tasync navigateToList(options?: { invalidate?: boolean }): Promise<void> {\n\t\treturn this.toList(options);\n\t}\n\n\t// Navigate to edit entry\n\tasync toEdit(entryId: string): Promise<void> {\n\t\tif (!entryId?.trim()) {\n\t\t\tlogger.warn('[NavigationManager] Edit navigation aborted: Invalid ID');\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.executeNavigation(`toEdit(${entryId})`, async () => {\n\t\t\tconst ok = await modeStateMachine.transitionTo('edit');\n\t\t\tif (!ok) {\n\t\t\t\tlogger.error('[NavigationManager] Failed to transition to edit mode');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait goto(`${page.url.pathname}?edit=${entryId}`);\n\t\t\tlogger.debug(`[NavigationManager] Navigated to edit: ${entryId}`);\n\t\t});\n\t}\n\n\t// Alias for backward compatibility\n\tasync navigateToEdit(entryId: string): Promise<void> {\n\t\treturn this.toEdit(entryId);\n\t}\n\n\t// Navigate to create view\n\tasync toCreate(): Promise<void> {\n\t\tawait this.executeNavigation('toCreate', async () => {\n\t\t\tconst ok = await modeStateMachine.transitionTo('create');\n\t\t\tif (!ok) {\n\t\t\t\tlogger.error('[NavigationManager] Failed to transition to create mode');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait goto(`${page.url.pathname}?create=true`);\n\t\t\tlogger.debug('[NavigationManager] Navigated to create view');\n\t\t});\n\t}\n\n\t// Alias for backward compatibility\n\tasync navigateToCreate(): Promise<void> {\n\t\treturn this.toCreate();\n\t}\n\n\t// Force unlock (error recovery)\n\tforceUnlock(): void {\n\t\tlogger.warn('[NavigationManager] Force unlock triggered');\n\t\tthis.navigating = false;\n\t\tglobalLoadingStore.stopLoading(loadingOperations.navigation);\n\t}\n}\n\nexport const navigationManager = new NavigationManager();\n","/**\n * @file src/stores/statusStore.svelte.ts\n * @description Centralized status logic for collection entries.\n * simplifies status management by deriving state directly from collectionValue.\n */\n\nimport { collections } from '@shared/stores/collectionStore.svelte';\nimport { updateEntryStatus } from '@shared/utils/apiClient';\nimport { showToast } from '@shared/utils/toast';\nimport type { StatusType } from '@cms-types/content';\nimport { StatusTypes } from '@cms-types/content';\nimport { logger } from '@shared/utils/logger';\n\n// Only track transient UI state\nconst statusState = $state({\n\tisLoading: false,\n\tlastToggleTime: 0\n});\n\n/**\n * Helper to determine if entry is published\n * Single source of truth: collectionValue.status\n */\nfunction getIsPublish(): boolean {\n\tconst cv = collections.activeValue;\n\n\t// 1. If we have an entry with explicit status, use it\n\tif (cv?.status) {\n\t\treturn cv.status === StatusTypes.publish;\n\t}\n\n\t// 2. Fall back to collection default status\n\tconst collectionStatus = collections.active?.status;\n\tconst defaultStatus = collectionStatus || StatusTypes.unpublish;\n\treturn defaultStatus === StatusTypes.publish;\n}\n\n// Reactively derive the publish state\nconst isPublish = $derived.by(getIsPublish);\n\n/**\n * Get current status as StatusType enum\n */\nfunction getCurrentStatus(): StatusType {\n\tconst cv = collections.activeValue;\n\n\tif (cv?.status) {\n\t\treturn cv.status as StatusType;\n\t}\n\n\tconst collectionStatus = collections.active?.status;\n\treturn (collectionStatus || StatusTypes.unpublish) as StatusType;\n}\n\nexport const statusStore = {\n\t/**\n\t * Check if current entry is published\n\t */\n\tget isPublish() {\n\t\treturn isPublish;\n\t},\n\n\t/**\n\t * Check if status operation is in progress\n\t */\n\tget isLoading() {\n\t\treturn statusState.isLoading;\n\t},\n\n\t/**\n\t * Get current status value\n\t */\n\tget currentStatus(): StatusType {\n\t\treturn getCurrentStatus();\n\t},\n\n\t/**\n\t * Toggle entry status between publish/unpublish\n\t *\n\t * @param newValue - true for publish, false for unpublish\n\t * @param componentName - Name of calling component (for logging)\n\t * @returns Promise<boolean> - true if successful\n\t */\n\tasync toggleStatus(newValue: boolean, componentName: string = 'Component'): Promise<boolean> {\n\t\t// Prevent redundant toggles\n\t\tif (newValue === isPublish) {\n\t\t\tlogger.debug(`[StatusStore] Status already ${newValue ? 'published' : 'unpublished'}`);\n\t\t\treturn true;\n\t\t}\n\n\t\t// Prevent concurrent toggles\n\t\tif (statusState.isLoading) {\n\t\t\tlogger.warn('[StatusStore] Status toggle already in progress');\n\t\t\treturn false;\n\t\t}\n\n\t\t// Throttle rapid toggles (prevent double-click issues)\n\t\tconst now = Date.now();\n\t\tif (now - statusState.lastToggleTime < 500) {\n\t\t\tlogger.debug('[StatusStore] Throttling rapid status toggle');\n\t\t\treturn false;\n\t\t}\n\n\t\tstatusState.isLoading = true;\n\t\tstatusState.lastToggleTime = now;\n\n\t\tconst newStatus = newValue ? StatusTypes.publish : StatusTypes.unpublish;\n\t\tlogger.debug(`[StatusStore] Toggling status to ${newStatus} (from ${componentName})`);\n\n\t\ttry {\n\t\t\t// Case 1: Entry exists - update via API\n\t\t\tif (collections.activeValue?._id && collections.active?._id) {\n\t\t\t\tconst result = await updateEntryStatus(String(collections.active._id), String(collections.activeValue._id), newStatus);\n\n\t\t\t\tif (result.success) {\n\t\t\t\t\t// Update local state\n\t\t\t\t\tcollections.setCollectionValue({\n\t\t\t\t\t\t...collections.activeValue,\n\t\t\t\t\t\tstatus: newStatus,\n\t\t\t\t\t\t// Clear schedule when manually toggling\n\t\t\t\t\t\t_scheduled: undefined\n\t\t\t\t\t});\n\n\t\t\t\t\tshowToast(newValue ? 'Entry published successfully' : 'Entry unpublished successfully', 'success');\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tshowToast(result.error || `Failed to ${newStatus} entry`, 'error');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Case 2: New entry (no ID yet) - update local state only\n\t\t\telse {\n\t\t\t\tcollections.setCollectionValue({\n\t\t\t\t\t...collections.activeValue,\n\t\t\t\t\tstatus: newStatus\n\t\t\t\t});\n\n\t\t\t\tlogger.debug(`[StatusStore] Status set to ${newStatus} (unsaved entry)`);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconst error = e as Error;\n\t\t\tshowToast(`Error updating status: ${error.message}`, 'error');\n\t\t\tlogger.error(`[StatusStore] Error in ${componentName}:`, error);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tstatusState.isLoading = false;\n\t\t}\n\t},\n\n\t/**\n\t * Get status value for save operations\n\t * Useful when preparing data to send to API\n\t */\n\tgetStatusForSave(): StatusType {\n\t\treturn getCurrentStatus();\n\t},\n\n\t/**\n\t * Set status directly (without API call)\n\t * Use for initialization or when status is set as part of larger save\n\t */\n\tsetStatusLocal(status: StatusType): void {\n\t\tlogger.debug(`[StatusStore] Setting status locally to ${status}`);\n\t\tcollections.setCollectionValue({\n\t\t\t...collections.activeValue,\n\t\t\tstatus\n\t\t});\n\t},\n\n\t/**\n\t * Check if entry is in a specific status\n\t */\n\thasStatus(status: StatusType): boolean {\n\t\treturn getCurrentStatus() === status;\n\t},\n\n\t/**\n\t * Check if entry is scheduled\n\t */\n\tget isScheduled(): boolean {\n\t\treturn getCurrentStatus() === StatusTypes.schedule && !!collections.activeValue?._scheduled;\n\t}\n};\n","<!--\n@file src/components/RightSidebar.svelte\n@component RightSidebar  Collection entry management (save, status, schedule, metadata)\n\n@features\n- Centralized validation & change tracking\n- Save with proper validation guard\n- Status toggle with loading state\n- Schedule publication modal\n- Clone/delete with permission checks\n- Clean display of created/updated metadata\n-->\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { page } from '$app/state';\n\timport { navigationManager } from '@shared/utils/navigationManager';\n\timport { getLocale } from '@shared/paraglide/runtime';\n\n\timport { cloneCurrentEntry, deleteCurrentEntry, saveEntry } from '@shared/utils/entryActions';\n\timport { showScheduleModal } from '@shared/utils/modalUtils';\n\timport { showToast } from '@shared/utils/toast';\n\timport * as m from '@shared/paraglide/messages';\n\n\timport { StatusTypes } from '@cms-types/content';\n\n\timport { screen } from '@shared/stores/screenSizeStore.svelte';\n\timport { collection, collectionValue, mode } from '@shared/stores/collectionStore.svelte';\n\timport { app, validationStore, dataChangeStore } from '@shared/stores/store.svelte';\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\timport { statusStore } from '@shared/stores/statusStore.svelte';\n\n\timport Toggles from './system/inputs/Toggles.svelte';\n\n\t// --- Derived from page & stores ---\n\tlet user = $derived(page.data.user);\n\tlet isAdmin = $derived(page.data.isAdmin === true);\n\n\tlet currentMode = $derived(mode.value);\n\tlet currentCollection = $derived(collection.value);\n\tlet currentEntry = $derived(collectionValue.value as Record<string, any> | null);\n\tlet currentScreenSize = $derived(screen.size);\n\n\tlet isFormValid = $derived(validationStore.isValid);\n\tlet hasChanges = $derived(dataChangeStore.hasChanges);\n\n\tlet canWrite = $derived(currentCollection?.permissions?.[user?.role]?.write !== false);\n\tlet canCreate = $derived(currentCollection?.permissions?.[user?.role]?.create !== false);\n\tlet canDelete = $derived(currentCollection?.permissions?.[user?.role]?.delete !== false);\n\n\tlet scheduleTimestamp = $derived(currentEntry?._scheduled ? Number(currentEntry._scheduled) : null);\n\n\t// --- Permissions & UI logic ---\n\tlet showSidebar = $derived(['edit', 'create'].includes(currentMode) && canWrite);\n\n\tlet shouldDisableStatusToggle = $derived(\n\t\t(currentMode === 'create' && !ui.isRightSidebarVisible) ||\n\t\t\t(currentMode === 'edit' && !ui.isRightSidebarVisible && currentScreenSize !== 'LG') ||\n\t\t\tstatusStore.isLoading\n\t);\n\n\tlet isMenuCollection = $derived(currentCollection?.name === 'Menu' || currentCollection?.slug === 'menu');\n\n\t// --- Next button handling ---\n\t// Restore logic for MegaMenu wizard support\n\tlet nextAction = $state<(() => void | Promise<void>) | null>(null);\n\n\t$effect(() => {\n\t\t// Logic: If it's the Menu collection in create mode, we ENABLE the Next button.\n\t\tif (isMenuCollection && currentMode === 'create') {\n\t\t\tapp.shouldShowNextButton = true;\n\t\t\t// If app.saveLayerStore is explicitly set (by widget?), use it.\n\t\t\tnextAction = app.saveLayerStore;\n\t\t} else {\n\t\t\tapp.shouldShowNextButton = false;\n\t\t\tnextAction = null;\n\t\t}\n\t});\n\n\t// --- Helpers ---\n\tfunction isUUID(str: string): boolean {\n\t\t// Support both standard UUIDs (with dashes) and dashless UUIDs (32 hex chars)\n\t\treturn /^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i.test(str);\n\t}\n\n\tfunction getDisplayName(value: string | undefined | null): string {\n\t\tif (!value) return 'system';\n\n\t\tif (isUUID(value)) {\n\t\t\t// If it matches the current user's ID, show their details\n\t\t\tif (user && user._id === value) {\n\t\t\t\tif (user.username && !isUUID(user.username)) return user.username;\n\t\t\t\tif (user.firstName || user.lastName) return [user.firstName, user.lastName].filter(Boolean).join(' ');\n\t\t\t\tif (user.email) return user.email.split('@')[0];\n\t\t\t}\n\t\t\t// TODO: Add lookup for other users if needed (requires a user store or API call)\n\t\t\t// For now, if it's a UUID and not the current user, it falls back to showing the UUID relative to the context,\n\t\t\t// or we could show \"User ...\"\n\t\t\t// But returning the raw UUID is better than \"system\".\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tfunction formatDate(dateStr: string | undefined | null): string {\n\t\tif (!dateStr) return '-';\n\t\ttry {\n\t\t\treturn new Date(dateStr).toLocaleString(getLocale(), {\n\t\t\t\tyear: 'numeric',\n\t\t\t\tmonth: 'short',\n\t\t\t\tday: '2-digit',\n\t\t\t\thour: '2-digit',\n\t\t\t\tminute: '2-digit'\n\t\t\t});\n\t\t} catch {\n\t\t\treturn '-';\n\t\t}\n\t}\n\n\tlet dates = $derived({\n\t\tcreated: formatDate(currentEntry?.createdAt as string),\n\t\tupdated: formatDate(currentEntry?.updatedAt as string)\n\t});\n\n\t// --- Actions ---\n\tfunction handleClone() {\n\t\tcloneCurrentEntry();\n\t}\n\n\tfunction handleDelete() {\n\t\tdeleteCurrentEntry(isAdmin);\n\t}\n\n\tasync function toggleStatus(newValue: boolean): Promise<boolean> {\n\t\treturn await statusStore.toggleStatus(newValue, 'RightSidebar');\n\t}\n\n\tfunction openSchedule() {\n\t\tshowScheduleModal({\n\t\t\tinitialAction: currentEntry?.status === StatusTypes.publish ? 'publish' : 'unpublish',\n\t\t\tonSchedule: (date: Date, action: string) => {\n\t\t\t\tconst timestamp = date.getTime();\n\t\t\t\tcollectionValue.value = {\n\t\t\t\t\t...currentEntry!,\n\t\t\t\t\tstatus: StatusTypes.schedule,\n\t\t\t\t\t_scheduled: timestamp\n\t\t\t\t};\n\t\t\t\tshowToast(`Entry scheduled for ${action}.`, 'success');\n\t\t\t}\n\t\t});\n\t}\n\n\tasync function save() {\n\t\tif (!isFormValid) {\n\t\t\tshowToast(m.validation_fix_before_save(), 'warning');\n\t\t\treturn;\n\t\t}\n\n\t\t// In edit mode: no changes  just navigate back\n\t\tif (currentMode === 'edit' && !hasChanges) {\n\t\t\tlogger.debug('[RightSidebar] No changes  navigating to list');\n\t\t\tui.forceUpdate();\n\t\t\tawait navigationManager.navigateToList();\n\t\t\treturn;\n\t\t}\n\n\t\t// Prepare data\n\t\tconst dataToSave = { ...currentEntry! };\n\n\t\tif (scheduleTimestamp) {\n\t\t\tdataToSave.status = StatusTypes.schedule;\n\t\t\tdataToSave._scheduled = scheduleTimestamp;\n\t\t} else {\n\t\t\tdataToSave.status = statusStore.getStatusForSave();\n\t\t\tdelete dataToSave._scheduled;\n\t\t}\n\n\t\t// Metadata\n\t\tif (currentMode === 'create') {\n\t\t\tdataToSave.createdBy = getDisplayName(user?.username);\n\t\t}\n\t\tdataToSave.updatedBy = getDisplayName(user?.username);\n\n\t\tif (process.env.NODE_ENV !== 'production') {\n\t\t\tlogger.debug('[RightSidebar] Saving entry:', dataToSave);\n\t\t}\n\n\t\tconst success = await saveEntry(dataToSave);\n\t\tif (!success) return;\n\n\t\tui.forceUpdate();\n\t\tawait navigationManager.navigateToList();\n\t}\n</script>\n\n{#if showSidebar}\n\t<div class=\"flex h-full flex-col justify-between px-3 py-4\">\n\t\t<!-- Special \"Next\" button for Menu wizard -->\n\t\t{#if app.shouldShowNextButton && currentMode === 'create' && isMenuCollection}\n\t\t\t<button type=\"button\" onclick={nextAction!} class=\"btn preset-filled-primary-500 w-full gap-2 shadow-lg\">\n\t\t\t\t<iconify-icon icon=\"carbon:next-filled\" width=\"20\"></iconify-icon>\n\t\t\t\t{m.button_next()}\n\t\t\t</button>\n\t\t{:else}\n\t\t\t<!-- Main actions -->\n\t\t\t<header class=\"flex flex-col gap-3\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonclick={save}\n\t\t\t\t\tdisabled={!isFormValid || !canWrite}\n\t\t\t\t\tclass=\"btn preset-filled-primary-500 w-full gap-2 shadow-lg transition-all\"\n\t\t\t\t\tclass:opacity-50={!isFormValid || !canWrite}\n\t\t\t\t\tclass:cursor-not-allowed={!isFormValid || !canWrite}\n\t\t\t\t\taria-label=\"Save\"\n\t\t\t\t\ttitle={!isFormValid ? 'Fix validation errors before saving' : 'Save changes'}\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"material-symbols:save\" width=\"20\"></iconify-icon>\n\t\t\t\t\t{m.button_save()}\n\t\t\t\t</button>\n\n\t\t\t\t<div class=\"btn gradient-secondary w-full gap-2 shadow-md\">\n\t\t\t\t\t<Toggles\n\t\t\t\t\t\tvalue={statusStore.isPublish}\n\t\t\t\t\t\tlabel={statusStore.isPublish ? m.status_publish() : m.status_unpublish()}\n\t\t\t\t\t\tlabelColor={statusStore.isPublish ? 'text-primary-500' : 'text-error-500'}\n\t\t\t\t\t\ticonOn=\"ic:baseline-check-circle\"\n\t\t\t\t\t\ticonOff=\"material-symbols:close\"\n\t\t\t\t\t\tdisabled={shouldDisableStatusToggle}\n\t\t\t\t\t\tonChange={toggleStatus}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{#if currentMode === 'edit'}\n\t\t\t\t\t<div class=\"flex w-full flex-col gap-2\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonclick={handleClone}\n\t\t\t\t\t\t\tdisabled={!canCreate}\n\t\t\t\t\t\t\tclass=\"btn gradient-secondary gradient-secondary-hover w-full gap-2 text-white shadow-md\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<iconify-icon icon=\"bi:clipboard-data-fill\" width=\"18\"></iconify-icon>\n\t\t\t\t\t\t\tClone <span class=\"font-semibold text-primary-500\">{currentCollection?.name}</span>\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button type=\"button\" onclick={handleDelete} disabled={!canDelete} class=\"btn preset-filled-error-500 w-full gap-2 shadow-md\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"icomoon-free:bin\" width=\"18\"></iconify-icon>\n\t\t\t\t\t\t\t{m.button_delete()}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</header>\n\n\t\t\t<main class=\"mt-6 flex w-full flex-col gap-4 text-left\">\n\t\t\t\t<div class=\"border-b border-surface-300 pb-2 dark:border-surface-600\">\n\t\t\t\t\t<h3 class=\"text-center text-sm font-bold uppercase tracking-wide text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t{m.siedabar_publish_options()}\n\t\t\t\t\t</h3>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"space-y-2\">\n\t\t\t\t\t{#if scheduleTimestamp}\n\t\t\t\t\t\t<p class=\"text-sm font-medium text-surface-600 dark:text-surface-300\">\n\t\t\t\t\t\t\t{m.sidebar_will_publish_on()}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t{/if}\n\t\t\t\t\t<button\n\t\t\t\t\t\tonclick={openSchedule}\n\t\t\t\t\t\tclass=\"btn preset-filled-surface-500 hover:preset-filled-primary-500-hover w-full justify-start gap-2 text-left transition-colors\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"bi:clock\" width=\"16\"></iconify-icon>\n\t\t\t\t\t\t<span class=\"text-sm text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t\t{scheduleTimestamp ? new Date(scheduleTimestamp).toLocaleString(getLocale()) : 'Schedule publication...'}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"space-y-3\">\n\t\t\t\t\t<div class=\"space-y-1\">\n\t\t\t\t\t\t<p class=\"text-sm font-medium\">{m.sidebar_createdby()}</p>\n\t\t\t\t\t\t<div class=\"preset-filled-surface-500 rounded-lg p-3 text-center\">\n\t\t\t\t\t\t\t<span class=\"text-sm font-semibold text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t\t\t{getDisplayName(currentEntry?.createdBy as string)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if currentEntry?.updatedBy}\n\t\t\t\t\t\t<div class=\"space-y-1\">\n\t\t\t\t\t\t\t<p class=\"text-sm font-medium text-surface-600 dark:text-surface-300\">Last updated by</p>\n\t\t\t\t\t\t\t<div class=\"preset-filled-surface-500 rounded-lg p-3 text-center\">\n\t\t\t\t\t\t\t\t<span class=\"text-sm font-semibold text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t\t\t\t{getDisplayName(currentEntry?.updatedBy as string)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</main>\n\n\t\t\t<footer class=\"mt-6 border-t border-surface-300 pt-4 dark:border-surface-600\">\n\t\t\t\t<div class=\"space-y-2 text-xs\">\n\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span class=\"font-medium capitalize\">Created:</span>\n\t\t\t\t\t\t<span class=\"font-bold text-tertiary-500 dark:text-primary-500\">{dates.created}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span class=\"font-medium capitalize\">Updated:</span>\n\t\t\t\t\t\t<span class=\"font-bold text-tertiary-500 dark:text-primary-500\">{dates.updated}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{#if currentMode === 'create'}\n\t\t\t\t\t<div class=\"mt-3 text-center text-xs text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t{new Date().toLocaleString(getLocale(), {\n\t\t\t\t\t\t\tyear: 'numeric',\n\t\t\t\t\t\t\tmonth: 'short',\n\t\t\t\t\t\t\tday: 'numeric',\n\t\t\t\t\t\t\thour: '2-digit',\n\t\t\t\t\t\t\tminute: '2-digit'\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</footer>\n\t\t{/if}\n\t</div>\n{/if}\n","<!--\n @file src/routes/+layout.svelte\n @component\n **This Svelte component serves as the layout for the entire application**\n\n ### Features\n - Paraglide i18n integration\n - Theme Management\n - Skeleton v4 Toasts & Modals\n -->\n\n<script lang=\"ts\">\n\t// Selected theme\n\timport '@shared/theme/app.css';\n\t// Register Iconify custom element globally\n\timport 'iconify-icon';\n\n\timport { page } from '$app/state';\n\timport { onMount, untrack } from 'svelte';\n\timport { browser } from '$app/environment';\n\n\t// Skeleton v4\n\timport { app } from '@shared/stores/store.svelte';\n\timport ToastManager from '@cms/components/system/ToastManager.svelte';\n\t// import DialogManager from '@shared/components/system/DialogManager.svelte';\n\n\t// Paraglide locale bridge\n\timport { locales as availableLocales, getLocale, setLocale } from '@shared/paraglide/runtime';\n\n\t// Theme management\n\timport { themeStore, initializeThemeStore, initializeDarkMode } from '@shared/stores/themeStore.svelte';\n\n\t// Global Settings\n\timport { initPublicEnv, publicEnv } from '@shared/stores/globalSettings.svelte';\n\n\t// Stores\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\n\t// Components\n\timport LeftSidebar from '@shared/components/LeftSidebar.svelte';\n\timport RightSidebar from '@shared/components/RightSidebar.svelte';\n\n\t// Props\n\tinterface Props {\n\t\tchildren?: import('svelte').Snippet;\n\t}\n\tconst { children }: Props = $props();\n\n\t// ============================================================================\n\t// State Management\n\t// ============================================================================\n\n\tlet currentLocale = $state(getLocale());\n\tlet isMounted = $state(false);\n\n\t// ============================================================================\n\t// Initialization\n\t// ============================================================================\n\n\t// Initialize public environment settings from server data\n\t// Note: Only access page.data after mount to avoid hydration issues\n\t$effect(() => {\n\t\tif (browser && page.data?.settings) {\n\t\t\tinitPublicEnv(page.data.settings);\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Mount Lifecycle\n\t// ============================================================================\n\n\tonMount(() => {\n\t\tconsole.log('[RootLayout] Mounting in', browser ? 'browser' : 'server');\n\n\t\t// URL is the source of truth on initial load\n\t\tconst urlLocale = getLocale();\n\t\tif (urlLocale && availableLocales.includes(urlLocale as any)) {\n\t\t\tif (app.systemLanguage !== urlLocale) {\n\t\t\t\tconsole.log(`[RootLayout] Aligning store (${app.systemLanguage}) to URL (${urlLocale})`);\n\t\t\t\tapp.systemLanguage = urlLocale as any;\n\t\t\t\tcurrentLocale = urlLocale;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize dark mode\n\t\tinitializeDarkMode();\n\n\t\tisMounted = true;\n\n\t\t// Check for flash messages (e.g., from login redirect)\n\t\tconst flashMessageJson = sessionStorage.getItem('flashMessage');\n\t\tif (flashMessageJson) {\n\t\t\ttry {\n\t\t\t\tconst flashMessage = JSON.parse(flashMessageJson);\n\t\t\t\tsessionStorage.removeItem('flashMessage');\n\n\t\t\t\t// Import toaster dynamically to avoid circular deps (though it's available in stores)\n\t\t\t\t// We can also import it directly if we want, but dynamic is safer for layout\n\t\t\t\timport('@shared/stores/store.svelte').then(({ toaster }) => {\n\t\t\t\t\tconst opts = {\n\t\t\t\t\t\ttitle: flashMessage.title,\n\t\t\t\t\t\tdescription: flashMessage.description,\n\t\t\t\t\t\tduration: flashMessage.duration || 4000\n\t\t\t\t\t};\n\n\t\t\t\t\t// Small delay to ensure ToastManager is ready\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (flashMessage.type === 'success') {\n\t\t\t\t\t\t\ttoaster.success(opts);\n\t\t\t\t\t\t} else if (flashMessage.type === 'warning') {\n\t\t\t\t\t\t\ttoaster.warning(opts);\n\t\t\t\t\t\t} else if (flashMessage.type === 'error') {\n\t\t\t\t\t\t\ttoaster.error(opts);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoaster.info(opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('Failed to parse flash message:', e);\n\t\t\t\tsessionStorage.removeItem('flashMessage');\n\t\t\t}\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Reactive Locale Syncing\n\t// ============================================================================\n\n\t$effect(() => {\n\t\t// Guard: Only sync after mount\n\t\tif (!isMounted) return;\n\n\t\tconst desired = app.systemLanguage;\n\t\tconst current = untrack(() => currentLocale);\n\n\t\t// Only update if there's an actual change\n\t\tif (desired && availableLocales.includes(desired as any) && current !== desired) {\n\t\t\tconsole.log('[RootLayout] Store changed, updating locale:', desired);\n\n\t\t\t// Update Paraglide locale (handles routing internally)\n\t\t\tsetLocale(desired as any, { reload: false });\n\t\t\tcurrentLocale = desired;\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Theme Auto-Refresh\n\t// ============================================================================\n\n\t$effect(() => {\n\t\tif (!themeStore.autoRefreshEnabled || !browser) return;\n\n\t\tconst interval = 30 * 60 * 1000; // 30 minutes\n\t\tconst intervalId = setInterval(() => {\n\t\t\tinitializeThemeStore().catch(console.error);\n\t\t}, interval);\n\n\t\treturn () => clearInterval(intervalId);\n\t});\n\n\t// ============================================================================\n\t// Derived State\n\t// ============================================================================\n\n\t// Get the site name from publicEnv store (safer for SSR/CSR transitions)\n\tconst siteName = $derived(publicEnv?.SITE_NAME || 'SveltyCMS');\n\n\t// Determine if we should show sidebars based on the current route\n\t// Sidebars are hidden on login and setup pages\n\tconst showSidebars = $derived.by(() => {\n\t\tconst path = page.url.pathname;\n\t\tconst isAuthRoute = path.includes('/login') || path.includes('/register');\n\t\tconst isSetupRoute = path.includes('/setup');\n\t\treturn !isAuthRoute && !isSetupRoute && isMounted;\n\t});\n</script>\n\n<svelte:head>\n\t<title>{siteName}</title>\n</svelte:head>\n\n{#key currentLocale}\n\t<ToastManager position=\"bottom-right\" />\n\n\t<div class=\"flex h-screen w-screen overflow-hidden bg-surface-50 dark:bg-surface-900\">\n\t\t{#if showSidebars && ui.isLeftSidebarVisible}\n\t\t\t<aside\n\t\t\t\tclass=\"h-full border-r border-surface-200 bg-white transition-all duration-300 dark:border-surface-800 dark:bg-surface-900 {ui.state\n\t\t\t\t\t.leftSidebar === 'full'\n\t\t\t\t\t? 'w-72'\n\t\t\t\t\t: 'w-20'}\"\n\t\t\t>\n\t\t\t\t<LeftSidebar />\n\t\t\t</aside>\n\t\t{/if}\n\n\t\t<main class=\"relative flex h-full flex-1 flex-col overflow-hidden\">\n\t\t\t<div class=\"h-full w-full overflow-auto\">\n\t\t\t\t{@render children?.()}\n\t\t\t</div>\n\t\t</main>\n\n\t\t{#if showSidebars && ui.isRightSidebarVisible}\n\t\t\t<aside class=\"h-full w-72 border-l border-surface-200 bg-white transition-all duration-300 dark:border-surface-800 dark:bg-surface-900\">\n\t\t\t\t<RightSidebar />\n\t\t\t</aside>\n\t\t{/if}\n\t</div>\n{/key}\n"],"file":"0.C4-KrlGS.js"}