{"version":3,"file":"ColorSelector.js","sources":["../../../../src/widgets/core/RichText/components/ColorSelector.svelte"],"sourcesContent":["<!--\n@file: /src/components/ColorSelector.svelte\n@component\n**Tiptp ColorSelector**\n\n### Props\n- `color`: string\n- `show`: boolean\n- `key`: string\n- `active`: string\n- `onChange`: (color: string) => void\n\n### Features\n- Click to edit\n- Enter to save\n- Escape to cancel\n-->\n\n<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport ColorPicker, { ChromeVariant } from 'svelte-awesome-color-picker';\n\n\tinterface Props {\n\t\tcolor?: string;\n\t\tshow?: boolean;\n\t\tkey?: string; // Unique key for this dropdown instance\n\t\tactive?: string; // Tracks the currently active dropdown on the page\n\t\tonChange?: (color: string) => void;\n\t}\n\n\tlet { color = $bindable(''), show = true, key = 'color-selector', active = $bindable(''), onChange }: Props = $props();\n\n\tlet expanded = $state(false);\n\tlet wrapperRef = $state<HTMLDivElement | null>(null);\n\n\t// Effect to call onChange when color changes\n\t$effect(() => {\n\t\tif (onChange) {\n\t\t\tonChange(color);\n\t\t}\n\t});\n\n\t// Effect to close this component if another one becomes active\n\t$effect(() => {\n\t\tif (key !== active) {\n\t\t\texpanded = false;\n\t\t}\n\t});\n\n\tfunction close() {\n\t\texpanded = false;\n\t\tif (active === key) {\n\t\t\tactive = '';\n\t\t}\n\t}\n\n\tfunction toggle() {\n\t\tconst wasExpanded = expanded;\n\t\t// Ensure other dropdowns are closed before opening this one\n\t\tif (!wasExpanded) {\n\t\t\tactive = key;\n\t\t}\n\t\texpanded = !wasExpanded;\n\n\t\t// If we just closed it, clear the active key\n\t\tif (wasExpanded) {\n\t\t\tclose();\n\t\t}\n\t}\n\n\tonMount(() => {\n\t\tconst handleClickOutside = (event: MouseEvent) => {\n\t\t\tif (wrapperRef && !wrapperRef.contains(event.target as Node)) {\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\n\t\tconst handleKeydown = (event: KeyboardEvent) => {\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener('click', handleClickOutside);\n\t\tdocument.addEventListener('keydown', handleKeydown);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('click', handleClickOutside);\n\t\t\tdocument.removeEventListener('keydown', handleKeydown);\n\t\t};\n\t});\n\n\t// Action to dynamically position the palette to avoid overflow\n\tfunction setPosition(node: HTMLDivElement) {\n\t\tif (!wrapperRef) return;\n\t\tconst parent = wrapperRef.parentElement as HTMLElement;\n\t\tconst { left: wrapperLeft } = wrapperRef.getBoundingClientRect();\n\t\tconst { left: parentLeft, width: parentWidth } = parent.getBoundingClientRect();\n\n\t\tconst leftPos = wrapperLeft - parentLeft;\n\t\tif (leftPos + node.offsetWidth > parentWidth) {\n\t\t\tnode.style.left = 'auto';\n\t\t\tnode.style.right = '0';\n\t\t} else {\n\t\t\tnode.style.right = 'auto';\n\t\t\tnode.style.left = '0'; // Position relative to the wrapper\n\t\t}\n\t}\n</script>\n\n<div class=\"wrapper\" class:hidden={!show} bind:this={wrapperRef}>\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={toggle}\n\t\tonkeydown={(e) => (e.key === 'Enter' || e.key === ' ') && toggle()}\n\t\taria-label=\"Select color\"\n\t\taria-expanded={expanded}\n\t\taria-controls=\"color-palette-{key}\"\n\t\tclass=\"selected btn-sm arrow\"\n\t\tclass:arrow_up={expanded}\n\t>\n\t\t<iconify-icon icon=\"fluent-mdl2:color-solid\" width=\"20\"></iconify-icon>\n\t</button>\n\t{#if expanded}\n\t\t<div id=\"color-palette-{key}\" class=\"palette\" use:setPosition>\n\t\t\t<ColorPicker bind:hex={color} components={ChromeVariant} sliderDirection=\"horizontal\" isDialog={false} />\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t.selected {\n\t\tdisplay: flex;\n\t\twidth: 100%;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: 5px;\n\t}\n\t.wrapper {\n\t\tz-index: 10;\n\t\tposition: relative;\n\t\tbox-shadow: 0px 0px 3px 0px #bfbfbf;\n\t\tpadding: 2px;\n\t\tcursor: pointer;\n\t\tborder-radius: 4px;\n\t}\n\t.palette {\n\t\tposition: absolute;\n\t\ttop: 100%;\n\t\tpadding: 10px;\n\t\tmargin-top: 10px;\n\t\tcursor: pointer;\n\t\tbackground: #fff;\n\t\tborder-radius: 5px;\n\t\tbox-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n\t}\n\t.arrow::after {\n\t\tcontent: '';\n\t\tborder: solid #6b6b6b;\n\t\tborder-width: 0 2px 2px 0;\n\t\tdisplay: inline-block;\n\t\tpadding: 3px;\n\t\ttransform: rotate(45deg);\n\t\ttransition: transform 0.2s ease-in-out;\n\t\tmargin-left: auto;\n\t}\n\n\t.arrow_up::after {\n\t\ttransform: rotate(-135deg);\n\t}\n</style>\n"],"names":["$$renderer","$.attr_class","$.attr","$.stringify"],"mappings":";;wCAkBA;;MAYO,QAAkB;AAAA,MAAK,OAAO;AAAA,MAAM,MAAM;AAAA,MAAkB,SAAmB;AAAA,MAAK;AAAA;AAEtF,QAAA,WAAkB;;;;AA8Ea,MAAAA,YAAA,KAAA,OAAAC,WAAA,0BAAA,QAAA,EAAA,UAAA,CAAA,KAAI,CAAA,CAAA,mDAAAC,KAAA,iBAMvB,QAAQ,CAAA,GAAAA,KAAA,iBAAA,iBAAAC,UACO,GAAG,gFAEjB,SAAQ,CAAA,CAAA,oFAAA;;;;;;;;;;;;;EAXlB,CAAA;;"}