{"version":3,"file":"SystemMessagesWidget.js","sources":["../../../../../../shared/features/src/dashboard/widgets/SystemMessagesWidget.svelte"],"sourcesContent":["<!--\n@file src/routes/(app)/dashboard/widgets/SystemMessagesWidget.svelte\n@component\n**Dashboard widget for displaying system messages with improved rendering and error handling**\n\n@example\n<SystemMessagesWidget label=\"System Messages\" />\n\n### Props\n- `label`: The label for the widget (default: 'System Messages')\n\n### Features:\n- Responsive doughnut chart visualization\n- Theme-aware rendering (light/dark mode support)\n- Real-time data updates\n- Customizable widget properties (size, position, etc.)\n- Improved error handling and data validation\n- Enhanced debugging and logging\n-->\n<script lang=\"ts\" module>\n\texport const widgetMeta = {\n\t\tname: 'System Messages',\n\t\ticon: 'mdi:message-alert-outline',\n\t\tdefaultSize: { w: 1, h: 2 }\n\t};\n</script>\n\n<script lang=\"ts\">\n\timport BaseWidget from '../BaseWidget.svelte';\n\timport type { WidgetSize } from '@cms-types';\n\n\t// Defines the structure for a single system message.\n\tinterface SystemMessage {\n\t\ttitle: string;\n\t\ttimestamp: string;\n\t\tbody: string;\n\t}\n\n\t// Defines the shape of the data payload fetched from the API.\n\ttype FetchedData = SystemMessage[] | undefined;\n\n\tconst {\n\t\tlabel = 'System Messages',\n\t\ttheme = 'light' as 'light' | 'dark',\n\t\ticon = 'mdi:message-alert-outline',\n\t\twidgetId = undefined,\n\t\tsize = { w: 1, h: 2 } as WidgetSize,\n\t\tonSizeChange = (_newSize: WidgetSize) => {},\n\t\tonRemove = () => {}\n\t}: {\n\t\tlabel?: string;\n\t\ttheme?: 'light' | 'dark';\n\t\ticon?: string;\n\t\twidgetId?: string;\n\t\tsize?: WidgetSize;\n\t\tonSizeChange?: (newSize: WidgetSize) => void;\n\t\tonRemove?: () => void;\n\t} = $props();\n</script>\n\n<BaseWidget\n\t{label}\n\t{theme}\n\tendpoint=\"/api/dashboard/systemMessages\"\n\tpollInterval={30000}\n\t{icon}\n\t{widgetId}\n\t{size}\n\t{onSizeChange}\n\tonCloseRequest={onRemove}\n>\n\t{#snippet children({ data: fetchedData }: { data: FetchedData })}\n\t\t{#if fetchedData && Array.isArray(fetchedData) && fetchedData.length > 0}\n\t\t\t<div class=\"grid gap-2\" style=\"max-height: calc({size.h} * 120px - 40px); overflow-y: auto;\" role=\"list\" aria-label=\"System messages\">\n\t\t\t\t{#each fetchedData.slice(0, 5) as message}\n\t\t\t\t\t<div class=\"rounded-lg bg-surface-100/80 px-3 py-2 text-xs dark:bg-surface-700/60\" role=\"listitem\">\n\t\t\t\t\t\t<div class=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t<strong class=\"text-text-900 dark:text-text-100 text-sm\" aria-label=\"Message title\">{message.title}</strong>\n\t\t\t\t\t\t\t<small class=\"shrink-0 pl-2 text-surface-500 dark:text-surface-50\" aria-label=\"Timestamp\">\n\t\t\t\t\t\t\t\t{new Date(message.timestamp).toLocaleString()}\n\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class=\"mt-1 text-surface-700 dark:text-surface-300\" aria-label=\"Message body\">{message.body}</p>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex flex-1 flex-col items-center justify-center py-6 text-xs text-gray-500 dark:text-gray-400\" role=\"status\" aria-live=\"polite\">\n\t\t\t\t<iconify-icon icon=\"mdi:alert-circle-outline\" width=\"32\" class=\"mb-2 text-surface-400 dark:text-surface-500\" aria-hidden=\"true\"\n\t\t\t\t></iconify-icon>\n\t\t\t\t<span>No system messages</span>\n\t\t\t</div>\n\t\t{/if}\n\t{/snippet}\n</BaseWidget>\n"],"names":["$$renderer","$.attr_style","$.stringify","$.ensure_array_like","$.escape"],"mappings":";;MAoBc,aAAU;AAAA,EACtB,MAAM;AAAA,EACN,MAAM;AAAA,EACN,eAAe,GAAG,GAAG,GAAG,EAAC;;;wCAI3B;;MAeE,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,GAAG,GAAG,GAAG,EAAC;AAAA,MACnB,eAAY,CAAI,aAAyB;AAAA,MAAC;AAAA,MAC1C,iBAAiB;AAAA,MAAC;AAAA;;UAuBT,oBAAQA,aAAA,EAAG,MAAM,YAAW,GAAA;YAChC,eAAe,MAAM,QAAQ,WAAW,KAAK,YAAY,SAAS,GAAC;;AACtB,UAAAA,YAAA,KAAA,0BAAAC,WAAA,oBAAAC,UAAA,KAAK,CAAC,CAAA,qCAAA,CAAA,oDAAA;AAC/C,gBAAA,aAAAC,kBAAA,YAAY,MAAM,GAAG,CAAC,CAAA;;gBAAK,UAAO,WAAA,OAAA;AAG+C,YAAAH,YAAA,KAAA,wOAAAI,YAAA,QAAQ,KAAK,CAAA,uGAAAA,YAAA,IAE5F,KAAK,QAAQ,SAAS,EAAE,eAAc,CAAA,CAAA,mGAAAA,YAGqC,QAAQ,IAAI,CAAA,YAAA;AAAA;;;;;;;;;QArBlG;AAAA,QACA;AAAA;sBAEa;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,wBACe;AAAA,QAEN;AAAA;;EAbH,CAAA;;"}