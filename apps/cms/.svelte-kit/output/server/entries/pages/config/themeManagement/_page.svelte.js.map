{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/routes/config/themeManagement/+page.svelte"],"sourcesContent":["<!-- \n@file src/routes/(app)/config/themeManagement/+page.svelte\n@description This file manages the theme management page. It provides a user-friendly interface for managing themes and custom themes. \n-->\n\n<script lang=\"ts\">\n\timport { themeStore, updateTheme } from '@shared/stores/themeStore.svelte';\n\timport type { DatabaseId } from '@cms-types';\n\timport type { Theme } from '@shared/database/dbInterface';\n\timport { dateToISODateString } from '@shared/utils/dateUtils';\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Component\n\timport PageTitle from '@cms/components/PageTitle.svelte';\n\n\tlet selectedTheme = $state<any | null>(null);\n\tlet livePreviewTheme = $state<any | null>(null);\n\n\t// This will hold the custom themes\n\tlet customThemes = $state<Theme[]>([]);\n\n\t// Load custom themes dynamically\n\tloadCustomThemes();\n\n\tasync function loadCustomThemes() {\n\t\t// Use Vite's glob feature to load all theme.css files from the custom themes directory\n\t\tconst customThemesFiles = import.meta.glob('../themes/custom/*/theme.css', { eager: true });\n\n\t\t// Convert the imported files to Theme objects\n\t\tcustomThemes = Object.entries(customThemesFiles).map(([key, value], index) => {\n\t\t\tconst nowIso = dateToISODateString(new Date());\n\t\t\treturn {\n\t\t\t\t_id: `custom-theme-${index}` as unknown as DatabaseId,\n\t\t\t\tname: key.split('/')[3],\n\t\t\t\tpath: value as string,\n\t\t\t\tisDefault: false,\n\t\t\t\tisActive: false,\n\t\t\t\tconfig: { tailwindConfigPath: '', assetsPath: '' },\n\t\t\t\tcreatedAt: nowIso,\n\t\t\t\tupdatedAt: nowIso\n\t\t\t} as Theme;\n\t\t});\n\t}\n\n\t// Combine default theme with dynamically loaded custom themes\n\tconst themes = $derived([\n\t\t{\n\t\t\t_id: 'default-theme' as unknown as DatabaseId,\n\t\t\tname: 'SveltyCMSTheme',\n\t\t\tpath: '/path/to/default/theme.css',\n\t\t\tisDefault: true,\n\t\t\tisActive: true,\n\t\t\tconfig: { tailwindConfigPath: '', assetsPath: '' },\n\t\t\tcreatedAt: dateToISODateString(new Date()),\n\t\t\tupdatedAt: dateToISODateString(new Date())\n\t\t} as Theme,\n\t\t...customThemes\n\t]);\n\n\t// Effects for theme changes\n\t$effect.root(() => {\n\t\tif (selectedTheme) updateTheme(selectedTheme.name);\n\t});\n\n\t$effect.root(() => {\n\t\tif (livePreviewTheme) updateTheme(livePreviewTheme.name);\n\t});\n\n\t// Initialize selectedTheme with current theme\n\t$effect.root(() => {\n\t\tif (themeStore.currentTheme) {\n\t\t\tselectedTheme = themeStore.currentTheme;\n\t\t}\n\t});\n\n\tfunction applyTheme(theme: Theme) {\n\t\tselectedTheme = theme;\n\t\tlivePreviewTheme = null;\n\t}\n\n\tfunction previewThemeChange(theme: Theme) {\n\t\tlivePreviewTheme = theme;\n\t}\n\n\tfunction resetPreview() {\n\t\tlivePreviewTheme = null;\n\t\tif (selectedTheme) updateTheme(selectedTheme.name);\n\t}\n\n\tfunction handleThemeChange() {\n\t\tif (selectedTheme) {\n\t\t\tapplyTheme(selectedTheme);\n\t\t}\n\t}\n</script>\n\n<!-- Page Title with Back Button -->\n<PageTitle name=\"Theme Management\" icon=\"ph:layout\" showBackButton={true} backUrl=\"/config\" />\n\n<div class=\"mb-4\">\n\t<label for=\"theme-select\" class=\"mb-2 block font-bold\">Current System Theme:</label>\n\t<select id=\"theme-select\" bind:value={selectedTheme} class=\"select\" onchange={handleThemeChange}>\n\t\t{#each themes as theme (theme._id)}\n\t\t\t<option value={theme}>{theme.name}</option>\n\t\t{/each}\n\t</select>\n</div>\n\n<div class=\"mt-4\">\n\t<h3 class=\"font-bold\">Available Themes:</h3>\n\t{#each customThemes as theme (theme._id)}\n\t\t<button\n\t\t\tonmouseover={() => previewThemeChange(theme)}\n\t\t\tonfocus={() => previewThemeChange(theme)}\n\t\t\tonmouseout={resetPreview}\n\t\t\tonblur={resetPreview}\n\t\t\tclass=\"preset-outline-tertiary-500 btn mt-2\"\n\t\t>\n\t\t\tPreview {theme.name}\n\t\t</button>\n\t{/each}\n</div>\n\n{#if customThemes.length === 0}\n\t<p class=\"my-2 text-center text-tertiary-500 dark:text-primary-500 sm:text-left\">\n\t\tThere are currently no custom themes available. Visit the SveltyCMS marketplace to find new themes.\n\t</p>\n\n\t<!-- Market Place -->\n\t<a\n\t\thref=\"https://www.sveltyCMS.com\"\n\t\ttarget=\"_blank\"\n\t\trel=\"noopener noreferrer\"\n\t\taria-label={m.marketplace()}\n\t\tclass=\"preset-outlined-primary-500 btn w-full gap-2 py-6\"\n\t>\n\t\t<iconify-icon icon=\"icon-park-outline:shopping-bag\" width=\"28\" class=\"text-white\"></iconify-icon>\n\t\t<p class=\"uppercase\">{m.marketplace()}</p>\n\t</a>\n{/if}\n"],"names":["$$renderer","$.escape","$.attr","m.marketplace"],"mappings":";;;;;;wCAKA;AAWK,QAAA,gBAAmC;QAInC,eAAY,CAAA;AAGhB,qBAAgB;AAED,mBAAA,mBAAmB;YAE3B,oBAAoB,uBAAA,OAAA,EAAA;AAG1B,qBAAe,OAAO,QAAQ,iBAAiB,EAAE,IAAG,CAAA,CAAG,KAAK,KAAK,GAAG,UAAU;cACvE,SAAS,oBAAmB,oBAAK,MAAI;;UAE1C,qBAAqB,KAAK;AAAA,UAC1B,MAAM,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,UACtB,MAAM;AAAA,UACN,WAAW;AAAA,UACX,UAAU;AAAA,UACV,UAAU,oBAAoB,IAAI,YAAY,GAAE;AAAA,UAChD,WAAW;AAAA,UACX,WAAW;AAAA;MAEb,CAAC;AAAA,IACF;UAGM,SAAM;AAAA;QAEV,KAAK;AAAA,QACL,MAAM;AAAA,QACN,MAAM;AAAA,QACN,WAAW;AAAA,QACX,UAAU;AAAA,QACV,UAAU,oBAAoB,IAAI,YAAY,GAAE;AAAA,QAChD,WAAW,oBAAmB,oBAAK,MAAI;AAAA,QACvC,WAAW,oBAAmB,oBAAK,KAAI,CAAA;AAAA;MAErC,GAAA;AAAA;AAiCK,aAAA,oBAAoB;AAAA,IAI7B;;;;sBAImE;AAAA;;;;;;eAI7B;AAAA;kBAAwC;AAAA;;;6CACtE,MAAM;;cAAI,QAAK,WAAA,OAAA;sCACN,MAAK,GAAA,CAAAA,gBAAA;AAAG,YAAAA,YAAA,KAAA,GAAAC,YAAA,MAAM,IAAI,CAAA,EAAA;AAAA;;;;;;2CAO5B,YAAY;;UAAI,QAAK,aAAA,SAAA;AAQjB,MAAAD,YAAA,KAAA,gEAAAC,YAAA,MAAM,IAAI,CAAA,WAAA;AAAA;;QAKjB,aAAa,WAAW,GAAC;;AAUhB,MAAAD,YAAA,KAAA,yQAAAE,KAAA,cAAAC,aAAa,CAAA,qLAAAF,YAIHE,YAAa,CAAA,CAAA,UAAA;AAAA;;;;EA3C7B,CAAA;;"}