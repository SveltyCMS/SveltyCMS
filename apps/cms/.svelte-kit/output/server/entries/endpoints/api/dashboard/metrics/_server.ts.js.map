{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/dashboard/metrics/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/dashboard/metrics/+server.ts\n * @description Dashboard metrics API endpoint for performance monitoring\n * Protected by handleApiRequests middleware (requires authentication + dashboard API permissions)\n */\n\nimport { json } from '@sveltejs/kit';\nimport { metricsService } from '@shared/services';\nimport type { RequestHandler } from './$types';\n\n// System Logger\nimport { logger } from '@shared/utils/logger.server';\n\nexport const GET: RequestHandler = async ({ url }) => {\n\ttry {\n\t\tconst metrics = metricsService.getReport();\n\n\t\t// Add additional system metrics if requested\n\t\tconst detailed = url.searchParams.get('detailed') === 'true';\n\n\t\tif (detailed) {\n\t\t\t// Add memory usage and other Node.js metrics\n\t\t\tconst memoryUsage = process.memoryUsage();\n\t\t\treturn json({\n\t\t\t\t...metrics,\n\t\t\t\tsystem: {\n\t\t\t\t\tmemory: {\n\t\t\t\t\t\tused: Math.round(memoryUsage.heapUsed / 1024 / 1024), // MB\n\t\t\t\t\t\ttotal: Math.round(memoryUsage.heapTotal / 1024 / 1024), // MB\n\t\t\t\t\t\texternal: Math.round(memoryUsage.external / 1024 / 1024), // MB\n\t\t\t\t\t\trss: Math.round(memoryUsage.rss / 1024 / 1024) // MB\n\t\t\t\t\t},\n\t\t\t\t\tuptime: Math.floor(process.uptime()),\n\t\t\t\t\tnodeVersion: process.version\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn json(metrics);\n\t} catch (err) {\n\t\tlogger.error('Dashboard metrics error:', err);\n\t\treturn json({ error: 'Failed to fetch dashboard metrics' }, { status: 500 });\n\t}\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAaO,MAAM,MAAsB,OAAO,EAAE,UAAU;AACrD,MAAI;AACH,UAAM,UAAU,eAAe,UAAA;AAG/B,UAAM,WAAW,IAAI,aAAa,IAAI,UAAU,MAAM;AAEtD,QAAI,UAAU;AAEb,YAAM,cAAc,QAAQ,YAAA;AAC5B,aAAO,KAAK;AAAA,QACX,GAAG;AAAA,QACH,QAAQ;AAAA,UACP,QAAQ;AAAA,YACP,MAAM,KAAK,MAAM,YAAY,WAAW,OAAO,IAAI;AAAA;AAAA,YACnD,OAAO,KAAK,MAAM,YAAY,YAAY,OAAO,IAAI;AAAA;AAAA,YACrD,UAAU,KAAK,MAAM,YAAY,WAAW,OAAO,IAAI;AAAA;AAAA,YACvD,KAAK,KAAK,MAAM,YAAY,MAAM,OAAO,IAAI;AAAA;AAAA,UAAA;AAAA,UAE9C,QAAQ,KAAK,MAAM,QAAQ,QAAQ;AAAA,UACnC,aAAa,QAAQ;AAAA,QAAA;AAAA,MACtB,CACA;AAAA,IACF;AAEA,WAAO,KAAK,OAAO;AAAA,EACpB,SAAS,KAAK;AACb,WAAO,MAAM,4BAA4B,GAAG;AAC5C,WAAO,KAAK,EAAE,OAAO,oCAAA,GAAuC,EAAE,QAAQ,KAAK;AAAA,EAC5E;AACD;"}