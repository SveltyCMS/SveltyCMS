{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/dashboard/health/+server.ts"],"sourcesContent":["/**\n * GET /api/health\n *\n * Public health check endpoint for monitoring system status.\n * Provides detailed information about system state and individual service health.\n *\n * Useful for:\n * - Load balancers\n * - Monitoring systems (Datadog, New Relic, etc.)\n * - CI/CD pipelines\n * - Kubernetes readiness/liveness probes\n *\n * Response format:\n * {\n *   \"overallStatus\": \"READY\" | \"INITIALIZING\" | \"DEGRADED\" | \"FAILED\" | \"IDLE\",\n *   \"timestamp\": 1234567890,\n *   \"uptime\": 45000,\n *   \"components\": {\n *     \"database\": { \"status\": \"healthy\", \"message\": \"...\", \"lastChecked\": 1234567890 },\n *     \"auth\": { \"status\": \"healthy\", \"message\": \"...\" },\n *     ...\n *   }\n * }\n */\n\nimport { json } from '@sveltejs/kit';\nimport type { RequestHandler } from './$types';\nimport { getHealthCheckReport } from '@shared/stores/system';\n\nexport const GET: RequestHandler = async () => {\n\ttry {\n\t\tconst healthReport = getHealthCheckReport();\n\n\t\t// Map system state to HTTP status codes\n\t\t// READY/DEGRADED = 200 (service is operational)\n\t\t// INITIALIZING = 503 (service temporarily unavailable)\n\t\t// FAILED/IDLE = 503 (service unavailable)\n\t\tconst statusCode = healthReport.overallStatus === 'READY' || healthReport.overallStatus === 'DEGRADED' ? 200 : 503;\n\n\t\treturn json(healthReport, { status: statusCode });\n\t} catch (error) {\n\t\t// If health check itself fails, return minimal error response\n\t\treturn json(\n\t\t\t{\n\t\t\t\toverallStatus: 'FAILED',\n\t\t\t\ttimestamp: Date.now(),\n\t\t\t\tuptime: 0,\n\t\t\t\tcomponents: {},\n\t\t\t\terror: error instanceof Error ? error.message : 'Unknown error'\n\t\t\t},\n\t\t\t{ status: 503 }\n\t\t);\n\t}\n};\n"],"names":[],"mappings":";;;;AA6BO,MAAM,MAAsB,YAAY;AAC9C,MAAI;AACH,UAAM,eAAe,qBAAA;AAMrB,UAAM,aAAa,aAAa,kBAAkB,WAAW,aAAa,kBAAkB,aAAa,MAAM;AAE/G,WAAO,KAAK,cAAc,EAAE,QAAQ,YAAY;AAAA,EACjD,SAAS,OAAO;AAEf,WAAO;AAAA,MACN;AAAA,QACC,eAAe;AAAA,QACf,WAAW,KAAK,IAAA;AAAA,QAChB,QAAQ;AAAA,QACR,YAAY,CAAA;AAAA,QACZ,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAAA;AAAA,MAEjD,EAAE,QAAQ,IAAA;AAAA,IAAI;AAAA,EAEhB;AACD;"}