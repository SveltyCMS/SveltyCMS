{"version":3,"mappings":"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","names":["RootContext","createContext","props","$.rest_props","$$props","progress","element","rest","attributes","$.derived","mergeProps","$.get","$.snippet","node_1","circle","root_2","$.attribute_effect","$$render","consequent","alternate","children","svg","$.noop","div","node","avatar","anatomy","createAnatomy","parts","getRootId","ctx","getTrackId","getLabelId","getCircleId","connect","service","normalize","context","computed","prop","send","scope","percent","percentAsString","max","min","orientation","translations","indeterminate","value","valueAsString","progressState","getProgressState","progressbarProps","circleProps2","getCircleProps","value2","props2","maxValue","circleProps","rootProps","machine","createMachine","midValue","formatter","num","bindable","isNumber","getValuePercent","memo","locale","formatOptions","event","isValidNumber","isValidMax","isValidMin","createProps","splitProps","createSplitProps","useProgress","useMachine","normalizeProps","id","$.props_id","$$d","progressProps","$$array","componentProps","span","$.template_effect","$0","$.set_text","text","consequent_1","alternate_1","Progress","Root","RootProvider","Label","ValueText","Track","Range","Circle","CircleTrack","CircleRange","browser","preloadTimers","PRELOAD_DELAY","preloadEntry","entryId","currentPath","delay","existingTimer","timer","url","preloadData","logger","error","reflectModeInURL","mode","options","method","parseURLToMode","editParam","createParam","pathParts","root","$.child","iconify_icon","$.first_child","fragment","p","m.entrylist_multibutton_publish","iconify_icon_1","fragment_2","p_1","text_1","m.entrylist_multibutton_unpublish","iconify_icon_2","fragment_4","p_2","text_2","m.entrylist_multibutton_schedule","iconify_icon_3","fragment_6","p_3","text_3","m.button_delete","iconify_icon_4","fragment_8","p_4","text_4","iconify_icon_5","fragment_10","p_5","text_5","m.entrylist_multibutton_clone","iconify_icon_6","fragment_12","p_6","text_6","m.entrylist_multibutton_draft","iconify_icon_7","fragment_14","p_7","text_7","m.button_archive","p_8","root_16","StatusTypes","consequent_7","consequent_6","consequent_5","alternate_2","consequent_4","alternate_3","consequent_3","alternate_4","consequent_2","alternate_5","alternate_6","alternate_7","$.reset","$.set_class","$.set_attribute","$.append","$$anchor","isCollectionEmpty","hasSelections","selectedCount","selectedItems","$.prop","showDeleted","ACTION_CONFIGS","m.entrylist_multibutton_create","isDropdownOpen","$.state","manualActionSet","dropdownRef","hoveredAction","isProcessing","focusedIndex","menuItemRefs","$.proxy","isSlowConnection","batchSizeLimit","currentAction","storeListboxValue","currentConfig","c","stats","items","published","i","drafts","dynamicLabel","m.button_loading","availableActions","config","$.user_effect","$.set","conn","checkConnection","handleClickOutside","target","handleKeyDown","e","action","handleAction","matchedConfig","onMount","onDestroy","limitMsg","m.entrylist_multibutton_limit_warning","showToast","executeAction","now","errMsg","toggleDropdown","handleOptionClick","actionType","handleMainButtonClick","div_1","button","$.set_custom_element_data","div_2","$.sibling","$$args","button_1","root_1","span_1","root_3","$.transition","scale","quintOut","button_2","root_4","node_3","root_5","m.entrylist_multibutton_toggle_menu","div_3","root_6","ul","li","root_7","button_3","div_4","div_5","div_6","div_7","div_8","root_8","root_9","span_2","root_10","$.event","m.entrylist_multibutton_available_actions","$$value","$1","m.entrylist_multibutton_show_active","m.entrylist_multibutton_show_archived","m.entrylist_multibutton_viewing_archived","m.entrylist_multibutton_viewing_active","isInitialized","completionTotals","availableLanguages","languages","publicEnv","currentLanguage","contentLanguage","currentMode","isViewMode","dropdownLanguages","l","overallPercentage","total","translated","showProgress","translationProgress","languageProgress","currentProgress","lang","langProgress","getProgressColor","getTextColor","isFieldTranslated","obj","langData","v","getTranslatableFieldPath","collectionName","field","baseName","getFieldName","initializeTranslationProgress","currentCollection","newProgress","SvelteSet","hasTranslatableFields","fieldPaths","path","updateTranslationProgressFromFields","currentCollectionValue","hasUpdates","originalLangProgress","newTranslatedSet","langHasUpdates","dbFieldName","fieldValue","fullPath","subFieldName","valueToCheck","isTranslated","wasTranslated","calculateCompletionTotals","handleLanguageChange","selectedLanguage","currentCollectionId","collection","currentSearch","page","newPath","goto","customEvent","lastEntryId","lastCollectionId","currentEntry","collectionValue","collectionId","collectionChanged","entryChanged","untrack","lastCollectionValueStr","currentStr","Menu","Menu_Trigger","fragment_1","getLanguageName","Portal","node_2","Menu_Positioner","Menu_Content","node_5","$.each","percentage","isActive","Menu_Item","span_3","span_4","node_8","span_5","span_6","span_7","Menu_Separator","node_11","div_9","root_12","node_13","span_8","node_12","m.translationsstatus_completed","m.applayout_contentlanguage","serverEntries","serverPagination","breadcrumb","collectionStats","tableData","pagesCount","totalItems","updateURL","updates","newUrl","key","onUpdatePage","newPage","entryListPaginationSettings","onUpdateRowsPerPage","rows","onSortChange","fieldName","newSorted","filterDebounce","debounce","onFilterChange","filterName","newFilters","filterUpdates","val","onActionSuccess","selectedMap","SelectAll","invalidateAll","preloadedEntries","PRELOAD_CACHE_TTL","isPreloadEnabled","hoverPatterns","effectiveType","saveData","handleRowHoverStart","currentCount","handleRowHoverEnd","batchPreloadVisibleEntries","deadline","entriesToPreload","entry","cached","cleanupInterval","handleDndConsider","displayTableHeaders","handleDndFinalize","defaultPaginationSettings","saved","parsed","stringified","globalSearchValue","expand","filterShow","columnShow","currentStates","app","screen","urlSearch","searchValue","currentUrlSearch","searchParams","hasChanges","hasActiveUrlFilters","tableHeaders","cacheKey","schemaHeaders","systemHeaders","filtersChanged","th","currentCollId","settings","schemaHeaderMap","reconciledHeaders","addedNames","savedHeader","schemaHeader","h","visibleTableHeaders","header","selectAllColumns","cellPaddingClass","meta_data","currentValue","setCollectionValue","invalidateCollectionCache","process_selectAllRows","selectAllState","_entry","index","isSelected","hasActiveFilters","f","setModifyEntry","status","selectedIds","getSelectedIds","showStatusChangeConfirm","setEntriesStatus","pathSegments","categoryName","b","segments","getSelectedRawEntries","onCreate","newEntry","setMode","ui","onPublish","onUnpublish","onDraft","onDelete","isPermanent","useArchiving","isForArchived","willDelete","actionVerb","showDeleteConfirm","collId","batchDeleteEntries","batchError","deleteEntry","onClone","cloneEntries","onSchedule","date","payload","handleColumnVisibilityToggle","headerToToggle","handleSelectAllColumnsToggle","newVisibility","resetViewSettings","TranslationStatus","node_6","TableFilter","node_7","div_10","EntryListMultiButton","node_9","div_11","div_12","div_13","div_14","div_15","label","input","section","div_16","root_11","flip","$.action","$$node","$$action_arg","dndzone","m.entrylist_dnd","m.entrylist_all","consequent_8","div_17","table","thead","tr","root_13","th_1","button_4","root_14","clearedFilters","urlUpdates","consequent_9","node_17","th_2","root_15","div_18","FloatingInput","node_18","consequent_10","tr_1","node_15","TableIcons","node_19","checked","node_20","th_3","div_19","root_17","consequent_11","tbody","node_23","tr_2","root_19","node_24","isChecked","node_26","td","root_21","currentStatus","nextStatus","result","updateEntryStatus","originalEntry","node_27","div_20","root_22","Status","node_28","div_21","root_24","div_22","div_23","formatDisplayDate","fieldData","translatedValue","debugInfo","root_27","consequent_14","$.html","node_34","consequent_15","consequent_13","consequent_12","consequent_16","tr_3","root_30","td_1","consequent_17","div_24","node_35","TablePagination","div_25","root_31","m.EntryList_no_collection","consequent_18","WidgetData","component","loading","loadComponent","module","err","strong","Component","Component_1","ActiveInputState","#current","activeInput","activeInputStore","user","tenantId","modules","__vitePreload","openTokenPicker","el","widgetFunctions","widgetFunctionsStore","revisions","localTabSet","apiUrl","selectedRevisionId","currentContentLanguage","newLang","selectedRevision","r","derivedFields","currentTranslationProgress","k","getFieldTranslationPercentage","allLangs","translatedCount","getTranslationTextColor","ensureFieldProperties","filteredFields","rolePermissions","global","globalId","dataChangeStore","local","currentDataStr","globalDataStr","lastLocalValueStr","localStr","globalStr","handleRevert","showConfirm","revertData","toaster","values","validationStore","Tabs","Tabs_List","Tabs_Trigger","m.button_edit","Tabs_Trigger_1","m.applayout_version","Tabs_Trigger_2","m.Fields_preview","Tabs_Trigger_3","Tabs_Content","rawField","textColor","widgetName","loadedWidget","storePath","camelPath","lowerPath","normalized","fileName","folderName","WidgetLoader","text_8","m.Fields_no_widgets_found","$.set_style","m.form_required","Tabs_Content_1","root_20","fragment_11","select","option","revision","option_1","root_23","option_1_value","diffObject","root_25","$.index","$$item","ch","root_26","fragment_13","root_29","text_13","text_14","root_33","root_34","root_35","Tabs_Content_2","hostProd","previewUrl","root_36","iconify_icon_8","iconify_icon_9","a","iconify_icon_10","iframe","$.set_value","text_15","Tabs_Content_3","div_26","root_37","div_27","input_1","div_28","pre","collectionSchema","entries","pagination","serverContentLanguage","collections","initialCollectionValue","userClickedCancel","isSavingDraft","lastServerLanguage","validationInitialized","$.user_pre_effect","fields","errorCount","fieldDef","currentStoreLanguage","currentStoreId","schemaId","isMounted","collectionIdFromPath","replaceState","lastUrlString","lastEditParam","hasInitiallyLoaded","currentUrl","entryData","editParamChanged","wasInCreateMode","isInCreateMode","autoSaveDraft","draftData","isNewEntry","endpoint","response","handleCancelClick","handleEntrySaved","beforeNavigate","cancel","$.head","$.document","$.key","EntryList","Fields"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"sources":["../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/modules/root-context.js","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/circle-range.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/circle-track.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/circle.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/label.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/range.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/root-context.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/root-provider.svelte","../../../../../../../../node_modules/@zag-js/progress/dist/index.mjs","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/modules/provider.svelte.js","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/root.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/track.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/anatomy/value-text.svelte","../../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/progress/modules/anatomy.js","../../../../../../../../shared/utils/src/navigationUtils.ts","../../../../../../../../shared/components/src/system/table/Status.svelte","../../../../../../../../shared/components/src/collectionDisplay/EntryList_MultiButton.svelte","../../../../../../../../shared/components/src/collectionDisplay/TranslationStatus.svelte","../../../../../../../../shared/components/src/collectionDisplay/EntryList.svelte","../../../../../../../../shared/components/src/collectionDisplay/WidgetLoader.svelte","../../../../../../../../shared/stores/src/activeInputStore.svelte.ts","../../../../../../../../shared/components/src/collectionDisplay/Fields.svelte","../../../../../../src/routes/[language]/[...collection]/+page.svelte"],"sourcesContent":["import { createContext } from '../../../internal/create-context.js';\nexport const RootContext = createContext();\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressCircleRangeProps extends PropsWithElement<'circle'>, HTMLAttributes<'circle', 'children'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressCircleRangeProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, ...rest } = $derived(props);\n\n\tconst attributes = $derived(\n\t\tmergeProps(\n\t\t\tprogress().getCircleRangeProps(),\n\t\t\t{\n\t\t\t\t'stroke-linecap': 'round',\n\t\t\t},\n\t\t\trest,\n\t\t),\n\t);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<circle {...attributes} />\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressCircleTrackProps extends PropsWithElement<'circle'>, HTMLAttributes<'circle', 'children'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressCircleTrackProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getCircleTrackProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<circle {...attributes} />\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressCircleProps extends PropsWithElement<'svg'>, HTMLAttributes<'svg'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressCircleProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getCircleProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<svg {...attributes}>\n\t\t{@render children?.()}\n\t</svg>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressLabelProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressLabelProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getLabelProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressRangeProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressRangeProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getRangeProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { useProgress } from '../modules/provider.svelte';\n\timport type { Snippet } from 'svelte';\n\n\texport interface ProgressRootContextProps {\n\t\tchildren: Snippet<[ReturnType<typeof useProgress>]>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\n\tconst props: ProgressRootContextProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { children } = $derived(props);\n</script>\n\n{@render children(progress)}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { useProgress } from '../modules/provider.svelte';\n\n\texport interface ProgressRootProviderProps extends PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir'> {\n\t\tvalue: ReturnType<typeof useProgress>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressRootProviderProps = $props();\n\n\tconst { element, children, value: avatar, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(avatar().getRootProps(), rest));\n\n\tRootContext.provide(() => avatar());\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","import { createAnatomy } from '@zag-js/anatomy';\nimport { createMachine, memo } from '@zag-js/core';\nimport { isNumber, getValuePercent, createSplitProps } from '@zag-js/utils';\nimport { createProps } from '@zag-js/types';\n\n// src/progress.anatomy.ts\nvar anatomy = createAnatomy(\"progress\").parts(\n  \"root\",\n  \"label\",\n  \"track\",\n  \"range\",\n  \"valueText\",\n  \"view\",\n  \"circle\",\n  \"circleTrack\",\n  \"circleRange\"\n);\nvar parts = anatomy.build();\n\n// src/progress.dom.ts\nvar getRootId = (ctx) => ctx.ids?.root ?? `progress-${ctx.id}`;\nvar getTrackId = (ctx) => ctx.ids?.track ?? `progress-${ctx.id}-track`;\nvar getLabelId = (ctx) => ctx.ids?.label ?? `progress-${ctx.id}-label`;\nvar getCircleId = (ctx) => ctx.ids?.circle ?? `progress-${ctx.id}-circle`;\n\n// src/progress.connect.ts\nfunction connect(service, normalize) {\n  const { context, computed, prop, send, scope } = service;\n  const percent = computed(\"percent\");\n  const percentAsString = computed(\"isIndeterminate\") ? \"\" : computed(\"formatter\").format(percent / 100);\n  const max = prop(\"max\");\n  const min = prop(\"min\");\n  const orientation = prop(\"orientation\");\n  const translations = prop(\"translations\");\n  const indeterminate = computed(\"isIndeterminate\");\n  const value = context.get(\"value\");\n  const valueAsString = translations?.value({ value, max, percent, min, formatter: computed(\"formatter\") }) ?? \"\";\n  const progressState = getProgressState(value, max);\n  const progressbarProps = {\n    role: \"progressbar\",\n    \"aria-label\": valueAsString,\n    \"data-max\": max,\n    \"aria-valuemin\": min,\n    \"aria-valuemax\": max,\n    \"aria-valuenow\": value ?? void 0,\n    \"data-orientation\": orientation,\n    \"data-state\": progressState\n  };\n  const circleProps2 = getCircleProps(service);\n  return {\n    value,\n    valueAsString,\n    min,\n    max,\n    percent,\n    percentAsString,\n    indeterminate,\n    setValue(value2) {\n      send({ type: \"VALUE.SET\", value: value2 });\n    },\n    setToMax() {\n      send({ type: \"VALUE.SET\", value: max });\n    },\n    setToMin() {\n      send({ type: \"VALUE.SET\", value: min });\n    },\n    getRootProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        ...parts.root.attrs,\n        id: getRootId(scope),\n        \"data-max\": max,\n        \"data-value\": value ?? void 0,\n        \"data-state\": progressState,\n        \"data-orientation\": orientation,\n        style: {\n          \"--percent\": indeterminate ? void 0 : percent\n        }\n      });\n    },\n    getLabelProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        id: getLabelId(scope),\n        ...parts.label.attrs,\n        \"data-orientation\": orientation\n      });\n    },\n    getValueTextProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        \"aria-live\": \"polite\",\n        ...parts.valueText.attrs\n      });\n    },\n    getTrackProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        id: getTrackId(scope),\n        ...parts.track.attrs,\n        ...progressbarProps\n      });\n    },\n    getRangeProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        ...parts.range.attrs,\n        \"data-orientation\": orientation,\n        \"data-state\": progressState,\n        style: {\n          [computed(\"isHorizontal\") ? \"width\" : \"height\"]: indeterminate ? void 0 : `${percent}%`\n        }\n      });\n    },\n    getCircleProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        id: getCircleId(scope),\n        ...parts.circle.attrs,\n        ...progressbarProps,\n        ...circleProps2.root\n      });\n    },\n    getCircleTrackProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        \"data-orientation\": orientation,\n        ...parts.circleTrack.attrs,\n        ...circleProps2.track\n      });\n    },\n    getCircleRangeProps() {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        ...parts.circleRange.attrs,\n        ...circleProps2.range,\n        \"data-state\": progressState\n      });\n    },\n    getViewProps(props2) {\n      return normalize.element({\n        dir: prop(\"dir\"),\n        ...parts.view.attrs,\n        \"data-state\": props2.state,\n        hidden: props2.state !== progressState\n      });\n    }\n  };\n}\nfunction getProgressState(value, maxValue) {\n  return value == null ? \"indeterminate\" : value === maxValue ? \"complete\" : \"loading\";\n}\nvar circleProps = {\n  style: {\n    \"--radius\": \"calc(var(--size) / 2 - var(--thickness) / 2)\",\n    cx: \"calc(var(--size) / 2)\",\n    cy: \"calc(var(--size) / 2)\",\n    r: \"var(--radius)\",\n    fill: \"transparent\",\n    strokeWidth: \"var(--thickness)\"\n  }\n};\nvar rootProps = {\n  style: {\n    width: \"var(--size)\",\n    height: \"var(--size)\"\n  }\n};\nfunction getCircleProps(service) {\n  const { context, computed } = service;\n  return {\n    root: rootProps,\n    track: circleProps,\n    range: {\n      opacity: context.get(\"value\") === 0 ? 0 : void 0,\n      style: {\n        ...circleProps.style,\n        \"--percent\": computed(\"percent\"),\n        \"--circumference\": `calc(2 * 3.14159 * var(--radius))`,\n        \"--offset\": `calc(var(--circumference) * (100 - var(--percent)) / 100)`,\n        strokeDashoffset: `calc(var(--circumference) * ((100 - var(--percent)) / 100))`,\n        strokeDasharray: computed(\"isIndeterminate\") ? void 0 : `var(--circumference)`,\n        transformOrigin: \"center\",\n        transform: \"rotate(-90deg)\"\n      }\n    }\n  };\n}\nvar machine = createMachine({\n  props({ props: props2 }) {\n    const min = props2.min ?? 0;\n    const max = props2.max ?? 100;\n    return {\n      orientation: \"horizontal\",\n      ...props2,\n      max,\n      min,\n      defaultValue: props2.defaultValue !== void 0 ? props2.defaultValue : midValue(min, max),\n      formatOptions: {\n        style: \"percent\",\n        ...props2.formatOptions\n      },\n      translations: {\n        value: ({ value, percent, formatter }) => {\n          if (value === null) return \"loading...\";\n          if (formatter) {\n            const formatOptions = formatter.resolvedOptions();\n            const num = formatOptions.style === \"percent\" ? percent / 100 : value;\n            return formatter.format(num);\n          }\n          return value.toString();\n        },\n        ...props2.translations\n      }\n    };\n  },\n  initialState() {\n    return \"idle\";\n  },\n  entry: [\"validateContext\"],\n  context({ bindable, prop }) {\n    return {\n      value: bindable(() => ({\n        defaultValue: prop(\"defaultValue\"),\n        value: prop(\"value\"),\n        onChange(value) {\n          prop(\"onValueChange\")?.({ value });\n        }\n      }))\n    };\n  },\n  computed: {\n    isIndeterminate: ({ context }) => context.get(\"value\") === null,\n    percent({ context, prop }) {\n      const value = context.get(\"value\");\n      if (!isNumber(value)) return -1;\n      return getValuePercent(value, prop(\"min\"), prop(\"max\")) * 100;\n    },\n    formatter: memo(\n      ({ prop }) => [prop(\"locale\"), prop(\"formatOptions\")],\n      ([locale, formatOptions]) => new Intl.NumberFormat(locale, formatOptions)\n    ),\n    isHorizontal: ({ prop }) => prop(\"orientation\") === \"horizontal\"\n  },\n  states: {\n    idle: {\n      on: {\n        \"VALUE.SET\": {\n          actions: [\"setValue\"]\n        }\n      }\n    }\n  },\n  implementations: {\n    actions: {\n      setValue: ({ context, event, prop }) => {\n        const value = event.value === null ? null : Math.max(0, Math.min(event.value, prop(\"max\")));\n        context.set(\"value\", value);\n      },\n      validateContext: ({ context, prop }) => {\n        const max = prop(\"max\");\n        const min = prop(\"min\");\n        const value = context.get(\"value\");\n        if (value == null) return;\n        if (!isValidNumber(max)) {\n          throw new Error(`[progress] The max value passed \\`${max}\\` is not a valid number`);\n        }\n        if (!isValidMax(value, max)) {\n          throw new Error(`[progress] The value passed \\`${value}\\` exceeds the max value \\`${max}\\``);\n        }\n        if (!isValidMin(value, min)) {\n          throw new Error(`[progress] The value passed \\`${value}\\` exceeds the min value \\`${min}\\``);\n        }\n      }\n    }\n  }\n});\nvar isValidNumber = (max) => isNumber(max) && !isNaN(max);\nvar isValidMax = (value, max) => isValidNumber(value) && value <= max;\nvar isValidMin = (value, min) => isValidNumber(value) && value >= min;\nvar midValue = (min, max) => min + (max - min) / 2;\nvar props = createProps()([\n  \"dir\",\n  \"getRootNode\",\n  \"id\",\n  \"ids\",\n  \"max\",\n  \"min\",\n  \"orientation\",\n  \"translations\",\n  \"value\",\n  \"onValueChange\",\n  \"defaultValue\",\n  \"formatOptions\",\n  \"locale\"\n]);\nvar splitProps = createSplitProps(props);\n\nexport { anatomy, connect, machine, props, splitProps };\n","import { connect, machine } from '@zag-js/progress';\nimport { normalizeProps, useMachine } from '@zag-js/svelte';\nexport function useProgress(props) {\n    const service = useMachine(machine, props);\n    const progress = $derived(connect(service, normalizeProps));\n    return () => progress;\n}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { Props } from '@zag-js/progress';\n\n\texport interface ProgressRootProps extends Omit<Props, 'id'>, PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { useProgress } from '../modules/provider.svelte';\n\timport { RootContext } from '../modules/root-context.js';\n\timport { splitProps } from '@zag-js/progress';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressRootProps = $props();\n\n\tconst [progressProps, componentProps] = $derived(splitProps(props));\n\tconst { element, children, ...rest } = $derived(componentProps);\n\n\tconst id = $props.id();\n\tconst avatar = useProgress(() => ({\n\t\t...progressProps,\n\t\tid: id,\n\t}));\n\n\tconst attributes = $derived(mergeProps(avatar().getRootProps(), rest));\n\n\tRootContext.provide(() => avatar());\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressTrackProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressTrackProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getTrackProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ProgressValueTextProps extends PropsWithElement<'span'>, HTMLAttributes<'span'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ProgressValueTextProps = $props();\n\n\tconst progress = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(progress().getValueTextProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<span {...attributes}>\n\t\t{#if children}\n\t\t\t{@render children?.()}\n\t\t{:else}\n\t\t\t{progress().percentAsString}\n\t\t{/if}\n\t</span>\n{/if}\n","import CircleRange from '../anatomy/circle-range.svelte';\nimport CircleTrack from '../anatomy/circle-track.svelte';\nimport Circle from '../anatomy/circle.svelte';\nimport Label from '../anatomy/label.svelte';\nimport Range from '../anatomy/range.svelte';\nimport RootContext from '../anatomy/root-context.svelte';\nimport RootProvider from '../anatomy/root-provider.svelte';\nimport Root from '../anatomy/root.svelte';\nimport Track from '../anatomy/track.svelte';\nimport ValueText from '../anatomy/value-text.svelte';\nexport const Progress = Object.assign(Root, {\n    Provider: RootProvider,\n    Context: RootContext,\n    Label: Label,\n    ValueText: ValueText,\n    Track: Track,\n    Range: Range,\n    Circle: Circle,\n    CircleTrack: CircleTrack,\n    CircleRange: CircleRange,\n});\n","/**\n * @file src/utils/navigationUtils.ts\n * @description  GUI-first navigation via uuids/mode for SveltyCMS using SvelteKit's built-in systems\n */\n\nconst browser = typeof window !== 'undefined';\nimport { preloadData } from '$app/navigation';\nimport { logger } from './logger';\nimport type { ModeType } from '@shared/stores/collectionStore.svelte';\n\n// ============================================================================\n// PRELOADING\n// ============================================================================\n\nconst preloadTimers = new Map<string, number>();\nexport const PRELOAD_DELAY = 200; // Configurable delay to prevent aggressive prefetching\n\nexport function preloadEntry(entryId: string, currentPath: string, delay: number = PRELOAD_DELAY): void {\n\tconst existingTimer = preloadTimers.get(entryId);\n\tif (existingTimer) clearTimeout(existingTimer);\n\n\tconst timer = setTimeout(async () => {\n\t\ttry {\n\t\t\tconst url = new URL(currentPath, window.location.origin);\n\t\t\turl.searchParams.set('edit', entryId);\n\t\t\tawait preloadData(url.pathname + url.search);\n\t\t\tlogger.debug(`[Preload] Entry ${entryId.substring(0, 8)}`);\n\t\t} catch (error) {\n\t\t\tlogger.warn(`[Preload ERROR]`, error);\n\t\t} finally {\n\t\t\tpreloadTimers.delete(entryId);\n\t\t}\n\t}, delay);\n\n\tpreloadTimers.set(entryId, timer as unknown as number);\n}\n\nexport function cancelPreload(entryId: string): void {\n\tconst timer = preloadTimers.get(entryId);\n\tif (timer) {\n\t\tclearTimeout(timer);\n\t\tpreloadTimers.delete(entryId);\n\t}\n}\n\n// ============================================================================\n// URL REFLECTION\n// ============================================================================\n\nexport function reflectModeInURL(mode: ModeType, entryId?: string, options: { replaceState?: boolean } = {}): void {\n\tif (!browser) return;\n\n\tconst url = new URL(window.location.href);\n\turl.searchParams.delete('edit');\n\turl.searchParams.delete('create');\n\n\tif (mode === 'edit' && entryId) {\n\t\turl.searchParams.set('edit', entryId);\n\t} else if (mode === 'create') {\n\t\turl.searchParams.set('create', 'true');\n\t}\n\n\tconst method = options.replaceState ? 'replaceState' : 'pushState';\n\twindow.history[method]({}, '', url.toString());\n\tlogger.debug(`[URL] ${mode}${entryId ? ` (${entryId.substring(0, 8)})` : ''}`);\n}\n\n// ============================================================================\n// URL PARSING\n// ============================================================================\n\nexport interface ParsedURL {\n\tmode: ModeType;\n\tentryId?: string;\n\tlanguage: string;\n\tcollectionPath: string;\n}\n\nexport function parseURLToMode(url: URL): ParsedURL {\n\tconst editParam = url.searchParams.get('edit');\n\tconst createParam = url.searchParams.get('create');\n\n\tlet mode: ModeType = 'view';\n\tlet entryId: string | undefined;\n\n\tif (editParam) {\n\t\tmode = 'edit';\n\t\tentryId = editParam;\n\t} else if (createParam === 'true') {\n\t\tmode = 'create';\n\t}\n\n\tconst pathParts = url.pathname.split('/').filter(Boolean);\n\treturn {\n\t\tmode,\n\t\tentryId,\n\t\tlanguage: pathParts[0] || 'en',\n\t\tcollectionPath: pathParts.slice(1).join('/')\n\t};\n}\n\n// ============================================================================\n// CACHE INVALIDATION\n// ============================================================================\n\nexport function invalidateCollectionEntries(collectionId: string): void {\n\t// SvelteKit will refetch on next navigation\n\tlogger.debug(`[Cache] Collection ${collectionId} - will refetch on next load`);\n}\n\nexport const navigationUtils = {\n\tpreloadEntry,\n\tcancelPreload,\n\treflectModeInURL,\n\tparseURLToMode,\n\tinvalidateCollectionEntries\n};\n\nexport default navigationUtils;\n","<!-- \n@file src/components/system/table/Status.svelte\n@component\n**Status component for table displaying different badges for different statuses**\n\nValues form StatusTypes\n\n@example\n<Status value=\"publish\" />\n\n### Props\n- `value` {string}: The status value to display\n\n### Features:\n- Displays different badges for different statuses\n- Uses icons and colors to represent each status visually\n-->\n\n<script lang=\"ts\">\n\t// Import StatusTypes for centralized status management\n\timport { StatusTypes } from '@cms-types/content';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\tconst { value } = $props(); // The status value to display\n</script>\n\n<!-- Display different badges for different statuses -->\n<div\n\tclass=\"flex w-fit min-w-24 items-center justify-center gap-2 rounded px-3 py-1.5 text-center text-white\n\t\t{value === StatusTypes.publish\n\t\t? 'gradient-primary'\n\t\t: value === StatusTypes.unpublish\n\t\t\t? 'gradient-yellow'\n\t\t\t: value === StatusTypes.schedule\n\t\t\t\t? 'gradient-pink'\n\t\t\t\t: value === StatusTypes.delete\n\t\t\t\t\t? 'bg-surface-500 text-white'\n\t\t\t\t\t: value === StatusTypes.clone\n\t\t\t\t\t\t? 'gradient-secondary'\n\t\t\t\t\t\t: value === StatusTypes.draft\n\t\t\t\t\t\t\t? 'preset-outlined-surface-500 text-surface-900-50-token'\n\t\t\t\t\t\t\t: value === StatusTypes.archive\n\t\t\t\t\t\t\t\t? 'bg-surface-600 text-white'\n\t\t\t\t\t\t\t\t: 'badge'}\"\n\ttitle={`Status: ${value}`}\n>\n\t{#if value === StatusTypes.publish}\n\t\t<iconify-icon icon=\"bi:hand-thumbs-up-fill\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.entrylist_multibutton_publish()}</p>\n\t{:else if value === StatusTypes.unpublish}\n\t\t<iconify-icon icon=\"bi:pause-circle\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.entrylist_multibutton_unpublish()}</p>\n\t{:else if value === StatusTypes.schedule}\n\t\t<iconify-icon icon=\"bi:clock\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.entrylist_multibutton_schedule()}</p>\n\t{:else if value === 'deleted'}\n\t\t<iconify-icon icon=\"bi:trash3-fill\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.button_delete()}</p>\n\t{:else if value === StatusTypes.delete}\n\t\t<iconify-icon icon=\"bi:trash3-fill\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.button_delete()}</p>\n\t{:else if value === StatusTypes.clone}\n\t\t<iconify-icon icon=\"bi:clipboard-data-fill\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.entrylist_multibutton_clone()}</p>\n\t{:else if value === StatusTypes.draft}\n\t\t<iconify-icon icon=\"bi:pencil-square\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.entrylist_multibutton_draft()}</p>\n\t{:else if value === StatusTypes.archive}\n\t\t<iconify-icon icon=\"bi:archive-fill\" width=\"16\"></iconify-icon>\n\t\t<p class=\"hidden sm:block text-xs font-bold uppercase\">{m.button_archive()}</p>\n\t{:else}\n\t\t<p class=\"px-2\">{value}</p>\n\t{/if}\n</div>\n","<!--\n@file src/components/collectionDisplay/EntryList_MultiButton.svelte\n@component\n**Enterprise-Grade MultiButton with Action Queue, Progress Tracking, and Undo Support**\n\n### Features:\n- **Action Queue System**: Real-time progress tracking for batch operations\n- **Undo/Redo Support**: 5-minute window for reversible actions\n- **Smart Confirmation**: Auto-confirms small batches, always confirms dangerous ops\n- **Connection-Aware**: Limits batch size on slow networks (2G/3G)\n- **Keyboard Shortcuts**: Alt+N (create), Alt+P (publish), Alt+U (unpublish), Alt+D (draft), Alt+Del (delete)\n- **Optimistic UI**: Instant feedback before server response\n- **Premium Styling**: Vibrant gradients, smooth transitions, and animated feedback\n\n### Props\n- `isCollectionEmpty` (Boolean): If true, displays only the Create button as `rounded-full`.\n- `hasSelections` (Boolean): If true, enables bulk actions.\n- `selectedCount` (Number): Number of items currently selected.\n- `selectedItems` (Array): Raw entry data of selected items for status analysis.\n- `showDeleted` (Boolean, bindable): Toggles between active and archived views.\n- `create`, `publish`, `unpublish`, `draft`, `schedule`, `clone`, `delete`: Action callbacks.\n-->\n\n<script lang=\"ts\">\n\timport { onMount, onDestroy } from 'svelte';\n\timport { scale } from 'svelte/transition';\n\timport { quintOut } from 'svelte/easing';\n\timport { StatusTypes } from '@cms-types/content';\n\timport { storeListboxValue } from '@shared/stores/store.svelte';\n\timport * as m from '@shared/paraglide/messages';\n\timport { logger } from '@shared/utils/logger';\n\timport { showToast } from '@shared/utils/toast';\n\n\t// --- Types ---\n\ttype ActionType = 'create' | 'publish' | 'unpublish' | 'draft' | 'schedule' | 'clone' | 'delete';\n\ttype DangerLevel = 'low' | 'medium' | 'high';\n\n\tinterface ActionConfig {\n\t\ttype: ActionType;\n\t\tlabel: string;\n\t\tgradient: string;\n\t\ticon: string;\n\t\ttextColor: string;\n\t\tshortcut?: string;\n\t\tshortcutKey?: string;\n\t\trequiresSelection: boolean;\n\t\tdangerLevel: DangerLevel;\n\t}\n\n\t// --- Props ---\n\tinterface Props {\n\t\tisCollectionEmpty?: boolean;\n\t\thasSelections?: boolean;\n\t\tselectedCount?: number;\n\t\tselectedItems?: any[];\n\t\tshowDeleted?: boolean;\n\t\tcreate: () => void;\n\t\tpublish: () => Promise<void> | void;\n\t\tunpublish: () => Promise<void> | void;\n\t\tdraft: () => Promise<void> | void;\n\t\tschedule: (date: string, action: string) => void;\n\t\tclone: () => Promise<void> | void;\n\t\tdelete: (permanent: boolean) => Promise<void> | void;\n\t}\n\n\tlet {\n\t\tisCollectionEmpty = false,\n\t\thasSelections = false,\n\t\tselectedCount = 0,\n\t\tselectedItems = [],\n\t\tshowDeleted = $bindable(false),\n\t\tpublish,\n\t\tunpublish,\n\t\tdraft,\n\t\tschedule,\n\t\tdelete: deleteAction,\n\t\tclone,\n\t\tcreate\n\t}: Props = $props();\n\n\t// --- Action Configurations ---\n\tconst ACTION_CONFIGS: ActionConfig[] = [\n\t\t{\n\t\t\ttype: 'create',\n\t\t\tlabel: m.entrylist_multibutton_create(),\n\t\t\tgradient: 'gradient-tertiary',\n\t\t\ticon: 'ic:round-plus',\n\t\t\ttextColor: 'text-white',\n\t\t\tshortcut: 'Alt+N',\n\t\t\tshortcutKey: 'n',\n\t\t\trequiresSelection: false,\n\t\t\tdangerLevel: 'low'\n\t\t},\n\t\t{\n\t\t\ttype: 'publish',\n\t\t\tlabel: m.entrylist_multibutton_publish(),\n\t\t\tgradient: 'gradient-primary',\n\t\t\ticon: 'bi:hand-thumbs-up-fill',\n\t\t\ttextColor: 'text-white',\n\t\t\tshortcut: 'Alt+P',\n\t\t\tshortcutKey: 'p',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'medium'\n\t\t},\n\t\t{\n\t\t\ttype: 'unpublish',\n\t\t\tlabel: m.entrylist_multibutton_unpublish(),\n\t\t\tgradient: 'gradient-warning',\n\t\t\ticon: 'bi:pause-circle',\n\t\t\ttextColor: 'text-black',\n\t\t\tshortcut: 'Alt+U',\n\t\t\tshortcutKey: 'u',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'medium'\n\t\t},\n\t\t{\n\t\t\ttype: 'draft',\n\t\t\tlabel: 'Draft',\n\t\t\tgradient: 'gradient-secondary',\n\t\t\ticon: 'ic:baseline-edit-note',\n\t\t\ttextColor: 'text-white',\n\t\t\tshortcut: 'Alt+D',\n\t\t\tshortcutKey: 'd',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'low'\n\t\t},\n\t\t{\n\t\t\ttype: 'schedule',\n\t\t\tlabel: m.entrylist_multibutton_schedule(),\n\t\t\tgradient: 'gradient-tertiary',\n\t\t\ticon: 'ic:round-schedule',\n\t\t\ttextColor: 'text-white',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'low'\n\t\t},\n\t\t{\n\t\t\ttype: 'clone',\n\t\t\tlabel: m.entrylist_multibutton_clone(),\n\t\t\tgradient: 'gradient-secondary',\n\t\t\ticon: 'ic:round-content-copy',\n\t\t\ttextColor: 'text-white',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'low'\n\t\t},\n\t\t{\n\t\t\ttype: 'delete',\n\t\t\tlabel: m.button_delete(),\n\t\t\tgradient: 'gradient-error',\n\t\t\ticon: 'ic:round-delete-forever',\n\t\t\ttextColor: 'text-white',\n\t\t\tshortcut: 'Alt+Del',\n\t\t\tshortcutKey: 'Delete',\n\t\t\trequiresSelection: true,\n\t\t\tdangerLevel: 'high'\n\t\t}\n\t];\n\n\t// --- State ---\n\tlet isDropdownOpen = $state(false);\n\tlet manualActionSet = $state(false);\n\tlet dropdownRef = $state<HTMLElement | null>(null);\n\tlet hoveredAction = $state<ActionType | null>(null);\n\tlet isProcessing = $state(false);\n\n\t// Dropdown keyboard navigation\n\tlet focusedIndex = $state(0);\n\tlet menuItemRefs = $state<HTMLButtonElement[]>([]);\n\n\t// Connection Awareness\n\tlet isSlowConnection = $state(false);\n\tconst batchSizeLimit = $derived(isSlowConnection ? 10 : 50);\n\n\t// --- Derived State ---\n\tconst currentAction = $derived((storeListboxValue.value as ActionType) || 'create');\n\n\tconst currentConfig = $derived.by(() => {\n\t\tconst config = ACTION_CONFIGS.find((c) => c.type === currentAction);\n\t\treturn config || ACTION_CONFIGS[0]; // Fallback to create\n\t});\n\n\t// Aggregate stats for smart filtering\n\tconst stats = $derived.by(() => {\n\t\tconst items = selectedItems || [];\n\t\tconst published = items.filter((i: any) => i.status === StatusTypes.publish).length;\n\t\tconst drafts = items.filter((i: any) => (i.status || i.raw_status) === StatusTypes.draft).length;\n\t\treturn { published, drafts, total: items.length };\n\t});\n\n\t// Dynamic label with selection count\n\tconst dynamicLabel = $derived.by(() => {\n\t\tif (isProcessing) {\n\t\t\treturn `${m.button_loading()}...`;\n\t\t}\n\t\tif (selectedCount < 2 || currentAction === 'create') {\n\t\t\treturn currentConfig.label;\n\t\t}\n\t\treturn `Bulk ${currentConfig.label} (${selectedCount})`;\n\t});\n\n\t// Available dropdown actions (filtered)\n\tconst availableActions = $derived.by(() => {\n\t\treturn ACTION_CONFIGS.filter((config) => {\n\t\t\t// Don't show current action in dropdown\n\t\t\tif (config.type === currentAction) return false;\n\t\t\t// Always hide create from dropdown\n\t\t\tif (config.type === 'create') return false;\n\n\t\t\t// Hide redundant actions based on selection\n\t\t\tif (hasSelections) {\n\t\t\t\tif (config.type === 'publish' && stats.published === selectedCount) return false;\n\t\t\t\tif (config.type === 'unpublish' && stats.drafts === selectedCount && stats.published === 0) return false;\n\t\t\t\tif (config.type === 'draft' && stats.drafts === selectedCount) return false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t});\n\n\t// --- Effects ---\n\n\t// Smart action selection based on selection state\n\t$effect(() => {\n\t\tif (isCollectionEmpty) {\n\t\t\tstoreListboxValue.set('create');\n\t\t\tmanualActionSet = false;\n\t\t\treturn;\n\t\t}\n\n\t\tif (manualActionSet) return;\n\n\t\tif (!hasSelections) {\n\t\t\tif (currentAction !== 'create') storeListboxValue.set('create');\n\t\t\treturn;\n\t\t}\n\n\t\t// Selection logic: prioritize Unpublish if only published items are selected\n\t\tif (stats.published > 0 && stats.published === selectedCount) {\n\t\t\tif (currentAction !== 'unpublish') storeListboxValue.set('unpublish');\n\t\t} else {\n\t\t\t// Mixed or Drafts: prioritize Publish\n\t\t\tif (currentAction !== 'publish') storeListboxValue.set('publish');\n\t\t}\n\t});\n\n\t// Connection awareness\n\t$effect(() => {\n\t\tif (typeof navigator !== 'undefined' && 'connection' in navigator) {\n\t\t\tconst conn = (navigator as any).connection;\n\t\t\tif (conn) {\n\t\t\t\tconst checkConnection = () => {\n\t\t\t\t\tisSlowConnection = conn.saveData || conn.effectiveType === 'slow-2g' || conn.effectiveType === '2g';\n\t\t\t\t};\n\t\t\t\tcheckConnection();\n\t\t\t\tconn.addEventListener('change', checkConnection);\n\t\t\t\treturn () => conn.removeEventListener('change', checkConnection);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Click outside handler\n\t$effect(() => {\n\t\tif (!isDropdownOpen) return;\n\n\t\tconst handleClickOutside = (event: MouseEvent) => {\n\t\t\tconst target = event.target as HTMLElement;\n\t\t\tif (dropdownRef && !dropdownRef.contains(target)) {\n\t\t\t\tisDropdownOpen = false;\n\t\t\t}\n\t\t};\n\n\t\tconst timer = setTimeout(() => {\n\t\t\tdocument.addEventListener('click', handleClickOutside);\n\t\t}, 10);\n\n\t\treturn () => {\n\t\t\tclearTimeout(timer);\n\t\t\tdocument.removeEventListener('click', handleClickOutside);\n\t\t};\n\t});\n\n\t// --- Keyboard Shortcuts ---\n\tfunction handleKeyDown(e: KeyboardEvent) {\n\t\t// Dropdown navigation when open\n\t\tif (isDropdownOpen) {\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'Escape':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tisDropdownOpen = false;\n\t\t\t\t\treturn;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfocusedIndex = Math.min(focusedIndex + 1, availableActions.length - 1);\n\t\t\t\t\tmenuItemRefs[focusedIndex]?.focus();\n\t\t\t\t\treturn;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfocusedIndex = Math.max(focusedIndex - 1, 0);\n\t\t\t\t\tmenuItemRefs[focusedIndex]?.focus();\n\t\t\t\t\treturn;\n\t\t\t\tcase 'Home':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfocusedIndex = 0;\n\t\t\t\t\tmenuItemRefs[0]?.focus();\n\t\t\t\t\treturn;\n\t\t\t\tcase 'End':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfocusedIndex = availableActions.length - 1;\n\t\t\t\t\tmenuItemRefs[focusedIndex]?.focus();\n\t\t\t\t\treturn;\n\t\t\t\tcase 'Enter':\n\t\t\t\tcase ' ':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst action = availableActions[focusedIndex];\n\t\t\t\t\tif (action && !(action.requiresSelection && !hasSelections)) {\n\t\t\t\t\t\thandleAction(action.type);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Global shortcuts with Alt key\n\t\tif (!e.altKey) return;\n\n\t\tconst matchedConfig = ACTION_CONFIGS.find((config) => {\n\t\t\tif (!config.shortcutKey) return false;\n\t\t\treturn e.key.toLowerCase() === config.shortcutKey.toLowerCase() || e.key === config.shortcutKey;\n\t\t});\n\n\t\tif (matchedConfig) {\n\t\t\te.preventDefault();\n\t\t\tif (matchedConfig.requiresSelection && !hasSelections) {\n\t\t\t\tlogger.debug(`[MultiButton] Keyboard shortcut ${matchedConfig.shortcut} requires selection`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\thandleAction(matchedConfig.type);\n\t\t}\n\t}\n\n\tonMount(() => {\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\t});\n\n\tonDestroy(() => {\n\t\twindow.removeEventListener('keydown', handleKeyDown);\n\t});\n\n\t// --- Action Handlers ---\n\tasync function handleAction(action: ActionType) {\n\t\tisDropdownOpen = false;\n\n\t\t// Validate batch size\n\t\tif (selectedCount > batchSizeLimit && isSlowConnection) {\n\t\t\tconst limitMsg = m.entrylist_multibutton_limit_warning\n\t\t\t\t? m.entrylist_multibutton_limit_warning({ count: batchSizeLimit })\n\t\t\t\t: 'Slow connection: Batch size limited';\n\t\t\tshowToast(limitMsg, 'warning');\n\t\t\treturn;\n\t\t}\n\n\t\t// IMMEDIATE EXECUTION - No Queue, No Undo\n\t\tawait executeAction(action);\n\t}\n\n\tasync function executeAction(action: ActionType) {\n\t\tisProcessing = true;\n\t\ttry {\n\t\t\tswitch (action) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tcreate();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'publish':\n\t\t\t\t\tawait publish();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'unpublish':\n\t\t\t\t\tawait unpublish();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'draft':\n\t\t\t\t\tawait draft();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'clone':\n\t\t\t\t\tawait clone();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\t// Delete usually has its own confirmation in parent if triggering via deleteAction?\n\t\t\t\t\t// If not, we should probably confirm. But user said \"only DELETE need a confirmation modal\".\n\t\t\t\t\t// Assuming deleteAction triggers the modal logic or actual delete.\n\t\t\t\t\tawait deleteAction(showDeleted);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'schedule':\n\t\t\t\t\tconst now = new Date().toISOString();\n\t\t\t\t\tschedule(now, 'publish');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconst errMsg = (error as Error).message;\n\t\t\tshowToast(errMsg, 'error');\n\t\t\tlogger.error(`[MultiButton] Action ${action} failed:`, error);\n\t\t} finally {\n\t\t\tisProcessing = false;\n\t\t}\n\t}\n\n\tfunction toggleDropdown(e: MouseEvent) {\n\t\te.stopPropagation();\n\t\tisDropdownOpen = !isDropdownOpen;\n\t}\n\n\tfunction handleOptionClick(event: Event, actionType: ActionType) {\n\t\tevent.preventDefault();\n\t\tstoreListboxValue.set(actionType);\n\t\tmanualActionSet = true;\n\t\tisDropdownOpen = false;\n\t}\n\n\tfunction handleMainButtonClick() {\n\t\thandleAction(currentAction);\n\t}\n</script>\n\n<!-- Multi-button group -->\n<div class=\"relative flex items-center\" bind:this={dropdownRef}>\n\t<div class=\"flex items-center gap-0\">\n\t\t<!-- Archive Toggle -->\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonclick={() => (showDeleted = !showDeleted)}\n\t\t\tclass=\"mt-1 btn rounded-full mr-2 transition-all duration-200 active:scale-90 {!showDeleted\n\t\t\t\t? 'preset-outlined-surface-500 '\n\t\t\t\t: 'preset-filled-error-500 text-white ring-2 ring-error-500 animate-pulse'}\"\n\t\t\ttitle={showDeleted ? m.entrylist_multibutton_show_active() : m.entrylist_multibutton_show_archived()}\n\t\t\taria-label={showDeleted ? m.entrylist_multibutton_viewing_archived() : m.entrylist_multibutton_viewing_active()}\n\t\t\taria-pressed={showDeleted}\n\t\t>\n\t\t\t<iconify-icon icon={showDeleted ? 'ic:round-archive' : 'ic:round-unarchive'} width=\"24\"></iconify-icon>\n\t\t</button>\n\n\t\t<!-- svelte-ignore a11y_click_events_have_key_events -->\n\t\t<!-- svelte-ignore a11y_no_static_element_interactions -->\n\t\t<div\n\t\t\tclass=\"group/main relative flex items-center shadow-xl overflow-visible transition-all duration-200 {!hasSelections\n\t\t\t\t? 'active:scale-95 cursor-pointer'\n\t\t\t\t: ''} rounded-l-full rounded-r-md border border-white/20\"\n\t\t\tonclick={!hasSelections ? handleMainButtonClick : undefined}\n\t\t>\n\t\t\t<!-- Main Contextual Button -->\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={hasSelections ? handleMainButtonClick : undefined}\n\t\t\t\tdisabled={isProcessing}\n\t\t\t\tclass=\"h-[40px] min-w-[60px] md:min-w-[140px] rtl:rotate-180 font-bold transition-all duration-200\n\t\t\t\t\t{hasSelections ? 'active:scale-95' : 'pointer-events-none'} \n\t\t\t\t\t{currentConfig.gradient} {currentConfig.textColor} \n\t\t\t\t\trounded-l-full rounded-r-none px-6 flex items-center gap-2 border-r border-white\n\t\t\t\t\tdisabled:opacity-50 disabled:cursor-not-allowed\"\n\t\t\t\taria-label={dynamicLabel}\n\t\t\t\taria-busy={isProcessing}\n\t\t\t>\n\t\t\t\t{#if isProcessing}\n\t\t\t\t\t<iconify-icon icon=\"svg-spinners:ring-resize\" width=\"24\" class=\"animate-spin\"></iconify-icon>\n\t\t\t\t{:else}\n\t\t\t\t\t<iconify-icon icon={currentConfig.icon} width=\"24\"></iconify-icon>\n\t\t\t\t{/if}\n\t\t\t\t<span class=\"hidden md:inline-block\">{dynamicLabel}</span>\n\t\t\t</button>\n\n\t\t\t<!-- Selection Badge -->\n\t\t\t{#if hasSelections && selectedCount > 0}\n\t\t\t\t<span\n\t\t\t\t\tclass=\"absolute left-0.5 top-3 flex h-5 w-5 items-center justify-center rounded-full bg-surface-500 text-xs font-bold text-white animate-pulse shadow-lg\"\n\t\t\t\t\ttransition:scale={{ duration: 200, easing: quintOut }}\n\t\t\t\t>\n\t\t\t\t\t{selectedCount}\n\t\t\t\t</span>\n\t\t\t{/if}\n\n\t\t\t<!-- Dropdown Toggle -->\n\t\t\t{#if !isCollectionEmpty}\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonclick={hasSelections ? toggleDropdown : undefined}\n\t\t\t\t\tdisabled={!hasSelections || isProcessing}\n\t\t\t\t\tclass=\"h-[40px] w-[32px] border-l border-white/20 transition-all duration-200 text-white flex items-center justify-center shadow-inner\n\t\t\t\t\t\t{hasSelections && !isProcessing\n\t\t\t\t\t\t? 'bg-surface-500 hover:bg-surface-400 active:scale-95 cursor-pointer'\n\t\t\t\t\t\t: currentConfig.gradient + ' pointer-events-none opacity-90'}\"\n\t\t\t\t\taria-haspopup=\"menu\"\n\t\t\t\t\taria-expanded={isDropdownOpen}\n\t\t\t\t\taria-label={m.entrylist_multibutton_toggle_menu()}\n\t\t\t\t>\n\t\t\t\t\t{#if hasSelections}\n\t\t\t\t\t\t<iconify-icon\n\t\t\t\t\t\t\ticon=\"ic:round-keyboard-arrow-down\"\n\t\t\t\t\t\t\twidth=\"20\"\n\t\t\t\t\t\t\tclass=\"transition-transform duration-200 {isDropdownOpen ? 'rotate-180' : ''}\"\n\t\t\t\t\t\t></iconify-icon>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t<!-- Dropdown Menu -->\n\t\t\t{#if isDropdownOpen}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"absolute right-0 top-full z-50 mt-2 w-64 overflow-hidden rounded-xl bg-surface-800 shadow-2xl ring-1 ring-black/20 backdrop-blur-md\"\n\t\t\t\t\trole=\"menu\"\n\t\t\t\t\taria-label={m.entrylist_multibutton_available_actions()}\n\t\t\t\t\ttransition:scale={{ duration: 150, easing: quintOut, start: 0.95, opacity: 0 }}\n\t\t\t\t>\n\t\t\t\t\t<ul class=\"flex flex-col\">\n\t\t\t\t\t\t{#each availableActions as config (config.type)}\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tclass=\"border-b border-black/10 last:border-0 relative\"\n\t\t\t\t\t\t\t\trole=\"none\"\n\t\t\t\t\t\t\t\tonmouseenter={() => (hoveredAction = config.type)}\n\t\t\t\t\t\t\t\tonmouseleave={() => (hoveredAction = null)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tonclick={(e) => handleOptionClick(e, config.type)}\n\t\t\t\t\t\t\t\t\trole=\"menuitem\"\n\t\t\t\t\t\t\t\t\tclass=\"group/item relative flex w-full items-center gap-3 px-4 py-3 text-left text-white transition-all duration-200\"\n\t\t\t\t\t\t\t\t\taria-label=\"{config.label} {config.shortcut ? `(${config.shortcut})` : ''}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<!-- Hover Gradient Overlay -->\n\t\t\t\t\t\t\t\t\t<div class=\"absolute inset-0 {config.gradient} opacity-0 transition-opacity duration-200 group-hover/item:opacity-100\"></div>\n\n\t\t\t\t\t\t\t\t\t<!-- Icon -->\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"relative z-10 flex h-8 w-8 items-center justify-center rounded-full bg-surface-700 transition-transform group-hover/item:scale-110\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<iconify-icon icon={config.icon} width=\"18\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<!-- Label & Shortcut -->\n\t\t\t\t\t\t\t\t\t<div class=\"relative z-10 flex-1\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"font-semibold\">{config.label}</div>\n\t\t\t\t\t\t\t\t\t\t{#if config.shortcut}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs text-surface-400\">{config.shortcut}</div>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<!-- Hover Indicator -->\n\t\t\t\t\t\t\t\t\t{#if hoveredAction === config.type}\n\t\t\t\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:chevron-right\" width=\"18\" class=\"relative z-10 text-white\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t<!-- Danger Badge -->\n\t\t\t\t\t\t\t\t\t{#if config.dangerLevel === 'high'}\n\t\t\t\t\t\t\t\t\t\t<span class=\"relative z-10 rounded bg-error-500/30 px-1.5 py-0.5 text-xs font-bold text-error-300\"></span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t.menu-dropdown {\n\t\tanimation: slideDown 0.2s ease-out;\n\t}\n\n\t@keyframes slideDown {\n\t\tfrom {\n\t\t\topacity: 0;\n\t\t\ttransform: translateY(-10px);\n\t\t}\n\t\tto {\n\t\t\topacity: 1;\n\t\t\ttransform: translateY(0);\n\t\t}\n\t}\n</style>\n","<!--\n@file src/components/TranslationStatus.svelte\n@component\n**Translation status component for displaying translation progress per language.**\n\nFIXES:\n1. Multi-field support - tracks all translatable fields in a collection\n2. Widget-aware - properly handles widgets with multiple inputs (like SEO)\n3. Field-level granularity - individual field progress tracking\n\n@example\n<TranslationStatus />\n-->\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { untrack } from 'svelte';\n\timport { SvelteSet } from 'svelte/reactivity';\n\timport { publicEnv } from '@shared/stores/globalSettings.svelte';\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/state';\n\timport { collection, collectionValue, mode } from '@shared/stores/collectionStore.svelte';\n\timport { contentLanguage, translationProgress } from '@shared/stores/store.svelte';\n\timport { getFieldName } from '@shared/utils/utils';\n\timport { getLanguageName } from '@shared/utils/languageUtils';\n\n\t// SkeletonUI\n\timport { Progress, Menu, Portal } from '@skeletonlabs/skeleton-svelte';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\timport type { Locale } from '@shared/paraglide/runtime';\n\n\t// State\n\tlet isInitialized = $state(false);\n\tlet completionTotals = $state({ total: 0, translated: 0 });\n\n\t// Derived values\n\tconst availableLanguages = $derived.by(() => {\n\t\tconst languages = publicEnv?.AVAILABLE_CONTENT_LANGUAGES;\n\t\tif (!languages || !Array.isArray(languages)) {\n\t\t\treturn ['en'] as Locale[];\n\t\t}\n\t\treturn languages as Locale[];\n\t});\n\n\tconst currentLanguage = $derived(contentLanguage.value);\n\tconst currentMode = $derived(mode.value);\n\tconst isViewMode = $derived(currentMode === 'view');\n\n\t// Logic: In View Mode, only show *other* languages (switcher style). In Edit Mode, show all (status style).\n\tconst dropdownLanguages = $derived.by(() => {\n\t\tif (isViewMode) {\n\t\t\treturn availableLanguages.filter((l) => l !== currentLanguage);\n\t\t}\n\t\treturn availableLanguages;\n\t});\n\n\tconst overallPercentage = $derived.by(() => {\n\t\tconst { total, translated } = completionTotals;\n\t\treturn total > 0 ? Math.round((translated / total) * 100) : 0;\n\t});\n\n\tconst showProgress = $derived(translationProgress.value?.show || completionTotals.total > 0);\n\n\t// Calculate language-specific progress\n\tconst languageProgress = $derived.by(() => {\n\t\tconst progress: Record<string, number> = {};\n\t\tconst currentProgress = translationProgress.value;\n\n\t\tfor (const lang of availableLanguages) {\n\t\t\tconst langProgress = currentProgress?.[lang as Locale];\n\t\t\tif (langProgress && langProgress.total.size > 0) {\n\t\t\t\tprogress[lang] = Math.round((langProgress.translated.size / langProgress.total.size) * 100);\n\t\t\t} else {\n\t\t\t\tprogress[lang] = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn progress;\n\t});\n\n\t// Helper functions\n\tfunction getProgressColor(value: number): string {\n\t\tif (value >= 80) return 'bg-primary-500';\n\t\tif (value >= 40) return 'bg-warning-500';\n\t\treturn 'bg-error-500';\n\t}\n\n\tfunction getTextColor(value: number): string {\n\t\treturn getProgressColor(value).replace('bg-', 'text-');\n\t}\n\n\t/**\n\t * FIXED: Multi-field translation detection\n\t * Handles complex widgets like SEO with nested language objects\n\t */\n\tfunction isFieldTranslated(value: unknown): boolean {\n\t\tif (value === null || value === undefined) return false;\n\n\t\t// Handle string values (simple fields)\n\t\tif (typeof value === 'string') return value.trim() !== '';\n\n\t\t// Handle object values (complex widgets like SEO)\n\t\t// For complex widgets, value might be an object with language keys\n\t\tif (typeof value === 'object' && !Array.isArray(value)) {\n\t\t\tconst obj = value as Record<string, any>;\n\n\t\t\t// Check if this is a language-keyed object (SEO widget pattern)\n\t\t\t// Look for language codes as keys (en, de, fr, etc.)\n\t\t\tconst hasLanguageKeys = availableLanguages.some((lang) => lang in obj);\n\n\t\t\tif (hasLanguageKeys) {\n\t\t\t\t// For language-keyed objects, check if the current language has content\n\t\t\t\tconst langData = obj[currentLanguage as string];\n\t\t\t\tif (!langData) return false;\n\n\t\t\t\t// Check if any required field in the language data has content\n\t\t\t\t// For SEO: check title and description\n\t\t\t\tif ('title' in langData && typeof langData.title === 'string') {\n\t\t\t\t\treturn langData.title.trim() !== '';\n\t\t\t\t}\n\t\t\t\tif ('description' in langData && typeof langData.description === 'string') {\n\t\t\t\t\treturn langData.description.trim() !== '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// For other objects, check if they have any meaningful content\n\t\t\treturn Object.values(obj).some((v) => {\n\t\t\t\tif (typeof v === 'string') return v.trim() !== '';\n\t\t\t\tif (typeof v === 'number') return true;\n\t\t\t\tif (Array.isArray(v)) return v.length > 0;\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\n\t\t// Handle arrays and other types\n\t\tif (Array.isArray(value)) return value.length > 0;\n\t\treturn Boolean(value);\n\t}\n\n\t/**\n\t * FIXED: Widget-aware field name generation\n\t * Handles both simple and complex (multi-input) widgets\n\t */\n\t// Updated to handle both generic widgets with simple values and multi-field widgets\n\tfunction getTranslatableFieldPath(collectionName: string, field: any): string[] {\n\t\tconst baseName = `${collectionName}.${getFieldName(field)}`;\n\t\t// Check if widget has a custom path definition (Generic Architecture)\n\t\tif (field.widget?.getTranslatablePaths) {\n\t\t\treturn field.widget.getTranslatablePaths(baseName);\n\t\t}\n\n\t\t// Fallback for simple widgets\n\t\treturn [baseName];\n\t}\n\n\t// Initialize translation progress\n\tfunction initializeTranslationProgress(currentCollection: { fields: unknown[]; name?: unknown; _id?: string }): void {\n\t\tconst newProgress: typeof translationProgress.value = { show: false };\n\n\t\tfor (const lang of availableLanguages) {\n\t\t\tnewProgress[lang] = {\n\t\t\t\ttotal: new SvelteSet<string>(),\n\t\t\t\ttranslated: new SvelteSet<string>()\n\t\t\t};\n\t\t}\n\n\t\tlet hasTranslatableFields = false;\n\n\t\t// Iterate through all fields\n\t\tfor (const field of currentCollection.fields as { translated?: boolean; label: string; widget?: any }[]) {\n\t\t\tif (field.translated) {\n\t\t\t\thasTranslatableFields = true;\n\n\t\t\t\t// Get all trackable paths for this field\n\t\t\t\tconst fieldPaths = getTranslatableFieldPath(currentCollection.name as string, field);\n\n\t\t\t\t// Add each path to all languages\n\t\t\t\tfor (const lang of availableLanguages) {\n\t\t\t\t\tfieldPaths.forEach((path) => {\n\t\t\t\t\t\tnewProgress[lang]?.total.add(path);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnewProgress.show = hasTranslatableFields;\n\t\ttranslationProgress.value = newProgress;\n\t}\n\n\t/**\n\t * FIXED: Multi-field progress tracking\n\t * Properly handles complex widgets with nested language data\n\t */\n\tfunction updateTranslationProgressFromFields(\n\t\tcurrentCollection: { fields: unknown[]; name?: unknown },\n\t\tcurrentCollectionValue: Record<string, any>\n\t): void {\n\t\tconst newProgress = { ...translationProgress.value };\n\t\tlet hasUpdates = false;\n\n\t\tfor (const lang of availableLanguages) {\n\t\t\tconst originalLangProgress = newProgress[lang];\n\t\t\tif (!originalLangProgress) continue;\n\n\t\t\tconst newTranslatedSet = new SvelteSet(originalLangProgress.translated);\n\t\t\tlet langHasUpdates = false;\n\n\t\t\tfor (const field of currentCollection.fields as { translated?: boolean; label: string; widget?: any }[]) {\n\t\t\t\tif (field.translated) {\n\t\t\t\t\tconst dbFieldName = getFieldName(field, false);\n\t\t\t\t\tconst fieldValue = currentCollectionValue[dbFieldName];\n\n\t\t\t\t\t// Get all trackable paths for this field\n\t\t\t\t\tconst fieldPaths = getTranslatableFieldPath(currentCollection.name as string, field);\n\n\t\t\t\t\t// Check translation status for each path\n\t\t\t\t\tfieldPaths.forEach((fullPath) => {\n\t\t\t\t\t\t// Extract sub-field name if present (e.g., \"title\" from \"seo.title\")\n\t\t\t\t\t\tconst pathParts = fullPath.split('.');\n\t\t\t\t\t\tconst subFieldName = pathParts.length > 2 ? pathParts[pathParts.length - 1] : null;\n\n\t\t\t\t\t\tlet valueToCheck: unknown;\n\n\t\t\t\t\t\tif (subFieldName && fieldValue && typeof fieldValue === 'object') {\n\t\t\t\t\t\t\t// For complex widgets, check the language-specific sub-field\n\t\t\t\t\t\t\tconst langData = (fieldValue as Record<string, any>)[lang];\n\t\t\t\t\t\t\tvalueToCheck = langData?.[subFieldName];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// For simple widgets, check the language-specific value\n\t\t\t\t\t\t\tif (fieldValue && typeof fieldValue === 'object' && !Array.isArray(fieldValue)) {\n\t\t\t\t\t\t\t\tvalueToCheck = (fieldValue as Record<string, any>)[lang];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalueToCheck = fieldValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst isTranslated = isFieldTranslated(valueToCheck);\n\t\t\t\t\t\tconst wasTranslated = originalLangProgress.translated.has(fullPath);\n\n\t\t\t\t\t\tif (isTranslated && !wasTranslated) {\n\t\t\t\t\t\t\tnewTranslatedSet.add(fullPath);\n\t\t\t\t\t\t\tlangHasUpdates = true;\n\t\t\t\t\t\t} else if (!isTranslated && wasTranslated) {\n\t\t\t\t\t\t\tnewTranslatedSet.delete(fullPath);\n\t\t\t\t\t\t\tlangHasUpdates = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (langHasUpdates) {\n\t\t\t\tnewProgress[lang] = {\n\t\t\t\t\t...originalLangProgress,\n\t\t\t\t\ttranslated: newTranslatedSet\n\t\t\t\t};\n\t\t\t\thasUpdates = true;\n\t\t\t}\n\t\t}\n\n\t\tif (hasUpdates) {\n\t\t\ttranslationProgress.value = newProgress;\n\t\t\tcalculateCompletionTotals();\n\t\t}\n\t}\n\n\t// Calculate overall completion totals\n\tfunction calculateCompletionTotals(): void {\n\t\tconst progress = translationProgress.value;\n\t\tlet total = 0;\n\t\tlet translated = 0;\n\n\t\tfor (const lang of availableLanguages) {\n\t\t\tconst langProgress = progress[lang as Locale];\n\t\t\tif (!langProgress) continue;\n\t\t\ttranslated += langProgress.translated.size;\n\t\t\ttotal += langProgress.total.size;\n\t\t}\n\n\t\tcompletionTotals = { total, translated };\n\t}\n\n\t// Dropdown positioning handled by Skeleton Menu\n\n\tfunction handleLanguageChange(selectedLanguage: Locale): void {\n\t\tlogger.debug('[TranslationStatus] Language change:', contentLanguage.value, '', selectedLanguage);\n\t\tcontentLanguage.set(selectedLanguage);\n\n\t\t// Handle View Mode Navigation (previously handleViewModeLanguageChange)\n\t\tif (isViewMode) {\n\t\t\tconst currentCollectionId = collection.value?._id;\n\t\t\tconst currentSearch = page.url.search;\n\n\t\t\tif (currentCollectionId) {\n\t\t\t\tconst newPath = `/${selectedLanguage}/${currentCollectionId}${currentSearch}`;\n\t\t\t\tgoto(newPath, { replaceState: false, invalidateAll: true });\n\t\t\t} else {\n\t\t\t\tconst currentPath = page.url.pathname;\n\t\t\t\tconst pathParts = currentPath.split('/').filter(Boolean);\n\t\t\t\tif (pathParts.length > 0) {\n\t\t\t\t\tpathParts[0] = selectedLanguage;\n\t\t\t\t\tconst newPath = '/' + pathParts.join('/') + currentSearch;\n\t\t\t\t\tgoto(newPath, { replaceState: false, invalidateAll: true });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof window !== 'undefined') {\n\t\t\tconst currentPath = window.location.pathname;\n\t\t\tconst pathParts = currentPath.split('/').filter(Boolean);\n\n\t\t\tif (pathParts.length > 0) {\n\t\t\t\tpathParts[0] = selectedLanguage;\n\t\t\t\tconst newPath = '/' + pathParts.join('/') + window.location.search;\n\t\t\t\twindow.history.replaceState({}, '', newPath);\n\t\t\t\tlogger.debug('[TranslationStatus] Updated URL to:', newPath);\n\t\t\t}\n\n\t\t\tconst customEvent = new CustomEvent('languageChanged', {\n\t\t\t\tdetail: { language: selectedLanguage },\n\t\t\t\tbubbles: true\n\t\t\t});\n\t\t\twindow.dispatchEvent(customEvent);\n\t\t\tlogger.debug('[TranslationStatus] Dispatched languageChanged event');\n\t\t}\n\t}\n\n\t// Effects\n\tlet lastEntryId = $state<string | undefined>(undefined);\n\tlet lastCollectionId = $state<string | undefined>(undefined);\n\n\t$effect(() => {\n\t\tconst currentCollection = collection.value;\n\t\tconst currentEntry = collectionValue.value as { _id?: string } | undefined;\n\t\tconst entryId = currentEntry?._id;\n\t\tconst collectionId = currentCollection?._id;\n\n\t\tconst collectionChanged = collectionId !== lastCollectionId;\n\t\tconst entryChanged = entryId !== lastEntryId;\n\n\t\tif (currentCollection?.fields && (collectionChanged || entryChanged)) {\n\t\t\tlogger.debug('[TranslationStatus] Initializing translation progress', {\n\t\t\t\tcollectionId,\n\t\t\t\tentryId,\n\t\t\t\tcollectionChanged,\n\t\t\t\tentryChanged,\n\t\t\t\tmode: entryId ? 'edit' : 'create'\n\t\t\t});\n\n\t\t\tuntrack(() => {\n\t\t\t\tisInitialized = false;\n\t\t\t\tinitializeTranslationProgress(currentCollection);\n\n\t\t\t\tif (entryId && currentEntry && Object.keys(currentEntry).length > 0) {\n\t\t\t\t\tupdateTranslationProgressFromFields(currentCollection, currentEntry);\n\t\t\t\t} else {\n\t\t\t\t\tcalculateCompletionTotals();\n\t\t\t\t}\n\n\t\t\t\tisInitialized = true;\n\t\t\t\tlastEntryId = entryId;\n\t\t\t\tlastCollectionId = collectionId;\n\t\t\t});\n\t\t}\n\t});\n\n\tlet lastCollectionValueStr = $state<string>('');\n\t$effect(() => {\n\t\tconst currentCollection = collection.value;\n\t\tconst currentCollectionValue = collectionValue.value as Record<string, any>;\n\n\t\tif (currentCollection?.fields && currentCollectionValue && Object.keys(currentCollectionValue).length > 0 && isInitialized) {\n\t\t\tconst currentStr = JSON.stringify(currentCollectionValue);\n\t\t\tif (currentStr !== lastCollectionValueStr) {\n\t\t\t\tlogger.debug('[TranslationStatus] Collection value changed, updating progress');\n\t\t\t\tupdateTranslationProgressFromFields(currentCollection, currentCollectionValue);\n\t\t\t\tlastCollectionValueStr = currentStr;\n\t\t\t}\n\t\t}\n\t});\n</script>\n\n<div class=\"translation-status-container relative mt-1 inline-block text-left\">\n\t<Menu>\n\t\t<Menu.Trigger\n\t\t\tclass=\"btn preset-outlined-surface-500 rounded-full flex w-full items-center gap-1 p-1.5 transition-all duration-200 hover:scale-105\"\n\t\t\taria-label=\"Toggle language menu\"\n\t\t>\n\t\t\t<span class=\"font-medium md:hidden\">{currentLanguage.toUpperCase()}</span>\n\t\t\t<span class=\"font-medium hidden md:inline\">{getLanguageName(currentLanguage)}</span>\n\t\t\t<iconify-icon icon=\"mdi:chevron-down\" class=\"h-5 w-5 transition-transform duration-200\" aria-hidden=\"true\"></iconify-icon>\n\t\t</Menu.Trigger>\n\n\t\t<Portal>\n\t\t\t<Menu.Positioner>\n\t\t\t\t<Menu.Content\n\t\t\t\t\tclass=\"card p-2 shadow-xl preset-filled-surface-100-900 z-9999 border border-surface-200 dark:border-surface-500 {showProgress &&\n\t\t\t\t\t!isViewMode\n\t\t\t\t\t\t? 'w-72'\n\t\t\t\t\t\t: 'w-56'}\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"px-3 py-2 text-xs font-bold text-tertiary-500 dark:text-primary-500 uppercase tracking-wider text-center border-b border-surface-200 dark:border-surface-50 mb-1\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{m.applayout_contentlanguage()}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#each dropdownLanguages as lang (lang)}\n\t\t\t\t\t\t{@const percentage = languageProgress[lang] || 0}\n\t\t\t\t\t\t{@const isActive = currentLanguage === lang}\n\n\t\t\t\t\t\t<Menu.Item value={lang} onclick={() => handleLanguageChange(lang as Locale)} class={isActive ? 'bg-primary-500/20' : ''}>\n\t\t\t\t\t\t\t<div class=\"flex w-full items-center justify-between gap-2\">\n\t\t\t\t\t\t\t\t<!-- Left: Language Name (Desktop) / Short Code (Mobile) -->\n\t\t\t\t\t\t\t\t<span class=\"font-medium transition-colors duration-200 {isActive ? 'text-primary-700 dark:text-primary-300' : ''}\">\n\t\t\t\t\t\t\t\t\t<span class=\"md:hidden\">{lang.toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t<span class=\"hidden md:inline\">{getLanguageName(lang)}</span>\n\t\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t\t<!-- Right: Code, Status, Progress -->\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t{#if !isViewMode && showProgress && translationProgress.value?.[lang as Locale]}\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex w-32 items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Progress class=\"transition-all duration-300\" value={percentage} aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"min-w-8 text-right text-sm font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t\t{percentage}%\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<!-- View Mode: Show Code on Right -->\n\t\t\t\t\t\t\t\t\t\t<span class=\"hidden text-xs font-normal text-tertiary-500 dark:text-primary-500 md:inline\">{lang.toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t{#if isActive}\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs\" aria-label=\"Current language\"></span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t{/each}\n\n\t\t\t\t\t{#if !isViewMode && showProgress}\n\t\t\t\t\t\t<Menu.Separator />\n\t\t\t\t\t\t<div class=\"px-4 py-2\">\n\t\t\t\t\t\t\t<div class=\"mb-1 text-center text-xs font-medium text-tertiary-500 dark:text-primary-500\">\n\t\t\t\t\t\t\t\t{m.translationsstatus_completed()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex items-center justify-between gap-3\">\n\t\t\t\t\t\t\t\t{#if overallPercentage}\n\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t<Progress class=\"transition-all duration-300\" value={overallPercentage} aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t<span class=\"min-w-10 text-right text-sm font-bold {getTextColor(overallPercentage)}\">\n\t\t\t\t\t\t\t\t\t{overallPercentage}%\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</Menu.Content>\n\t\t\t</Menu.Positioner>\n\t\t</Portal>\n\t</Menu>\n\n\t<div class=\"mt-0.5 transition-all duration-300\">\n\t\t<!-- External progress bar removed to prevent header overflow -->\n\t</div>\n</div>\n","<!--\n@file src/components/collectionDisplay/EntryList.svelte\n@component\n**EntryList component to display collections data in a tabular format.**\n\n### Features:\n- **Search & Filter**: Real-time server-side search and field-level filtering.\n- **Pagination**: Configurable rows per page and page navigation.\n- **Selection**: Multi-select entries for bulk actions.\n- **Sorting**: Clickable headers for server-side sorting.\n- **Preloading**: Hover-based predictive data preloading for faster navigation.\n- **Smart Actions**: Integrated with `EntryList_MultiButton` for context-aware operations.\n\n### Props\n- `entries` (Array): The raw collection entry data from the server.\n- `pagination` (Object): Pagination metadata (currentPage, pageSize, totalItems, pagesCount).\n- `contentLanguage` (String): The language for displaying translatable field data.\n- `breadcrumb` (Array, optional): Breadcrumb navigation paths.\n- `collectionStats` (Object, optional): Stats like count and last modified.\n\n### Keyboard Shortcuts\n- `Alt + N`: Create new entry\n- `Alt + P`: Publish selected\n- `Alt + U`: Unpublish selected\n- `Alt + D`: Move selected to Draft\n- `Alt + Del`: Delete selected\n-->\n\n<script module lang=\"ts\">\n\texport type SortOrder = 0 | 1 | -1; // Strict type for sort order\n</script>\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { goto, invalidateAll } from '$app/navigation';\n\timport { page } from '$app/state';\n\timport { browser } from '$app/environment';\n\timport { untrack } from 'svelte';\n\n\t// Utils\n\timport { batchDeleteEntries, deleteEntry, invalidateCollectionCache, updateEntryStatus } from '@shared/utils/apiClient';\n\timport { formatDisplayDate } from '@shared/utils/dateUtils';\n\timport { cloneEntries, setEntriesStatus } from '@shared/utils/entryActions';\n\timport { debounce, getFieldName, meta_data } from '@shared/utils/utils';\n\timport { preloadEntry, reflectModeInURL } from '@shared/utils/navigationUtils';\n\timport { showToast } from '@shared/utils/toast';\n\n\t// Config\n\timport { publicEnv } from '@shared/stores/globalSettings.svelte';\n\n\t// Types\n\timport type { PaginationSettings, TableHeader } from '@cms-types/content';\n\timport type { StatusType } from '@cms-types/content';\n\timport { StatusTypes } from '@cms-types/content';\n\n\t// Stores\n\timport { collection, collectionValue, mode, setCollectionValue, setMode, setModifyEntry, statusMap } from '@shared/stores/collectionStore.svelte';\n\timport { screen } from '@shared/stores/screenSizeStore.svelte';\n\timport { app } from '@shared/stores/store.svelte';\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Components\n\timport FloatingInput from '@cms/components/system/inputs/floatingInput.svelte';\n\timport Status from '@cms/components/system/table/Status.svelte';\n\timport TableFilter from '@cms/components/system/table/TableFilter.svelte';\n\timport TableIcons from '@cms/components/system/table/TableIcons.svelte';\n\timport TablePagination from '@cms/components/system/table/TablePagination.svelte';\n\timport EntryListMultiButton from './EntryList_MultiButton.svelte';\n\timport TranslationStatus from './TranslationStatus.svelte';\n\n\t// Skeleton\n\timport { showDeleteConfirm, showStatusChangeConfirm } from '@shared/utils/modalUtils';\n\n\t// Svelte-dnd-action\n\timport { dndzone } from 'svelte-dnd-action';\n\timport { flip } from 'svelte/animate';\n\n\t// =================================================================\n\t// 1. RECEIVE DATA AS PROPS (From +page.server.ts)\n\t// =================================================================\n\timport type { EntryListProps } from '@cms-types/content';\n\n\t// =================================================================\n\t// 1. RECEIVE DATA AS PROPS (From +page.server.ts)\n\t// =================================================================\n\tconst {\n\t\tentries: serverEntries = [],\n\t\tpagination: serverPagination = { currentPage: 1, pageSize: 10, totalItems: 0, pagesCount: 1 },\n\t\tcontentLanguage: propContentLanguage,\n\t\tbreadcrumb = [],\n\t\tcollectionStats = null\n\t}: EntryListProps & {\n\t\tbreadcrumb?: Array<{ name: string; path: string }>;\n\t\tcollectionStats?: { _id: string; name: string; count: number; lastModified: string } | null;\n\t} = $props();\n\n\t// =================================================================\n\t// 2. USE SERVER DATA (Simple $derived - No Client-Side State)\n\t// =================================================================\n\tconst tableData = $derived(serverEntries);\n\tconst pagesCount = $derived(serverPagination.pagesCount);\n\tconst totalItems = $derived(serverPagination.totalItems);\n\n\t// =================================================================\n\t// 3. URL-BASED NAVIGATION (Replaces All Client-Side Fetching)\n\t// =================================================================\n\tfunction updateURL(updates: Record<string, string | number | null>) {\n\t\tconst newUrl = new URL(page.url);\n\t\tObject.entries(updates).forEach(([key, value]) => {\n\t\t\tif (value === null || value === '') {\n\t\t\t\tnewUrl.searchParams.delete(key);\n\t\t\t} else {\n\t\t\t\tnewUrl.searchParams.set(key, String(value));\n\t\t\t}\n\t\t});\n\t\tgoto(newUrl, { keepFocus: true, noScroll: true });\n\t}\n\n\tfunction onUpdatePage(newPage: number) {\n\t\tentryListPaginationSettings.currentPage = newPage;\n\t\tupdateURL({ page: newPage });\n\t}\n\n\tfunction onUpdateRowsPerPage(rows: number) {\n\t\tentryListPaginationSettings.rowsPerPage = rows;\n\t\tentryListPaginationSettings.currentPage = 1;\n\t\tupdateURL({ page: 1, pageSize: rows });\n\t}\n\n\tfunction onSortChange(fieldName: string) {\n\t\tconst newSorted = { ...entryListPaginationSettings.sorting };\n\t\tif (newSorted.sortedBy === fieldName) {\n\t\t\tnewSorted.isSorted = newSorted.isSorted === 1 ? -1 : ((newSorted.isSorted === -1 ? 0 : 1) as SortOrder);\n\t\t\tif (newSorted.isSorted === 0) newSorted.sortedBy = '';\n\t\t} else {\n\t\t\tnewSorted.sortedBy = fieldName;\n\t\t\tnewSorted.isSorted = 1;\n\t\t}\n\t\tentryListPaginationSettings.sorting = newSorted;\n\t\tupdateURL({\n\t\t\tsort: newSorted.sortedBy || null,\n\t\t\torder: newSorted.isSorted === 1 ? 'asc' : newSorted.isSorted === -1 ? 'desc' : null\n\t\t});\n\t}\n\n\tconst filterDebounce = debounce(500);\n\n\tfunction onFilterChange(filterName: string, value: string) {\n\t\tfilterDebounce(() => {\n\t\t\tconst newFilters = { ...entryListPaginationSettings.filters };\n\t\t\tif (value) {\n\t\t\t\tnewFilters[filterName] = value;\n\t\t\t} else {\n\t\t\t\tdelete newFilters[filterName];\n\t\t\t}\n\t\t\tentryListPaginationSettings.filters = newFilters;\n\n\t\t\t// Build filter URL params\n\t\t\tconst filterUpdates: Record<string, string | null> = {};\n\t\t\tObject.entries(newFilters).forEach(([key, val]) => {\n\t\t\t\tfilterUpdates[`filter_${key}`] = val || null;\n\t\t\t});\n\t\t\tfilterUpdates.page = '1'; // Reset to page 1 on filter change\n\t\t\tupdateURL(filterUpdates);\n\t\t});\n\t}\n\n\tasync function onActionSuccess() {\n\t\t// Clear selections\n\t\tObject.keys(selectedMap).forEach((key) => delete selectedMap[key]);\n\t\tSelectAll = false;\n\t\t// Tell SvelteKit to re-run the server load function\n\t\tawait invalidateAll();\n\t}\n\n\t// =================================================================\n\t// 4. KEEP REMAINING UI STATE & LOGIC (Selection, Display, etc.)\n\t// =================================================================\n\n\tlet SelectAll: boolean = $state(false);\n\tconst selectedMap: Record<string, boolean> = $state({});\n\n\t// =================================================================\n\t// 5. HOVER PRELOADING FOR EDIT MODE (Enterprise UX Optimization)\n\t// =================================================================\n\tlet hoverPreloadTimeout: ReturnType<typeof setTimeout> | null = null;\n\tconst preloadedEntries = new Map();\n\n\tconst PRELOAD_CACHE_TTL = 30000; // ms - keep preloaded data for 30 seconds\n\n\t// Phase 2: Connection-aware preloading\n\tlet isSlowConnection = $state(false);\n\tlet isPreloadEnabled = $state(true);\n\n\t// Phase 2: Predictive preloading - track hover patterns\n\tconst hoverPatterns = new Map(); // entryId -> hover count\n\tconst predictivePreloadQueue: string[] = [];\n\n\t// Detect connection speed\n\t$effect(() => {\n\t\tif (browser && 'connection' in navigator) {\n\t\t\tconst conn = (navigator as any).connection || (navigator as any).mozConnection || (navigator as any).webkitConnection;\n\t\t\tif (conn) {\n\t\t\t\tconst checkConnection = () => {\n\t\t\t\t\tconst effectiveType = conn.effectiveType;\n\t\t\t\t\tconst saveData = conn.saveData;\n\t\t\t\t\tisSlowConnection = saveData || effectiveType === 'slow-2g' || effectiveType === '2g';\n\t\t\t\t\tisPreloadEnabled = !isSlowConnection;\n\t\t\t\t};\n\t\t\t\tcheckConnection();\n\t\t\t\tconn.addEventListener('change', checkConnection);\n\t\t\t\treturn () => conn.removeEventListener('change', checkConnection);\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction handleRowHoverStart(entryId: string) {\n\t\t// Phase 2: Respect connection awareness\n\t\tif (!isPreloadEnabled) {\n\t\t\tlogger.debug('[Preload] Disabled on slow connection');\n\t\t\treturn;\n\t\t}\n\n\t\t//  Use SvelteKit's preloadData\n\t\tpreloadEntry(entryId, page.url.pathname);\n\n\t\t// Phase 2: Track hover patterns for predictive preloading\n\t\tconst currentCount = hoverPatterns.get(entryId) || 0;\n\t\thoverPatterns.set(entryId, currentCount + 1);\n\n\t\t// Phase 2: Predictive preloading - queue frequently hovered entries\n\t\tif (currentCount >= 2) {\n\t\t\tpredictivePreloadQueue.push(entryId);\n\t\t}\n\t}\n\n\tfunction handleRowHoverEnd() {\n\t\t// Cancel pending preload if user moves mouse away quickly\n\t\tif (hoverPreloadTimeout) {\n\t\t\tclearTimeout(hoverPreloadTimeout);\n\t\t\thoverPreloadTimeout = null;\n\t\t}\n\t}\n\n\t// Phase 2: Batch preloading during idle time\n\tasync function batchPreloadVisibleEntries() {\n\t\tif (!isPreloadEnabled || !browser) return;\n\n\t\t// Use requestIdleCallback for background loading\n\t\tif ('requestIdleCallback' in window) {\n\t\t\t(window as any).requestIdleCallback(\n\t\t\t\tasync (deadline: any) => {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\tconst entriesToPreload = tableData.slice(0, 5); // First 5 visible entries\n\n\t\t\t\t\twhile (i < entriesToPreload.length && deadline.timeRemaining() > 0) {\n\t\t\t\t\t\tconst entry = entriesToPreload[i];\n\t\t\t\t\t\tconst cached = preloadedEntries.get(entry._id);\n\n\t\t\t\t\t\tif (!cached || Date.now() - cached.timestamp > PRELOAD_CACHE_TTL) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst preloadUrl = new URL(page.url);\n\t\t\t\t\t\t\t\tpreloadUrl.searchParams.set('edit', entry._id);\n\n\t\t\t\t\t\t\t\t// Use new warm-cache endpoint for batch preloading\n\t\t\t\t\t\t\t\tawait fetch('/api/collections/warm-cache', {\n\t\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\tcollectionId: currentCollection?._id,\n\t\t\t\t\t\t\t\t\t\tentryIds: [entry._id] // We could batch this further if we refactor the loop\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// Keep existing preload for edit page data if needed, or rely on warm cache\n\t\t\t\t\t\t\t\t/* await fetch(preloadUrl.toString(), {\n\t\t\t\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\t\t\t\tcredentials: 'include',\n\t\t\t\t\t\t\t\t\theaders: { 'X-Preload': 'true', 'X-Batch-Preload': 'true' }\n\t\t\t\t\t\t\t\t}); */\n\n\t\t\t\t\t\t\t\tpreloadedEntries.set(entry._id, {\n\t\t\t\t\t\t\t\t\tdata: null,\n\t\t\t\t\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\t\t\t\t\thoverCount: 0\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tlogger.debug(`[Batch Preload] Entry ${entry._id.substring(0, 8)} preloaded during idle`);\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tlogger.warn('[Batch Preload] Failed:', error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ timeout: 2000 }\n\t\t\t);\n\t\t}\n\t}\n\n\t// Trigger batch preload when data changes\n\t$effect(() => {\n\t\tif (tableData.length > 0 && currentMode === 'view') {\n\t\t\t// Delay to avoid interfering with initial page load\n\t\t\tsetTimeout(() => batchPreloadVisibleEntries(), 2000);\n\t\t}\n\t});\n\n\t// Cleanup preload cache periodically\n\t$effect(() => {\n\t\tconst cleanupInterval = setInterval(() => {\n\t\t\tconst now = Date.now();\n\t\t\tfor (const [entryId, cached] of preloadedEntries.entries()) {\n\t\t\t\tif (now - cached.timestamp > PRELOAD_CACHE_TTL) {\n\t\t\t\t\tpreloadedEntries.delete(entryId);\n\t\t\t\t}\n\t\t\t}\n\t\t}, 10000); // Cleanup every 10 seconds\n\n\t\treturn () => clearInterval(cleanupInterval);\n\t});\n\n\t// DND Logic for Headers\n\tfunction handleDndConsider(event: CustomEvent) {\n\t\tdisplayTableHeaders = event.detail.items;\n\t}\n\n\tfunction handleDndFinalize(event: CustomEvent) {\n\t\tdisplayTableHeaders = event.detail.items;\n\t\tentryListPaginationSettings.displayTableHeaders = displayTableHeaders;\n\t}\n\n\t// Pagination\n\tconst defaultPaginationSettings = (collectionId: string | null): PaginationSettings => ({\n\t\tcollectionId: collectionId,\n\t\tdensity: 'normal',\n\t\tsorting: { sortedBy: '', isSorted: 0 as SortOrder },\n\t\tcurrentPage: 1,\n\t\trowsPerPage: 10,\n\t\tfilters: {}, // Will be populated by an effect based on tableHeaders\n\t\tdisplayTableHeaders: []\n\t});\n\tlet entryListPaginationSettings = $state(defaultPaginationSettings(collection.value?._id ?? null));\n\n\t// Load settings from localStorage\n\t$effect(() => {\n\t\tif (browser && collection.value?._id) {\n\t\t\tconst key = `entryListPaginationSettings_${collection.value._id}`;\n\t\t\tconst saved = localStorage.getItem(key);\n\t\t\tif (saved) {\n\t\t\t\ttry {\n\t\t\t\t\tconst parsed = JSON.parse(saved);\n\t\t\t\t\t// Ensure we don't overwrite with stale data structure, merge carefully if needed\n\t\t\t\t\t// For now, assume saved state is valid but ensure collectionId matches\n\t\t\t\t\tif (parsed.collectionId === collection.value._id) {\n\t\t\t\t\t\t// We need to match the Shape of PaginationSettings\n\t\t\t\t\t\tentryListPaginationSettings = {\n\t\t\t\t\t\t\t...defaultPaginationSettings(collection.value._id),\n\t\t\t\t\t\t\t...parsed\n\t\t\t\t\t\t\t// Ensure displayTableHeaders are re-verified against current schema later by existing effects\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Failed to load entry list settings', e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// Save settings to localStorage\n\t$effect(() => {\n\t\tif (browser && collection.value?._id && entryListPaginationSettings) {\n\t\t\tconst key = `entryListPaginationSettings_${collection.value._id}`;\n\t\t\t// Debounce save slightly or just save? $effect runs after render.\n\t\t\t// Use untrack? No, we want to track entryListPaginationSettings.\n\t\t\tconst stringified = JSON.stringify(entryListPaginationSettings);\n\t\t\tlocalStorage.setItem(key, stringified);\n\t\t}\n\t});\n\n\t// Simplified stable state management\n\tlet showDeleted = $state(false); // Controls whether to view active or archived entries\n\tlet globalSearchValue = $state('');\n\tlet expand = $state(false);\n\tlet filterShow = $state(false);\n\tlet columnShow = $state(false);\n\tconst currentStates = $derived.by(() => ({\n\t\tlanguage: app.contentLanguage,\n\t\tsystemLanguage: app.systemLanguage,\n\t\tmode: mode.value,\n\t\tcollection: collection.value,\n\t\tscreenSize: screen.size\n\t}));\n\n\t// Initialize globalSearchValue from URL parameter on mount/navigation\n\t$effect(() => {\n\t\tconst urlSearch = page.url.searchParams.get('search') || '';\n\t\tif (urlSearch !== globalSearchValue) {\n\t\t\tglobalSearchValue = urlSearch;\n\t\t}\n\t});\n\n\t// Reactive effect to update URL when globalSearchValue changes (user typing)\n\t$effect(() => {\n\t\tconst searchValue = globalSearchValue;\n\t\tconst currentUrlSearch = page.url.searchParams.get('search') || '';\n\n\t\t// Skip if values match (avoid loop) or initial empty state\n\t\tif (searchValue === currentUrlSearch) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Use untrack to prevent infinite loops from URL changes\n\t\tuntrack(() => {\n\t\t\tfilterDebounce(() => {\n\t\t\t\tupdateURL({\n\t\t\t\t\tsearch: searchValue || null,\n\t\t\t\t\tpage: searchValue ? 1 : null // Reset to page 1 when searching, preserve page when clearing\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t});\n\n\t// Sync filters from URL parameters\n\t$effect(() => {\n\t\tconst searchParams = page.url.searchParams;\n\t\tuntrack(() => {\n\t\t\tconst newFilters = { ...entryListPaginationSettings.filters };\n\t\t\tlet hasChanges = false;\n\t\t\tlet hasActiveUrlFilters = false;\n\n\t\t\t// Check all filter_ params in URL\n\t\t\tfor (const [key, value] of searchParams.entries()) {\n\t\t\t\tif (key.startsWith('filter_')) {\n\t\t\t\t\tconst filterName = key.replace('filter_', '');\n\t\t\t\t\tif (newFilters[filterName] !== value) {\n\t\t\t\t\t\tnewFilters[filterName] = value;\n\t\t\t\t\t\thasChanges = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (value) hasActiveUrlFilters = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply changes if any\n\t\t\tif (hasChanges) {\n\t\t\t\tentryListPaginationSettings.filters = newFilters;\n\t\t\t}\n\n\t\t\t// Auto-open filter row if filters are present in URL\n\t\t\tif (hasActiveUrlFilters && !filterShow) {\n\t\t\t\tfilterShow = true;\n\t\t\t}\n\t\t});\n\t});\n\n\t// Destructure for easier access\n\tconst currentLanguage = $derived(propContentLanguage || currentStates.language);\n\tconst currentMode = $derived(currentStates.mode);\n\tconst currentCollection = $derived(currentStates.collection);\n\n\t// Optimized table headers with better caching\n\tconst tableHeaders = $derived.by((): TableHeader[] => {\n\t\tif (!currentCollection?.fields) return [];\n\n\t\tconst cacheKey = `${currentCollection._id}-${currentCollection.fields.length}`;\n\n\t\tconst schemaHeaders: TableHeader[] = currentCollection.fields.map(\n\t\t\t(field: any): TableHeader => ({\n\t\t\t\tid: `${cacheKey}-${getFieldName(field)}`,\n\t\t\t\tlabel: field.label,\n\t\t\t\tname: getFieldName(field),\n\t\t\t\tvisible: true\n\t\t\t})\n\t\t);\n\n\t\tconst systemHeaders: TableHeader[] = [\n\t\t\t{ id: `${cacheKey}-createdAt`, label: 'createdAt', name: 'createdAt', visible: true },\n\t\t\t{ id: `${cacheKey}-updatedAt`, label: 'updatedAt', name: 'updatedAt', visible: true },\n\t\t\t{ id: `${cacheKey}-status`, label: 'status', name: 'status', visible: true }\n\t\t];\n\n\t\treturn [...schemaHeaders, ...systemHeaders];\n\t});\n\n\t// Effect to initialize/update the filters object in paginationSettings when tableHeaders change\n\t$effect(() => {\n\t\tif (tableHeaders.length > 0) {\n\t\t\tconst newFilters: Record<string, string> = { ...entryListPaginationSettings.filters };\n\t\t\tlet filtersChanged = false;\n\t\t\tfor (const th of tableHeaders) {\n\t\t\t\tif (!(th.name in newFilters)) {\n\t\t\t\t\tnewFilters[th.name] = '';\n\t\t\t\t\tfiltersChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filtersChanged) {\n\t\t\t\tentryListPaginationSettings.filters = newFilters;\n\t\t\t}\n\t\t} else {\n\t\t\tif (Object.keys(entryListPaginationSettings.filters).length > 0) {\n\t\t\t\tentryListPaginationSettings.filters = {};\n\t\t\t}\n\t\t}\n\t});\n\n\t// displayTableHeaders are the actual headers shown, considering user's order/visibility preferences from localStorage\n\tlet displayTableHeaders: TableHeader[] = $state([]);\n\n\t$effect(() => {\n\t\t// Sync displayTableHeaders with settings or defaults from tableHeaders\n\t\tconst currentCollId = currentCollection?._id;\n\t\tconst settings = entryListPaginationSettings;\n\n\t\tif (tableHeaders.length > 0) {\n\t\t\tif (settings.collectionId === currentCollId && Array.isArray(settings.displayTableHeaders) && settings.displayTableHeaders.length > 0) {\n\t\t\t\tconst schemaHeaderMap = new Map(tableHeaders.map((th) => [th.name, th]));\n\t\t\t\tconst reconciledHeaders: TableHeader[] = [];\n\t\t\t\tconst addedNames = new Set();\n\n\t\t\t\tfor (const savedHeader of settings.displayTableHeaders) {\n\t\t\t\t\tconst schemaHeader = schemaHeaderMap.get(savedHeader.name);\n\t\t\t\t\tif (schemaHeader) {\n\t\t\t\t\t\treconciledHeaders.push({\n\t\t\t\t\t\t\t...schemaHeader,\n\t\t\t\t\t\t\tid: savedHeader.id || schemaHeader.id,\n\t\t\t\t\t\t\tvisible: typeof savedHeader.visible === 'boolean' ? savedHeader.visible : schemaHeader.visible\n\t\t\t\t\t\t});\n\t\t\t\t\t\taddedNames.add(savedHeader.name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const schemaHeader of tableHeaders) {\n\t\t\t\t\tif (!addedNames.has(schemaHeader.name)) {\n\t\t\t\t\t\treconciledHeaders.push({ ...schemaHeader, visible: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdisplayTableHeaders = reconciledHeaders;\n\t\t\t} else {\n\t\t\t\tdisplayTableHeaders = tableHeaders.map((h) => ({ ...h, visible: true }));\n\t\t\t}\n\t\t} else {\n\t\t\tdisplayTableHeaders = [];\n\t\t}\n\t});\n\n\tconst visibleTableHeaders = $derived(displayTableHeaders.filter((header) => header.visible));\n\n\tlet selectAllColumns = $state(true);\n\t$effect(() => {\n\t\tselectAllColumns = displayTableHeaders.length > 0 ? displayTableHeaders.every((h) => h.visible) : false;\n\t});\n\n\tconst cellPaddingClass = $derived(\n\t\tentryListPaginationSettings.density === 'compact'\n\t\t\t? '!p-1'\n\t\t\t: entryListPaginationSettings.density === 'comfortable'\n\t\t\t\t? '!p-3' // Comfortable\n\t\t\t\t: '!p-2' // Normal\n\t);\n\n\t$effect(() => {\n\t\tif (currentMode === 'view') {\n\t\t\tuntrack(() => {\n\t\t\t\tmeta_data.clear();\n\t\t\t\tconst currentValue = collectionValue;\n\t\t\t\tif (currentValue && Object.keys(currentValue).length > 0) {\n\t\t\t\t\tsetCollectionValue({});\n\t\t\t\t}\n\t\t\t\tconst currentCollId = collection.value?._id;\n\t\t\t\tif (currentCollId) {\n\t\t\t\t\tinvalidateCollectionCache(currentCollId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (currentMode === 'edit') {\n\t\t\tuntrack(() => {\n\t\t\t\tObject.keys(selectedMap).forEach((key) => delete selectedMap[key]);\n\t\t\t\tSelectAll = false;\n\t\t\t});\n\t\t}\n\t});\n\n\tfunction process_selectAllRows(selectAllState: boolean) {\n\t\tif (!Array.isArray(tableData)) return;\n\n\t\tuntrack(() => {\n\t\t\tif (selectAllState) {\n\t\t\t\ttableData.forEach((_entry, index) => {\n\t\t\t\t\tselectedMap[index.toString()] = true;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tObject.keys(selectedMap).forEach((key) => delete selectedMap[key]);\n\t\t\t}\n\t\t});\n\t}\n\n\t$effect(() => {\n\t\tprocess_selectAllRows(SelectAll);\n\t});\n\n\tconst hasSelections = $derived.by(() => {\n\t\treturn Object.values(selectedMap).some((isSelected) => isSelected);\n\t});\n\n\tconst hasActiveFilters = $derived(Object.values(entryListPaginationSettings.filters).some((f) => !!f) || !!globalSearchValue);\n\n\tsetModifyEntry(async (status?: keyof typeof statusMap): Promise<void> => {\n\t\tconst selectedIds = getSelectedIds();\n\t\tif (!selectedIds.length) {\n\t\t\tshowToast('No entries selected', 'warning');\n\t\t\treturn;\n\t\t}\n\n\t\tshowStatusChangeConfirm({\n\t\t\tstatus: String(status ?? ''),\n\t\t\tcount: selectedIds.length,\n\t\t\tonConfirm: async () => {\n\t\t\t\tawait setEntriesStatus(selectedIds, status as StatusType, onActionSuccess);\n\t\t\t}\n\t\t});\n\t});\n\n\tconst pathSegments = $derived(page.url.pathname.split('/').filter(Boolean));\n\tconst categoryName = $derived.by(() => {\n\t\tif (breadcrumb && breadcrumb.length > 0) {\n\t\t\treturn breadcrumb.map((b: { name: string; path: string }) => b.name).join(' > ');\n\t\t}\n\t\tconst segments = pathSegments?.slice() ?? [];\n\t\tif (segments.length > 0) {\n\t\t\tsegments.shift();\n\t\t}\n\t\treturn segments.slice(0, -1).join('>') || '';\n\t});\n\n\tconst getSelectedIds = () =>\n\t\tObject.entries(selectedMap)\n\t\t\t.filter(([, isSelected]) => isSelected)\n\t\t\t.map(([index]) => tableData[Number(index)]._id);\n\n\tconst getSelectedRawEntries = () =>\n\t\tObject.entries(selectedMap)\n\t\t\t.filter(([, isSelected]) => isSelected)\n\t\t\t.map(([index]) => tableData[Number(index)])\n\t\t\t.filter(Boolean);\n\n\tconst onCreate = async () => {\n\t\tconst newEntry: Record<string, any> = {};\n\t\tif (currentCollection?.fields) {\n\t\t\tfor (const field of currentCollection.fields) {\n\t\t\t\tif (typeof field === 'object' && field !== null && 'label' in field && 'type' in field) {\n\t\t\t\t\tconst fieldName = getFieldName(field as any, false);\n\t\t\t\t\tnewEntry[fieldName] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collection.value?.status) {\n\t\t\tnewEntry.status = collection.value.status;\n\t\t}\n\n\t\t//  GUI-FIRST PATTERN: Instant mode switch (no data loading needed for create)\n\t\t// 1. Update stores INSTANTLY (no navigation wait)\n\t\tsetMode('create');\n\t\tsetCollectionValue(newEntry);\n\n\t\t// 2. Reflect in URL (passive, no reload)\n\t\treflectModeInURL('create');\n\n\t\t// 3. Toggle UI\n\t\tawait Promise.resolve();\n\t\tui.forceUpdate();\n\n\t\tlogger.debug('[Create] INSTANT - New entry mode');\n\t};\n\n\tconst onPublish = () => setEntriesStatus(getSelectedIds(), StatusTypes.publish, onActionSuccess);\n\tconst onUnpublish = () => setEntriesStatus(getSelectedIds(), StatusTypes.unpublish, onActionSuccess);\n\tconst onDraft = () => setEntriesStatus(getSelectedIds(), StatusTypes.draft, onActionSuccess);\n\tconst onDelete = (isPermanent = false) => {\n\t\tconst selectedIds = getSelectedIds();\n\t\tif (!selectedIds.length) {\n\t\t\tshowToast('No entries selected', 'warning');\n\t\t\treturn;\n\t\t}\n\n\t\tconst useArchiving = publicEnv?.USE_ARCHIVE_ON_DELETE ?? false;\n\t\tconst isForArchived = showDeleted || isPermanent;\n\t\tconst willDelete = !useArchiving || isForArchived;\n\t\tconst actionVerb = willDelete ? 'delete' : 'archive';\n\n\t\tshowDeleteConfirm({\n\t\t\tisArchive: !willDelete,\n\t\t\tcount: selectedIds.length,\n\t\t\tonConfirm: async () => {\n\t\t\t\ttry {\n\t\t\t\t\tif (willDelete) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst collId = collection.value?._id;\n\t\t\t\t\t\t\tif (collId) {\n\t\t\t\t\t\t\t\tconst result = await batchDeleteEntries(collId, selectedIds);\n\t\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\t\tshowToast(`${selectedIds.length} ${selectedIds.length === 1 ? 'entry' : 'entries'} deleted successfully`, 'success');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthrow new Error('Batch delete failed');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (batchError) {\n\t\t\t\t\t\t\tlogger.warn('Batch delete failed, using individual deletes:', batchError);\n\t\t\t\t\t\t\tawait Promise.all(\n\t\t\t\t\t\t\t\tselectedIds.map((entryId) => {\n\t\t\t\t\t\t\t\t\tconst collId = collection.value?._id;\n\t\t\t\t\t\t\t\t\tif (collId) {\n\t\t\t\t\t\t\t\t\t\treturn deleteEntry(collId, entryId);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tshowToast(`${selectedIds.length} ${selectedIds.length === 1 ? 'entry' : 'entries'} deleted successfully`, 'success');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait setEntriesStatus(selectedIds, StatusTypes.archive, () => {});\n\t\t\t\t\t}\n\t\t\t\t\tonActionSuccess();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tshowToast(`Failed to ${actionVerb} entries: ${(error as Error).message}`, 'error');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\tconst onClone = () => cloneEntries(getSelectedRawEntries(), onActionSuccess);\n\n\tconst onSchedule = (date: string) => {\n\t\tconst payload = { _scheduled: new Date(date).getTime() };\n\t\tsetEntriesStatus(getSelectedIds(), StatusTypes.draft, onActionSuccess, payload);\n\t};\n\n\tfunction handleColumnVisibilityToggle(headerToToggle: TableHeader) {\n\t\tdisplayTableHeaders = displayTableHeaders.map((h) => (h.id === headerToToggle.id ? { ...h, visible: !h.visible } : h));\n\t}\n\n\tfunction handleSelectAllColumnsToggle() {\n\t\tconst newVisibility = selectAllColumns;\n\t\tdisplayTableHeaders = displayTableHeaders.map((h) => ({ ...h, visible: newVisibility }));\n\t}\n\n\tfunction resetViewSettings() {\n\t\tconst currentCollId = currentCollection?._id;\n\t\tif (browser && currentCollId) {\n\t\t\tlocalStorage.removeItem(`entryListPaginationSettings_${currentCollId}`);\n\t\t}\n\t\tentryListPaginationSettings = defaultPaginationSettings(currentCollId ?? null);\n\t}\n</script>\n\n<!--Table -->\n{#if !currentCollection}\n\t<div class=\"dark:bg-error-950 flex h-64 flex-col items-center justify-center rounded-lg border border-error-500 bg-error-50 p-8\">\n\t\t<svg class=\"mb-4 h-16 w-16 text-error-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t<path\n\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\tstroke-width=\"2\"\n\t\t\t\td=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n\t\t\t/>\n\t\t</svg>\n\t\t<h3 class=\"mb-2 text-xl font-bold text-error-600 dark:text-error-400\">Collection Not Found</h3>\n\t\t<p class=\"text-center text-error-600 dark:text-error-400\">\n\t\t\tThe requested collection could not be loaded. Please check the collection name and try again.\n\t\t</p>\n\t</div>\n{:else}\n\t<!-- Header -->\n\t<div class=\"mb-2 flex justify-between dark:text-white\">\n\t\t<!-- Row 1 for Mobile -->\n\t\t<div class=\"flex items-center justify-between\">\n\t\t\t<!-- Hamburger -->\n\t\t\t{#if ui.state.leftSidebar === 'hidden'}\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonkeydown={() => {}}\n\t\t\t\t\tonclick={() => ui.toggle('leftSidebar', screen.isDesktop ? 'full' : 'collapsed')}\n\t\t\t\t\taria-label=\"Open Sidebar\"\n\t\t\t\t\tclass=\"preset-outlined-surface-500 btn-icon mt-1\"\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"mingcute:menu-fill\" width=\"24\"></iconify-icon>\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t<!-- Collection type with icon -->\n\t\t\t<div class=\"mr-1 flex flex-col {!ui.state.leftSidebar ? 'ml-2' : 'ml-1 sm:ml-2'}\">\n\t\t\t\t{#if categoryName}\n\t\t\t\t\t<div class=\"mb-2 text-xs capitalize text-surface-500 dark:text-surface-300 rtl:text-left\">\n\t\t\t\t\t\t{categoryName}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t\t<div class=\"-mt-2 flex justify-start text-sm font-bold uppercase dark:text-white md:text-2xl lg:text-xl\">\n\t\t\t\t\t{#if currentCollection?.icon}\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<iconify-icon icon={currentCollection.icon} width=\"24\" class=\"mr-1 text-error-500 sm:mr-2\"></iconify-icon>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t{/if}\n\t\t\t\t\t{#if currentCollection?.name}\n\t\t\t\t\t\t<div class=\"flex max-w-[85px] whitespace-normal leading-3 sm:mr-2 sm:max-w-none md:mt-0 md:leading-none xs:mt-1\">\n\t\t\t\t\t\t\t{currentCollection.name}\n\t\t\t\t\t\t\t{#if collectionStats}\n\t\t\t\t\t\t\t\t<span class=\"ml-2 text-xs font-normal text-surface-500\">({collectionStats.count})</span>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex items-center justify-between gap-1\">\n\t\t\t<!-- Expand/Collapse -->\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonkeydown={() => {}}\n\t\t\t\tonclick={() => (expand = !expand)}\n\t\t\t\tclass=\"preset-outlined-surface-500 btn-icon p-1 sm:hidden\"\n\t\t\t\taria-label=\"Expand/Collapse Filters\"\n\t\t\t>\n\t\t\t\t<iconify-icon icon=\"material-symbols:filter-list-rounded\" width=\"30\"> </iconify-icon>\n\t\t\t</button>\n\n\t\t\t<!-- Translation Content Language - Mobile -->\n\t\t\t<div class=\"mt-1 sm:hidden\">\n\t\t\t\t<TranslationStatus />\n\t\t\t</div>\n\n\t\t\t<!-- Table Filter with Translation Content Language - Desktop -->\n\t\t\t<div class=\"relative mt-1 hidden items-center justify-center gap-2 sm:flex\">\n\t\t\t\t<TableFilter bind:globalSearchValue bind:filterShow bind:columnShow bind:density={entryListPaginationSettings.density} />\n\t\t\t\t<TranslationStatus />\n\t\t\t</div>\n\n\t\t\t<!-- MultiButton -->\n\t\t\t<div class=\" flex w-full items-center justify-end sm:mt-0 sm:w-auto\">\n\t\t\t\t<EntryListMultiButton\n\t\t\t\t\tisCollectionEmpty={tableData?.length === 0}\n\t\t\t\t\t{hasSelections}\n\t\t\t\t\tselectedCount={Object.values(selectedMap).filter(Boolean).length}\n\t\t\t\t\tselectedItems={getSelectedRawEntries()}\n\t\t\t\t\tbind:showDeleted\n\t\t\t\t\tpublish={onPublish}\n\t\t\t\t\tunpublish={onUnpublish}\n\t\t\t\t\tschedule={onSchedule}\n\t\t\t\t\tdelete={onDelete}\n\t\t\t\t\tdraft={onDraft}\n\t\t\t\t\tclone={onClone}\n\t\t\t\t\tcreate={onCreate}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<!-- Table  Start-->\n\t{#if expand}\n\t\t<div class=\"mb-2 flex items-center justify-center sm:hidden\">\n\t\t\t<TableFilter bind:globalSearchValue bind:filterShow bind:columnShow bind:density={entryListPaginationSettings.density} />\n\t\t</div>\n\t{/if}\n\n\t{#if columnShow}\n\t\t<!-- Column order -->\n\t\t<div class=\"rounded-b-0 flex flex-col justify-center rounded-t-md border-b bg-secondary-100 p-2 text-center dark:bg-surface-700\">\n\t\t\t<div class=\"text-sm dark:text-primary-500\">\n\t\t\t\t{m.entrylist_dnd()}\n\t\t\t</div>\n\t\t\t<!-- Select All Columns -->\n\t\t\t<div class=\"my-2 flex w-full flex-col items-center justify-center gap-2 sm:flex-row sm:gap-4\">\n\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t<label class=\"flex items-center\">\n\t\t\t\t\t\t<input type=\"checkbox\" bind:checked={selectAllColumns} onchange={handleSelectAllColumnsToggle} class=\"mr-1\" />\n\t\t\t\t\t\t{m.entrylist_all()}\n\t\t\t\t\t</label>\n\n\t\t\t\t\t<button class=\"bg-surface-400 btn text-white\" onclick={resetViewSettings}>\n\t\t\t\t\t\t<iconify-icon icon=\"material-symbols-light:device-reset\" width=\"20\" class=\"mr-1 text-white\"></iconify-icon>\n\t\t\t\t\t\tReset View\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<section\n\t\t\t\t\tuse:dndzone={{ items: displayTableHeaders, flipDurationMs: 300, type: 'columns', dropTargetStyle: { outline: 'none' } }}\n\t\t\t\t\tonconsider={handleDndConsider}\n\t\t\t\t\tonfinalize={handleDndFinalize}\n\t\t\t\t\tclass=\"flex w-full flex-wrap justify-center gap-2 p-2 border-2 border-dashed border-secondary-500/50 rounded transition-all hover:border-secondary-500\"\n\t\t\t\t>\n\t\t\t\t\t{#each displayTableHeaders as header (header.id)}\n\t\t\t\t\t\t<div animate:flip={{ duration: 300 }}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"chip {header.visible\n\t\t\t\t\t\t\t\t\t? 'dark:preset-filled-primary-500 preset-filled-tertiary-500'\n\t\t\t\t\t\t\t\t\t: 'ring ring-surface-500 bg-transparent text-secondary-500'} flex items-center justify-center text-xs cursor-move\"\n\t\t\t\t\t\t\t\tonclick={() => handleColumnVisibilityToggle(header)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#if header.visible}<iconify-icon icon=\"fa:check\" class=\"mr-1\"></iconify-icon>{/if}\n\t\t\t\t\t\t\t\t<span class=\"capitalize\">{header.label}</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n\n\t{#if tableData.length > 0 || hasActiveFilters}\n\t\t<div class=\"table-container max-h-[calc(100dvh)] overflow-auto\">\n\t\t\t<table class=\"table table-interactive table-hover\">\n\t\t\t\t<!-- Table Header -->\n\t\t\t\t<thead class=\"sticky top-0 z-10 bg-secondary-100 text-tertiary-500 dark:bg-surface-900 dark:text-primary-500\">\n\t\t\t\t\t{#if filterShow && visibleTableHeaders.length > 0}\n\t\t\t\t\t\t<tr class=\"divide-x divide-surface-400 dark:divide-surface-600\">\n\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t<!-- Clear All Filters Button -->\n\t\t\t\t\t\t\t\t{#if Object.values(entryListPaginationSettings.filters).some((f) => f !== '')}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\t\t\tconst clearedFilters: Record<string, string> = {};\n\t\t\t\t\t\t\t\t\t\t\tconst urlUpdates: Record<string, string | null> = {};\n\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(entryListPaginationSettings.filters).forEach((key) => {\n\t\t\t\t\t\t\t\t\t\t\t\tclearedFilters[key] = '';\n\t\t\t\t\t\t\t\t\t\t\t\turlUpdates[`filter_${key}`] = null;\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\tentryListPaginationSettings.filters = clearedFilters;\n\t\t\t\t\t\t\t\t\t\t\turlUpdates.page = '1';\n\t\t\t\t\t\t\t\t\t\t\tupdateURL(urlUpdates);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\taria-label=\"Clear All Filters\"\n\t\t\t\t\t\t\t\t\t\tclass=\"preset-outlined-surface-500 btn-icon\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<iconify-icon icon=\"material-symbols:close\" width=\"18\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<!-- Filter -->\n\t\t\t\t\t\t\t{#each visibleTableHeaders as header (header.id)}\n\t\t\t\t\t\t\t\t<th\n\t\t\t\t\t\t\t\t\t><div class=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t\t\t<FloatingInput\n\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\ticon=\"material-symbols:search-rounded\"\n\t\t\t\t\t\t\t\t\t\t\tlabel={`Filter ${(header as TableHeader).label}`}\n\t\t\t\t\t\t\t\t\t\t\tname={(header as TableHeader).name}\n\t\t\t\t\t\t\t\t\t\t\tvalue={entryListPaginationSettings.filters[(header as TableHeader).name] || ''}\n\t\t\t\t\t\t\t\t\t\t\tonInput={(value: string) => onFilterChange((header as TableHeader).name, value)}\n\t\t\t\t\t\t\t\t\t\t\tinputClass=\"text-xs dark:text-primary-500\"\n\t\t\t\t\t\t\t\t\t\t\ttextColor=\"\"\n\t\t\t\t\t\t\t\t\t\t\tlabelClass=\"dark:text-white\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<tr class=\"divide-x divide-surface-400 border-b border-black dark:border-white\">\n\t\t\t\t\t\t<TableIcons\n\t\t\t\t\t\t\tcellClass={`w-10 ${hasSelections ? 'bg-primary-500/10 dark:bg-secondary-500/20' : ''}`}\n\t\t\t\t\t\t\tchecked={SelectAll}\n\t\t\t\t\t\t\tonCheck={(checked: boolean) => {\n\t\t\t\t\t\t\t\tSelectAll = checked;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t{#each visibleTableHeaders as header (header.id)}\n\t\t\t\t\t\t\t<th\n\t\t\t\t\t\t\t\tclass=\"cursor-pointer text-center text-xs sm:text-sm {cellPaddingClass} {(header as TableHeader).name ===\n\t\t\t\t\t\t\t\tentryListPaginationSettings.sorting.sortedBy\n\t\t\t\t\t\t\t\t\t? 'font-semibold text-primary-500 dark:text-secondary-400'\n\t\t\t\t\t\t\t\t\t: 'text-tertiary-500 dark:text-primary-500'}\"\n\t\t\t\t\t\t\t\tonclick={() => onSortChange((header as TableHeader).name)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t{(header as TableHeader).label}\n\t\t\t\t\t\t\t\t\t{#if (header as TableHeader).name === entryListPaginationSettings.sorting.sortedBy && entryListPaginationSettings.sorting.isSorted !== 0}\n\t\t\t\t\t\t\t\t\t\t<iconify-icon\n\t\t\t\t\t\t\t\t\t\t\ticon={entryListPaginationSettings.sorting.isSorted === 1\n\t\t\t\t\t\t\t\t\t\t\t\t? 'material-symbols:arrow-upward-rounded'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'material-symbols:arrow-downward-rounded'}\n\t\t\t\t\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ml-1 origin-center\"\n\t\t\t\t\t\t\t\t\t\t></iconify-icon>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{#if tableData.length > 0}\n\t\t\t\t\t\t{#each tableData as entry, index (entry._id)}\n\t\t\t\t\t\t\t<tr\n\t\t\t\t\t\t\t\tclass=\"divide-x divide-surface-400 dark:divide-surface-700 {selectedMap[index] ? 'bg-primary-500/5 dark:bg-secondary-500/10' : ''}\"\n\t\t\t\t\t\t\t\tonmouseenter={() => handleRowHoverStart(entry._id)}\n\t\t\t\t\t\t\t\tonmouseleave={handleRowHoverEnd}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<TableIcons\n\t\t\t\t\t\t\t\t\tcellClass={`w-10 text-center ${selectedMap[index] ? 'bg-primary-500/10 dark:bg-secondary-500/20' : ''}`}\n\t\t\t\t\t\t\t\t\tchecked={selectedMap[index]}\n\t\t\t\t\t\t\t\t\tonCheck={(isChecked: boolean) => {\n\t\t\t\t\t\t\t\t\t\tselectedMap[index] = isChecked;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{#if visibleTableHeaders}\n\t\t\t\t\t\t\t\t\t{#each visibleTableHeaders as header (header.id)}\n\t\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-center {cellPaddingClass} text-xs font-bold sm:text-sm {(header as TableHeader).name !== 'status'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'cursor-pointer transition-colors duration-200 hover:bg-primary-500/10 dark:hover:bg-secondary-500/20'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'cursor-pointer transition-colors duration-200 hover:bg-warning-500/10 dark:hover:bg-warning-500/20'}\"\n\t\t\t\t\t\t\t\t\t\t\ttitle={(header as TableHeader).name !== 'status' ? 'Click to edit this entry' : 'Click to change status'}\n\t\t\t\t\t\t\t\t\t\t\tonclick={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tif ((header as TableHeader).name === 'status') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Handle single entry status change with modal (same style as multibutton)\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst currentStatus = entry.status || entry.raw_status || 'draft';\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet nextStatus;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Define status progression logic using StatusTypes\n\t\t\t\t\t\t\t\t\t\t\t\t\tswitch (currentStatus) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase StatusTypes.draft:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnextStatus = StatusTypes.publish;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase StatusTypes.publish:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnextStatus = StatusTypes.unpublish;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase StatusTypes.unpublish:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnextStatus = StatusTypes.publish;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase StatusTypes.schedule:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnextStatus = StatusTypes.publish;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnextStatus = StatusTypes.publish;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Create modal with same styling as multibutton modals\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowStatusChangeConfirm({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstatus: String(nextStatus),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonConfirm: async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst collId = collection.value?._id;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!collId) return;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst result = await updateEntryStatus(collId, entry._id, String(nextStatus));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowToast(`Entry status updated to ${nextStatus}`, 'success');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonActionSuccess();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowToast(result.error || 'Failed to update entry status', 'error');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlogger.error('Error updating entry status:', error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowToast('An error occurred while updating entry status', 'error');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t// GUI-FIRST PATTERN: Navigate to edit mode (loads full multilingual data)\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst originalEntry = tableData.find((e: any) => e._id === entry._id);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (originalEntry) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Navigate to edit mode - this triggers SSR to load full multilingual data\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// List view has language-projected data, edit mode needs all languages\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst newUrl = `${page.url.pathname}?edit=${originalEntry._id}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgoto(newUrl);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlogger.debug(`[Edit] Loading full data for entry ${originalEntry._id}`);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{#if (header as TableHeader).name === 'status'}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex w-full items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Status value={entry.status || entry.raw_status || 'draft'} />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{:else if (header as TableHeader).name === 'createdAt' || (header as TableHeader).name === 'updatedAt'}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDisplayDate(entry[(header as TableHeader).name], 'en', { year: 'numeric', month: 'short', day: 'numeric' })}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-surface-500 dark:text-surface-200\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDisplayDate(entry[(header as TableHeader).name], 'en', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thour: '2-digit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tminute: '2-digit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsecond: '2-digit',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thour12: false\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{:else if typeof entry[(header as TableHeader).name] === 'object' && entry[(header as TableHeader).name] !== null}\n\t\t\t\t\t\t\t\t\t\t\t\t{@const fieldData = entry[(header as TableHeader).name]}\n\t\t\t\t\t\t\t\t\t\t\t\t{@const translatedValue = fieldData[currentLanguage] || Object.values(fieldData)[0] || '-'}\n\t\t\t\t\t\t\t\t\t\t\t\t{@const debugInfo = `Field: ${(header as TableHeader).name}, Lang: ${currentLanguage}, Data: ${JSON.stringify(fieldData)}, Value: ${translatedValue}`}\n\t\t\t\t\t\t\t\t\t\t\t\t{#if (header as TableHeader).name === 'last_name'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span title={debugInfo}>{@html translatedValue}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{@html translatedValue}\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t{@html entry[(header as TableHeader).name] || '-'}\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan={visibleTableHeaders.length + 1} class=\"p-4 text-center text-surface-500 dark:text-surface-50\"> No results found. </td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t{/if}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t\t<!-- Pagination -->\n\t\t<div\n\t\t\tclass=\"sticky bottom-0 left-0 right-0 z-10 mt-1 flex flex-col items-center justify-center border-t border-surface-300 bg-secondary-100 dark:text-surface-50 dark:bg-surface-800 md:flex-row md:justify-between md:p-4\"\n\t\t>\n\t\t\t<TablePagination\n\t\t\t\tcurrentPage={serverPagination.currentPage}\n\t\t\t\trowsPerPage={serverPagination.pageSize}\n\t\t\t\t{pagesCount}\n\t\t\t\t{totalItems}\n\t\t\t\t{onUpdatePage}\n\t\t\t\t{onUpdateRowsPerPage}\n\t\t\t/>\n\t\t</div>\n\t{:else}\n\t\t<div class=\"py-10 text-center text-tertiary-500 dark:text-primary-500\">\n\t\t\t<iconify-icon icon=\"bi:exclamation-circle-fill\" height=\"44\" class=\"mb-2\"></iconify-icon>\n\t\t\t<p class=\"text-lg\">\n\t\t\t\t{currentCollection?.name ? m.EntryList_no_collection({ name: currentCollection.name }) : 'No collection selected or collection is empty.'}\n\t\t\t</p>\n\t\t</div>\n\t{/if}\n{/if}\n\n<style>\n\tdiv::-webkit-scrollbar-thumb {\n\t\tborder-radius: 50px;\n\t\tbackground-color: #0ec423;\n\t}\n\tdiv::-webkit-scrollbar {\n\t\twidth: 10px;\n\t}\n</style>\n","<!--\n@file src/components/collectionDisplay/WidgetLoader.svelte\n@component WidgetLoader - Async widget component loader with code-splitting\n\n@description\nThis component enables dynamic, asynchronous loading of widget components,\nsupporting code-splitting for better performance. It loads widgets on-demand\nrather than bundling all widgets upfront.\n\n@example\n<WidgetLoader\n  loader={widgetLoader}\n  field={field}\n  bind:value={entryValue}\n  tenantId={tenantId}\n/>\n\n\n### Features\n- Async component loading with Suspense-like behavior\n- Code-splitting support via import.meta.glob\n- Error boundary with fallback UI\n- Loading state management\n- TypeScript support\n-->\n\n<script lang=\"ts\">\n\timport type { FieldInstance } from '@cms-types/content';\n\timport { onMount } from 'svelte';\n\timport { logger } from '@shared/utils/logger';\n\n\tinterface Props {\n\t\tloader: () => Promise<{ default: any }>;\n\t\tfield: FieldInstance;\n\t\tWidgetData?: Record<string, any>;\n\t\tvalue?: any;\n\t\ttenantId?: string;\n\t}\n\n\tlet { loader, field, WidgetData = {}, value = $bindable(), tenantId }: Props = $props();\n\n\t// Component state\n\tlet component: any = $state(null);\n\tlet loading = $state(true);\n\tlet error = $state<Error | null>(null);\n\n\t// Load the widget component asynchronously\n\tasync function loadComponent() {\n\t\ttry {\n\t\t\tloading = true;\n\t\t\terror = null;\n\n\t\t\tconst module = await loader();\n\t\t\tcomponent = module.default;\n\n\t\t\tlogger.debug('[WidgetLoader] Component loaded:', {\n\t\t\t\twidget: field.widget?.Name || 'unknown',\n\t\t\t\tfield: field.label\n\t\t\t});\n\t\t} catch (err) {\n\t\t\terror = err instanceof Error ? err : new Error(String(err));\n\t\t\tlogger.error('[WidgetLoader] Failed to load component:', {\n\t\t\t\twidget: field.widget?.Name || 'unknown',\n\t\t\t\tfield: field.label,\n\t\t\t\terror: error.message\n\t\t\t});\n\t\t} finally {\n\t\t\tloading = false;\n\t\t}\n\t}\n\n\t// Load on mount\n\tonMount(() => {\n\t\tloadComponent();\n\t});\n</script>\n\n{#if loading}\n\t<!-- Loading skeleton -->\n\t<div class=\"widget-loader-skeleton animate-pulse\">\n\t\t<div class=\"mb-2 h-4 w-1/3 rounded bg-surface-300 dark:bg-surface-600\"></div>\n\t\t<div class=\"h-10 w-full rounded bg-surface-200 dark:bg-surface-700\"></div>\n\t</div>\n{:else if error}\n\t<!-- Error fallback -->\n\t<div class=\"widget-loader-error rounded-lg border border-error-500 bg-error-50 p-4 dark:bg-error-900/20\">\n\t\t<div class=\"mb-2 flex items-center gap-2\">\n\t\t\t<iconify-icon icon=\"mdi:alert-circle\" class=\"text-error-500\" width=\"20\"></iconify-icon>\n\t\t\t<span class=\"font-semibold text-error-700 dark:text-error-400\">Widget Load Error</span>\n\t\t</div>\n\t\t<p class=\"text-sm text-error-600 dark:text-error-300\">\n\t\t\tFailed to load widget: <strong>{field.widget?.Name || 'Unknown'}</strong>\n\t\t</p>\n\t\t<p class=\"mt-1 text-xs text-error-500 dark:text-error-400\">{error.message}</p>\n\t\t<button class=\"preset-outlined-error-500 btn-sm mt-3\" onclick={() => loadComponent()}>\n\t\t\t<iconify-icon icon=\"mdi:refresh\" width=\"16\" class=\"mr-1\"></iconify-icon>\n\t\t\tRetry\n\t\t</button>\n\t</div>\n{:else if component}\n\t<!-- Loaded component -->\n\t{@const Component = component}\n\t<Component {field} bind:value {WidgetData} {tenantId} />\n{:else}\n\t<!-- Unexpected state -->\n\t<div class=\"widget-loader-empty rounded border border-warning-500 bg-warning-50 p-3 dark:bg-warning-900/20\">\n\t\t<p class=\"text-sm text-warning-700 dark:text-warning-300\">Widget component not available</p>\n\t</div>\n{/if}\n\n<style>\n\t.widget-loader-skeleton {\n\t\tmin-height: 60px;\n\t}\n\n\t@keyframes pulse {\n\t\t0%,\n\t\t100% {\n\t\t\topacity: 1;\n\t\t}\n\t\t50% {\n\t\t\topacity: 0.5;\n\t\t}\n\t}\n\n\t.animate-pulse {\n\t\tanimation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n\t}\n</style>\n","/**\n * @file src/stores/activeInputStore.svelte.ts\n * @description Global singleton for the currently active token input using Svelte 5 runes.\n *\n * Features:\n * - Reactive tracking of focused input (element + metadata)\n * - Class-based singleton pattern\n * - Type-safe interface for token insertion\n */\n\nexport interface ActiveTokenInput {\n\t/** The DOM input/textarea element */\n\telement: HTMLInputElement | HTMLTextAreaElement | null;\n\t/** Field metadata for context (e.g., token picker UI) */\n\tfield: {\n\t\tname: string;\n\t\tlabel?: string;\n\t\tcollection?: string;\n\t\t[key: string]: any;\n\t};\n\t/** Optional custom insertion handler (e.g., for rich text editors) */\n\tonInsert?: (token: string) => void;\n}\n\nclass ActiveInputState {\n\t#current = $state<ActiveTokenInput | null>(null);\n\n\t/** The currently active input metadata */\n\tget current() {\n\t\treturn this.#current;\n\t}\n\n\t/** Sets the active input state */\n\tset(input: ActiveTokenInput | null) {\n\t\tthis.#current = input;\n\t}\n\n\t/** Clears the active input and closes the picker */\n\tclear() {\n\t\tthis.#current = null;\n\t}\n}\n\n/**\n * Global singleton instance for managing focus-driven token input targets.\n * Use this to set which input should receive tokens from the TokenPicker.\n */\nexport const activeInput = new ActiveInputState();\nexport const activeInputStore = activeInput;\n","<!--\n@file src/components/collectionDisplay/Fields.svelte\n@component\n**Fields is a core component that renders collection fields for data entry and provides revision history.**\n\n### Features:\n- **Widget Rendering**: Automatically loads and renders appropriate widgets for each field.\n- **Reactivity**: Binds form data to the `collectionValue` store with real-time sync.\n- **Revision History**: Displays entry revisions with compare and revert functionality.\n- **Validation**: Performs field-level validation based on schema constraints.\n- **Translation Aware**: Manages multilingual data input through widget-integrated language context.\n\n### Props\n- `fields` (Array): The array of field instances from the collection schema.\n- `revisions` (Array): Historical snapshot data for the current entry.\n- `contentLanguage` (String): The language for data entry (GUI remains in systemLanguage).\n\n### Keyboard Shortcuts\n- `Alt + S`: Save currently edited entry (if focused)\n-->\n<script lang=\"ts\">\n\timport { untrack } from 'svelte';\n\timport { getFieldName } from '@shared/utils/utils';\n\timport { logger } from '@shared/utils/logger';\n\n\t// Auth & Page data\n\timport { page } from '$app/state';\n\tconst user = $derived(page.data?.user);\n\tconst tenantId = $derived(page.data?.tenantId);\n\n\t// Stores\n\timport { collection, collectionValue, setCollectionValue } from '@shared/stores/collectionStore.svelte';\n\timport { translationProgress, contentLanguage, dataChangeStore, validationStore } from '@shared/stores/store.svelte';\n\timport { publicEnv } from '@shared/stores/globalSettings.svelte';\n\timport type { Locale } from '@shared/paraglide/runtime';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Skeleton\n\timport { Tabs } from '@skeletonlabs/skeleton-svelte';\n\t// import { CodeBlock, Tab, TabGroup, clipboard } from '@skeletonlabs/skeleton-svelte';\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { showConfirm } from '@shared/utils/modalUtils';\n\n\timport { widgetFunctions as widgetFunctionsStore } from '@shared/stores/widgetStore.svelte';\n\n\t// --- PERFORMANCE FIX: DYNAMIC WIDGET IMPORTS ---\n\t// Lazy-load widgets for code-splitting (eager: false is default)\n\t// Returns loader functions instead of eager-loaded components\n\tconst modules: Record<string, () => Promise<{ default: any }>> = import.meta.glob('/src/widgets/**/*.svelte') as Record<\n\t\tstring,\n\t\t() => Promise<{ default: any }>\n\t>;\n\n\t// Import async widget loader component\n\timport WidgetLoader from './WidgetLoader.svelte';\n\timport { activeInputStore } from '@shared/stores/activeInputStore.svelte';\n\n\t// Token Picker\n\t// Token Picker\n\n\tfunction openTokenPicker(field: any, e: MouseEvent) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\t// Fallback: Try to find the input by ID (using db_fieldName as ID)\n\t\tconst id = field.db_fieldName;\n\t\tconst el = document.getElementById(id) as HTMLInputElement | HTMLTextAreaElement;\n\t\tif (el) {\n\t\t\tel.focus();\n\t\t\tactiveInputStore.set({ element: el, field }); // Explicitly open picker on button click\n\t\t} else {\n\t\t\tconsole.warn('Could not find input for field', field);\n\t\t}\n\t}\n\t// --- END PERFORMANCE FIX ---\n\n\tlet widgetFunctions = $state<Record<string, any>>({});\n\t$effect(() => {\n\t\tconst unsubscribe = widgetFunctionsStore.subscribe((value) => {\n\t\t\twidgetFunctions = value;\n\t\t});\n\t\treturn unsubscribe;\n\t});\n\n\t// --- 1. RECEIVE DATA AS PROPS ---\n\tlet {\n\t\tfields,\n\t\trevisions = []\n\t\t// contentLanguage prop received but not directly used - widgets access contentLanguage store\n\t} = $props<{\n\t\tfields?: NonNullable<(typeof collection)['value']>['fields'];\n\t\trevisions?: any[];\n\t\tcontentLanguage?: string; // Passed for documentation, widgets use store directly\n\t}>();\n\n\t// --- 2. SIMPLIFIED STATE ---\n\tlet localTabSet = $state('0');\n\tlet apiUrl = $state('');\n\n\t// This is form state, not fetched data, so it remains.\n\tlet currentCollectionValue = $state<Record<string, any>>({});\n\n\t// Revisions State (now simpler)\n\tlet selectedRevisionId = $state('');\n\n\t// Track the last entry ID to detect when switching entries\n\tlet lastEntryId = $state<string | undefined>(undefined);\n\n\t// Track current content language for reactivity\n\tlet currentContentLanguage = $state<Locale>(contentLanguage.value as Locale);\n\n\t// React to contentLanguage store changes and update local state\n\t// This ensures widgets remount with the correct language\n\t$effect(() => {\n\t\tconst newLang = contentLanguage.value as Locale;\n\t\tif (currentContentLanguage !== newLang) {\n\t\t\tlogger.debug('Language changed:', currentContentLanguage, '', newLang);\n\t\t\tlogger.debug('Current collectionValue keys:', Object.keys(currentCollectionValue));\n\t\t\t// Update immediately to trigger {#key} block\n\t\t\tcurrentContentLanguage = newLang;\n\t\t\tlogger.debug('Updated currentContentLanguage to:', currentContentLanguage);\n\t\t}\n\t});\n\n\t// --- 3. DERIVED STATE FROM PROPS ---\n\tlet selectedRevision = $derived(revisions.find((r: any) => r._id === selectedRevisionId) || null);\n\n\t// --- 4. SIMPLIFIED LOGIC ---\n\tlet derivedFields = $derived(fields || []);\n\n\t// Get translation progress\n\tlet currentTranslationProgress = $derived(translationProgress.value);\n\n\t// Track changes to translation progress for debugging\n\t$effect(() => {\n\t\tlogger.debug('Translation progress updated:', {\n\t\t\tshowProgress: translationProgress.value?.show,\n\t\t\tlanguages: Object.keys(translationProgress.value || {}).filter((k) => k !== 'show')\n\t\t});\n\t});\n\n\t// Get available languages\n\tlet availableLanguages = $derived.by<Locale[]>(() => {\n\t\t// Wait for publicEnv to be initialized\n\t\tconst languages = publicEnv?.AVAILABLE_CONTENT_LANGUAGES;\n\t\tif (!languages || !Array.isArray(languages)) {\n\t\t\treturn ['en'] as Locale[];\n\t\t}\n\t\treturn languages as Locale[];\n\t});\n\n\t// Helper to get field translation percentage across all languages\n\tfunction getFieldTranslationPercentage(field: any): number {\n\t\tif (!field.translated) return 100; // Not a translatable field\n\n\t\tconst fieldName = `${collection.value?.name}.${getFieldName(field)}`;\n\t\tconst allLangs = availableLanguages; // Use the new derived state\n\n\t\t// Avoid division by zero if no languages are configured\n\t\tif (allLangs.length === 0) return 100;\n\n\t\tlet translatedCount = 0;\n\n\t\t// Count how many languages have this field translated\n\t\tfor (const lang of allLangs) {\n\t\t\tconst langProgress = currentTranslationProgress?.[lang as Locale];\n\t\t\tif (langProgress && langProgress.translated.has(fieldName)) {\n\t\t\t\ttranslatedCount++;\n\t\t\t}\n\t\t}\n\n\t\t// Calculate the overall percentage for this field\n\t\treturn Math.round((translatedCount / allLangs.length) * 100);\n\t}\n\n\t// Helper to get text color based on translation status\n\tfunction getTranslationTextColor(percentage: number): string {\n\t\tif (percentage === 100) return 'text-tertiary-500 dark:text-primary-500';\n\t\treturn 'text-error-500';\n\t}\n\n\tfunction ensureFieldProperties(field: any) {\n\t\tif (!field) return null;\n\t\treturn {\n\t\t\t...field,\n\t\t\tdb_fieldName: field.db_fieldName || getFieldName(field, true),\n\t\t\twidget: field.widget || { Name: field.type || 'Input' },\n\t\t\tpermissions: field.permissions || {}\n\t\t};\n\t}\n\n\tlet filteredFields = $derived(\n\t\tderivedFields\n\t\t\t.map(ensureFieldProperties)\n\t\t\t.filter(Boolean)\n\t\t\t.filter((field: any) => {\n\t\t\t\tif (!field.permissions || page.data?.isAdmin || !user?.role) return true;\n\t\t\t\tconst rolePermissions = field.permissions[user.role];\n\t\t\t\treturn !rolePermissions || rolePermissions.read !== false;\n\t\t\t})\n\t);\n\n\t// Sync local form state with global store\n\t// When collectionValue changes (new entry loaded), update local state\n\t// When local state changes (user editing), update global state\n\t$effect(() => {\n\t\tconst global = collectionValue.value as Record<string, unknown> | undefined;\n\t\tconst globalId = (global as any)?._id;\n\n\t\t// When a new entry is loaded (different ID), pull from global -> local\n\t\tif (globalId && globalId !== lastEntryId) {\n\t\t\tlogger.debug('Loading entry data:', globalId);\n\t\t\tcurrentCollectionValue = { ...global } as any;\n\t\t\tlastEntryId = globalId;\n\t\t\t// Set initial snapshot for change tracking\n\t\t\tdataChangeStore.setInitialSnapshot(global as Record<string, any>);\n\t\t\treturn;\n\t\t}\n\n\t\t// If creating new entry (no ID), initialize with global state\n\t\tif (!globalId && !lastEntryId && global && Object.keys(global).length > 0) {\n\t\t\tlogger.debug('Initializing new entry');\n\t\t\tcurrentCollectionValue = { ...global } as any;\n\t\t\t// Set initial snapshot for change tracking\n\t\t\tdataChangeStore.setInitialSnapshot(global as Record<string, any>);\n\t\t\treturn;\n\t\t}\n\n\t\t// Otherwise, push local changes to global (user is editing)\n\t\t// Use untrack to read currentCollectionValue without creating a dependency loop\n\t\tconst local = untrack(() => currentCollectionValue) as Record<string, unknown> | undefined;\n\t\tif (local && Object.keys(local).length > 0) {\n\t\t\tconst currentDataStr = JSON.stringify(local);\n\t\t\tconst globalDataStr = JSON.stringify(global ?? {});\n\t\t\tif (currentDataStr !== globalDataStr) {\n\t\t\t\tlogger.debug('Pushing local changes to global store');\n\t\t\t\tuntrack(() => setCollectionValue({ ...local }));\n\t\t\t\t// Track changes for save button state\n\t\t\t\tdataChangeStore.compareWithCurrent(local as Record<string, any>);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Separate effect to detect changes in currentCollectionValue and sync to store\n\t// This is needed because the widget bind:value updates currentCollectionValue\n\tlet lastLocalValueStr = $state<string>('');\n\t$effect(() => {\n\t\t// React to currentCollectionValue changes (from widget inputs)\n\t\tconst localStr = JSON.stringify(currentCollectionValue);\n\n\t\t// Skip if this is the initial load or empty\n\t\tif (!currentCollectionValue || Object.keys(currentCollectionValue).length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Only update if value actually changed\n\t\tif (localStr !== lastLocalValueStr) {\n\t\t\tlogger.debug('currentCollectionValue changed, syncing to store');\n\t\t\tlastLocalValueStr = localStr;\n\n\t\t\t// Update the global store (using untrack to avoid creating dependency)\n\t\t\tconst global = untrack(() => collectionValue.value);\n\t\t\tconst globalStr = JSON.stringify(global ?? {});\n\n\t\t\tif (localStr !== globalStr) {\n\t\t\t\tuntrack(() => setCollectionValue({ ...currentCollectionValue }));\n\t\t\t\t// Track changes for save button state\n\t\t\t\tdataChangeStore.compareWithCurrent(currentCollectionValue as Record<string, any>);\n\t\t\t}\n\t\t}\n\t});\n\n\t// --- 5. REFACTORED REVISION LOGIC ---\n\tfunction handleRevert() {\n\t\tif (!selectedRevision?.data) return;\n\t\tshowConfirm({\n\t\t\ttitle: 'Confirm Revert',\n\t\t\tbody: 'Are you sure you want to revert to this version? Any unsaved changes will be lost.',\n\t\t\tconfirmText: 'Revert',\n\t\t\tonConfirm: () => {\n\t\t\t\tconst revertData = { ...selectedRevision.data, _id: (collectionValue as any).value?._id };\n\t\t\t\tsetCollectionValue(revertData);\n\t\t\t\tcurrentCollectionValue = revertData; // also update local state\n\t\t\t\ttoaster.info({ description: 'Content reverted. Please save your changes.' });\n\t\t\t\tlocalTabSet = '0';\n\t\t\t}\n\t\t});\n\t}\n\n\t// --- 6. VALIDATION LOGIC ---\n\t// Reactively validate fields whenever values change\n\t$effect(() => {\n\t\tconst values = currentCollectionValue; // React to value changes\n\n\t\t// Iterate over fields to validate them\n\t\tfilteredFields.forEach((field: any) => {\n\t\t\tif (field.required) {\n\t\t\t\tconst fieldName = getFieldName(field, false);\n\t\t\t\tconst value = values[fieldName];\n\n\t\t\t\t// Check for empty values\n\t\t\t\t// Handle various types: string, array, null, undefined\n\t\t\t\tconst isEmpty =\n\t\t\t\t\tvalue === null || value === undefined || (typeof value === 'string' && value.trim() === '') || (Array.isArray(value) && value.length === 0);\n\n\t\t\t\tif (isEmpty) {\n\t\t\t\t\t// Only set error if it's not already set to avoid loop (though store handles this)\n\t\t\t\t\tif (!validationStore.hasError(fieldName)) {\n\t\t\t\t\t\tvalidationStore.setError(fieldName, `${field.label || fieldName} is required`);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (validationStore.hasError(fieldName)) {\n\t\t\t\t\t\tvalidationStore.clearError(fieldName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t$effect(() => {\n\t\tif ((collectionValue as any).value?._id) {\n\t\t\tapiUrl = `${location.origin}/api/collection/${collection.value?._id}/${(collectionValue as any).value._id}`;\n\t\t}\n\t});\n</script>\n\n<Tabs value={localTabSet} onValueChange={(e) => (localTabSet = e.value)} class=\"flex flex-1 flex-col items-center\">\n\t<Tabs.List\n\t\tclass=\"flex justify-between md:justify-around rounded-tl-container rounded-tr-container border-b border-tertiary-500 dark:border-primary-500 w-full\"\n\t>\n\t\t<Tabs.Trigger value=\"0\" class=\"flex-1\">\n\t\t\t<div class=\"flex items-center justify-center gap-2 py-2\">\n\t\t\t\t<iconify-icon icon=\"mdi:pen\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t{m.button_edit()}\n\t\t\t</div>\n\t\t</Tabs.Trigger>\n\n\t\t{#if collection.value?.revision}\n\t\t\t<Tabs.Trigger value=\"1\" class=\"flex-1\">\n\t\t\t\t<div class=\"flex items-center justify-center gap-2 py-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:history\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t{m.applayout_version()} <span class=\"preset-filled-secondary-500 badge\">{revisions.length}</span>\n\t\t\t\t</div>\n\t\t\t</Tabs.Trigger>\n\t\t{/if}\n\n\t\t{#if collection.value?.livePreview}\n\t\t\t<Tabs.Trigger value=\"2\" class=\"flex-1\">\n\t\t\t\t<div class=\"flex items-center justify-center gap-2 py-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:eye-outline\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t{m.Fields_preview()}\n\t\t\t\t</div>\n\t\t\t</Tabs.Trigger>\n\t\t{/if}\n\n\t\t{#if user?.isAdmin}\n\t\t\t<Tabs.Trigger value=\"3\" class=\"flex-1\">\n\t\t\t\t<div class=\"flex items-center justify-center gap-2 py-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:api\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\tAPI\n\t\t\t\t</div>\n\t\t\t</Tabs.Trigger>\n\t\t{/if}\n\t</Tabs.List>\n\n\t<Tabs.Content value=\"0\" class=\"w-full\">\n\t\t<div class=\"mb-2 text-center text-xs text-error-500\">{m.form_required()}</div>\n\t\t<div class=\"rounded-md border bg-white px-4 py-6 drop-shadow-2xl dark:border-surface-500 dark:bg-surface-900\">\n\t\t\t<div class=\"flex flex-wrap items-center justify-center gap-1 overflow-auto\">\n\t\t\t\t{#each filteredFields as rawField (rawField.db_fieldName || rawField.id || rawField.label || rawField.name)}\n\t\t\t\t\t{#if rawField.widget}\n\t\t\t\t\t\t{@const field = ensureFieldProperties(rawField)}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"mx-auto text-center {!field?.width ? 'w-full ' : 'max-md:w-full!'}\"\n\t\t\t\t\t\t\tstyle={'min-width:min(300px,100%);' + (field.width ? `width:calc(${Math.floor(100 / field?.width)}% - 0.5rem)` : '')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex items-center justify-between gap-2 px-[5px] text-start field-label\">\n\t\t\t\t\t\t\t\t<!-- Field label -->\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<p class=\"inline-block font-semibold capitalize\">\n\t\t\t\t\t\t\t\t\t\t{field.label || field.db_fieldName}\n\t\t\t\t\t\t\t\t\t\t{#if field.required}<span class=\"text-error-500\">*</span>{/if}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\tonclick={(e) => openTokenPicker(field, e)}\n\t\t\t\t\t\t\t\t\t\tclass=\"\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"Insert Token\"\n\t\t\t\t\t\t\t\t\t\taria-label=\"Insert token into {field.label}\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:code-braces\" width=\"16\" class=\"font-bold text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<!-- Translation status -->\n\t\t\t\t\t\t\t\t\t{#if field.translated}\n\t\t\t\t\t\t\t\t\t\t{@const percentage = getFieldTranslationPercentage(field)}\n\t\t\t\t\t\t\t\t\t\t{@const textColor = getTranslationTextColor(percentage)}\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-1 text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t<iconify-icon icon=\"bi:translate\" width=\"16\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"font-medium text-tertiary-500 dark:text-primary-500\">{currentContentLanguage.toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"font-medium {textColor}\">({percentage}%)</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t<!-- Icon for field type -->\n\t\t\t\t\t\t\t\t\t{#if field.icon}\n\t\t\t\t\t\t\t\t\t\t<iconify-icon icon={field.icon} width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if field.widget}\n\t\t\t\t\t\t\t\t{@const widgetName = field.widget.Name}\n\n\t\t\t\t\t\t\t\t<!-- --- PERFORMANCE FIX: ROBUST WIDGET FINDER --- -->\n\t\t\t\t\t\t\t\t{@const loadedWidget = (() => {\n\t\t\t\t\t\t\t\t\t// 1. Try exact path from widget store (fastest)\n\t\t\t\t\t\t\t\t\tconst storePath = widgetFunctions[widgetName]?.componentPath;\n\t\t\t\t\t\t\t\t\tif (storePath && storePath in modules) return modules[storePath];\n\n\t\t\t\t\t\t\t\t\t// 2. Try casing variations from store\n\t\t\t\t\t\t\t\t\tconst camelPath = widgetFunctions[widgetName.charAt(0).toLowerCase() + widgetName.slice(1)]?.componentPath;\n\t\t\t\t\t\t\t\t\tif (camelPath && camelPath in modules) return modules[camelPath];\n\n\t\t\t\t\t\t\t\t\tconst lowerPath = widgetFunctions[widgetName.toLowerCase()]?.componentPath;\n\t\t\t\t\t\t\t\t\tif (lowerPath && lowerPath in modules) return modules[lowerPath];\n\n\t\t\t\t\t\t\t\t\t// 3. Robust Search in modules (fallback)\n\t\t\t\t\t\t\t\t\tconst normalized = widgetName.toLowerCase();\n\t\t\t\t\t\t\t\t\tfor (const path in modules) {\n\t\t\t\t\t\t\t\t\t\tconst lowerPath = path.toLowerCase();\n\t\t\t\t\t\t\t\t\t\tconst parts = lowerPath.split('/');\n\t\t\t\t\t\t\t\t\t\tconst fileName = parts.pop();\n\t\t\t\t\t\t\t\t\t\tconst folderName = parts.pop();\n\n\t\t\t\t\t\t\t\t\t\t// A. Match 3-Pillar Structure: /WidgetName/Input.svelte\n\t\t\t\t\t\t\t\t\t\t// IMPORTANT: Enforce folder name matches widget name to avoid matching other widgets' Input.svelte\n\t\t\t\t\t\t\t\t\t\tif (folderName === normalized && fileName === 'input.svelte') return modules[path];\n\n\t\t\t\t\t\t\t\t\t\t// B. Match 3-Pillar Index: /WidgetName/index.svelte\n\t\t\t\t\t\t\t\t\t\tif (folderName === normalized && fileName === 'index.svelte') return modules[path];\n\n\t\t\t\t\t\t\t\t\t\t// C. Match Single File: /WidgetName.svelte\n\t\t\t\t\t\t\t\t\t\t// EXCEPTION: Do not loosely match \"Input.svelte\" as it causes collisions with standard 3-pillar components\n\t\t\t\t\t\t\t\t\t\tif (fileName === `${normalized}.svelte` && normalized !== 'input') return modules[path];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t\t{#if loadedWidget}\n\t\t\t\t\t\t\t\t\t{@const fieldName = getFieldName(field, false)}\n\t\t\t\t\t\t\t\t\t{#key currentContentLanguage}\n\t\t\t\t\t\t\t\t\t\t<!-- Widget remounts when currentContentLanguage changes -->\n\t\t\t\t\t\t\t\t\t\t<WidgetLoader loader={loadedWidget} {field} WidgetData={{}} bind:value={currentCollectionValue[fieldName]} {tenantId} />\n\t\t\t\t\t\t\t\t\t{/key}\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<p class=\"text-error-500\">{m.Fields_no_widgets_found({ name: widgetName })}</p>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t<!-- --- END PERFORMANCE FIX --- -->\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t</div>\n\t</Tabs.Content>\n\t<Tabs.Content value=\"1\" class=\"w-full\">\n\t\t<div class=\"p-4\">\n\t\t\t{#if revisions.length === 0}\n\t\t\t\t<p class=\"p-4 text-center text-surface-500\">No revision history found for this entry.</p>\n\t\t\t{:else}\n\t\t\t\t<div class=\"mb-4 flex items-center justify-between gap-4\">\n\t\t\t\t\t<select class=\"select grow\" bind:value={selectedRevisionId}>\n\t\t\t\t\t\t<option value=\"\" disabled>-- Select a revision to compare --</option>\n\t\t\t\t\t\t{#each revisions as revision (revision._id)}\n\t\t\t\t\t\t\t<option value={revision._id}>\n\t\t\t\t\t\t\t\t{new Date(revision.revision_at).toLocaleString()} by {revision.revision_by.substring(0, 8)}...\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t\t<button class=\"preset-filled-primary-500 btn\" onclick={handleRevert} disabled={!selectedRevision?.data}>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:restore\" class=\"mr-1\"></iconify-icon> Revert\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"rounded-lg border p-4 dark:text-surface-50\">\n\t\t\t\t\t<h3 class=\"mb-3 text-lg font-bold\">Changes from Selected Revision</h3>\n\t\t\t\t\t{#if selectedRevision}\n\t\t\t\t\t\t{@const diffObject = selectedRevision?.diff || null}\n\t\t\t\t\t\t{#if diffObject && Object.keys(diffObject).length > 0}\n\t\t\t\t\t\t\t<div class=\"space-y-3 font-mono text-sm\">\n\t\t\t\t\t\t\t\t{#each Object.entries(diffObject) as [key, change]}\n\t\t\t\t\t\t\t\t\t{@const ch = change as any}\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<strong class=\"font-bold text-surface-600 dark:text-surface-300\">{key}:</strong>\n\t\t\t\t\t\t\t\t\t\t{#if ch.status === 'modified'}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"mt-1 rounded border border-error-500/30 bg-error-500/10 p-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-error-700 dark:text-error-300\">- {JSON.stringify(ch.old)}</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"mt-1 rounded border border-success-500/30 bg-success-500/10 p-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-success-700 dark:text-success-300\">+ {JSON.stringify(ch.new)}</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{:else if ch.status === 'added'}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"mt-1 rounded border border-success-500/30 bg-success-500/10 p-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-success-700 dark:text-success-300\">+ {JSON.stringify(ch.value)}</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{:else if ch.status === 'deleted'}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"mt-1 rounded border border-error-500/30 bg-error-500/10 p-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-error-700 dark:text-error-300\">- {JSON.stringify(ch.value)}</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else if selectedRevisionId}\n\t\t\t\t\t\t\t<p class=\"text-center text-surface-500\">No differences found.</p>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<p class=\"text-center text-surface-500\">Select a revision to see what's changed.</p>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<p class=\"text-center text-surface-500\">Select a revision to see what's changed.</p>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</Tabs.Content>\n\t<Tabs.Content value=\"2\" class=\"w-full\">\n\t\t{@const hostProd = publicEnv?.HOST_PROD || 'https://localhost:5173'}\n\t\t{@const entryId = (collectionValue as any).value?._id || 'draft'}\n\t\t{@const previewUrl = `${hostProd}?preview=${entryId}`}\n\t\t<div class=\"flex h-[600px] flex-col p-4\">\n\t\t\t<div class=\"mb-4 flex items-center justify-between gap-4\">\n\t\t\t\t<div class=\"flex flex-1 items-center gap-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:open-in-new\" width=\"20\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t<input type=\"text\" class=\"input grow text-sm\" readonly value={previewUrl} />\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"preset-outline-surface-500 btn-sm\"\n\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\tnavigator.clipboard.writeText(previewUrl);\n\t\t\t\t\t\t\ttoaster.success({ description: 'Preview URL Copied' });\n\t\t\t\t\t\t}}\n\t\t\t\t\t\taria-label=\"Copy preview URL\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:content-copy\" width=\"16\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<a href={previewUrl} target=\"_blank\" rel=\"noopener noreferrer\" class=\"preset-filled-primary-500 btn-sm\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:open-in-new\" width=\"16\" class=\"mr-1\"></iconify-icon>\n\t\t\t\t\tOpen\n\t\t\t\t</a>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex-1 overflow-hidden rounded-lg border border-surface-300 dark:text-surface-50\">\n\t\t\t\t<iframe src={previewUrl} title=\"Live Preview\" class=\"h-full w-full\" sandbox=\"allow-same-origin allow-scripts allow-forms allow-popups\"\n\t\t\t\t></iframe>\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-2 text-center text-xs text-surface-500\">\n\t\t\t\tPreview URL: {hostProd}?preview={entryId}\n\t\t\t</div>\n\t\t</div>\n\t</Tabs.Content>\n\t<Tabs.Content value=\"3\" class=\"w-full\">\n\t\t<div class=\"space-y-4 p-4\">\n\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t<input type=\"text\" class=\"input grow\" readonly value={apiUrl} />\n\t\t\t\t<button\n\t\t\t\t\tclass=\"preset-outline-surface-500 btn\"\n\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\tnavigator.clipboard.writeText(apiUrl);\n\t\t\t\t\t\ttoaster.success({ description: 'API URL Copied' });\n\t\t\t\t\t}}>Copy</button\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"card p-4 overflow-x-auto bg-surface-800 text-white font-mono text-sm max-h-[500px]\">\n\t\t\t\t<pre>{JSON.stringify((collectionValue as any).value, null, 2)}</pre>\n\t\t\t</div>\n\t\t</div>\n\t</Tabs.Content>\n</Tabs>\n","<!--\n@file src/routes/(app)/[language]/[...collection]/+page.svelte\n@component\n**This component acts as a layout and data router for the collection view.**\n\n## Navigation Architecture (GUI-First Pattern):\n\n### PRIMARY: GUI Actions (90% of navigation)\n1. User hovers button  Preload data to cache\n2. User clicks button  Check cache  setMode()  URL reflects change\n3. FAST: No goto(), no SSR reload, instant mode switching\n\n### SECONDARY: URL Changes (10% - manual edits)\n1. User manually edits URL  Detect change in $effect\n2. Parse URL  Translate to UUID  setMode()  Load if not cached\n3. SLOWER: Required SSR reload only when user types URL directly\n\n## Features:\n- Receives all page data (schema, entries, pagination) from the server-side `load` function.\n- Passes server-loaded data as props to the `EntryList` or `Fields` components.\n- URL-to-mode translation for manual URL edits (browser address bar changes).\n- Auto-saves unsaved changes as draft when navigating away to prevent data loss.\n\n-->\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { beforeNavigate, invalidateAll, replaceState } from '$app/navigation';\n\timport { page } from '$app/state';\n\timport { untrack, onMount } from 'svelte';\n\timport { collections } from '@shared/stores/collectionStore.svelte';\n\timport { app, validationStore } from '@shared/stores/store.svelte';\n\timport { parseURLToMode } from '@shared/utils/navigationUtils';\n\timport { getFieldName } from '@shared/utils/utils';\n\timport EntryList from '@cms/components/collectionDisplay/EntryList.svelte';\n\timport Fields from '@cms/components/collectionDisplay/Fields.svelte';\n\timport { showToast } from '@shared/utils/toast';\n\timport type { Schema } from '@cms-types';\n\n\tinterface PageData {\n\t\tcollectionSchema: Schema;\n\t\tentries: any[];\n\t\tpagination: {\n\t\t\ttotalItems: number;\n\t\t\tpagesCount: number;\n\t\t\tcurrentPage: number;\n\t\t\tpageSize: number;\n\t\t};\n\t\trevisions: any[];\n\t\tcontentLanguage: string;\n\t}\n\n\tconst { data }: { data: PageData } = $props();\n\n\t// Use $derived for reactivity from server-loaded data\n\tconst collectionSchema = $derived(data?.collectionSchema);\n\tconst entries = $derived(data?.entries || []);\n\tconst pagination = $derived(data?.pagination || { currentPage: 1, pageSize: 10, totalItems: 0, pagesCount: 1 });\n\tconst revisions = $derived(data?.revisions || []);\n\tconst serverContentLanguage = $derived(data?.contentLanguage);\n\n\t// Debug: Monitor data prop changes\n\t$effect(() => {\n\t\tlogger.debug('[+page.svelte] Data changed:', {\n\t\t\tschemaId: data?.collectionSchema?._id,\n\t\t\tschemaName: data?.collectionSchema?.name,\n\t\t\tentriesCount: data?.entries?.length,\n\t\t\tstoreId: collections.active?._id,\n\t\t\tstoreName: collections.active?.name\n\t\t});\n\t});\n\n\t// Track initial collectionValue to detect changes\n\tlet initialCollectionValue = $state('');\n\tlet userClickedCancel = $state(false);\n\tlet isSavingDraft = $state(false);\n\n\t// Track when we last received server data to avoid overwriting client-side language changes\n\tlet lastServerLanguage: string | undefined = $state(undefined);\n\n\t// Track if we've initialized validation for the current create session\n\tlet validationInitialized = $state(false);\n\n\t// Initialize validation IMMEDIATELY for create mode using $effect.pre()\n\t// This runs synchronously BEFORE DOM updates, ensuring button state is correct on first render\n\t$effect.pre(() => {\n\t\tconst createParam = page.url.searchParams.get('create');\n\n\t\tif (createParam === 'true' && collectionSchema && !validationInitialized) {\n\t\t\t// Clear all errors first to start fresh\n\t\t\tvalidationStore.clearAllErrors();\n\n\t\t\t// Initialize validation for all required fields\n\t\t\tconst fields = collectionSchema.fields || [];\n\t\t\tlet errorCount = 0;\n\t\t\tfor (const field of fields) {\n\t\t\t\tconst fieldDef = field as any;\n\t\t\t\tif (fieldDef.required) {\n\t\t\t\t\tconst fieldName = getFieldName(fieldDef, false);\n\t\t\t\t\tvalidationStore.setError(fieldName, `${fieldDef.label || fieldName} is required`);\n\t\t\t\t\terrorCount++;\n\t\t\t\t\tconsole.log(' [Validation Init] Set error for required field:', fieldName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvalidationInitialized = true;\n\t\t\tconsole.log(' [Validation Init] Initialized', errorCount, 'required field errors, isValid:', validationStore.isValid);\n\t\t} else if (createParam !== 'true') {\n\t\t\t// Reset flag when leaving create mode\n\t\t\tif (validationInitialized) {\n\t\t\t\tconsole.log(' [Validation Init] Resetting validation flag');\n\t\t\t\tvalidationInitialized = false;\n\t\t\t}\n\t\t}\n\t});\n\n\t// Sync contentLanguage store with server data\n\t// IMPORTANT: Server language (URL) takes precedence over cookie/store\n\t// This MUST run immediately when data changes to ensure widgets get correct language\n\t// BUT: Only sync when we receive NEW server data (not on client-side URL changes)\n\t$effect(() => {\n\t\tif (serverContentLanguage) {\n\t\t\t// Only sync if server language actually changed (indicates new server load)\n\t\t\tif (serverContentLanguage !== lastServerLanguage) {\n\t\t\t\tconst currentStoreLanguage = app.contentLanguage;\n\t\t\t\tif (currentStoreLanguage !== serverContentLanguage) {\n\t\t\t\t\tlogger.debug('[+page.svelte] Syncing contentLanguage from server:', currentStoreLanguage, '', serverContentLanguage);\n\t\t\t\t\t// Set without untrack to ensure all reactive subscribers are notified\n\t\t\t\t\tapp.contentLanguage = serverContentLanguage as any;\n\t\t\t\t\tlogger.debug('[+page.svelte] ContentLanguage store now:', app.contentLanguage);\n\t\t\t\t}\n\t\t\t\tlastServerLanguage = serverContentLanguage;\n\t\t\t}\n\t\t}\n\t});\n\n\t// Initial collection store sync - ensures store has correct schema on first load\n\t// CRITICAL: Always sync when collectionSchema changes to keep store in sync with server data\n\t$effect(() => {\n\t\tif (collectionSchema) {\n\t\t\tconst currentStoreId = collections.active?._id;\n\t\t\tconst schemaId = collectionSchema._id;\n\t\t\t// Only update if different to avoid unnecessary re-renders\n\t\t\tif (currentStoreId !== schemaId) {\n\t\t\t\tlogger.debug('[+page.svelte] Syncing collection store:', currentStoreId, '', schemaId, collectionSchema.name);\n\t\t\t\tcollections.setCollection(collectionSchema);\n\t\t\t}\n\t\t}\n\t});\n\n\tlet isMounted = $state(false);\n\n\tonMount(() => {\n\t\tisMounted = true;\n\t});\n\n\t$effect(() => {\n\t\tif (isMounted && typeof window !== 'undefined') {\n\t\t\tconst currentPath = page.url.pathname;\n\t\t\tconst collectionIdFromPath = currentPath.split('/').pop() || '';\n\t\t\tconst isUUID = /^[a-f0-9]{32}$/i.test(collectionIdFromPath);\n\n\t\t\t// Only replace URL if:\n\t\t\t// 1. The URL contains a UUID\n\t\t\t// 2. We have a collection schema with a path\n\t\t\t// 3. The collection schema ID matches the UUID in the URL (ensures data is loaded for correct collection)\n\t\t\tif (isUUID && collectionSchema?.path && collectionSchema._id === collectionIdFromPath) {\n\t\t\t\tconst newPath = `/${serverContentLanguage}${collectionSchema.path}${page.url.search}`;\n\t\t\t\tif (newPath !== currentPath) {\n\t\t\t\t\tlogger.debug(`[URL Update] Replacing UUID path with pretty path: ${newPath}`);\n\t\t\t\t\t// Use SvelteKit's replaceState to avoid interfering with navigation state\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\treplaceState(newPath, {});\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// URL-TO-MODE TRANSLATION & INITIAL LOAD DETECTION\n\t// ============================================================================\n\t// Handles both:\n\t// 1. Initial page load with ?edit=id in URL\n\t// 2. Manual URL changes (user types in address bar)\n\t// 3. Language changes in edit mode (URL language prefix changes but ?edit=id stays same)\n\t// 4. Collection changes (navigation between different collections)\n\n\tlet lastUrlString: string = $state('');\n\tlet lastEditParam: string | null = $state(null);\n\tlet hasInitiallyLoaded = $state(false);\n\tlet lastCollectionId: string | null = $state(null);\n\n\t// Track collection changes - when navigating to a different collection, reset state\n\t$effect(() => {\n\t\tconst currentCollectionId = collectionSchema?._id as string | undefined;\n\t\tif (currentCollectionId && currentCollectionId !== lastCollectionId) {\n\t\t\tlogger.debug('[Collection Change] Detected collection switch:', lastCollectionId, '', currentCollectionId);\n\t\t\tlogger.debug('[Collection Change] New entries count:', entries.length, 'pagination:', pagination);\n\n\t\t\t// CRITICAL: Sync collection store with server data\n\t\t\t// This ensures collections.active is updated when navigating between collections\n\t\t\tif (collectionSchema) {\n\t\t\t\tcollections.setCollection(collectionSchema);\n\t\t\t\tlogger.debug('[Collection Change] Store synced with server data:', collectionSchema.name);\n\t\t\t}\n\n\t\t\t// Reset state tracking for the new collection\n\t\t\thasInitiallyLoaded = false;\n\t\t\tlastEditParam = null;\n\t\t\tlastUrlString = '';\n\t\t\t// Update tracking\n\t\t\tlastCollectionId = currentCollectionId;\n\t\t\t// Set mode to view for new collection (unless URL says otherwise)\n\t\t\tconst editParam = page.url.searchParams.get('edit');\n\t\t\tconst createParam = page.url.searchParams.get('create');\n\t\t\tif (!editParam && !createParam) {\n\t\t\t\tcollections.setMode('view');\n\t\t\t}\n\t\t}\n\t});\n\n\t$effect(() => {\n\t\tconst currentUrl = page.url.toString();\n\t\tconst editParam = page.url.searchParams.get('edit');\n\t\tconst createParam = page.url.searchParams.get('create');\n\n\t\t// CASE 1: Initial page load with ?edit=id\n\t\tif (!hasInitiallyLoaded && editParam && entries && entries.length === 1) {\n\t\t\thasInitiallyLoaded = true;\n\t\t\tlastEditParam = editParam;\n\t\t\tconst entryData = entries[0];\n\t\t\tlogger.debug('[Initial Load] Edit mode detected, loading entry:', entryData._id);\n\n\t\t\tcollections.setMode('edit');\n\t\t\tcollections.setCollectionValue(entryData);\n\t\t\tinitialCollectionValue = JSON.stringify(entryData);\n\t\t\tlastUrlString = currentUrl;\n\t\t\treturn; // Exit early to avoid triggering URL change logic\n\t\t}\n\n\t\t// CASE 1b: Initial page load with ?create=true\n\t\tif (!hasInitiallyLoaded && createParam === 'true') {\n\t\t\thasInitiallyLoaded = true;\n\t\t\tlastUrlString = currentUrl;\n\n\t\t\tcollections.setMode('create');\n\t\t\tconst newEntry: Record<string, any | null> = {};\n\t\t\tconst fields = collections.active?.fields || [];\n\n\t\t\t// Initialize empty entry\n\t\t\tfor (const field of fields) {\n\t\t\t\tconst fieldName = getFieldName(field as any, false);\n\t\t\t\tnewEntry[fieldName] = null;\n\t\t\t}\n\t\t\tcollections.setCollectionValue(newEntry);\n\n\t\t\t//  Validation is now handled by $effect.pre() above\n\t\t\t// No need to duplicate validation logic here\n\n\t\t\t// Initialize change tracking\n\t\t\tinitialCollectionValue = JSON.stringify(newEntry);\n\n\t\t\tlogger.debug('[Initial Load] Create mode detected, entry initialized');\n\t\t\treturn; // Exit early to avoid triggering URL change logic\n\t\t}\n\n\t\t// CASE 2: URL changed (manual navigation)\n\t\tif (currentUrl !== lastUrlString && hasInitiallyLoaded) {\n\t\t\t// Check if only language changed (URL language prefix) but params stayed the same\n\t\t\tconst editParamChanged = editParam !== lastEditParam;\n\t\t\tconst wasInCreateMode = lastUrlString.includes('create=true');\n\t\t\tconst isInCreateMode = createParam === 'true';\n\n\t\t\t// If we're in edit/create mode and only URL language changed, ignore the URL change\n\t\t\t// This happens when user changes language in TranslationStatus dropdown\n\t\t\tif ((collections.mode === 'edit' || collections.mode === 'create') && editParam === lastEditParam && isInCreateMode === wasInCreateMode) {\n\t\t\t\tlogger.debug('[URL Change] Language prefix changed, but staying in', collections.mode, 'mode (no reload needed)');\n\t\t\t\tlastUrlString = currentUrl;\n\t\t\t\treturn; // Don't reload data, just update URL tracking\n\t\t\t}\n\n\t\t\tlastUrlString = currentUrl;\n\t\t\tlastEditParam = editParam;\n\t\t\tconst parsed = parseURLToMode(page.url);\n\n\t\t\tlogger.debug(`[URL Change] ${collections.mode}  ${parsed.mode}`, {\n\t\t\t\tentryId: parsed.entryId,\n\t\t\t\thasEntries: entries.length,\n\t\t\t\teditParamChanged\n\t\t\t});\n\n\t\t\t// Edit mode from URL change\n\t\t\tif (parsed.mode === 'edit' && parsed.entryId && editParamChanged) {\n\t\t\t\tif (entries && entries.length === 1) {\n\t\t\t\t\t// Data already loaded by server\n\t\t\t\t\tconst entryData = entries[0];\n\t\t\t\t\tcollections.setMode('edit');\n\t\t\t\t\tcollections.setCollectionValue(entryData);\n\t\t\t\t\tinitialCollectionValue = JSON.stringify(entryData);\n\t\t\t\t} else {\n\t\t\t\t\t// Need to reload data\n\t\t\t\t\tinvalidateAll().then(() => {\n\t\t\t\t\t\tcollections.setMode('edit');\n\t\t\t\t\t\tlogger.debug(`[URL Change] Reloaded entry ${parsed.entryId}`);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (parsed.mode === 'view' && collections.mode === 'edit') {\n\t\t\t\t// Exiting edit mode\n\t\t\t\tcollections.setMode('view');\n\t\t\t} else if (parsed.mode === 'create') {\n\t\t\t\t// Create mode (URL change while already loaded)\n\t\t\t\tcollections.setMode('create');\n\t\t\t\tconst newEntry: Record<string, any | null> = {};\n\t\t\t\tconst fields = collections.active?.fields || [];\n\n\t\t\t\t// Initialize empty entry with null values\n\t\t\t\tfor (const field of fields) {\n\t\t\t\t\tconst fieldName = getFieldName(field as any, false);\n\t\t\t\t\tnewEntry[fieldName] = null;\n\t\t\t\t}\n\t\t\t\tcollections.setCollectionValue(newEntry);\n\n\t\t\t\t//  FIX: Perform initial validation for required fields\n\t\t\t\tvalidationStore.clearAllErrors();\n\n\t\t\t\t// Initialize change tracking\n\t\t\t\tinitialCollectionValue = JSON.stringify(newEntry);\n\n\t\t\t\tfor (const field of fields) {\n\t\t\t\t\tconst fieldDef = field as any;\n\t\t\t\t\tif (fieldDef.required) {\n\t\t\t\t\t\tconst fieldName = getFieldName(fieldDef, false);\n\t\t\t\t\t\tconst value = newEntry[fieldName];\n\n\t\t\t\t\t\t// Validate required field\n\t\t\t\t\t\tif (value === null || value === undefined || value === '') {\n\t\t\t\t\t\t\tvalidationStore.setError(fieldName, `${fieldDef.label || fieldName} is required`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlogger.debug('[URL Change] Create mode validation initialized');\n\t\t\t} else if (collections.mode !== parsed.mode) {\n\t\t\t\t// Other mode changes\n\t\t\t\tcollections.setMode(parsed.mode);\n\t\t\t}\n\t\t}\n\n\t\t// CASE 3: Mark as loaded after first render (for view mode)\n\t\tif (!hasInitiallyLoaded && !editParam) {\n\t\t\thasInitiallyLoaded = true;\n\t\t\tlastEditParam = editParam;\n\t\t\tlastUrlString = currentUrl;\n\t\t}\n\t});\n\n\t// Sync collection schema from server data\n\t$effect(() => {\n\t\tif (collectionSchema) {\n\t\t\tcollections.setCollection(collectionSchema);\n\t\t}\n\t});\n\n\t// Track initial state when entering edit mode\n\t// This runs AFTER collections.activeValue is set, but doesn't trigger when collections.activeValue changes\n\t$effect(() => {\n\t\tconst currentMode = collections.mode;\n\t\tif (currentMode === 'edit' || currentMode === 'create') {\n\t\t\t// Use untrack to read collections.activeValue without creating a dependency\n\t\t\tconst currentValue = untrack(() => collections.activeValue);\n\t\t\tif (currentValue) {\n\t\t\t\tinitialCollectionValue = JSON.stringify(currentValue);\n\t\t\t\tuserClickedCancel = false; // Reset cancel flag\n\t\t\t}\n\t\t}\n\t});\n\n\t// Auto-save draft function\n\tasync function autoSaveDraft(): Promise<boolean> {\n\t\tif (isSavingDraft) return false;\n\n\t\tisSavingDraft = true;\n\t\ttry {\n\t\t\tconst entryData = collections.activeValue as any;\n\t\t\tconst collectionId = collections.active?._id;\n\t\t\tconst tenantId = page.data?.tenantId;\n\n\t\t\tif (!collectionId || !entryData) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Use collection's default status or current entry status\n\t\t\t// FORCE 'draft' status for auto-saves to bypass validation for required fields\n\t\t\tconst draftData = {\n\t\t\t\t...entryData,\n\t\t\t\tstatus: 'draft',\n\t\t\t\tupdatedAt: new Date().toISOString()\n\t\t\t};\n\n\t\t\t// Determine if creating new or updating existing\n\t\t\tconst isNewEntry = !entryData._id;\n\t\t\tconst endpoint = isNewEntry ? `/api/collections/${collectionId}` : `/api/collections/${collectionId}/${entryData._id}`;\n\n\t\t\tconst method = isNewEntry ? 'POST' : 'PUT';\n\n\t\t\tconst response = await fetch(endpoint, {\n\t\t\t\tmethod,\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tdata: draftData,\n\t\t\t\t\ttenantId\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tif (response.ok) {\n\t\t\t\tconst result = await response.json();\n\n\t\t\t\t// Update collectionValue with the saved draft (including _id for new entries)\n\t\t\t\tif (isNewEntry && result.data?._id) {\n\t\t\t\t\tcollections.activeValue = { ...draftData, _id: result.data._id };\n\t\t\t\t}\n\n\t\t\t\tlogger.debug('[Auto-save] Draft saved successfully');\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tlogger.error('[Auto-save] Failed to save draft:', response.statusText);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error('[Auto-save] Error saving draft:', error);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tisSavingDraft = false;\n\t\t}\n\t}\n\n\t// Listen for cancel and save events\n\t$effect(() => {\n\t\tconst handleCancelClick = () => {\n\t\t\tuserClickedCancel = true;\n\t\t\tlogger.debug('[Auto-save] Cancel clicked - no draft will be saved');\n\t\t};\n\n\t\tconst handleEntrySaved = () => {\n\t\t\t// Update baseline to match current value, preventing unsaved changes detection\n\t\t\tif (collections.activeValue) {\n\t\t\t\tinitialCollectionValue = JSON.stringify(collections.activeValue);\n\t\t\t\tlogger.debug('[Auto-save] Entry saved manually - baseline updated');\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener('cancelEdit' as any, handleCancelClick as EventListener);\n\t\tdocument.addEventListener('entrySaved' as any, handleEntrySaved as EventListener);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('cancelEdit' as any, handleCancelClick as EventListener);\n\t\t\tdocument.removeEventListener('entrySaved' as any, handleEntrySaved as EventListener);\n\t\t};\n\t});\n\n\t// Navigation guard: auto-save draft if changes exist\n\tbeforeNavigate(async ({ cancel }) => {\n\t\t// Skip if user clicked cancel button\n\t\tif (userClickedCancel) {\n\t\t\tlogger.debug('[Auto-save] Skipping auto-save due to cancel');\n\t\t\tuserClickedCancel = false;\n\t\t\treturn;\n\t\t}\n\n\t\t// Only check if we're in edit/create mode and have unsaved changes\n\t\tif (['edit', 'create'].includes(collections.mode) && collections.activeValue) {\n\t\t\tconst currentValue = JSON.stringify(collections.activeValue);\n\t\t\tconst hasUnsavedChanges = currentValue !== initialCollectionValue;\n\n\t\t\tif (hasUnsavedChanges && !isSavingDraft) {\n\t\t\t\tlogger.debug('[Auto-save] Detected unsaved changes, auto-saving as draft...');\n\n\t\t\t\t// Cancel navigation temporarily\n\t\t\t\tcancel();\n\n\t\t\t\t// Auto-save as draft\n\t\t\t\tconst saved = await autoSaveDraft();\n\n\t\t\t\tif (saved) {\n\t\t\t\t\tshowToast('Changes auto-saved as draft', 'success');\n\t\t\t\t\t// Update initial value to prevent re-saving\n\t\t\t\t\tinitialCollectionValue = JSON.stringify(collections.activeValue);\n\t\t\t\t\t// Allow navigation to continue\n\t\t\t\t\tcollections.setMode('view');\n\t\t\t\t} else {\n\t\t\t\t\tshowToast('Failed to auto-save. Please save manually.', 'error');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n</script>\n\n<svelte:head>\n\t<title>{collectionSchema?.name ?? 'Collection'} - SveltyCMS</title>\n</svelte:head>\n\n<div class=\"content h-full\">\n\t<!-- Auto-save indicator -->\n\t{#if isSavingDraft}\n\t\t<div class=\"fixed right-4 top-20 z-50 flex items-center gap-2 rounded-lg bg-warning-500 px-4 py-2 text-white shadow-lg\">\n\t\t\t<div class=\"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\"></div>\n\t\t\t<span class=\"text-sm font-medium\">Auto-saving draft...</span>\n\t\t</div>\n\t{/if}\n\n\t{#if !collections.active}\n\t\t<!-- Collection data should be available from SSR, if not show error -->\n\t\t<div class=\"dark:bg-error-950 flex h-64 flex-col items-center justify-center rounded-lg border border-error-500 bg-error-50 p-8\">\n\t\t\t<svg class=\"mb-4 h-16 w-16 text-error-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t<path\n\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\td=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t\t<h3 class=\"mb-2 text-xl font-bold text-error-600 dark:text-error-400\">Collection Not Loaded</h3>\n\t\t\t<p class=\"text-center text-error-600 dark:text-error-400\">Unable to load collection schema. Please refresh the page.</p>\n\t\t</div>\n\t{:else if collections.mode === 'view' || collections.mode === 'modify'}\n\t\t<!-- Key block forces EntryList to remount when collection changes -->\n\t\t{#key collectionSchema?._id}\n\t\t\t<EntryList {entries} {pagination} contentLanguage={serverContentLanguage} />\n\t\t{/key}\n\t{:else if ['edit', 'create'].includes(collections.mode)}\n\t\t<div id=\"fields_container\" class=\"fields max-h-[calc(100vh-100px)] overflow-y-auto overflow-x-visible max-md:max-h-[calc(100vh-120px)]\">\n\t\t\t<!-- Pass the server-loaded data directly as props -->\n\t\t\t<Fields fields={collections.active.fields} {revisions} contentLanguage={serverContentLanguage} />\n\t\t</div>\n\t{/if}\n</div>\n"],"file":"CY0QKx3Q.js"}