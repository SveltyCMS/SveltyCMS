{"version":3,"file":"C__nG7V9.js","sources":["../../../../../../src/widgets/core/RichText/components/VideoDialog.svelte"],"sourcesContent":["<!--\n@file src/widgets/richText/components/VideoDialog.svelte\n@component\n**VideoDialog for richText editor**\n\n@props show - boolean\n@props editor - Editor\n\n-->\n\n<script lang=\"ts\">\n\timport FloatingInput from '@cms/components/system/inputs/floatingInput.svelte';\n\timport type { Editor } from '@tiptap/core';\n\timport { onMount } from 'svelte';\n\timport { fade } from 'svelte/transition';\n\n\tinterface Props {\n\t\tshow?: boolean;\n\t\teditor: Editor | null;\n\t}\n\n\tlet { show = $bindable(false), editor }: Props = $props();\n\n\tlet insert_url = $state(false);\n\tlet youtube_url = $state('');\n\n\tfunction close() {\n\t\tshow = false;\n\t\t// Reset state after a short delay to allow the fade-out transition to complete\n\t\tsetTimeout(() => {\n\t\t\tyoutube_url = '';\n\t\t\tinsert_url = false;\n\t\t}, 200);\n\t}\n\n\tfunction handleSubmit(e: Event) {\n\t\te.preventDefault();\n\n\t\t// SECURITY: Validate YouTube URL to prevent XSS\n\t\t// Only allow youtube.com and youtu.be URLs (HTTPS only)\n\t\tconst youtubePattern = /^https:\\/\\/(www\\.)?(youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([a-zA-Z0-9_-]{11})$/;\n\n\t\tif (youtube_url && editor) {\n\t\t\tif (youtubePattern.test(youtube_url)) {\n\t\t\t\teditor.chain().focus().setYoutubeVideo({ src: youtube_url }).run();\n\t\t\t\tclose();\n\t\t\t} else {\n\t\t\t\talert('Invalid YouTube URL. Please use a valid youtube.com or youtu.be link.');\n\t\t\t}\n\t\t} else {\n\t\t\tclose();\n\t\t}\n\t}\n\n\t// Add 'Escape' key listener\n\tonMount(() => {\n\t\tconst handleKeydown = (e: KeyboardEvent) => {\n\t\t\tif (e.key === 'Escape' && show) {\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('keydown', handleKeydown);\n\t\treturn () => {\n\t\t\twindow.removeEventListener('keydown', handleKeydown);\n\t\t};\n\t});\n</script>\n\n{#if show}\n\t<div transition:fade={{ duration: 150 }} class=\"fixed inset-0 z-40 bg-black/30\" onclick={close} role=\"presentation\"></div>\n\n\t<div\n\t\ttransition:fade={{ duration: 150 }}\n\t\trole=\"dialog\"\n\t\taria-modal=\"true\"\n\t\taria-labelledby=\"video-dialog-title\"\n\t\tclass=\"fixed left-1/2 top-1/2 z-50 w-full max-w-lg -translate-x-1/2 -translate-y-1/2 transform rounded-lg bg-white p-6 shadow-xl\"\n\t>\n\t\t<iconify-icon\n\t\t\ticon=\"material-symbols:close\"\n\t\t\twidth=\"24\"\n\t\t\trole=\"button\"\n\t\t\taria-label=\"Close\"\n\t\t\tclass=\"absolute right-3 top-3 z-10 cursor-pointer text-gray-500 hover:text-gray-800\"\n\t\t\tonclick={close}\n\t\t\tonkeydown={(e: KeyboardEvent) => e.key === 'Enter' && close()}\n\t\t\ttabindex=\"0\"\n\t\t></iconify-icon>\n\n\t\t<h3 id=\"video-dialog-title\" class=\"mb-4 text-lg font-medium\">Add Video</h3>\n\n\t\t{#if insert_url}\n\t\t\t<form onsubmit={handleSubmit} class=\"relative mt-2 flex flex-col items-center justify-center gap-4\">\n\t\t\t\t<FloatingInput bind:value={youtube_url} autofocus={true} textColor=\"black\" name=\"Youtube URL\" label=\"Youtube URL\" />\n\t\t\t\t<button type=\"submit\" class=\"preset-filled-primary-500 btn w-full\">Add Video</button>\n\t\t\t</form>\n\t\t{:else}\n\t\t\t<div class=\"relative mt-2 flex flex-col items-center justify-center gap-4\">\n\t\t\t\t<p class=\"text-sm text-gray-500\">Video upload is not yet implemented.</p>\n\t\t\t\t<p>or</p>\n\t\t\t\t<div class=\"flex w-full justify-center gap-2\">\n\t\t\t\t\t<button class=\"preset-outline-primary-500 btn w-full\" disabled>Browse locally</button>\n\t\t\t\t\t<button class=\"variant-filled-secondary btn w-full\" onclick={() => (insert_url = true)}> YouTube </button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n{/if}\n"],"names":["show","insert_url","$.state","youtube_url","close","$.set","handleSubmit","e","youtubePattern","$.get","$$props","onMount","handleKeydown","div","$.first_child","fragment_1","div_1","$.sibling","iconify_icon","$.child","form","root_2","FloatingInput","node_2","$$value","$.event","div_2","root_3","div_3","button","$$render","consequent","alternate","$.reset","fade","consequent_1"],"mappings":"60CAUA,SAWO,IAAAA,gBAAiB,EAAK,EAExBC,EAAaC,EAAO,EAAK,EACzBC,EAAcD,EAAO,EAAE,EAElB,SAAAE,GAAQ,CAChBJ,EAAO,EAAK,EAEZ,WAAiB,IAAA,CAChBK,EAAAF,EAAc,EAAE,EAChBE,EAAAJ,EAAa,EAAK,CACnB,EAAG,IACJ,UAESK,EAAaC,EAAU,CAC/BA,EAAE,eAAc,EAIV,MAAAC,EAAiB,+EAEnBC,EAAAN,CAAW,GAAAO,EAAA,OACVF,EAAe,KAAIC,EAACN,CAAW,CAAA,YAC3B,MAAK,EAAG,MAAK,EAAG,iBAAkB,IAAGM,EAAEN,CAAW,CAAA,CAAA,EAAI,IAAG,EAChEC,EAAK,GAEL,MAAM,uEAAuE,EAG9EA,EAAK,CAEP,CAGAO,EAAO,IAAO,OACPC,EAAiBL,GAAqB,CACvCA,EAAE,MAAQ,UAAYP,EAAI,GAC7BI,EAAK,CAEP,EACA,cAAO,iBAAiB,UAAWQ,CAAa,EACnC,IAAA,CACZ,OAAO,oBAAoB,UAAWA,CAAa,CACpD,CACD,CAAC,wCAIAC,EAAGC,EAAAC,CAAA,EAAHF,EAA+E,QAAST,EAExF,IAAAY,EAAAC,EAFAJ,EAAG,CAAA,EASFK,EAAQC,EAPTH,CAAA,IAOCE,EAAQ,OAAA,wBAAA,IAARA,EAAQ,QAAA,IAAA,IAARA,EAAQ,OAAA,QAAA,IAARA,EAAQ,aAAA,OAAA,IAARA,EAAQ,EAAA,8EAAA,EAARA,EAMA,QAASd,EANTc,EAOA,UAAYX,GAAqBA,EAAE,MAAQ,SAAWH,EAAK,IAP3Dc,EAAQ,WAAA,GAAA,UAARA,EAAQ,CAAA,iBAcPE,EAAIC,EAAA,MAAJD,CAAI,EACHE,EAAaC,EAAA,WAAqC,gEAApC,OAAU,UAAEpB,CAAW,OAAvB,MAAUqB,EAAA,GAAErB,EAAWqB,EAAA,EAAA,YADtCJ,CAAI,EAAJK,EAAA,SAAAL,EAAed,CAAY,MAA3Bc,CAAI,aAKJM,EAAGC,EAAA,EAGFC,MAHDF,CAAG,EAAA,CAAA,EAKDG,MAFDD,CAAG,EAAA,CAAA,EAEFC,EAAmD,QAAO,IAAAxB,EAASJ,EAAa,EAAI,IAFrF2B,CAAG,IAHJF,CAAG,MAAHA,CAAG,aANAzB,CAAU,EAAA6B,EAAAC,CAAA,EAAAD,EAAAE,EAAA,EAAA,IApBfC,EAAAjB,CAAA,MAFAH,EAAG,IAAAqB,EAAA,KAAA,CAAoB,SAAU,GAAG,EAAA,MAEpClB,EAAA,IAAAkB,EAAA,KAAA,CACmB,SAAU,GAAG,EAAA,kBAJ7BlC,EAAI,GAAA8B,EAAAK,CAAA,cAFD"}