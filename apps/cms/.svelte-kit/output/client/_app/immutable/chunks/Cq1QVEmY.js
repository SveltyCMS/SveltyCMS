const __vite__mapDeps = (i, m = __vite__mapDeps, d = m.f || (m.f = ['./Z7upHnG1.js', './DtH1sEIR.js', './DrlZFkx8.js', './rsSWfq8L.js'])) =>
	i.map((i) => d[i]);
import { i as rt } from './zi73tRJP.js';
import {
	p as pt,
	d as Y,
	x as Ht,
	z as wt,
	b as f,
	c as o,
	s as h,
	g as t,
	u as yt,
	r as n,
	t as Z,
	a as vt,
	f as Rt,
	n as ht,
	aA as si,
	A as ci,
	aC as li
} from './DrlZFkx8.js';
import { d as At, f as K, a as X, s as Q, c as Ut, e as xe, t as di } from './CTjXDULS.js';
import { r as Zt, b as w, c as nt, a as bt, d as pe, e as ui, g as fi, h as le, s as hi } from './MEFvoR_D.js';
import { b as ue } from './YQp2a1pQ.js';
import { p as dt, b as pi } from './DePHBZW_.js';
import { m as vi, g as re, e as Ae } from './D3eWcrZU.js';
import { i as mi } from './B_fImZOG.js';
import { l as Tt } from './BvngfGKt.js';
import {
	dE as gi,
	dF as bi,
	dG as De,
	dH as Fe,
	dI as yi,
	dJ as Ee,
	dK as _i,
	dL as xi,
	dM as wi,
	dN as ki,
	dO as Si,
	dP as Ci,
	dQ as Ti
} from './N8Jg0v49.js';
import { v as Ie } from './C-hhfhAN.js';
import { m as Ge, b as Ne } from './-PV6rnhC.js';
import { t as Ri } from './COJ8Fh6m.js';
import { o as Ve, a as Ke } from './CMZtchEj.js';
import { e as de, i as Se } from './BXe5mj2j.js';
import { t as qt, f as te, a as Ai } from './0XeaN6pZ.js';
import { b as Di } from './D4QnGYgQ.js';
import { a as Fi } from './B9ygI19o.js';
import { c as Je } from './7bh91wXp.js';
import { K as W, i as d } from './DtH1sEIR.js';
import { _ as Ei } from './PPVm8Dsz.js';
import { s as Ii } from './BSPmpUse.js';
import { s as Gi } from './DhHAlOU0.js';
import { p as Ni, B as Pi, a as Li, h as Pe, j as Mi, E as zi, n as se, y as Oi, s as $t } from './Bg__saH3.js';
var Wi = K('<span class="text-sm font-normal opacity-70"> </span>'),
	Ui = K(
		'<div class="flex items-center justify-between rounded-lg border-l-4 border-primary-500 bg-primary-50 p-3 dark:bg-primary-900/20"><span class="text-sm font-medium"> </span> <div class="flex gap-2"><button class="preset-outlined-surface-500btn btn-sm">Clear</button> <button class="preset-filled-primary-500 btn-sm">Confirm Selection</button></div></div>'
	),
	ji = K(
		'<div class="flex flex-1 items-center justify-center"><div class="flex flex-col items-center gap-3"><div class="h-12 w-12 animate-spin rounded-full border-4 border-primary-500 border-t-transparent"></div> <p class="text-lg text-primary-500">Loading media...</p></div></div>'
	),
	Xi = K(
		'<div class="flex flex-1 items-center justify-center"><div class="flex flex-col items-center gap-3"><iconify-icon></iconify-icon> <p class="text-lg text-error-500"> </p> <button class="preset-filled-primary-500 btn-sm">Try Again</button></div></div>',
		2
	),
	Yi = K(
		'<div class="flex flex-1 items-center justify-center"><div class="flex flex-col items-center gap-3"><iconify-icon></iconify-icon> <p class="text-lg text-surface-600 dark:text-surface-50"> </p></div></div>',
		2
	),
	Hi = K('<label class="absolute left-2 top-2 z-10"><input type="checkbox" class="checkbox"/></label>'),
	Bi = K('<img class="max-h-full max-w-full rounded-md object-contain" loading="lazy"/>'),
	Vi = K('<tr><td class="uppercase"> </td><td> </td></tr>'),
	Ki = K(
		'<div class="w-full text-left"><h4 class="mb-2 text-sm font-semibold">Thumbnail Sizes</h4> <table class="table w-full text-xs"><thead><tr><th class="text-left">Size</th><th class="text-left">Dimensions</th></tr></thead><tbody></tbody></table></div>'
	),
	Ji = K(
		'<div role="listitem"><!> <div class="relative z-10 flex w-full items-center bg-surface-700/90 backdrop-blur-sm"><button class="btn-sm m-1 p-1 hover:bg-surface-600" type="button"><iconify-icon></iconify-icon></button> <p class="flex-1 truncate pr-2 text-center text-sm text-white"> </p></div> <button class="flex flex-1 items-center justify-center p-4 transition-transform hover:scale-[1.02] focus:scale-[1.02] focus:outline-2 focus:outline-primary-500" type="button"><!></button></div>',
		2
	),
	qi = K('<div role="list" aria-label="Media files"></div>'),
	Zi = K(
		'<div class="flex h-full flex-col gap-4" role="region" aria-label="Media gallery"><div class="flex flex-wrap items-center gap-2"><label for="media-search" class="font-bold text-tertiary-500 dark:text-primary-500">Media <!></label> <input type="search" placeholder="Search files..." class="input flex-1" id="media-search" aria-label="Search media files"/> <div class="flex gap-1 rounded-lg border border-surface-300 p-1 dark:border-surface-600" role="group" aria-label="View mode"><button aria-label="Grid view"><iconify-icon></iconify-icon></button> <button aria-label="List view"><iconify-icon></iconify-icon></button></div> <button class="preset-outlined-primary-500 btn-sm" aria-label="Refresh media"><iconify-icon></iconify-icon></button> <select class="input w-auto" aria-label="Sort by"><option>Sort by Name</option><option>Sort by Date</option><option>Sort by Size</option></select> <button class="btn-icon btn-icon-sm preset-outlined-surface-500"><iconify-icon></iconify-icon></button></div> <!> <!></div>',
		2
	);
function Qi(y, e) {
	pt(e, !0);
	const i = dt(e, 'onselect', 3, () => {}),
		s = dt(e, 'multiple', 3, !1),
		r = dt(e, 'viewMode', 3, 'grid'),
		l = ['sm', 'md', 'lg'],
		u = 300;
	let a = Y(Ht([])),
		b = Y(''),
		R = Y(!0),
		k = Y(null),
		g = Y(Ht(new Set())),
		_ = Y(Ht(new Set())),
		T = Y('grid'),
		I = Y('name'),
		v = Y(!0),
		S = null,
		x = Y(!1);
	wt(() => {
		f(T, r());
	});
	const c = yt(() => {
			let j = t(a);
			if (t(b).trim()) {
				const tt = t(b).toLowerCase();
				j = j.filter((it) => it.filename.toLowerCase().includes(tt));
			}
			return (
				(j = [...j].sort((tt, it) => {
					let mt = 0;
					switch (t(I)) {
						case 'name':
							mt = tt.filename.localeCompare(it.filename);
							break;
						case 'date':
							mt = 0;
							break;
						case 'size':
							mt = 0;
							break;
					}
					return t(v) ? mt : -mt;
				})),
				j
			);
		}),
		C = yt(() => t(c).length > 0),
		F = yt(() => t(_).size);
	function A(j) {
		return t(g).has(j);
	}
	function L(j, tt) {
		(j.stopPropagation(), j.preventDefault());
		const it = new Set(t(g));
		(it.has(tt) ? it.delete(tt) : it.add(tt), f(g, it, !0));
	}
	function m(j) {
		return t(_).has(j);
	}
	function M(j, tt) {
		tt?.stopPropagation();
		const it = new Set(t(_));
		s() ? (it.has(j.filename) ? it.delete(j.filename) : it.add(j.filename), f(_, it, !0)) : (f(_, new Set([j.filename]), !0), G(j));
	}
	async function O() {
		(f(R, !0), f(k, null));
		try {
			const j = await Fi.get('/media/getAll');
			(f(a, j.data, !0), f(g, new Set(), !0), f(_, new Set(), !0));
		} catch (j) {
			(f(k, j instanceof Error ? j.message : 'Failed to load media', !0), Tt.error('Error fetching media:', j));
		} finally {
			f(R, !1);
		}
	}
	function G(j) {
		if (s()) {
			const tt = t(a).filter((it) => t(_).has(it.filename));
			i()(tt);
		} else i()(j);
	}
	function z() {
		const j = t(a).filter((tt) => t(_).has(tt.filename));
		i()(j);
	}
	function J() {
		f(_, new Set(), !0);
	}
	function lt(j, tt) {
		(j.key === 'Enter' || j.key === ' ') && (j.preventDefault(), M(tt));
	}
	function et(j, tt = 'sm') {
		return j.thumbnails?.[tt]?.url || '';
	}
	function $(j, tt) {
		const it = j.thumbnails?.[tt];
		return it ? `${it.width}Ã—${it.height}` : 'N/A';
	}
	function P() {
		(S && clearTimeout(S), (S = setTimeout(() => {}, u)));
	}
	(Ve(() => {
		const j = window.matchMedia('(prefers-reduced-motion: reduce)');
		f(x, j.matches, !0);
		const tt = (it) => {
			f(x, it.matches, !0);
		};
		return (j.addEventListener('change', tt), O(), () => j.removeEventListener('change', tt));
	}),
		Ke(() => {
			S && clearTimeout(S);
		}));
	var V = Zi(),
		q = o(V),
		p = o(q),
		N = h(o(p));
	{
		var D = (j) => {
			var tt = Wi(),
				it = o(tt);
			(n(tt), Z(() => Q(it, `(${t(c).length ?? ''})`)), X(j, tt));
		};
		rt(N, (j) => {
			t(C) && j(D);
		});
	}
	n(p);
	var E = h(p, 2);
	(Zt(E), (E.__input = P));
	var U = h(E, 2),
		H = o(U);
	H.__click = () => f(T, 'grid');
	var at = o(H);
	(w(at, 'icon', 'mdi:view-grid'), w(at, 'width', '18'), n(H));
	var B = h(H, 2);
	B.__click = () => f(T, 'list');
	var ut = o(B);
	(w(ut, 'icon', 'mdi:view-list'), w(ut, 'width', '18'), n(B), n(U));
	var st = h(U, 2);
	st.__click = O;
	var ot = o(st);
	(w(ot, 'icon', 'mdi:refresh'), w(ot, 'width', '20'), n(st));
	var ct = h(st, 2),
		ft = o(ct);
	ft.value = ft.__value = 'name';
	var kt = h(ft);
	kt.value = kt.__value = 'date';
	var Gt = h(kt);
	((Gt.value = Gt.__value = 'size'), n(ct));
	var jt = h(ct, 2);
	jt.__click = () => f(v, !t(v));
	var Qt = o(jt);
	(Z(() => w(Qt, 'icon', t(v) ? 'mdi:sort-ascending' : 'mdi:sort-descending')), w(Qt, 'width', '20'), n(jt), n(q));
	var Bt = h(q, 2);
	{
		var Vt = (j) => {
			var tt = Ui(),
				it = o(tt),
				mt = o(it);
			n(it);
			var Dt = h(it, 2),
				Ft = o(Dt);
			Ft.__click = J;
			var St = h(Ft, 2);
			((St.__click = z),
				n(Dt),
				n(tt),
				Z(() => Q(mt, `${t(F) ?? ''} file${t(F) !== 1 ? 's' : ''} selected`)),
				qt(
					3,
					tt,
					() => te,
					() => ({ duration: t(x) ? 0 : 200 })
				),
				X(j, tt));
		};
		rt(Bt, (j) => {
			s() && t(F) > 0 && j(Vt);
		});
	}
	var Xt = h(Bt, 2);
	{
		var Lt = (j) => {
				var tt = ji();
				(qt(
					3,
					tt,
					() => te,
					() => ({ duration: t(x) ? 0 : 200 })
				),
					X(j, tt));
			},
			ee = (j) => {
				var tt = Ut(),
					it = Rt(tt);
				{
					var mt = (Ft) => {
							var St = Xi(),
								Ct = o(St),
								_t = o(Ct);
							(w(_t, 'icon', 'mdi:alert-circle'), w(_t, 'width', '48'), nt(_t, 1, 'text-error-500'));
							var Mt = h(_t, 2),
								Nt = o(Mt);
							n(Mt);
							var Et = h(Mt, 2);
							((Et.__click = O),
								n(Ct),
								n(St),
								Z(() => Q(Nt, `Error: ${t(k) ?? ''}`)),
								qt(
									3,
									St,
									() => te,
									() => ({ duration: t(x) ? 0 : 200 })
								),
								X(Ft, St));
						},
						Dt = (Ft) => {
							var St = Ut(),
								Ct = Rt(St);
							{
								var _t = (Nt) => {
										var Et = Yi(),
											zt = o(Et),
											gt = o(zt);
										(w(gt, 'icon', 'mdi:image-off'), w(gt, 'width', '48'), nt(gt, 1, 'text-surface-400'));
										var Pt = h(gt, 2),
											Jt = o(Pt, !0);
										(n(Pt),
											n(zt),
											n(Et),
											Z((Ot) => Q(Jt, Ot), [() => (t(b) ? `No media found for "${t(b)}"` : gi())]),
											qt(
												3,
												Et,
												() => te,
												() => ({ duration: t(x) ? 0 : 200 })
											),
											X(Nt, Et));
									},
									Mt = (Nt) => {
										var Et = qi();
										(de(
											Et,
											23,
											() => t(c),
											(zt) => zt.filename,
											(zt, gt, Pt) => {
												const Jt = yt(() => m(t(gt).filename));
												var Ot = Ji(),
													fe = o(Ot);
												{
													var ve = (xt) => {
														var It = Hi(),
															Yt = o(It);
														(Zt(Yt),
															(Yt.__change = (he) => M(t(gt), he)),
															n(It),
															Z(() => {
																(fi(Yt, t(Jt)), bt(Yt, 'aria-label', `Select ${t(gt).filename}`));
															}),
															X(xt, It));
													};
													rt(fe, (xt) => {
														s() && xt(ve);
													});
												}
												var ie = h(fe, 2),
													Kt = o(ie);
												Kt.__click = (xt) => L(xt, t(Pt));
												var ae = o(Kt);
												(Z(() => w(ae, 'icon', A(t(Pt)) ? 'mdi:information-off' : 'mdi:information')),
													w(ae, 'width', '20'),
													nt(ae, 1, 'text-primary-500'),
													n(Kt));
												var ne = h(Kt, 2),
													Qe = o(ne, !0);
												(n(ne), n(ie));
												var oe = h(ie, 2);
												((oe.__click = () => M(t(gt))), (oe.__keydown = (xt) => lt(xt, t(gt))));
												var $e = o(oe);
												{
													var ti = (xt) => {
															var It = Bi();
															(Z(
																(Yt) => {
																	(bt(It, 'src', Yt), bt(It, 'alt', t(gt).filename));
																},
																[() => et(t(gt), t(T) === 'list' ? 'sm' : 'md')]
															),
																X(xt, It));
														},
														ei = (xt) => {
															var It = Ki(),
																Yt = h(o(It), 2),
																he = h(o(Yt));
															(de(
																he,
																20,
																() => l,
																(me) => me,
																(me, ge) => {
																	var Te = Ut(),
																		ii = Rt(Te);
																	{
																		var ai = (be) => {
																			var ye = Vi(),
																				_e = o(ye),
																				ni = o(_e, !0);
																			n(_e);
																			var Re = h(_e),
																				oi = o(Re, !0);
																			(n(Re),
																				n(ye),
																				Z(
																					(ri) => {
																						(Q(ni, ge), Q(oi, ri));
																					},
																					[() => $(t(gt), ge)]
																				),
																				X(be, ye));
																		};
																		rt(ii, (be) => {
																			t(gt).thumbnails?.[ge] && be(ai);
																		});
																	}
																	X(me, Te);
																}
															),
																n(he),
																n(Yt),
																n(It),
																X(xt, It));
														};
													rt($e, (xt) => {
														A(t(Pt)) ? xt(ei, !1) : xt(ti);
													});
												}
												(n(oe),
													n(Ot),
													Z(
														(xt, It) => {
															(nt(
																Ot,
																1,
																`group card relative flex ${t(T) === 'list' ? 'flex-row items-center' : 'flex-col'} overflow-hidden transition-all duration-200 ${t(Jt) ? 'ring-4 ring-primary-500' : ''}`
															),
																bt(Kt, 'aria-label', xt),
																bt(Kt, 'aria-pressed', It),
																bt(ne, 'title', t(gt).filename),
																Q(Qe, t(gt).filename),
																bt(oe, 'aria-label', `${t(Jt) ? 'Deselect' : 'Select'} ${t(gt).filename}`));
														},
														[() => `${A(t(Pt)) ? 'Hide' : 'Show'} info for ${t(gt).filename}`, () => A(t(Pt))]
													),
													qt(
														3,
														Ot,
														() => Ai,
														() => ({ duration: t(x) ? 0 : 200, start: 0.95 })
													),
													X(zt, Ot));
											}
										),
											n(Et),
											Z(() =>
												nt(
													Et,
													1,
													`flex-1 overflow-auto ${t(T) === 'grid' ? 'grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4' : 'flex flex-col gap-2'}`
												)
											),
											X(Nt, Et));
									};
								rt(
									Ct,
									(Nt) => {
										t(C) ? Nt(Mt, !1) : Nt(_t);
									},
									!0
								);
							}
							X(Ft, St);
						};
					rt(
						it,
						(Ft) => {
							t(k) ? Ft(mt) : Ft(Dt, !1);
						},
						!0
					);
				}
				X(j, tt);
			};
		rt(Xt, (j) => {
			t(R) ? j(Lt) : j(ee, !1);
		});
	}
	(n(V),
		Z(() => {
			((E.disabled = t(R)),
				nt(H, 1, `btn-icon btn-icon-sm ${t(T) === 'grid' ? 'preset-filled-primary-500' : 'preset-outlined-surface-500'}`),
				bt(H, 'aria-pressed', t(T) === 'grid'),
				nt(B, 1, `btn-icon btn-icon-sm ${t(T) === 'list' ? 'preset-filled-primary-500' : 'preset-outlined-surface-500'}`),
				bt(B, 'aria-pressed', t(T) === 'list'),
				(st.disabled = t(R)),
				nt(ot, 1, pe(t(R) && !t(x) ? 'animate-spin' : '')),
				(ct.disabled = t(R)),
				bt(jt, 'aria-label', t(v) ? 'Sort descending' : 'Sort ascending'));
		}),
		Di(
			E,
			() => t(b),
			(j) => f(b, j)
		),
		ui(
			ct,
			() => t(I),
			(j) => f(I, j)
		),
		X(y, V),
		vt());
}
At(['input', 'click', 'change', 'keydown']);
var $i = K('<p class="font-bold"><span class="text-tertiary-500 dark:text-primary-500"> </span> </p>'),
	ta = K('<p class="font-bold"><span class="text-tertiary-500 dark:text-primary-500"> </span> </p>'),
	ea = K(
		'<div class="bg-surface-100-800-token fixed left-[50%] top-[50%] z-999999999 flex h-[90%] w-[95%] translate-x-[-50%] translate-y-[-50%] flex-col rounded border border-surface-400 p-2"><div class="bg-surface-100-800-token flex items-center justify-between border-b p-2"><p class="ml-auto font-bold text-black dark:text-primary-500"> </p> <button aria-label="Close" class="preset-outlined-secondary-500 btn-icon ml-auto"><iconify-icon></iconify-icon></button></div> <!></div>',
		2
	),
	ia = K(
		'<div role="cell" tabindex="0"><div class="grid grid-cols-6 items-center p-4"><iconify-icon></iconify-icon> <span class="text-white">test</span> <div class="col-span-5"><!> <p class="text-sm opacity-75"> </p> <div class="flex w-full justify-center gap-2"><button class="preset-filled-tertiary-500 btn mt-3 dark:preset-filled-primary-500"> </button> <button class="preset-filled-tertiary-500 btn mt-3 dark:preset-filled-primary-500"> </button></div></div></div> <input type="file" accept="image/*,image/webp,image/avif,image/svg+xml" hidden=""/></div> <!>',
		3
	);
function aa(y, e) {
	pt(e, !0);
	let i = dt(e, 'value', 15),
		s = dt(e, 'multiple', 11, !1),
		r = dt(e, 'show', 15, !0),
		l = dt(e, 'className', 3, ''),
		u = Y(null),
		a = Y(!1);
	function b(c) {
		(r(!1), f(a, !1));
		const C = Array.isArray(c) ? c[0] : c;
		C && (i(C), e.onChange?.(C));
	}
	function R() {
		if (!t(u)?.files || t(u).files.length === 0) return;
		const c = t(u).files[0];
		(i(c), r(!1), e.onChange?.(c));
	}
	function k(c) {
		c.preventDefault();
		const C = c?.dataTransfer?.files[0];
		C && (i(C), e.onChange?.(C));
	}
	function g(c) {
		c.preventDefault();
		const C = c.target;
		C.style.borderColor = '#6bdfff';
	}
	function _(c) {
		(c.preventDefault(), c.target.style.removeProperty('border-color'));
	}
	function T() {
		t(u)?.click();
	}
	function I(c) {
		f(a, c, !0);
	}
	var v = Ut(),
		S = Rt(v);
	{
		var x = (c) => {
			var C = ia(),
				F = Rt(C),
				A = o(F),
				L = o(A);
			(w(L, 'icon', 'fa6-solid:file-arrow-up'), w(L, 'width', '40'));
			var m = h(L, 4),
				M = o(m);
			{
				var O = (D) => {
						var E = $i(),
							U = o(E),
							H = o(U, !0);
						n(U);
						var at = h(U);
						(n(E),
							Z(
								(B, ut) => {
									(Q(H, B), Q(at, ` ${ut ?? ''}`));
								},
								[() => yi(), () => Ee()]
							),
							X(D, E));
					},
					G = (D) => {
						var E = ta(),
							U = o(E),
							H = o(U, !0);
						n(U);
						var at = h(U);
						(n(E),
							Z(
								(B, ut) => {
									(Q(H, B), Q(at, ` ${ut ?? ''}`));
								},
								[() => _i(), () => Ee()]
							),
							X(D, E));
					};
				rt(M, (D) => {
					r() ? D(G, !1) : D(O);
				});
			}
			var z = h(M, 2),
				J = o(z);
			n(z);
			var lt = h(z, 2),
				et = o(lt);
			et.__click = T;
			var $ = o(et, !0);
			n(et);
			var P = h(et, 2);
			P.__click = () => I(!0);
			var V = o(P, !0);
			(n(P), n(lt), n(m), n(A));
			var q = h(A, 2);
			((q.__change = R),
				ue(
					q,
					(D) => f(u, D),
					() => t(u)
				),
				n(F));
			var p = h(F, 2);
			{
				var N = (D) => {
					var E = ea(),
						U = o(E),
						H = o(U),
						at = o(H, !0);
					n(H);
					var B = h(H, 2);
					B.__click = () => I(!1);
					var ut = o(B);
					(w(ut, 'icon', 'material-symbols:close'), w(ut, 'width', '24'), nt(ut, 1, 'text-tertiary-500 dark:text-primary-500'), n(B), n(U));
					var st = h(U, 2);
					(Qi(st, { onselect: b }), n(E), Z((ot) => Q(at, ot), [() => xi()]), X(D, E));
				};
				rt(p, (D) => {
					t(a) && D(N);
				});
			}
			(Z(
				(D, E, U, H, at, B) => {
					(nt(F, 1, D), Q(J, `${E ?? ''}.`), bt(et, 'aria-label', U), Q($, H), bt(P, 'aria-label', at), Q(V, B), (q.multiple = s()));
				},
				[
					() =>
						pe(
							Ri(
								'relative mt-2 flex h-[200px] w-full max-w-full select-none flex-col items-center justify-center gap-4 rounded border-2 border-dashed border-surface-600 bg-surface-200 dark:border-surface-500 dark:bg-surface-700',
								l()
							)
						),
					() => bi(),
					() => De(),
					() => De(),
					() => Fe(),
					() => Fe()
				]
			),
				xe('drop', F, k),
				xe('dragover', F, g),
				xe('dragleave', F, _),
				X(c, C));
		};
		rt(S, (c) => {
			r() && c(x);
		});
	}
	(X(y, v), vt());
}
At(['click', 'change']);
var na = K(
	'<div class="flex w-full items-center gap-4"><div class="btn-group preset-outlined-surface-500"><button title="Add Text"><iconify-icon></iconify-icon></button> <button title="Draw Arrow"><iconify-icon></iconify-icon></button> <button title="Draw Rectangle"><iconify-icon></iconify-icon></button> <button title="Draw Circle"><iconify-icon></iconify-icon></button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <label class="flex items-center gap-2 text-sm" title="Stroke Color"><iconify-icon></iconify-icon> <input type="color" class="input-color svelte-x4y8sh"/></label> <label class="flex items-center gap-2 text-sm" title="Fill Color"><iconify-icon></iconify-icon> <input type="color" class="input-color svelte-x4y8sh"/></label> <div class="grow"></div> <button class="btn preset-outlined-error-500"><iconify-icon></iconify-icon> <span>Delete</span></button> <button class="btn preset-filled-success-500"><iconify-icon></iconify-icon> <span>Done</span></button></div>',
	2
);
function Le(y, e) {
	pt(e, !0);
	var i = na(),
		s = o(i),
		r = o(s);
	let l;
	r.__click = () => e.onSetTool(e.currentTool === 'text' ? null : 'text');
	var u = o(r);
	(w(u, 'icon', 'mdi:format-text'), n(r));
	var a = h(r, 2);
	let b;
	a.__click = () => e.onSetTool(e.currentTool === 'arrow' ? null : 'arrow');
	var R = o(a);
	(w(R, 'icon', 'mdi:arrow-top-right'), n(a));
	var k = h(a, 2);
	let g;
	k.__click = () => e.onSetTool(e.currentTool === 'rectangle' ? null : 'rectangle');
	var _ = o(k);
	(w(_, 'icon', 'mdi:rectangle-outline'), n(k));
	var T = h(k, 2);
	let I;
	T.__click = () => e.onSetTool(e.currentTool === 'circle' ? null : 'circle');
	var v = o(T);
	(w(v, 'icon', 'mdi:circle-outline'), n(T), n(s));
	var S = h(s, 4),
		x = o(S);
	w(x, 'icon', 'mdi:water-opacity');
	var c = h(x, 2);
	(Zt(c), (c.__input = (G) => e.onStrokeColorChange(G.currentTarget.value)), n(S));
	var C = h(S, 2),
		F = o(C);
	w(F, 'icon', 'mdi:format-color-fill');
	var A = h(F, 2);
	(Zt(A), (A.__input = (G) => e.onFillColorChange(G.currentTarget.value)), n(C));
	var L = h(C, 4);
	L.__click = function (...G) {
		e.onDelete?.apply(this, G);
	};
	var m = o(L);
	(w(m, 'icon', 'mdi:delete-outline'), ht(2), n(L));
	var M = h(L, 2);
	M.__click = function (...G) {
		e.onApply?.apply(this, G);
	};
	var O = o(M);
	(w(O, 'icon', 'mdi:check'),
		ht(2),
		n(M),
		n(i),
		Z(() => {
			((l = nt(r, 1, 'btn-sm', null, l, { active: e.currentTool === 'text' })),
				(b = nt(a, 1, 'btn-sm', null, b, { active: e.currentTool === 'arrow' })),
				(g = nt(k, 1, 'btn-sm', null, g, { active: e.currentTool === 'rectangle' })),
				(I = nt(T, 1, 'btn-sm', null, I, { active: e.currentTool === 'circle' })),
				le(c, e.strokeColor),
				le(A, e.fillColor));
		}),
		X(y, i),
		vt());
}
At(['click', 'input']);
class oa {
	id;
	node;
	layer;
	kind;
	_onSelect = null;
	_onDestroy = null;
	constructor(e, i, s, r) {
		((this.id = e),
			(this.node = i),
			(this.layer = s),
			(this.kind = r),
			this.node.on('click tap', (l) => {
				((l.cancelBubble = !0), this._onSelect?.());
			}));
	}
	enableInteraction() {
		this.node.draggable(!0);
	}
	disableInteraction() {
		this.node.draggable(!1);
	}
	on(e, i) {
		this.node.on(e, i);
	}
	off(e) {
		this.node.off(e);
	}
	destroy() {
		try {
			this.node.destroy();
		} catch {}
		this._onDestroy?.();
	}
	onSelect(e) {
		this._onSelect = e;
	}
	onDestroy(e) {
		this._onDestroy = e;
	}
}
function ra(y, e, i, s = 'Text', r = 20, l = '#000') {
	const u = new W.Text({ x: e, y: i, text: s, fontSize: r, fontFamily: 'Arial', fill: l, draggable: !0, name: 'annotation-text' });
	return (y.add(u), u);
}
function sa(y, e, i, s = 0, r = 0, l = '#f00', u = 'transparent', a = 2) {
	const b = new W.Rect({ x: e, y: i, width: s, height: r, stroke: l, fill: u, strokeWidth: a, draggable: !0, name: 'annotation-rect' });
	return (y.add(b), b);
}
function ca(y, e, i, s = 0, r = '#f00', l = 'transparent', u = 2) {
	const a = new W.Circle({ x: e, y: i, radius: s, stroke: r, fill: l, strokeWidth: u, draggable: !0, name: 'annotation-circle' });
	return (y.add(a), a);
}
function la(y, e, i = '#f00', s = 2) {
	const r = new W.Line({ points: e, stroke: i, strokeWidth: s, lineCap: 'round', lineJoin: 'round', name: 'annotation-line', draggable: !1 });
	return (y.add(r), r);
}
function da(y, e, i = '#f00', s = 2) {
	const r = new W.Arrow({
		points: e,
		stroke: i,
		fill: i,
		strokeWidth: s,
		pointerLength: 10,
		pointerWidth: 8,
		name: 'annotation-arrow',
		draggable: !1
	});
	return (y.add(r), r);
}
const qe = {
		anchorFill: '#3b82f6',
		anchorStroke: '#ffffff',
		anchorStrokeWidth: 2,
		anchorSize: 12,
		anchorCornerRadius: 6,
		borderStroke: '#3b82f6',
		borderStrokeWidth: 2,
		borderDash: []
	},
	ua = {
		...qe,
		anchorFill: '#3b82f6',
		anchorStroke: '#ffffff',
		anchorSize: 14,
		anchorCornerRadius: 7,
		borderStroke: '#ffffff',
		borderStrokeWidth: 1.5
	},
	fa = qe,
	Me = { stroke: 'rgba(255, 255, 255, 0.4)', strokeWidth: 1, listening: !1 },
	ha = {
		keepRatio: !0,
		rotateEnabled: !0,
		rotationSnaps: [0, 90, 180, 270],
		rotateAnchorOffset: 40,
		enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right'],
		boundBoxFunc: (y, e) => (e.width < 20 || e.height < 20 ? y : e)
	};
function Ze(y, e) {
	const i = new W.Transformer({ ...fa, ...ha, ...e });
	return (y.add(i), i.moveToTop(), i);
}
function ce(y, e) {
	try {
		if (!e) {
			(y.nodes([]), y.hide());
			return;
		}
		(y.nodes([e]), y.show(), y.forceUpdate(), y.moveToTop());
	} catch {
		try {
			(y.nodes([]), y.hide());
		} catch {}
	}
}
function pa(y) {
	return Ze(y, { keepRatio: !1, enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right', 'middle-left', 'middle-right'] });
}
const ze = ce;
function va(y, e, i) {
	const s = y.container().getBoundingClientRect(),
		r = e.absolutePosition(),
		l = window.scrollX,
		u = window.scrollY,
		a = document.createElement('textarea');
	(document.body.appendChild(a),
		(a.value = e.text()),
		(a.style.position = 'absolute'),
		(a.style.top = `${s.top + r.y + u}px`),
		(a.style.left = `${s.left + r.x + l}px`),
		(a.style.width = `${e.width()}px`),
		(a.style.height = `${e.height() + 10}px`),
		(a.style.fontSize = `${e.fontSize()}px`),
		(a.style.fontFamily = String(e.fontFamily()) || 'Arial'),
		(a.style.color = String(e.fill()) || '#000'),
		(a.style.lineHeight = String(e.lineHeight())),
		(a.style.padding = e.padding() + 'px'),
		(a.style.background = 'white'),
		(a.style.border = '1px solid #0066ff'),
		(a.style.boxShadow = '0 0 5px rgba(0,0,0,0.2)'),
		(a.style.margin = '0'),
		(a.style.resize = 'none'),
		(a.style.overflow = 'hidden'),
		(a.style.zIndex = '10000'),
		a.focus(),
		a.select());
	function b() {
		(i(a.value), document.body.removeChild(a), window.removeEventListener('keydown', R), a.removeEventListener('blur', b));
	}
	function R(k) {
		(k.key === 'Escape' && b(), k.key === 'Enter' && !k.shiftKey && b());
	}
	(window.addEventListener('keydown', R), a.addEventListener('blur', b));
}
const ma = 'annotate';
function Wt(y) {
	return [`${y}.${ma}`, `${y}.annotate`].join(' ');
}
function ga(y, e) {
	pt(e, !0);
	let i = Y(null),
		s = Y(Ht([])),
		r = Y(null),
		l = Y(null),
		u = Y('#ff0000'),
		a = Y('transparent'),
		b = 2,
		R = 20,
		k = Y(!1),
		g = Y(null),
		_ = Y(null),
		T = Y(!1);
	wt(() => {
		d.state.activeState === 'annotate'
			? (I(),
				d.setToolbarControls({
					component: Le,
					props: {
						currentTool: t(l),
						strokeColor: t(u),
						fillColor: t(a),
						onSetTool: (V) => {
							(f(l, V, !0), M());
						},
						onStrokeColorChange: (V) => {
							(f(u, V, !0), t(r)?.node.setAttrs({ stroke: V }));
						},
						onFillColorChange: (V) => {
							(f(a, V, !0), t(r)?.node.setAttrs({ fill: V }));
						},
						onDelete: () => O(),
						onApply: () => z()
					}
				}))
			: (v(), d.state.toolbarControls?.component === Le && d.setToolbarControls(null));
	});
	function I() {
		const { stage: P, layer: V } = d.state;
		!P ||
			!V ||
			t(T) ||
			(f(T, !0),
			t(i) || f(i, pa(V), !0),
			P.on(Wt('mousedown'), S),
			P.on(Wt('mousemove'), x),
			P.on(Wt('mouseup'), c),
			P.on(Wt('click'), C),
			P.on(Wt('dblclick'), F),
			(P.container().style.cursor = 'crosshair'));
	}
	function v() {
		const { stage: P } = d.state;
		!P ||
			!t(T) ||
			(f(T, !1),
			P.off(Wt('mousedown')),
			P.off(Wt('mousemove')),
			P.off(Wt('mouseup')),
			P.off(Wt('click')),
			P.off(Wt('dblclick')),
			P.container() && (P.container().style.cursor = 'default'),
			M(),
			f(l, null),
			f(k, !1),
			f(g, null));
	}
	function S(P) {
		if (P.target !== P.target.getStage()) return;
		const { stage: V, layer: q } = d.state;
		if (!V || !q) return;
		const p = V.getPointerPosition();
		if (p && t(l))
			switch ((M(), f(k, !0), f(_, p, !0), t(l))) {
				case 'text': {
					const N = ra(q, p.x, p.y, 'Text', R, t(u)),
						D = A(N, 'text');
					(m(D), f(k, !1), f(l, null), L(D.node));
					break;
				}
				case 'rect':
					f(g, sa(q, p.x, p.y, 0, 0, t(u), t(a), b), !0);
					break;
				case 'circle':
					f(g, ca(q, p.x, p.y, 0, t(u), t(a), b), !0);
					break;
				case 'line':
					f(g, la(q, [p.x, p.y, p.x, p.y], t(u), b), !0);
					break;
				case 'arrow':
					f(g, da(q, [p.x, p.y, p.x, p.y], t(u), b), !0);
					break;
			}
	}
	function x() {
		if (!t(k) || !t(g) || !t(_)) return;
		const { stage: P, layer: V } = d.state;
		if (!P || !V) return;
		const q = P.getPointerPosition();
		if (q) {
			if (t(g) instanceof W.Rect) (t(g).width(q.x - t(_).x), t(g).height(q.y - t(_).y));
			else if (t(g) instanceof W.Circle) {
				const p = Math.hypot(q.x - t(_).x, q.y - t(_).y);
				t(g).radius(p);
			} else (t(g) instanceof W.Line || t(g) instanceof W.Arrow) && t(g).points([t(_).x, t(_).y, q.x, q.y]);
			V.batchDraw();
		}
	}
	function c() {
		if (!t(k) || !t(g) || !t(l)) return;
		f(k, !1);
		const P = A(t(g), t(l));
		(m(P), f(g, null), f(l, null), f(_, null), d.state.layer?.batchDraw());
	}
	function C(P) {
		t(k) || t(l) || (P.target === P.target.getStage() && M());
	}
	function F(P) {
		const V = P.target;
		if (V instanceof W.Text) {
			const q = t(s).find((p) => p.node === V);
			q && (m(q), L(q.node));
		}
	}
	function A(P, V) {
		const { layer: q } = d.state;
		if (!q) throw new Error('No layer');
		(P.name(`annotation-${V}`), P.draggable(!0));
		const p = new oa(crypto.randomUUID(), P, q, V);
		return (p.onSelect(() => m(p)), f(s, [...t(s), p], !0), p);
	}
	function L(P) {
		const { stage: V } = d.state;
		V &&
			(P.hide(),
			t(i)?.hide(),
			va(V, P, (q) => {
				(P.text(q), P.show(), t(i)?.show(), t(i)?.forceUpdate(), d.state.layer?.batchDraw());
			}));
	}
	function m(P) {
		(f(r, P, !0), t(i) && ze(t(i), P.node));
	}
	function M() {
		(f(r, null), t(i) && ze(t(i), null));
	}
	function O() {
		if (!t(r)) return;
		const P = t(r).id;
		(t(r).destroy(),
			f(
				s,
				t(s).filter((V) => V.id !== P),
				!0
			),
			f(r, null),
			M());
	}
	function G(P = !0) {
		(M(),
			f(k, !1),
			f(l, null),
			f(g, null),
			P ? ([...t(s)].forEach((V) => V.destroy()), f(s, [], !0)) : t(s).forEach((V) => V.disableInteraction()),
			d.state.layer?.batchDraw());
	}
	function z() {
		(d.takeSnapshot(), d.setActiveState(''));
	}
	function J() {
		try {
			(v(), G(!0), t(i)?.destroy(), f(i, null));
		} catch {}
	}
	function lt() {}
	function et() {
		J();
	}
	var $ = { cleanup: J, saveState: lt, beforeExit: et };
	return vt($);
}
const ba = { key: 'annotate', title: 'Annotate', icon: 'mdi:draw', tool: ga },
	ya = Object.freeze(Object.defineProperty({ __proto__: null, default: ba }, Symbol.toStringTag, { value: 'Module' }));
var _a = K(
	'<div class="flex w-full items-center gap-3"><button class="btn btn-sm preset-filled-primary-500" title="Add Blur Region"><iconify-icon></iconify-icon> <span class="hidden sm:inline">Add</span></button> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <span class="hidden text-sm sm:inline">Shape:</span> <div class="btn-group preset-outlined-surface-500"><button title="Rectangle"><iconify-icon></iconify-icon></button> <button title="Ellipse"><iconify-icon></iconify-icon></button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <span class="hidden text-sm sm:inline">Pattern:</span> <div class="btn-group preset-outlined-surface-500"><button title="Blur"><iconify-icon></iconify-icon></button> <button title="Pixelate"><iconify-icon></iconify-icon></button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <label class="flex items-center gap-2 text-sm"><span class="hidden sm:inline"> </span> <input type="range" min="5" step="1" class="range range-primary w-24"/> <span class="w-6 text-right text-xs"> </span></label> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <div class="btn-group preset-outlined-surface-500"><button class="btn btn-icon btn-sm" title="Rotate Region Left"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm" title="Rotate Region Right"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm" title="Flip Region"><iconify-icon></iconify-icon></button></div> <button class="btn btn-sm preset-outlined-error-500" title="Delete Selected Region"><iconify-icon></iconify-icon></button> <div class="grow"></div> <button class="btn btn-sm preset-outlined-surface-500"><iconify-icon></iconify-icon> <span class="hidden sm:inline">Reset</span></button> <button class="btn btn-sm preset-outlined-error-500"><iconify-icon></iconify-icon> <span class="hidden sm:inline">Cancel</span></button> <button class="btn btn-sm preset-filled-success-500"><iconify-icon></iconify-icon> <span class="hidden sm:inline">Apply</span></button></div>',
	2
);
function Oe(y, e) {
	pt(e, !0);
	let i = dt(e, 'hasActiveRegion', 3, !1);
	function s(B) {
		const ut = B.currentTarget;
		e.onStrengthChange(parseInt(ut.value, 10));
	}
	var r = _a(),
		l = o(r);
	l.__click = function (...B) {
		e.onAddRegion?.apply(this, B);
	};
	var u = o(l);
	(w(u, 'icon', 'mdi:plus'), ht(2), n(l));
	var a = h(l, 6),
		b = o(a);
	let R;
	b.__click = () => e.onShapeChange('rectangle');
	var k = o(b);
	(w(k, 'icon', 'mdi:crop-square'), n(b));
	var g = h(b, 2);
	let _;
	g.__click = () => e.onShapeChange('ellipse');
	var T = o(g);
	(w(T, 'icon', 'mdi:circle-outline'), n(g), n(a));
	var I = h(a, 6),
		v = o(I);
	let S;
	v.__click = () => e.onPatternChange('blur');
	var x = o(v);
	(w(x, 'icon', 'mdi:blur'), n(v));
	var c = h(v, 2);
	let C;
	c.__click = () => e.onPatternChange('pixelate');
	var F = o(c);
	(w(F, 'icon', 'mdi:grid'), n(c), n(I));
	var A = h(I, 4),
		L = o(A),
		m = o(L, !0);
	n(L);
	var M = h(L, 2);
	(Zt(M), (M.__input = s));
	var O = h(M, 2),
		G = o(O, !0);
	(n(O), n(A));
	var z = h(A, 4),
		J = o(z);
	J.__click = function (...B) {
		e.onRotateLeft?.apply(this, B);
	};
	var lt = o(J);
	(w(lt, 'icon', 'mdi:rotate-left'), n(J));
	var et = h(J, 2);
	et.__click = function (...B) {
		e.onRotateRight?.apply(this, B);
	};
	var $ = o(et);
	(w($, 'icon', 'mdi:rotate-right'), n(et));
	var P = h(et, 2);
	P.__click = function (...B) {
		e.onFlipHorizontal?.apply(this, B);
	};
	var V = o(P);
	(w(V, 'icon', 'mdi:flip-horizontal'), n(P), n(z));
	var q = h(z, 2);
	q.__click = function (...B) {
		e.onDeleteRegion?.apply(this, B);
	};
	var p = o(q);
	(w(p, 'icon', 'mdi:delete'), n(q));
	var N = h(q, 4);
	N.__click = function (...B) {
		e.onReset?.apply(this, B);
	};
	var D = o(N);
	(w(D, 'icon', 'mdi:restore'), ht(2), n(N));
	var E = h(N, 2);
	E.__click = function (...B) {
		e.onCancel?.apply(this, B);
	};
	var U = o(E);
	(w(U, 'icon', 'mdi:close'), ht(2), n(E));
	var H = h(E, 2);
	H.__click = function (...B) {
		e.onApply?.apply(this, B);
	};
	var at = o(H);
	(w(at, 'icon', 'mdi:check'),
		ht(2),
		n(H),
		n(r),
		Z(() => {
			((R = nt(b, 1, 'btn-sm', null, R, { active: e.shape === 'rectangle' })),
				(_ = nt(g, 1, 'btn-sm', null, _, { active: e.shape === 'ellipse' })),
				(S = nt(v, 1, 'btn-sm', null, S, { active: e.pattern === 'blur' })),
				(C = nt(c, 1, 'btn-sm', null, C, { active: e.pattern === 'pixelate' })),
				Q(m, e.pattern === 'pixelate' ? 'Size:' : 'Strength:'),
				bt(M, 'max', e.pattern === 'pixelate' ? 50 : 100),
				le(M, e.blurStrength),
				Q(G, e.blurStrength),
				(J.disabled = !i()),
				(et.disabled = !i()),
				(P.disabled = !i()),
				(q.disabled = !i()));
		}),
		X(y, r),
		vt());
}
At(['click', 'input']);
class xa {
	id;
	shapeNode;
	overlay;
	overlayGroup;
	transformer;
	toolbar;
	layer;
	imageNode;
	imageGroup;
	currentPattern;
	currentStrength;
	_onSelect = null;
	_onDestroy = null;
	_onClone = null;
	_cacheTimer = null;
	constructor(e) {
		((this.id = e.id), (this.layer = e.layer), (this.imageNode = e.imageNode), (this.imageGroup = e.imageGroup));
		const i = e.init || {};
		((this.currentPattern = i.pattern || 'blur'), (this.currentStrength = i.strength || 20));
		const s = i.width ?? 160,
			r = i.height ?? 120,
			l = i.x ?? 0,
			u = i.y ?? 0;
		(i.shape === 'ellipse'
			? (this.shapeNode = new W.Ellipse({
					x: l,
					y: u,
					radiusX: s / 2,
					radiusY: r / 2,
					stroke: 'white',
					strokeWidth: 1.5,
					draggable: !0,
					name: 'blurShape'
				}))
			: (this.shapeNode = new W.Rect({
					x: l - s / 2,
					y: u - r / 2,
					width: s,
					height: r,
					stroke: 'white',
					strokeWidth: 1.5,
					fill: 'rgba(59, 130, 246, 0.2)',
					draggable: !0,
					name: 'blurShape'
				})),
			this.shapeNode.id(this.id),
			this.imageGroup.add(this.shapeNode),
			(this.overlay = new W.Image({
				image: this.imageNode.image(),
				listening: !1,
				name: 'blurOverlay',
				x: this.imageNode.x(),
				y: this.imageNode.y(),
				width: this.imageNode.width(),
				height: this.imageNode.height(),
				scaleX: this.imageNode.scaleX(),
				scaleY: this.imageNode.scaleY(),
				rotation: this.imageNode.rotation(),
				cornerRadius: this.imageNode.cornerRadius()
			})),
			(this.overlayGroup = new W.Group({ listening: !1 })),
			this.overlayGroup.add(this.overlay),
			this.overlay.filters([]),
			this.overlayGroup.clipFunc(this.makeClipFunc()),
			this.imageGroup.add(this.overlayGroup),
			this.imageNode.zIndex(0),
			this.overlayGroup.zIndex(1),
			this.shapeNode.zIndex(2),
			this.layer.batchDraw(),
			this.shapeNode.on('dragmove transform', () => {
				(this.updateToolbarPosition(), this.updateOverlayClip(), this.layer.batchDraw());
			}),
			this.setPattern(this.currentPattern),
			this.setStrength(this.currentStrength),
			this.shapeNode.on('click tap', (a) => {
				((a.cancelBubble = !0), this._onSelect?.());
			}));
	}
	updateToolbarPosition() {
		if (!this.toolbar) return;
		const e = this.shapeNode;
		let i = { x: 0, y: 0 };
		e instanceof W.Rect ? (i = { x: e.width() / 2, y: e.height() + 20 }) : (i = { x: 0, y: e.radiusY() + 20 });
		const s = e.getTransform().point(i);
		(this.toolbar.position(s), this.toolbar.rotation(e.rotation()), this.layer.batchDraw());
	}
	updateOverlayClip() {
		const e = this.shapeNode.getSelfRect(),
			i = this.currentStrength * 2,
			s = this.shapeNode.x() - this.overlay.x(),
			r = this.shapeNode.y() - this.overlay.y(),
			l = { x: s - i, y: r - i, width: e.width + i * 2, height: e.height + i * 2 };
		(this._cacheTimer && window.clearTimeout(this._cacheTimer),
			(this._cacheTimer = window.setTimeout(() => {
				try {
					(this.overlayGroup.clearCache(), this.overlayGroup.cache(l), this.layer.batchDraw());
				} catch {}
				this._cacheTimer = null;
			}, 0)),
			this.layer.batchDraw());
	}
	makeClipFunc() {
		const e = this.shapeNode;
		return (i) => {
			const r = e.getTransform().copy().m;
			(i.setTransform(r[0], r[1], r[2], r[3], r[4], r[5]),
				e instanceof W.Ellipse
					? (i.beginPath(), i.ellipse(0, 0, e.radiusX(), e.radiusY(), 0, 0, Math.PI * 2), i.closePath())
					: (i.beginPath(), i.rect(0, 0, e.width(), e.height()), i.closePath()));
		};
	}
	setPattern(e) {
		((this.currentPattern = e),
			this.overlay.filters([]),
			e === 'blur' ? this.overlay.filters([W.Filters.Blur]) : this.overlay.filters([W.Filters.Pixelate]),
			this.setStrength(this.currentStrength),
			this.updateOverlayClip());
	}
	setStrength(e) {
		((this.currentStrength = e),
			this.currentPattern === 'blur' ? this.overlay.blurRadius(e) : this.overlay.pixelSize(Math.max(1, Math.round(e / 2))),
			this.updateOverlayClip());
	}
	resizeFromStart(e, i) {
		const s = i.x - e.x,
			r = i.y - e.y;
		this.shapeNode instanceof W.Ellipse
			? this.shapeNode.setAttrs({ x: e.x + s / 2, y: e.y + r / 2, radiusX: Math.abs(s / 2), radiusY: Math.abs(r / 2) })
			: this.shapeNode.setAttrs({ x: s > 0 ? e.x : i.x, y: r > 0 ? e.y : i.y, width: Math.abs(s), height: Math.abs(r) });
	}
	finalize() {
		((this.transformer = new W.Transformer({
			nodes: [this.shapeNode],
			anchorFill: '#3b82f6',
			anchorStroke: '#ffffff',
			anchorStrokeWidth: 2,
			anchorSize: 12,
			anchorCornerRadius: 6,
			borderStroke: '#ffffff',
			borderStrokeWidth: 1.5,
			borderDash: [],
			rotateEnabled: !0,
			rotationSnaps: [0, 45, 90, 135, 180, 225, 270, 315],
			rotateAnchorOffset: 25,
			enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right'],
			keepRatio: !1,
			ignoreStroke: !0,
			boundBoxFunc: (e, i) => (i.width < 10 || i.height < 10 ? e : i)
		})),
			this.transformer.on('dragend transformend', () => {
				d.takeSnapshot();
			}),
			this.imageGroup.add(this.transformer),
			this.transformer.moveToTop(),
			this.shapeNode.on('dragend transformend', () => {
				d.takeSnapshot();
			}),
			this.createToolbar());
	}
	createToolbar() {
		this.toolbar && this.toolbar.destroy();
		const e = this.shapeNode.getClientRect(),
			i = e.y - 45,
			s = e.x + e.width / 2;
		this.toolbar = new W.Group({ x: s, y: i, name: 'blurToolbar' });
		const r = new W.Rect({
			x: -45,
			y: 0,
			width: 90,
			height: 36,
			fill: '#1f2937',
			cornerRadius: 8,
			shadowColor: 'black',
			shadowBlur: 10,
			shadowOpacity: 0.4
		});
		this.toolbar.add(r);
		const l = new W.Group({ x: -22, y: 18, cursor: 'pointer' });
		(l.add(
			new W.Path({ data: 'M12 4v16m8-8H4', stroke: 'white', strokeWidth: 2, lineCap: 'round', scale: { x: 0.8, y: 0.8 }, offset: { x: 12, y: 12 } })
		),
			l.on('click tap', (a) => {
				((a.cancelBubble = !0), this._onClone?.());
			}),
			l.on('mouseenter', () => {
				const a = this.layer.getStage();
				a && (a.container().style.cursor = 'pointer');
			}),
			l.on('mouseleave', () => {
				const a = this.layer.getStage();
				a && (a.container().style.cursor = 'crosshair');
			}),
			this.toolbar.add(l));
		const u = new W.Group({ x: 22, y: 18, cursor: 'pointer' });
		(u.add(
			new W.Path({
				data: 'M3 6h18M9 6v12M15 6v12M5 6v14a2 2 0 002 2h10a2 2 0 002-2V6M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2',
				stroke: 'white',
				strokeWidth: 2,
				scale: { x: 0.7, y: 0.7 },
				offset: { x: 12, y: 12 }
			})
		),
			u.on('click tap', (a) => {
				((a.cancelBubble = !0), this.destroy());
			}),
			u.on('mouseenter', () => {
				const a = this.layer.getStage();
				a && (a.container().style.cursor = 'pointer');
			}),
			u.on('mouseleave', () => {
				const a = this.layer.getStage();
				a && (a.container().style.cursor = 'crosshair');
			}),
			this.toolbar.add(u),
			this.imageGroup.add(this.toolbar),
			this.toolbar.zIndex(10),
			this.updateToolbarPosition());
	}
	isTooSmall() {
		const e = this.shapeNode;
		return e instanceof W.Ellipse ? e.radiusX() < 10 || e.radiusY() < 10 : e.width() < 20 || e.height() < 20;
	}
	setActive(e) {
		(this.transformer && this.transformer.visible(e),
			this.toolbar && this.toolbar.visible(e),
			e && (this.transformer?.moveToTop(), this.toolbar?.moveToTop(), this.updateToolbarPosition()),
			this.layer.batchDraw());
	}
	hideUI() {
		(this.transformer?.visible(!1), this.toolbar?.visible(!1), this.shapeNode.visible(!1));
	}
	cloneForBake() {
		try {
			return this.overlayGroup.clone();
		} catch {
			return null;
		}
	}
	rotate(e) {
		(this.shapeNode.rotate(e), this.updateToolbarPosition(), this.updateOverlayClip(), this.layer.batchDraw());
	}
	flipX() {
		(this.shapeNode.scaleX(this.shapeNode.scaleX() * -1), this.updateToolbarPosition(), this.updateOverlayClip(), this.layer.batchDraw());
	}
	destroy() {
		(this.shapeNode.off('dragmove transform click tap'),
			this.transformer?.destroy(),
			this.toolbar?.destroy(),
			this.overlayGroup.destroy(),
			this.shapeNode.destroy(),
			this._onDestroy?.());
	}
	onSelect(e) {
		this._onSelect = e;
	}
	onDestroy(e) {
		this._onDestroy = e;
	}
	onClone(e) {
		this._onClone = e;
	}
}
function wa(y, e) {
	pt(e, !0);
	let i = Y(20),
		s = Y('blur'),
		r = Y('rectangle'),
		l = Y(Ht([])),
		u = Y(null),
		a = Y(!1),
		b = null;
	(wt(() => {
		d.state.activeState === 'blur'
			? (R(),
				d.setToolbarControls({
					component: Oe,
					props: {
						blurStrength: t(i),
						pattern: t(s),
						shape: t(r),
						onAdd: void 0,
						onDelete: void 0,
						onStrengthChange: (m) => {
							(f(i, m, !0),
								b && clearTimeout(b),
								(b = window.setTimeout(() => {
									(t(u)
										? t(l)
												.find((M) => M.id === t(u))
												?.setStrength(m)
										: t(l).forEach((M) => M.setStrength(m)),
										d.state.layer?.batchDraw());
								}, 30)));
						},
						onPatternChange: (m) => {
							(f(s, m, !0), t(l).forEach((M) => M.setPattern(m)));
						},
						onShapeChange: (m) => {
							if ((f(r, m, !0), t(u))) {
								const M = t(l).find((O) => O.id === t(u));
								if (M) {
									const G = M.shapeNode.getClientRect();
									(I(M.id), _({ x: G.x, y: G.y, width: G.width, height: G.height, shape: m }));
								}
							}
						},
						onAddRegion: () => {
							const m = d.state.stage,
								M = m ? m.width() / 2 : 100,
								O = m ? m.height() / 2 : 100;
							_({ x: M, y: O });
						},
						onDeleteRegion: () => {
							t(u) && I(t(u));
						},
						onRotateLeft: () => {
							t(u) &&
								t(l)
									.find((m) => m.id === t(u))
									?.rotate(-90);
						},
						onRotateRight: () => {
							t(u) &&
								t(l)
									.find((m) => m.id === t(u))
									?.rotate(90);
						},
						onFlipHorizontal: () => {
							t(u) &&
								t(l)
									.find((m) => m.id === t(u))
									?.flipX();
						},
						onReset: () => S(),
						onCancel: () => e.onCancel(),
						onApply: x
					}
				}))
			: (k(), d.state.toolbarControls?.component === Oe && d.setToolbarControls(null));
	}),
		wt(() => {
			t(a) && t(l).length === 0 && _();
		}));
	function R() {
		const { stage: L } = d.state;
		!L || t(a) || (L.on('click tap', g), L.container() && (L.container().style.cursor = 'crosshair'), f(a, !0));
	}
	function k() {
		const { stage: L } = d.state;
		!L || !t(a) || (L.off('click tap', g), L.container() && (L.container().style.cursor = 'default'), f(a, !1));
	}
	function g(L) {
		const { stage: m, imageNode: M, imageGroup: O } = d.state,
			G = L.target;
		if (m && (G === m || G === M || G === O)) {
			const z = m.getPointerPosition();
			z && _({ x: z.x - 100, y: z.y - 75, width: 200, height: 150, shape: t(r) });
		}
	}
	function _(L) {
		const { stage: m, layer: M, imageNode: O, imageGroup: G } = d.state;
		if (!m || !M || !O || !G) return;
		const z = new xa({ id: crypto.randomUUID(), layer: M, imageNode: O, imageGroup: G, init: { shape: t(r), pattern: t(s), strength: t(i), ...L } });
		(f(l, [...t(l), z], !0),
			f(u, z.id, !0),
			z.onSelect(() => T(z.id)),
			z.onClone(() => {
				const J = z.shapeNode.getClientRect();
				_({
					x: J.x + 20,
					y: J.y + 20,
					width: J.width,
					height: J.height,
					shape: z.shapeNode instanceof W.Ellipse ? 'ellipse' : 'rectangle',
					pattern: t(s),
					strength: t(i)
				});
			}),
			z.onDestroy(() => {
				(f(
					l,
					t(l).filter((J) => J.id !== z.id),
					!0
				),
					t(u) === z.id && f(u, null));
			}),
			z.setPattern(t(s)),
			z.setStrength(t(i)),
			z.finalize(),
			T(z.id));
	}
	function T(L) {
		(f(u, L, !0), t(l).forEach((m) => m.setActive(m.id === L)), d.state.layer?.batchDraw());
	}
	function I(L) {
		t(l)
			.find((M) => M.id === L)
			?.destroy();
	}
	function v(L = !0) {
		(L ? ([...t(l)].forEach((m) => m.destroy()), f(l, [], !0)) : t(l).forEach((m) => m.hideUI()), f(u, null), d.state.layer?.batchDraw());
	}
	function S() {
		v(!0);
	}
	function x() {
		(v(!1), d.takeSnapshot(), d.setActiveState(''));
	}
	function c() {
		try {
			(k(), v(!0));
		} catch {}
	}
	function C() {}
	function F() {
		c();
	}
	var A = { reset: S, apply: x, cleanup: c, saveState: C, beforeExit: F };
	return vt(A);
}
const ka = { key: 'blur', title: 'Blur', icon: 'mdi:blur', tool: wa },
	Sa = Object.freeze(Object.defineProperty({ __proto__: null, default: ka }, Symbol.toStringTag, { value: 'Module' }));
var Ca = K(
	'<div class="flex items-center gap-3"><div class="btn-group preset-outlined-surface-500"><button class="btn-sm">Free</button> <button class="btn-sm">1:1</button> <button class="btn-sm">16:9</button> <button class="btn-sm">4:3</button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <div class="btn-group preset-outlined-surface-500"><button title="Rectangle"><iconify-icon></iconify-icon></button> <button title="Circle"><iconify-icon></iconify-icon></button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Rotate Left"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Rotate Right"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Flip Horizontal"><iconify-icon></iconify-icon></button> <div class="grow"></div> <button class="btn preset-outlined-error-500"><iconify-icon></iconify-icon> <span>Cancel</span></button> <button class="btn preset-filled-success-500"><iconify-icon></iconify-icon> <span>Apply Crop</span></button></div>',
	2
);
function We(y, e) {
	pt(e, !0);
	var i = Ca(),
		s = o(i),
		r = o(s);
	r.__click = () => e.onAspectRatio(null);
	var l = h(r, 2);
	l.__click = () => e.onAspectRatio(1);
	var u = h(l, 2);
	u.__click = () => e.onAspectRatio(16 / 9);
	var a = h(u, 2);
	((a.__click = () => e.onAspectRatio(4 / 3)), n(s));
	var b = h(s, 4),
		R = o(b);
	let k;
	R.__click = () => e.onCropShapeChange('rectangle');
	var g = o(R);
	(w(g, 'icon', 'mdi:rectangle-outline'), n(R));
	var _ = h(R, 2);
	let T;
	_.__click = () => e.onCropShapeChange('circular');
	var I = o(_);
	(w(I, 'icon', 'mdi:circle-outline'), n(_), n(b));
	var v = h(b, 4);
	v.__click = function (...O) {
		e.onRotateLeft?.apply(this, O);
	};
	var S = o(v);
	(w(S, 'icon', 'mdi:rotate-left'), n(v));
	var x = h(v, 2);
	x.__click = function (...O) {
		e.onRotateRight?.apply(this, O);
	};
	var c = o(x);
	(w(c, 'icon', 'mdi:rotate-right'), n(x));
	var C = h(x, 2);
	C.__click = function (...O) {
		e.onFlipHorizontal?.apply(this, O);
	};
	var F = o(C);
	(w(F, 'icon', 'mdi:flip-horizontal'), n(C));
	var A = h(C, 4);
	A.__click = function (...O) {
		e.onCancel?.apply(this, O);
	};
	var L = o(A);
	(w(L, 'icon', 'mdi:close'), ht(2), n(A));
	var m = h(A, 2);
	m.__click = function (...O) {
		e.onApply?.apply(this, O);
	};
	var M = o(m);
	(w(M, 'icon', 'mdi:check'),
		ht(2),
		n(m),
		n(i),
		Z(() => {
			((k = nt(R, 1, 'btn-sm', null, k, { active: e.cropShape === 'rectangle' })),
				(T = nt(_, 1, 'btn-sm', null, T, { active: e.cropShape === 'circular' })));
		}),
		X(y, i),
		vt());
}
At(['click']);
function Ue(y) {
	if (!y || y === 'free') return null;
	const e = y.split(':').map((i) => Number(i));
	return e.length !== 2 || Number.isNaN(e[0]) || Number.isNaN(e[1]) || e[1] === 0 ? null : e[0] / e[1];
}
function Ta(y, e, i = !0) {
	const s = y.findOne('.cropCut');
	if (s) {
		if (
			(e instanceof W.Circle && s instanceof W.Circle
				? (s.position(e.position()), s.radius(e.radius()), s.rotation(e.rotation()))
				: e instanceof W.Rect &&
					s instanceof W.Rect &&
					s.setAttrs({ x: e.x(), y: e.y(), width: e.width() * e.scaleX(), height: e.height() * e.scaleY(), rotation: e.rotation() }),
			i)
		) {
			const r = y.getStage();
			y.cache({ x: 0, y: 0, width: r?.width() ?? 0, height: r?.height() ?? 0, pixelRatio: 1 });
		}
		y.getLayer()?.batchDraw();
	}
}
class Ra {
	id;
	layer;
	imageNode;
	imageGroup;
	shape;
	overlayGroup;
	gridGroup;
	transformer;
	aspect = null;
	_onTransform = null;
	_onTransformEnd = null;
	_onDestroy = null;
	constructor(e) {
		((this.id = e.id), (this.layer = e.layer), (this.imageNode = e.imageNode), (this.imageGroup = e.imageGroup));
		const i = e.init || {};
		((this.aspect = i.aspect ?? null), (this.overlayGroup = new W.Group({ name: 'cropOverlayGroup' })));
		const s = this.layer.getStage(),
			r = s?.width() ?? 0,
			l = s?.height() ?? 0,
			u = new W.Rect({ x: 0, y: 0, width: r, height: l, fill: 'rgba(0,0,0,0.8)', listening: !1, name: 'cropOverlay' });
		this.overlayGroup.add(u);
		const a = this.imageGroup.getClientRect(),
			b = Math.min(a.width, a.height) * 0.8,
			R = a.x + a.width / 2,
			k = a.y + a.height / 2;
		let g, _;
		const T = Ue(this.aspect);
		if ((T ? ((g = b), (_ = b / T)) : ((g = b), (_ = b * 0.75)), i.shape === 'circular')) {
			const I = b / 2,
				v = new W.Circle({ x: R, y: k, radius: I, fill: 'black', globalCompositeOperation: 'destination-out', listening: !1, name: 'cropCut' });
			(this.overlayGroup.add(v),
				(this.shape = new W.Circle({ x: R, y: k, radius: I, stroke: 'white', strokeWidth: 3, draggable: !0, name: 'cropTool' })));
		} else {
			const I = new W.Rect({
				x: R - g / 2,
				y: k - _ / 2,
				width: g,
				height: _,
				fill: 'black',
				globalCompositeOperation: 'destination-out',
				listening: !1,
				name: 'cropCut'
			});
			(this.overlayGroup.add(I),
				(this.shape = new W.Rect({
					x: R - g / 2,
					y: k - _ / 2,
					width: g,
					height: _,
					stroke: 'white',
					strokeWidth: 1,
					draggable: !0,
					name: 'cropTool'
				})),
				this.createGrid());
		}
		(this.overlayGroup.cache({ x: 0, y: 0, width: r, height: l, pixelRatio: 1 }),
			this.layer.add(this.overlayGroup),
			this.layer.add(this.shape),
			this.imageGroup.zIndex(0),
			this.overlayGroup.zIndex(1),
			this.gridGroup?.zIndex(2),
			this.shape.zIndex(3),
			this.shape.on('dragmove transform', () => {
				(this._onTransform?.(), this.updateCutout(!1), this.updateGrid());
			}),
			this.shape.on('dragend transformend', () => {
				this._onTransformEnd?.();
			}));
	}
	createGrid() {
		if (this.shape instanceof W.Rect) {
			(this.gridGroup && this.gridGroup.destroy(), (this.gridGroup = new W.Group({ listening: !1 })));
			for (let e = 1; e <= 2; e++)
				(this.gridGroup.add(new W.Line({ name: `v${e}`, points: [0, 0, 0, 0], ...Me })),
					this.gridGroup.add(new W.Line({ name: `h${e}`, points: [0, 0, 0, 0], ...Me })));
			(this.layer.add(this.gridGroup), this.updateGrid());
		}
	}
	updateGrid() {
		if (!this.gridGroup || !(this.shape instanceof W.Rect)) return;
		const e = this.shape.x(),
			i = this.shape.y(),
			s = this.shape.width() * this.shape.scaleX(),
			r = this.shape.height() * this.shape.scaleY();
		for (let l = 1; l <= 2; l++) {
			const u = e + (s * l) / 3,
				a = this.gridGroup.findOne(`.v${l}`);
			a && a.points([u, i, u, i + r]);
			const b = i + (r * l) / 3,
				R = this.gridGroup.findOne(`.h${l}`);
			R && R.points([e, b, e + s, b]);
		}
	}
	updateCutout(e = !0) {
		Ta(this.overlayGroup, this.shape, e);
	}
	centerIn(e) {
		const i = e.x + e.width / 2,
			s = e.y + e.height / 2;
		(this.shape.position({ x: i, y: s }), this.transformer?.forceUpdate());
	}
	attachTransformer() {
		this.transformer && this.transformer.destroy();
		const e = Ue(this.aspect ?? 'free'),
			i = this.shape instanceof W.Circle || this.aspect === '1:1' || (e !== null && typeof e == 'number');
		((this.transformer = new W.Transformer({
			nodes: [this.shape],
			...ua,
			keepRatio: i,
			enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right'],
			rotateEnabled: !1,
			boundBoxFunc: (s, r) => (r.width < 30 || r.height < 30 ? s : (e && i && this.shape instanceof W.Rect && (r.height = r.width / e), r))
		})),
			this.layer.add(this.transformer),
			this.transformer.zIndex(4),
			this.transformer.moveToTop());
	}
	hideUI() {
		(this.transformer?.visible(!1), this.shape.visible(!1), this.gridGroup?.visible(!1), this.overlayGroup.visible(!1), this.layer.batchDraw());
	}
	destroy() {
		(this.shape.off('dragmove transform dragend transformend'),
			this.transformer?.destroy(),
			this.gridGroup?.destroy(),
			this.overlayGroup.destroy(),
			this.shape.destroy(),
			this._onDestroy?.());
	}
	onTransform(e) {
		this._onTransform = e;
	}
	onTransformEnd(e) {
		this._onTransformEnd = e;
	}
	onDestroy(e) {
		this._onDestroy = e;
	}
}
function Aa(y, e) {
	pt(e, !0);
	let i = Y('rectangle'),
		s = Y('free'),
		r = Y(null),
		l = Y(!1);
	wt(() => {
		d.state.activeState === 'crop'
			? (u(),
				d.setToolbarControls({
					component: We,
					props: {
						cropShape: t(i),
						onRotateLeft: R,
						onRotateRight: g,
						onFlipHorizontal: k,
						onCropShapeChange: (c) => {
							(f(i, c, !0),
								(c === 'square' || c === 'circular') && f(s, '1:1'),
								c === 'circular' && Ii('Round Crop selected. Image will be saved with transparency.', 'info'),
								b());
						},
						onAspectRatio: (c) => {
							(f(s, c === null ? 'free' : `${c}`, !0), c === 1 ? f(i, t(i) === 'circular' ? 'circular' : 'square', !0) : f(i, 'rectangle'), b());
						},
						onApply: _,
						onCancel: () => e.onCancel()
					}
				}))
			: (a(), d.state.toolbarControls?.component === We && d.setToolbarControls(null));
	});
	function u() {
		t(l) || (f(l, !0), b());
	}
	function a() {
		t(l) && (f(l, !1), T());
	}
	function b() {
		const { stage: x, layer: c, imageNode: C, imageGroup: F } = d.state;
		if (!x || !c || !C || !F) return;
		t(r) && (t(r).destroy(), f(r, null));
		const A = new Ra({ id: crypto.randomUUID(), layer: c, imageNode: C, imageGroup: F, init: { shape: t(i), aspect: t(s) } });
		(A.onTransform(() => {
			A.updateCutout(!1);
		}),
			A.onTransformEnd(() => {
				A.updateCutout(!0);
			}),
			A.attachTransformer(),
			f(r, A, !0),
			c.batchDraw());
	}
	function R() {
		const { imageGroup: x, layer: c } = d.state;
		if (!x || !c) return;
		const F = (x.rotation() - 90) % 360;
		(x.rotation(F), t(r) && (t(r).centerIn(x.getClientRect()), t(r).updateCutout(!0)), c.batchDraw());
	}
	function k() {
		const { imageGroup: x, layer: c } = d.state;
		!x || !c || (x.scaleX(x.scaleX() * -1), t(r) && (t(r).centerIn(x.getClientRect()), t(r).updateCutout(!0)), c.batchDraw());
	}
	function g() {
		const { imageGroup: x, layer: c } = d.state;
		if (!x || !c) return;
		const F = (x.rotation() + 90) % 360;
		(x.rotation(F), t(r) && (t(r).centerIn(x.getClientRect()), t(r).updateCutout(!0)), c.batchDraw());
	}
	function _() {
		const { imageNode: x, imageGroup: c, layer: C, stage: F } = d.state;
		!x ||
			!c ||
			!t(r) ||
			!C ||
			!F ||
			Ei(
				async () => {
					const { stageRectToImageRect: A } = await import('./Z7upHnG1.js');
					return { stageRectToImageRect: A };
				},
				__vite__mapDeps([0, 1, 2, 3]),
				import.meta.url
			).then(({ stageRectToImageRect: A }) => {
				const L = t(r).shape.getClientRect(),
					m = A(L, x, c);
				(x.cropX(m.x),
					x.cropY(m.y),
					x.cropWidth(m.width),
					x.cropHeight(m.height),
					x.width(m.width),
					x.height(m.height),
					x.x(-m.width / 2),
					x.y(-m.height / 2),
					t(i) === 'circular' ? x.cornerRadius(Math.max(m.width, m.height)) : x.cornerRadius(0));
				const M = F.width(),
					O = F.height(),
					G = (M * 0.8) / m.width,
					z = (O * 0.8) / m.height,
					J = Math.min(G, z);
				(c.scaleX(J), c.scaleY(J), c.rotation(0), c.x(M / 2), c.y(O / 2), t(r).hideUI(), C.batchDraw(), d.takeSnapshot(), d.setActiveState(''));
			});
	}
	function T() {
		(t(r) && (t(r).destroy(), f(r, null)), d.state.layer?.batchDraw());
	}
	function I() {}
	function v() {
		T();
	}
	var S = { cleanup: T, saveState: I, beforeExit: v };
	return vt(S);
}
const Da = { key: 'crop', title: 'Crop', icon: 'mdi:crop', tool: Aa },
	Fa = Object.freeze(Object.defineProperty({ __proto__: null, default: Da }, Symbol.toStringTag, { value: 'Module' }));
var Ea = K('<button><iconify-icon></iconify-icon> <span class="text-[10px] uppercase tracking-tighter leading-none"> </span></button>', 2),
	Ia = K(
		'<div class="flex w-full items-center gap-4"><div class="flex-1 overflow-x-auto no-scrollbar py-1 svelte-11mkv27"><div class="flex items-center gap-1 min-w-max px-2"></div></div> <div class="w-48 px-2 flex flex-col gap-1"><div class="flex justify-between text-[10px] text-surface-500 uppercase font-bold"><span> </span> <span> </span></div> <input type="range" min="-100" max="100" step="1" class="range range-primary range-sm"/></div> <button class="btn-sm btn-icon preset-outlined-surface-500" title="Reset this adjustment"><iconify-icon></iconify-icon></button> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <button class="btn preset-outlined-error-500"><iconify-icon></iconify-icon> <span>Cancel</span></button> <button class="btn preset-filled-success-500"><iconify-icon></iconify-icon> <span>Apply</span></button></div>',
		2
	);
function je(y, e) {
	pt(e, !0);
	const i = [
		{ key: 'brightness', label: 'Brightness', icon: 'mdi:brightness-6' },
		{ key: 'contrast', label: 'Contrast', icon: 'mdi:contrast-box' },
		{ key: 'saturation', label: 'Saturation', icon: 'mdi:palette' },
		{ key: 'exposure', label: 'Exposure', icon: 'mdi:brightness-7' },
		{ key: 'highlights', label: 'Highlights', icon: 'mdi:white-balance-sunny' },
		{ key: 'shadows', label: 'Shadows', icon: 'mdi:weather-night' },
		{ key: 'temperature', label: 'Temperature', icon: 'mdi:thermometer' },
		{ key: 'clarity', label: 'Clarity', icon: 'mdi:crystal-ball' },
		{ key: 'vibrance', label: 'Vibrance', icon: 'mdi:vibrate' }
	];
	function s(F) {
		const A = F.currentTarget;
		e.onChange(parseInt(A.value, 10));
	}
	var r = Ia(),
		l = o(r),
		u = o(l);
	(de(
		u,
		21,
		() => i,
		Se,
		(F, A) => {
			var L = Ea();
			let m;
			L.__click = () => e.onAdjustmentChange(t(A).key);
			var M = o(L);
			(Z(() => w(M, 'icon', t(A).icon)), w(M, 'width', '18'));
			var O = h(M, 2),
				G = o(O, !0);
			(n(O),
				n(L),
				Z(() => {
					((m = nt(L, 1, 'btn-sm preset-outlined-surface-500flex flex-col items-center gap-1 w-20 h-14', null, m, {
						'preset-filled-primary-500': e.activeAdjustment === t(A).key
					})),
						bt(L, 'title', t(A).label),
						Q(G, t(A).label));
				}),
				X(F, L));
		}
	),
		n(u),
		n(l));
	var a = h(l, 2),
		b = o(a),
		R = o(b),
		k = o(R, !0);
	n(R);
	var g = h(R, 2),
		_ = o(g, !0);
	(n(g), n(b));
	var T = h(b, 2);
	(Zt(T), (T.__input = s), n(a));
	var I = h(a, 2);
	I.__click = function (...F) {
		e.onReset?.apply(this, F);
	};
	var v = o(I);
	(w(v, 'icon', 'mdi:restore'), n(I));
	var S = h(I, 4);
	S.__click = function (...F) {
		e.onCancel?.apply(this, F);
	};
	var x = o(S);
	(w(x, 'icon', 'mdi:close'), ht(2), n(S));
	var c = h(S, 2);
	c.__click = function (...F) {
		e.onApply?.apply(this, F);
	};
	var C = o(c);
	(w(C, 'icon', 'mdi:check'),
		ht(2),
		n(c),
		n(r),
		Z(
			(F) => {
				(Q(k, F), nt(g, 1, pe(e.value !== 0 ? 'text-primary-500' : '')), Q(_, e.value), le(T, e.value), (I.disabled = e.value === 0));
			},
			[() => i.find((F) => F.key === e.activeAdjustment)?.label]
		),
		X(y, r),
		vt());
}
At(['click', 'input']);
const Xe = { brightness: 0, contrast: 0, saturation: 0, temperature: 0, exposure: 0, highlights: 0, shadows: 0, clarity: 0, vibrance: 0 };
function Ga(y, e) {
	(y.brightness(e.brightness / 100), y.contrast(e.contrast / 100));
	const i = (e.saturation + e.vibrance * 0.7) / 100;
	y.saturation(i);
}
function Na(y) {
	const e = 1 + y.exposure / 100,
		i = 1 + y.highlights / 100,
		s = 1 + y.shadows / 100,
		r = 1 + y.clarity / 100,
		l = 128;
	return function (u) {
		const a = u.data;
		for (let b = 0; b < a.length; b += 4) {
			let R = a[b],
				k = a[b + 1],
				g = a[b + 2];
			y.exposure !== 0 && ((R *= e), (k *= e), (g *= e));
			const _ = 0.299 * R + 0.587 * k + 0.114 * g;
			if (y.highlights !== 0 && _ > 150) {
				const T = (_ - 150) / 105,
					I = 1 + (i - 1) * T;
				((R *= I), (k *= I), (g *= I));
			}
			if (y.shadows !== 0 && _ < 100) {
				const T = (100 - _) / 100,
					I = 1 + (s - 1) * T;
				((R *= I), (k *= I), (g *= I));
			}
			if ((y.clarity !== 0 && ((R = l + (R - l) * r), (k = l + (k - l) * r), (g = l + (g - l) * r)), y.temperature !== 0)) {
				const T = (y.temperature / 100) * 20;
				((R += T), (g -= T));
			}
			((a[b] = Math.min(255, Math.max(0, R))), (a[b + 1] = Math.min(255, Math.max(0, k))), (a[b + 2] = Math.min(255, Math.max(0, g))));
		}
	};
}
function Pa(y, e) {
	pt(e, !0);
	let i = Y(Ht({ ...Xe })),
		s = Y('brightness');
	const r = [
		{ key: 'brightness', label: 'Brightness', icon: 'mdi:brightness-6' },
		{ key: 'contrast', label: 'Contrast', icon: 'mdi:contrast-box' },
		{ key: 'saturation', label: 'Saturation', icon: 'mdi:palette' },
		{ key: 'exposure', label: 'Exposure', icon: 'mdi:brightness-7' },
		{ key: 'highlights', label: 'Highlights', icon: 'mdi:white-balance-sunny' },
		{ key: 'shadows', label: 'Shadows', icon: 'mdi:weather-night' },
		{ key: 'temperature', label: 'Temperature', icon: 'mdi:thermometer' },
		{ key: 'clarity', label: 'Clarity', icon: 'mdi:crystal-ball' },
		{ key: 'vibrance', label: 'Vibrance', icon: 'mdi:vibrate' }
	];
	let l = Y(!1),
		u = null;
	(wt(() => {
		d.state.activeState === 'finetune'
			? (a(),
				d.setToolbarControls({
					component: je,
					props: {
						activeAdjustment: t(s),
						activeIcon: r.find((S) => S.key === t(s))?.icon,
						value: t(i)[t(s)],
						onChange: (S) => {
							t(i)[t(s)] = S;
						},
						onAdjustmentChange: (S) => {
							f(s, S, !0);
						},
						onReset: () => R(),
						onCancel: () => e.onCancel(),
						onApply: () => k()
					}
				}))
			: (b(), d.state.toolbarControls?.component === je && d.setToolbarControls(null));
	}),
		wt(() => {
			if (!t(l)) return;
			const v = JSON.parse(JSON.stringify(t(i)));
			(u && clearTimeout(u),
				(u = window.setTimeout(() => {
					const { imageNode: S, layer: x } = d.state;
					if (!S || !x) return;
					console.log('Applying FineTune adjustments:', v);
					const c = [];
					(c.push(W.Filters.Brighten),
						c.push(W.Filters.Contrast),
						c.push(W.Filters.HSL),
						(t(i).exposure !== 0 || t(i).highlights !== 0 || t(i).shadows !== 0 || t(i).clarity !== 0 || t(i).temperature !== 0) && c.push(Na(v)),
						S.filters(c),
						Ga(S, v),
						S.clearCache(),
						S.cache(),
						x.batchDraw());
				}, 100)));
		}));
	function a() {
		t(l) || (f(l, !0), f(i, { ...Xe }, !0));
	}
	function b() {
		t(l) && (f(l, !1), u && clearTimeout(u));
	}
	function R() {
		t(i)[t(s)] = 0;
	}
	function k() {
		(d.takeSnapshot(), d.setActiveState(''));
	}
	function g() {
		try {
			b();
		} catch {}
	}
	function _() {}
	function T() {
		g();
	}
	var I = { cleanup: g, saveState: _, beforeExit: T };
	return vt(I);
}
const La = { key: 'finetune', title: 'Fine-Tune', icon: 'mdi:tune', tool: Pa },
	Ma = Object.freeze(Object.defineProperty({ __proto__: null, default: La }, Symbol.toStringTag, { value: 'Module' }));
var za = K(
	'<div class="flex items-center gap-4 flex-wrap"><div class="flex items-center gap-2"><span class="text-sm font-medium">Focal Point:</span> <div class="flex items-center gap-1"><span class="badge variant-soft-primary text-xs"> </span> <span class="badge variant-soft-primary text-xs"> </span></div></div> <span class="text-xs text-surface-600 dark:text-surface-50">Click on the image to set focal point</span> <div class="flex-1"></div> <div class="flex items-center gap-2"><button class="btn preset-outlined-surface-500btn-sm" title="Reset to center"><iconify-icon></iconify-icon> <span>Reset</span></button> <button class="btn preset-outlined-error-500 btn-sm" title="Discard changes"><iconify-icon></iconify-icon> <span>Cancel</span></button> <button class="btn preset-filled-primary-500 btn-sm" title="Apply focal point"><iconify-icon></iconify-icon> <span>Apply</span></button></div></div>',
	2
);
function we(y, e) {
	const i = dt(e, 'focalX', 3, 50),
		s = dt(e, 'focalY', 3, 50),
		r = dt(e, 'onReset', 3, () => {}),
		l = dt(e, 'onApply', 3, () => {}),
		u = dt(e, 'onCancel', 3, () => {});
	var a = za(),
		b = o(a),
		R = h(o(b), 2),
		k = o(R),
		g = o(k);
	n(k);
	var _ = h(k, 2),
		T = o(_);
	(n(_), n(R), n(b));
	var I = h(b, 6),
		v = o(I);
	v.__click = function (...A) {
		r()?.apply(this, A);
	};
	var S = o(v);
	(w(S, 'icon', 'mdi:restore'), w(S, 'width', '18'), ht(2), n(v));
	var x = h(v, 2);
	x.__click = function (...A) {
		u()?.apply(this, A);
	};
	var c = o(x);
	(w(c, 'icon', 'mdi:close'), w(c, 'width', '18'), ht(2), n(x));
	var C = h(x, 2);
	C.__click = function (...A) {
		l()?.apply(this, A);
	};
	var F = o(C);
	(w(F, 'icon', 'mdi:check'),
		w(F, 'width', '18'),
		ht(2),
		n(C),
		n(I),
		n(a),
		Z(() => {
			(Q(g, `X: ${i() ?? ''}%`), Q(T, `Y: ${s() ?? ''}%`));
		}),
		X(y, a));
}
At(['click']);
function Oa(y, e) {
	pt(e, !0);
	let i = Y(Ht({ x: 0.5, y: 0.5 })),
		s = Y(null),
		r = Y(null),
		l = Y(!1);
	wt(() => {
		d.state.activeState === 'focalpoint'
			? (u(),
				d.setToolbarControls({
					component: we,
					props: {
						focalX: Math.round(t(i).x * 100),
						focalY: Math.round(t(i).y * 100),
						onReset: () => _(),
						onCancel: () => e.onCancel(),
						onApply: () => T()
					}
				}))
			: (a(), d.state.toolbarControls?.component === we && d.setToolbarControls(null));
	});
	function u() {
		const { stage: c, imageNode: C } = d.state;
		if (!c || !C || t(l)) return;
		f(l, !0);
		const F = C.metadata;
		(F?.focalPoint && f(i, { ...F.focalPoint }, !0),
			b(),
			R(),
			c.on('click.focalpoint tap.focalpoint', k),
			(c.container().style.cursor = 'crosshair'));
	}
	function a() {
		const { stage: c } = d.state;
		!c ||
			!t(l) ||
			(f(l, !1),
			c.off('click.focalpoint tap.focalpoint'),
			c.container() && (c.container().style.cursor = 'default'),
			t(s)?.destroy(),
			f(s, null),
			f(r, null));
	}
	function b() {
		const { stage: c, imageNode: C, imageGroup: F } = d.state;
		if (!c || !C || !F) return;
		(f(s, new W.Layer(), !0), c.add(t(s)), t(s).moveToTop());
		const A = C.width() * C.scaleX(),
			L = C.height() * C.scaleY(),
			m = F.x(),
			M = F.y(),
			O = m - A / 2,
			G = M - L / 2,
			z = '#00ff00',
			J = 1,
			lt = 0.7;
		for (let et = 1; et <= 2; et++) {
			const $ = O + (A / 3) * et,
				P = new W.Line({ points: [$, G, $, G + L], stroke: z, strokeWidth: J, opacity: lt, listening: !1 });
			t(s).add(P);
		}
		for (let et = 1; et <= 2; et++) {
			const $ = G + (L / 3) * et,
				P = new W.Line({ points: [O, $, O + A, $], stroke: z, strokeWidth: J, opacity: lt, listening: !1 });
			t(s).add(P);
		}
		t(s).batchDraw();
	}
	function R() {
		const { imageNode: c, imageGroup: C } = d.state;
		if (!t(s) || !c || !C) return;
		const F = c.width() * c.scaleX(),
			A = c.height() * c.scaleY(),
			L = C.x(),
			m = C.y(),
			M = L - F / 2,
			O = m - A / 2,
			G = M + F * t(i).x,
			z = O + A * t(i).y;
		f(r, new W.Group({ x: G, y: z, listening: !1 }), !0);
		const J = 20,
			lt = '#ff0000',
			et = 2,
			$ = new W.Line({ points: [-J, 0, J, 0], stroke: lt, strokeWidth: et }),
			P = new W.Line({ points: [0, -J, 0, J], stroke: lt, strokeWidth: et }),
			V = new W.Circle({ radius: 4, fill: lt, stroke: '#ffffff', strokeWidth: 2 });
		(t(r).add($, P, V), t(s).add(t(r)), t(s).batchDraw());
	}
	function k() {
		const { stage: c, imageNode: C, imageGroup: F } = d.state;
		if (!c || !C || !F) return;
		const A = c.getPointerPosition();
		if (!A) return;
		const L = C.width() * C.scaleX(),
			m = C.height() * C.scaleY(),
			M = F.x() - L / 2,
			O = F.y() - m / 2;
		A.x < M ||
			A.x > M + L ||
			A.y < O ||
			A.y > O + m ||
			(f(i, { x: (A.x - M) / L, y: (A.y - O) / m }, !0),
			g(),
			d.setToolbarControls({
				component: we,
				props: { focalX: Math.round(t(i).x * 100), focalY: Math.round(t(i).y * 100), onReset: () => _(), onApply: () => T() }
			}));
	}
	function g() {
		const { imageNode: c, imageGroup: C } = d.state;
		if (!t(r) || !c || !C) return;
		const F = c.width() * c.scaleX(),
			A = c.height() * c.scaleY(),
			L = C.x() - F / 2,
			m = C.y() - A / 2,
			M = L + F * t(i).x,
			O = m + A * t(i).y;
		(t(r).position({ x: M, y: O }), t(s)?.batchDraw());
	}
	function _() {
		(f(i, { x: 0.5, y: 0.5 }, !0), g());
	}
	function T() {
		const { imageNode: c } = d.state;
		c && ((c.metadata = { ...c.metadata, focalPoint: { ...t(i) } }), d.takeSnapshot(), d.setActiveState(''));
	}
	function I() {
		try {
			a();
		} catch {}
	}
	function v() {}
	function S() {
		I();
	}
	var x = { cleanup: I, saveState: v, beforeExit: S };
	return vt(x);
}
const Wa = { key: 'focalpoint', title: 'Focal', icon: 'mdi:target', tool: Oa, controls: null },
	Ua = Object.freeze(Object.defineProperty({ __proto__: null, editorWidget: Wa }, Symbol.toStringTag, { value: 'Module' }));
var ja = K(
	'<div class="flex w-full items-center gap-4"><span class="text-sm font-medium">Rotate & Flip Image</span> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <div class="flex items-center gap-2"><span class="text-sm">Rotate:</span> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Rotate Left 90Â°"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Rotate Right 90Â°"><iconify-icon></iconify-icon></button></div> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <label class="flex items-center gap-2 text-sm"><span>Angle:</span> <input type="range" min="-180" max="180" step="1" class="range range-primary w-32"/> <span class="w-12 text-right"> </span></label> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <div class="flex items-center gap-2"><span class="text-sm">Flip:</span> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Flip Horizontal"><iconify-icon></iconify-icon></button> <button class="btn btn-icon btn-sm preset-outlined-surface-500" title="Flip Vertical"><iconify-icon></iconify-icon></button></div> <div class="grow"></div> <button class="btn preset-outlined-surface-500"><iconify-icon></iconify-icon> <span>Reset</span></button> <button class="btn preset-filled-success-500"><iconify-icon></iconify-icon> <span>Apply</span></button></div>',
	2
);
function ke(y, e) {
	pt(e, !0);
	function i(m) {
		const M = m.currentTarget;
		e.onRotationChange(parseInt(M.value, 10));
	}
	const s = yt(() => () => {
		let m = e.rotationAngle % 360;
		return (m > 180 && (m -= 360), m < -180 && (m += 360), Math.round(m));
	});
	var r = ja(),
		l = h(o(r), 4),
		u = h(o(l), 2);
	u.__click = function (...m) {
		e.onRotateLeft?.apply(this, m);
	};
	var a = o(u);
	(w(a, 'icon', 'mdi:rotate-left'), n(u));
	var b = h(u, 2);
	b.__click = function (...m) {
		e.onRotateRight?.apply(this, m);
	};
	var R = o(b);
	(w(R, 'icon', 'mdi:rotate-right'), n(b), n(l));
	var k = h(l, 4),
		g = h(o(k), 2);
	(Zt(g), (g.__input = i));
	var _ = h(g, 2),
		T = o(_);
	(n(_), n(k));
	var I = h(k, 4),
		v = h(o(I), 2);
	v.__click = function (...m) {
		e.onFlipHorizontal?.apply(this, m);
	};
	var S = o(v);
	(w(S, 'icon', 'mdi:flip-horizontal'), n(v));
	var x = h(v, 2);
	x.__click = function (...m) {
		e.onFlipVertical?.apply(this, m);
	};
	var c = o(x);
	(w(c, 'icon', 'mdi:flip-vertical'), n(x), n(I));
	var C = h(I, 4);
	C.__click = function (...m) {
		e.onReset?.apply(this, m);
	};
	var F = o(C);
	(w(F, 'icon', 'mdi:restore'), ht(2), n(C));
	var A = h(C, 2);
	A.__click = function (...m) {
		e.onApply?.apply(this, m);
	};
	var L = o(A);
	(w(L, 'icon', 'mdi:check'),
		ht(2),
		n(A),
		n(r),
		Z(
			(m) => {
				(le(g, e.rotationAngle), Q(T, `${m ?? ''}Â°`));
			},
			[() => t(s)()]
		),
		X(y, r),
		vt());
}
At(['click', 'input']);
function Xa(y, e) {
	pt(e, !0);
	let i = Y(0);
	wt(() => {
		if (d.state.activeState === 'rotate') {
			const { imageGroup: S } = d.state;
			(S && f(i, S.rotation(), !0),
				d.setToolbarControls({
					component: ke,
					props: {
						rotationAngle: t(i),
						onRotateLeft: s,
						onRotateRight: r,
						onRotationChange: l,
						onFlipHorizontal: u,
						onFlipVertical: a,
						onReset: b,
						onApply: R
					}
				}));
		} else d.state.toolbarControls?.component === ke && d.setToolbarControls(null);
	});
	function s() {
		const { imageGroup: v, layer: S } = d.state;
		if (!v || !S) return;
		const c = (v.rotation() - 90) % 360;
		(v.rotation(c), f(i, c), S.batchDraw());
	}
	function r() {
		const { imageGroup: v, layer: S } = d.state;
		if (!v || !S) return;
		const c = (v.rotation() + 90) % 360;
		(v.rotation(c), f(i, c), S.batchDraw());
	}
	function l(v) {
		const { imageGroup: S, layer: x } = d.state;
		!S || !x || (S.rotation(v), f(i, v, !0), x.batchDraw());
	}
	function u() {
		const { imageGroup: v, layer: S } = d.state;
		!v || !S || (v.scaleX(v.scaleX() * -1), S.batchDraw());
	}
	function a() {
		const { imageGroup: v, layer: S } = d.state;
		!v || !S || (v.scaleY(v.scaleY() * -1), S.batchDraw());
	}
	function b() {
		const { imageGroup: v, layer: S } = d.state;
		!v || !S || (v.rotation(0), v.scaleX(Math.abs(v.scaleX())), v.scaleY(Math.abs(v.scaleY())), f(i, 0), S.batchDraw());
	}
	function R() {
		(d.takeSnapshot(), d.setActiveState(''));
	}
	function k() {}
	function g() {}
	function _() {}
	var T = { cleanup: k, saveState: g, beforeExit: _ };
	ht();
	var I =
		di(`// imageEditor/widgets/Rotate/Tool.svelte /** * @file src/components/imageEditor/widgets/Rotate/Tool.svelte * @component * Rotate tool for rotating
and flipping images */`);
	return (X(y, I), vt(T));
}
const Ya = { key: 'rotate', title: 'Rotate', icon: 'mdi:rotate-right', tool: Xa, controls: ke },
	Ye = Ya,
	Ha = Object.freeze(Object.defineProperty({ __proto__: null, default: Ye, editorWidget: Ye }, Symbol.toStringTag, { value: 'Module' }));
var Ba = K('<button class="btn-sm"><iconify-icon></iconify-icon></button>', 2),
	Va = K(
		'<div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <span class="text-sm">Position:</span> <div class="btn-group preset-outlined-surface-500"></div> <div class="grow"></div> <button class="btn preset-outlined-error-500"><iconify-icon></iconify-icon> <span>Delete</span></button>',
		3
	),
	Ka = K(
		'<div class="flex w-full items-center gap-4"><button class="btn preset-outlined-surface-500"><iconify-icon></iconify-icon> <span>Add Watermark</span></button> <!></div>',
		2
	);
function He(y, e) {
	pt(e, !0);
	const i = [
		{ value: 'top-left', icon: 'mdi:align-vertical-top' },
		{ value: 'top-center', icon: 'mdi:align-vertical-center' },
		{ value: 'top-right', icon: 'mdi:align-vertical-top' },
		{ value: 'center-left', icon: 'mdi:align-horizontal-left' },
		{ value: 'center', icon: 'mdi:align-horizontal-center' },
		{ value: 'center-right', icon: 'mdi:align-horizontal-right' },
		{ value: 'bottom-left', icon: 'mdi:align-vertical-bottom' },
		{ value: 'bottom-center', icon: 'mdi:align-vertical-center' },
		{ value: 'bottom-right', icon: 'mdi:align-vertical-bottom' }
	];
	var s = Ka(),
		r = o(s);
	r.__click = function (...b) {
		e.onAddWatermark?.apply(this, b);
	};
	var l = o(r);
	(w(l, 'icon', 'mdi:plus-box-outline'), ht(2), n(r));
	var u = h(r, 2);
	{
		var a = (b) => {
			var R = Va(),
				k = h(Rt(R), 4);
			(de(
				k,
				21,
				() => i,
				Se,
				(T, I) => {
					var v = Ba();
					v.__click = () => e.onPositionChange(t(I).value);
					var S = o(v);
					(Z(() => w(S, 'icon', t(I).icon)), n(v), Z(() => bt(v, 'title', t(I).value)), X(T, v));
				}
			),
				n(k));
			var g = h(k, 4);
			g.__click = function (...T) {
				e.onDeleteWatermark?.apply(this, T);
			};
			var _ = o(g);
			(w(_, 'icon', 'mdi:delete-outline'), ht(2), n(g), X(b, R));
		};
		rt(u, (b) => {
			e.hasSelection && b(a);
		});
	}
	(n(s), X(y, s), vt());
}
At(['click']);
class Be {
	id;
	node;
	layer;
	imageGroup;
	objectUrl = null;
	_onSelect = null;
	_onDestroy = null;
	constructor(e) {
		((this.id = e.id),
			(this.layer = e.layer),
			(this.imageGroup = e.imageGroup),
			(this.node = new W.Image({ image: void 0, draggable: !0, name: 'watermark' })),
			this.layer.add(this.node),
			this.node.zIndex(5),
			this.node.on('click tap', (i) => {
				((i.cancelBubble = !0), this._onSelect?.());
			}));
	}
	loadImage(e, i) {
		return new Promise((s, r) => {
			this.objectUrl = URL.createObjectURL(e);
			const l = new Image();
			((l.onload = () => {
				const u = (i.stageWidth * 0.2) / l.width,
					a = l.width * u,
					b = l.height * u,
					R = i.stageWidth / 2 - a / 2,
					k = i.stageHeight / 2 - b / 2;
				(this.node.setAttrs({ image: l, x: R, y: k, width: a, height: b, opacity: i.opacity }), this.layer.batchDraw(), s());
			}),
				(l.onerror = (u) => {
					r(u);
				}),
				(l.src = this.objectUrl));
		});
	}
	setOpacity(e) {
		(this.node.opacity(e), this.layer.batchDraw());
	}
	snapTo(e) {
		const i = this.layer.getStage(),
			s = this.imageGroup.getClientRect(),
			r = this.node.getClientRect(),
			l = 10;
		let u, a;
		(e.startsWith('t') ? (a = s.y + l) : e.startsWith('c') ? (a = s.y + s.height / 2 - r.height / 2) : (a = s.y + s.height - r.height - l),
			e.endsWith('l') ? (u = s.x + l) : e.endsWith('c') ? (u = s.x + s.width / 2 - r.width / 2) : (u = s.x + s.width - r.width - l));
		const R = i.getAbsoluteTransform().copy().invert().point({ x: u, y: a });
		(this.node.position(R), this.layer.batchDraw());
	}
	disableInteraction() {
		this.node.draggable(!1);
	}
	destroy() {
		(this.node.off('click tap'), this.node.destroy(), this.objectUrl && URL.revokeObjectURL(this.objectUrl), this._onDestroy?.());
	}
	onSelect(e) {
		this._onSelect = e;
	}
	onDestroy(e) {
		this._onDestroy = e;
	}
}
var Ja = K('<input type="file" accept="image/png, image/svg+xml" class="hidden"/>');
function qa(y, e) {
	pt(e, !0);
	let i = Y(Ht([])),
		s = Y(null),
		r = Y(null),
		l = Y(0.8),
		u,
		a = Y(!1),
		b = Y(!1);
	const R = si('watermarkPreset');
	wt(() => {
		if (d.state.activeState === 'watermark') {
			k();
			const z = R?.();
			(z?.url && t(i).length === 0 && !t(b) && (f(b, !0), T(z)),
				d.setToolbarControls({
					component: He,
					props: {
						hasSelection: !!t(s),
						onAddWatermark: () => u?.click(),
						onDeleteWatermark: () => x(),
						onPositionChange: (J) => t(s)?.snapTo(J),
						onApply: () => C()
					}
				}));
		} else (g(), f(b, !1), d.state.toolbarControls?.component === He && d.setToolbarControls(null));
	});
	function k() {
		const { stage: G, layer: z } = d.state;
		!G || !z || t(a) || (f(a, !0), t(r) || f(r, Ze(z), !0), G.on('click.watermark tap.watermark', _), (G.container().style.cursor = 'default'));
	}
	function g() {
		const { stage: G } = d.state;
		!G || !t(a) || (f(a, !1), G.off('click.watermark tap.watermark'), G.container() && (G.container().style.cursor = 'default'), S());
	}
	function _(G) {
		G.target === G.target.getStage() && S();
	}
	async function T(G) {
		const { stage: z, layer: J, imageNode: lt, imageGroup: et } = d.state;
		if (!(!z || !J || !lt || !et))
			try {
				const $ = await fetch(G.url);
				if (!$.ok) {
					console.warn('Failed to fetch preset watermark:', G.url);
					return;
				}
				const P = await $.blob(),
					V = G.url.split('/').pop() || 'preset-watermark.png',
					q = new File([P], V, { type: P.type || 'image/png' }),
					p = new Be({ id: crypto.randomUUID(), layer: J, imageGroup: et });
				(p.onSelect(() => v(p)),
					p.onDestroy(() => {
						(f(
							i,
							t(i).filter((D) => D.id !== p.id),
							!0
						),
							t(s)?.id === p.id && S());
					}),
					f(i, [...t(i), p], !0),
					v(p));
				const N = typeof G.scale == 'number' && G.scale > 1 ? G.scale / 100 : (G.scale ?? 0.8);
				(await p.loadImage(q, { opacity: N, stageWidth: z.width(), stageHeight: z.height() }),
					G.position && p.snapTo(G.position),
					ce(t(r), p.node),
					J.batchDraw());
			} catch ($) {
				console.error('Failed to load preset watermark', $);
			}
	}
	async function I(G) {
		const { stage: z, layer: J, imageNode: lt, imageGroup: et } = d.state;
		if (!z || !J || !lt || !et) return;
		const $ = new Be({ id: crypto.randomUUID(), layer: J, imageGroup: et });
		($.onSelect(() => v($)),
			$.onDestroy(() => {
				(f(
					i,
					t(i).filter((P) => P.id !== $.id),
					!0
				),
					t(s)?.id === $.id && S());
			}),
			f(i, [...t(i), $], !0),
			v($));
		try {
			(await $.loadImage(G, { opacity: t(l), stageWidth: z.width(), stageHeight: z.height() }), ce(t(r), $.node), J.batchDraw());
		} catch (P) {
			(console.error('Failed to load watermark image', P), $.destroy());
		}
	}
	function v(G) {
		(f(s, G, !0), t(r) && (ce(t(r), G.node), f(l, G.node.opacity(), !0)));
	}
	function S() {
		(f(s, null), t(r) && ce(t(r), null));
	}
	function x() {
		t(s) && t(s).destroy();
	}
	function c(G = !0) {
		(S(), G ? ([...t(i)].forEach((z) => z.destroy()), f(i, [], !0)) : t(i).forEach((z) => z.disableInteraction()), d.state.layer?.batchDraw());
	}
	function C() {
		(d.takeSnapshot(), d.setActiveState(''));
	}
	function F(G) {
		const z = G.target;
		(z.files && z.files.length > 0 && I(z.files[0]), (z.value = ''));
	}
	function A() {
		try {
			(g(), c(!0), t(r)?.destroy(), f(r, null));
		} catch {}
	}
	function L() {}
	function m() {
		A();
	}
	var M = { cleanup: A, saveState: L, beforeExit: m },
		O = Ja();
	return (
		(O.__change = F),
		ue(
			O,
			(G) => (u = G),
			() => u
		),
		X(y, O),
		vt(M)
	);
}
At(['change']);
const Za = { key: 'watermark', title: 'Watermark', icon: 'mdi:copyright', tool: qa },
	Qa = Object.freeze(Object.defineProperty({ __proto__: null, default: Za }, Symbol.toStringTag, { value: 'Module' })),
	$a = Object.assign({
		'./Annotate/index.ts': ya,
		'./Blur/index.ts': Sa,
		'./Crop/index.ts': Fa,
		'./FineTune/index.ts': Ma,
		'./FocalPoint/index.ts': Ua,
		'./Rotate/index.ts': Ha,
		'./Watermark/index.ts': Qa
	}),
	Ce = Object.values($a)
		.map((y) => {
			const e = y;
			return e.default ?? e.editorWidget;
		})
		.filter((y) => !!y);
var tn = K('<div class="text-[10px] text-surface-300"> </div>'),
	en = K(
		'<button><div class="tool-icon flex items-center justify-center"><iconify-icon></iconify-icon></div> <span class="tool-label text-[10px] font-medium leading-none lg:text-xs"> </span> <div class="tooltip pointer-events-none absolute left-full top-1/2 z-50 ml-2 -translate-y-1/2 whitespace-nowrap rounded bg-surface-900 px-2 py-1 text-xs text-white opacity-0 transition-opacity duration-200 group-hover:opacity-100 dark:bg-surface-700 shadow-lg"><div class="font-medium"> </div> <!> <div class="absolute -left-1 top-1/2 -mt-1 h-2 w-2 -rotate-45 bg-surface-900 dark:bg-surface-700"></div></div></button>',
		2
	),
	an = K(
		'<div class="no-image-hint flex flex-col items-center gap-1 p-2 text-center"><iconify-icon></iconify-icon> <span class="text-xs text-surface-500 dark:text-surface-50">Upload an image to enable tools</span></div>',
		2
	),
	nn = K(
		'<div class="editor-sidebar flex w-20 flex-col border-r lg:w-24 svelte-1ux7yyb"><div class="sidebar-tools flex flex-1 flex-col gap-1 p-1.5 lg:p-2 max-lg:gap-0.5 max-lg:p-1"></div> <div class="sidebar-footer border-t p-2 svelte-1ux7yyb"><!></div></div>'
	);
function on(y, e) {
	pt(e, !0);
	const i = dt(e, 'hasImage', 3, !1),
		s = [...Ce.map((g) => ({ id: g.key, name: g.title, icon: g.icon ?? 'mdi:cog', description: '' }))];
	function r(g) {
		i() && e.onToolSelect(g.id);
	}
	function l(g) {
		return e.activeState === g.id;
	}
	var u = nn(),
		a = o(u);
	(de(
		a,
		21,
		() => s,
		Se,
		(g, _) => {
			var T = en();
			let I;
			T.__click = () => r(t(_));
			var v = o(T),
				S = o(v);
			(Z(() => w(S, 'icon', t(_).icon)), w(S, 'width', '24'), n(v));
			var x = h(v, 2),
				c = o(x, !0);
			n(x);
			var C = h(x, 2),
				F = o(C),
				A = o(F, !0);
			n(F);
			var L = h(F, 2);
			{
				var m = (M) => {
					var O = tn(),
						G = o(O, !0);
					(n(O), Z(() => Q(G, t(_).description)), X(M, O));
				};
				rt(L, (M) => {
					t(_).description && M(m);
				});
			}
			(ht(2),
				n(C),
				n(T),
				Z(
					(M) => {
						((I = nt(T, 1, 'btn preset-filled-primary-500 group relative flex flex-col items-center justify-center gap-1 py-2', null, I, M)),
							bt(T, 'aria-label', t(_).name),
							(T.disabled = !i()),
							Q(c, t(_).name),
							Q(A, t(_).name));
					},
					[
						() => ({
							active: l(t(_)),
							disabled: !i(),
							'bg-primary-500': l(t(_)),
							'text-white': l(t(_)),
							'shadow-md': l(t(_)),
							'hover:bg-primary-600': l(t(_)),
							'cursor-not-allowed': !i(),
							'opacity-50': !i(),
							'bg-transparent': !i()
						})
					]
				),
				X(g, T));
		}
	),
		n(a));
	var b = h(a, 2),
		R = o(b);
	{
		var k = (g) => {
			var _ = an(),
				T = o(_);
			(w(T, 'icon', 'mdi:information-outline'), w(T, 'width', '16'), nt(T, 1, 'text-surface-400'), ht(2), n(_), X(g, _));
		};
		rt(R, (g) => {
			i() || g(k);
		});
	}
	(n(b), n(u), X(y, u), vt());
}
At(['click']);
var rn = K(
		'<div class="empty-state pointer-events-none absolute inset-0 z-10 flex items-center justify-center svelte-68xzn3"><div class="empty-state-content flex max-w-md flex-col items-center gap-6 p-8 text-center max-md:p-6"><div class="empty-icon flex h-20 w-20 items-center justify-center rounded-full bg-surface-200 ring-4 ring-surface-300 dark:bg-surface-700 dark:ring-surface-600 max-md:h-16 max-md:w-16"><iconify-icon></iconify-icon></div> <div class="empty-text"><h3 class="mb-2 text-lg font-medium text-surface-700 dark:text-surface-300 max-md:text-base">No Image Selected</h3> <p class="text-sm text-surface-500 dark:text-surface-50 max-md:text-xs">Upload an image to start editing</p></div> <div class="empty-hints flex flex-col gap-2"><div class="hint-item flex items-center justify-center gap-2"><iconify-icon></iconify-icon> <span class="text-xs text-surface-500 dark:text-surface-50 max-md:text-[10px]">Drag & drop supported</span></div> <div class="hint-item flex items-center justify-center gap-2"><iconify-icon></iconify-icon> <span class="text-xs text-surface-500 dark:text-surface-50 max-md:text-[10px]">PNG, JPG, WebP, GIF</span></div></div></div></div>',
		2
	),
	sn = K(
		'<div class="loading-overlay absolute inset-0 flex flex-col items-center justify-center gap-3 bg-surface-50/80 backdrop-blur-sm dark:bg-surface-900/80 z-20"><div class="loading-spinner flex h-12 w-12 items-center justify-center rounded-full bg-white shadow-lg dark:bg-surface-800"><iconify-icon></iconify-icon></div> <span class="text-sm text-surface-600 dark:text-surface-300"> </span></div>',
		2
	),
	cn = K(
		'<div class="editor-canvas-wrapper relative flex-1 overflow-hidden rounded-lg border border-surface-200 transition-all duration-300 ease-in-out focus-within:ring-2 focus-within:ring-primary-500 focus-within:ring-offset-2 focus-within:ring-offset-surface-50 dark:focus-within:ring-offset-surface-900 md:rounded-lg md:border md:border-surface-200 max-md:rounded-none max-md:border-0 max-md:border-b max-md:border-t svelte-68xzn3"><div class="canvas-container h-full w-full transition-all duration-300 ease-in-out svelte-68xzn3"></div> <!> <!> <!></div>'
	);
function ln(y, e) {
	pt(e, !0);
	let i = dt(e, 'hasImage', 3, !1),
		s = dt(e, 'isLoading', 3, !1),
		r = dt(e, 'loadingMessage', 3, 'Loading...'),
		l = dt(e, 'containerRef', 15),
		u = Y(!1);
	wt(() => {
		f(u, !0);
	});
	var a = cn(),
		b = o(a);
	ue(
		b,
		(I) => l(I),
		() => l()
	);
	var R = h(b, 2);
	{
		var k = (I) => {
			var v = rn(),
				S = o(v),
				x = o(S),
				c = o(x);
			(w(c, 'icon', 'mdi:image-plus'), w(c, 'width', '48'), nt(c, 1, 'text-surface-400 dark:text-surface-500'), n(x));
			var C = h(x, 4),
				F = o(C),
				A = o(F);
			(w(A, 'icon', 'mdi:gesture-tap'), w(A, 'width', '16'), nt(A, 1, 'text-surface-400'), ht(2), n(F));
			var L = h(F, 2),
				m = o(L);
			(w(m, 'icon', 'mdi:file-image'), w(m, 'width', '16'), nt(m, 1, 'text-surface-400'), ht(2), n(L), n(C), n(S), n(v), X(I, v));
		};
		rt(R, (I) => {
			i() || I(k);
		});
	}
	var g = h(R, 2);
	Gi(g, () => e.children ?? ci);
	var _ = h(g, 2);
	{
		var T = (I) => {
			var v = sn(),
				S = o(v),
				x = o(S);
			(w(x, 'icon', 'mdi:loading'), w(x, 'width', '32'), nt(x, 1, 'animate-spin text-primary-500'), n(S));
			var c = h(S, 2),
				C = o(c, !0);
			(n(c),
				n(v),
				Z(() => Q(C, r())),
				qt(
					3,
					v,
					() => te,
					() => ({ duration: 200 })
				),
				X(I, v));
		};
		rt(_, (I) => {
			((i() && !t(u)) || s()) && I(T);
		});
	}
	(n(a), X(y, a), vt());
}
var dn = K(
		'<div class="error-banner bg-error-50 border-l-4 border-error-500 p-4 text-error-700 dark:bg-error-900/20 dark:text-error-300" role="alert"><div class="flex items-center gap-2"><iconify-icon></iconify-icon> <span> </span> <button class="ml-auto text-error-600 hover:text-error-800" aria-label="Dismiss error"><iconify-icon></iconify-icon></button></div></div>',
		2
	),
	un = K(
		'<div class="image-editor flex h-full w-full flex-col overflow-hidden" role="application" aria-label="Image editor"><!> <div class="editor-layout flex h-full overflow-hidden"><!> <div class="editor-main flex min-w-0 flex-1 flex-col"><div class="canvas-wrapper relative flex flex-1 flex-col"><!></div></div></div></div>'
	);
function fn(y, e) {
	pt(e, !0);
	const i = dt(e, 'imageFile', 3, null),
		s = dt(e, 'initialImageSrc', 3, ''),
		r = dt(e, 'onsave', 3, () => {}),
		l = dt(e, 'oncancel', 3, () => {});
	let u = Y(''),
		a = Y(void 0),
		b = Y(!1),
		R = Y(!1),
		k = Y(null),
		g = Y(null);
	const _ = d.state,
		T = yt(() => d.state.activeState),
		I = yt(() => !!_.imageNode),
		v = yt(() => {
			if (!t(T)) return null;
			const p = Ce.find((N) => N.key === t(T));
			return p?.tool ? p.tool : (t(T) === 'focalpoint' || Tt.warn(`Tool not found for state: ${t(T)}`), null);
		});
	(wt(() => () => {
		t(u) && t(u).startsWith('blob:') && URL.revokeObjectURL(t(u));
	}),
		wt(() => {
			t(a) &&
				!t(b) &&
				(s() || i()) &&
				(s()
					? (Tt.debug('Loading initial image from src:', s()), f(u, s()), S(t(u)))
					: i() && (Tt.debug('Loading initial image from file'), f(u, URL.createObjectURL(i()), !0), S(t(u), i())),
				f(b, !0));
		}));
	function S(p, N) {
		if (!t(a)) {
			(Tt.error('Container ref not available'), f(k, 'Container not ready'));
			return;
		}
		(f(R, !0), f(k, null));
		const D = new Image();
		try {
			const E = window.location.origin;
			new URL(p, E).origin !== E && (D.crossOrigin = 'anonymous');
		} catch {
			D.crossOrigin = 'anonymous';
		}
		((D.onerror = () => {
			(f(k, 'Failed to load image'), f(R, !1), Tt.error('Image load error'));
		}),
			(D.onload = () => {
				try {
					const E = t(a).clientWidth,
						U = t(a).clientHeight,
						H = d.state.stage;
					H && H.destroy();
					const at = new W.Stage({ container: t(a), width: E, height: U }),
						B = new W.Layer();
					at.add(B);
					const ut = (E * 0.8) / D.width,
						st = (U * 0.8) / D.height,
						ot = Math.min(ut, st),
						ct = new W.Image({ image: D, width: D.width, height: D.height, x: -D.width / 2, y: -D.height / 2 }),
						ft = new W.Group({ x: E / 2, y: U / 2, scaleX: ot, scaleY: ot });
					(ft.add(ct),
						B.add(ft),
						B.draw(),
						d.setStage(at),
						d.setLayer(B),
						d.setImageNode(ct),
						d.setImageGroup(ft),
						N && d.setFile(N),
						d.takeSnapshot(),
						f(R, !1));
				} catch (E) {
					(f(k, 'Failed to setup editor'), f(R, !1), Tt.error('Konva setup error:', E));
				}
			}),
			(D.src = p));
	}
	function x() {
		const { stage: p, imageGroup: N } = d.state;
		if (!p || !t(a)) return;
		const D = t(a).clientWidth,
			E = t(a).clientHeight;
		(p.width(D), p.height(E), N && N.position({ x: D / 2, y: E / 2 }), p.batchDraw());
	}
	function c(p) {
		const N = p.target;
		if (N.tagName === 'INPUT' || N.tagName === 'TEXTAREA' || N.contentEditable === 'true') return;
		const E = p.metaKey || p.ctrlKey,
			U = p.shiftKey;
		if (p.key === 'Escape') {
			const H = d.state.activeState;
			H && (d.saveToolState(), d.cleanupToolSpecific(H), d.setActiveState(''));
			return;
		}
		if (E && !U && p.key === 'z') {
			(p.preventDefault(), C());
			return;
		}
		if (E && U && p.key === 'z') {
			(p.preventDefault(), F());
			return;
		}
		if (p.key === 'Delete') {
			const H = d.state.activeState;
			(H === 'textoverlay' || H === 'shapeoverlay') && document.querySelector('.preset-filled-error-500.btn')?.click();
		}
	}
	function C() {
		if (!d.canUndoState) return;
		const p = d.state.activeState;
		p && (d.cleanupToolSpecific(p), d.setActiveState(''));
		const N = d.undoState();
		N && A(N);
	}
	function F() {
		if (!d.canRedoState) return;
		const p = d.state.activeState;
		p && (d.cleanupToolSpecific(p), d.setActiveState(''));
		const N = d.redoState();
		N && A(N);
	}
	function A(p) {
		const { stage: N, layer: D, imageNode: E, imageGroup: U } = d.state;
		if (!(!N || !D || !E || !U))
			try {
				d.cleanupTempNodes();
				const H = JSON.parse(p),
					at = H.stage && H.activeState !== void 0,
					B = at ? JSON.parse(H.stage) : H;
				(at && d.setActiveState(H.activeState), E.filters([]), E.clearCache());
				const ut = (ot) => {
						for (const ct of ot) {
							if (ct.className === 'Group' && ct.children?.some((ft) => ft.className === 'Image')) return ct;
							if (ct.children) {
								const ft = ut(ct.children);
								if (ft) return ft;
							}
						}
						return null;
					},
					st = ut(B.children || []);
				if (st && st.attrs) {
					U.setAttrs({
						x: st.attrs.x ?? N.width() / 2,
						y: st.attrs.y ?? N.height() / 2,
						scaleX: st.attrs.scaleX ?? 1,
						scaleY: st.attrs.scaleY ?? 1,
						rotation: st.attrs.rotation ?? 0
					});
					const ot = st.children.find((ct) => ct.className === 'Image');
					if (
						ot &&
						ot.attrs &&
						(E.setAttrs({
							cropX: ot.attrs.cropX,
							cropY: ot.attrs.cropY,
							cropWidth: ot.attrs.cropWidth,
							cropHeight: ot.attrs.cropHeight,
							width: ot.attrs.width,
							height: ot.attrs.height,
							x: ot.attrs.x,
							y: ot.attrs.y,
							cornerRadius: ot.attrs.cornerRadius ?? 0
						}),
						ot.attrs.filters?.length > 0)
					) {
						const ct = [];
						(ot.attrs.brightness !== void 0 && ct.push(W.Filters.Brighten),
							ot.attrs.contrast !== void 0 && ct.push(W.Filters.Contrast),
							(ot.attrs.saturation !== void 0 || ot.attrs.luminance !== void 0) && ct.push(W.Filters.HSL),
							E.filters(ct),
							E.setAttrs(ot.attrs),
							E.cache());
					}
				}
				(D.batchDraw(), N.batchDraw());
			} catch (H) {
				(Tt.error('Failed to restore state:', H), f(k, 'Failed to restore state'));
			}
	}
	async function L() {
		const { stage: p, file: N } = d.state;
		if (!p || !N) {
			f(k, 'Nothing to save');
			return;
		}
		(f(R, !0), f(k, null));
		try {
			d.hideAllUI();
			let D, E, U;
			try {
				if (((D = p.toDataURL({ mimeType: 'image/avif', quality: 0.85, pixelRatio: 1 })), D.startsWith('data:image/avif')))
					((E = 'image/avif'), (U = 'avif'), Tt.debug('Using AVIF format'));
				else throw new Error('AVIF not supported');
			} catch {
				(Tt.warn('AVIF not supported, using WebP'),
					(D = p.toDataURL({ mimeType: 'image/webp', quality: 0.95, pixelRatio: 1 })),
					(E = 'image/webp'),
					(U = 'webp'));
			}
			const at = await (await fetch(D)).blob(),
				ut = `edited-${new Date().toISOString().replace(/[:.]/g, '-')}.${U}`,
				st = new File([at], ut, { type: E });
			r()({ dataURL: D, file: st });
		} catch (D) {
			(Tt.error('Save error:', D), f(k, 'Failed to save image'));
		} finally {
			f(R, !1);
		}
	}
	function m() {
		l()();
	}
	function M(p) {
		const N = d.state.activeState;
		if (N && N !== p) {
			(d.saveToolState(), d.cleanupToolSpecific(N));
			const { stage: E, imageGroup: U } = d.state;
			if (E && U) {
				const H = E.width() / 2,
					at = E.height() / 2,
					B = U.x(),
					ut = U.y();
				(Math.abs(B - H) > 5 || Math.abs(ut - at) > 5) && U.position({ x: H, y: at });
			}
		}
		const D = N === p ? '' : p;
		(D !== '' && D !== N && f(g, d.undoState(!0), !0), d.setActiveState(D), D === '' && (d.setToolbarControls(null), f(g, null)));
	}
	function O() {
		const p = d.state.activeState;
		p && (t(g) && A(t(g)), d.cleanupToolSpecific(p), d.setActiveState(''), d.setToolbarControls(null), f(g, null));
	}
	(Ve(
		() => (
			d.reset(),
			window.addEventListener('resize', x),
			window.addEventListener('keydown', c),
			() => {
				(window.removeEventListener('resize', x), window.removeEventListener('keydown', c), d.cleanupTempNodes(), d.reset());
			}
		)
	),
		Ke(() => {
			t(u) && t(u).startsWith('blob:') && URL.revokeObjectURL(t(u));
		}));
	var G = { handleUndo: C, handleRedo: F, handleSave: L, handleCancel: m, handleCancelTool: O },
		z = un(),
		J = o(z);
	{
		var lt = (p) => {
			var N = dn(),
				D = o(N),
				E = o(D);
			(w(E, 'icon', 'mdi:alert-circle'), w(E, 'width', '20'));
			var U = h(E, 2),
				H = o(U, !0);
			n(U);
			var at = h(U, 2);
			at.__click = () => f(k, null);
			var B = o(at);
			(w(B, 'icon', 'mdi:close'), w(B, 'width', '18'), n(at), n(D), n(N), Z(() => Q(H, t(k))), X(p, N));
		};
		rt(J, (p) => {
			t(k) && p(lt);
		});
	}
	var et = h(J, 2),
		$ = o(et);
	{
		let p = yt(() => t(T) ?? '');
		on($, {
			get activeState() {
				return t(p);
			},
			onToolSelect: M,
			get hasImage() {
				return t(I);
			}
		});
	}
	var P = h($, 2),
		V = o(P),
		q = o(V);
	return (
		ln(q, {
			get hasImage() {
				return t(I);
			},
			get containerRef() {
				return t(a);
			},
			set containerRef(p) {
				f(a, p, !0);
			},
			children: (p, N) => {
				var D = Ut(),
					E = Rt(D);
				{
					var U = (H) => {
						var at = Ut(),
							B = Rt(at);
						{
							var ut = (st) => {
								const ot = yt(() => t(v));
								var ct = Ut(),
									ft = Rt(ct);
								(Je(
									ft,
									() => t(ot),
									(kt, Gt) => {
										Gt(kt, { onCancel: O });
									}
								),
									X(st, ct));
							};
							rt(B, (st) => {
								t(v) && st(ut);
							});
						}
						X(H, at);
					};
					rt(E, (H) => {
						_.stage && _.layer && _.imageNode && _.imageGroup && H(U);
					});
				}
				X(p, D);
			},
			$$slots: { default: !0 }
		}),
		n(V),
		n(P),
		n(et),
		n(z),
		Z(() => bt(z, 'aria-busy', t(R))),
		X(y, z),
		vt(G)
	);
}
At(['click']);
var hn = K(
		'<div class="absolute bottom-full left-0 right-0 flex items-center justify-center bg-error-500 py-1 text-xs font-medium text-white"><iconify-icon></iconify-icon> </div>',
		2
	),
	pn = K(
		'<div class="border-t border-surface-300 bg-surface-100 p-2 shadow-lg dark:text-surface-50 dark:bg-surface-800 svelte-1k8todc"><div class="mx-auto flex h-16 max-w-7xl items-center gap-4 px-4"><div class="flex h-full flex-1 items-center gap-3"><!></div></div> <!></div>'
	);
function vn(y, e) {
	pt(e, !0);
	const i = yt(() => d.state.toolbarControls);
	var s = pn(),
		r = o(s),
		l = o(r),
		u = o(l);
	{
		var a = (k) => {
			const g = yt(() => t(i).component);
			var _ = Ut(),
				T = Rt(_);
			{
				var I = (v) => {
					var S = Ut(),
						x = Rt(S);
					(Je(
						x,
						() => t(g),
						(c, C) => {
							C(
								c,
								pi(() => t(i).props)
							);
						}
					),
						X(v, S));
				};
				rt(T, (v) => {
					t(g) && v(I);
				});
			}
			X(k, _);
		};
		rt(u, (k) => {
			t(i)?.component && k(a);
		});
	}
	(n(l), n(r));
	var b = h(r, 2);
	{
		var R = (k) => {
			var g = hn(),
				_ = o(g);
			(w(_, 'icon', 'mdi:alert-circle'), w(_, 'width', '14'), nt(_, 1, 'mr-1'));
			var T = h(_);
			(n(g),
				Z(() => Q(T, ` ${d.state.error ?? ''}`)),
				qt(
					3,
					g,
					() => te,
					() => ({ duration: 200 })
				),
				X(k, g));
		};
		rt(b, (k) => {
			d.state.error && k(R);
		});
	}
	(n(s), X(y, s), vt());
}
var mn = K('<iconify-icon></iconify-icon>', 2),
	gn = K(
		'<span class="max-sm:hidden text-surface-400">:</span> <span class="flex items-center gap-1 text-primary-600 dark:text-primary-400 font-extrabold"><!> <span> </span></span>',
		1
	),
	bn = K('<span class="sm:hidden"> </span>'),
	yn = K(
		'<div class="flex items-center gap-2 text-primary-500 shrink-0"><iconify-icon></iconify-icon></div> <div class="flex flex-col min-w-0"><h2 id="image-editor-title" class="text-sm lg:text-lg font-bold truncate leading-tight flex items-center gap-1.5"><span class="max-sm:hidden"> </span> <!></h2></div>',
		3
	),
	_n = K('<h2 id="image-editor-title" class="text-tertiary-500 dark:text-primary-400 text-lg font-semibold shrink-0">Image Editor</h2>'),
	xn = K(
		'<div class="relative flex h-full min-h-[500px] w-full flex-col overflow-hidden bg-surface-100 shadow-xl dark:bg-surface-800"><header class="flex items-center justify-between border-b border-surface-300 p-3 lg:p-4 dark:text-surface-50 bg-surface-100/80 dark:bg-surface-800/80 sticky top-0 z-10"><div class="flex items-center gap-3 overflow-hidden"><!></div> <div class="flex items-center gap-2"><button class="btn-icon preset-outlined-surface-500" title="Undo (Ctrl+Z)" aria-label="Undo"><iconify-icon></iconify-icon></button> <button class="btn-icon preset-outlined-surface-500" title="Redo (Ctrl+Shift+Z)" aria-label="Redo"><iconify-icon></iconify-icon></button> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <button class="btn preset-outlined-surface-500"> </button> <button class="btn preset-filled-tertiary-500 dark:preset-filled-primary-500"><iconify-icon></iconify-icon> <span>Save</span></button> <div class="h-6 w-px bg-surface-300 dark:bg-surface-600"></div> <button class="btn-icon preset-outlined-surface-500" aria-label="Close"><iconify-icon></iconify-icon></button></div></header> <main class="flex-1 overflow-auto bg-surface-50/50 dark:bg-surface-900/50"><!></main> <!></div>',
		2
	);
function wn(y, e) {
	pt(e, !0);
	let i = dt(e, 'image', 3, null),
		s = dt(e, 'watermarkPreset', 3, null),
		r = dt(e, 'onsave', 3, () => {}),
		l = dt(e, 'close', 3, () => {});
	li('watermarkPreset', () => s());
	let u = Y(void 0);
	const a = yt(() => d.state.activeState),
		b = yt(() => Ce.find((v) => v.key === t(a))),
		R = yt(() => {
			if (t(a) === 'finetune') {
				const v = d.state.toolbarControls?.props;
				if (v?.activeAdjustment) {
					const S = v.activeAdjustment;
					return { label: S.charAt(0).toUpperCase() + S.slice(1), icon: v.activeIcon };
				}
			}
			return null;
		});
	function k() {
		(d.canUndoState && !confirm('You have unsaved changes. Are you sure you want to close?')) || l()();
	}
	function g() {
		if (t(a)) (d.cleanupToolSpecific(t(a)), d.setActiveState(''));
		else {
			if (d.canUndoState && !confirm('You have unsaved changes. Are you sure you want to discard them?')) return;
			k();
		}
	}
	var _ = Ut(),
		T = Rt(_);
	{
		var I = (v) => {
			var S = xn(),
				x = o(S),
				c = o(x),
				C = o(c);
			{
				var F = (N) => {
						var D = yn(),
							E = Rt(D),
							U = o(E);
						(Z(() => w(U, 'icon', t(b).icon)), w(U, 'width', '24'), nt(U, 1, 'max-sm:width-[20px]'), n(E));
						var H = h(E, 2),
							at = o(H),
							B = o(at),
							ut = o(B, !0);
						n(B);
						var st = h(B, 2);
						{
							var ot = (ft) => {
									var kt = gn(),
										Gt = h(Rt(kt), 2),
										jt = o(Gt);
									{
										var Qt = (Xt) => {
											var Lt = mn();
											(Z(() => w(Lt, 'icon', t(R).icon)), w(Lt, 'width', '16'), nt(Lt, 1, 'lg:width-[20px]'), X(Xt, Lt));
										};
										rt(jt, (Xt) => {
											t(R).icon && Xt(Qt);
										});
									}
									var Bt = h(jt, 2),
										Vt = o(Bt, !0);
									(n(Bt), n(Gt), Z(() => Q(Vt, t(R).label)), X(ft, kt));
								},
								ct = (ft) => {
									var kt = bn(),
										Gt = o(kt, !0);
									(n(kt), Z(() => Q(Gt, t(b).title)), X(ft, kt));
								};
							rt(st, (ft) => {
								t(R) ? ft(ot) : ft(ct, !1);
							});
						}
						(n(at), n(H), Z(() => Q(ut, t(b).title)), X(N, D));
					},
					A = (N) => {
						var D = _n();
						X(N, D);
					};
				rt(C, (N) => {
					t(b) ? N(F) : N(A, !1);
				});
			}
			n(c);
			var L = h(c, 2),
				m = o(L);
			m.__click = () => t(u)?.handleUndo();
			var M = o(m);
			(w(M, 'icon', 'mdi:undo'), w(M, 'width', '20'), n(m));
			var O = h(m, 2);
			O.__click = () => t(u)?.handleRedo();
			var G = o(O);
			(w(G, 'icon', 'mdi:redo'), w(G, 'width', '20'), n(O));
			var z = h(O, 4);
			z.__click = g;
			var J = o(z, !0);
			n(z);
			var lt = h(z, 2);
			lt.__click = () => t(u)?.handleSave();
			var et = o(lt);
			(w(et, 'icon', 'mdi:content-save'), w(et, 'width', '18'), ht(2), n(lt));
			var $ = h(lt, 4);
			$.__click = k;
			var P = o($);
			(w(P, 'icon', 'mdi:close'), w(P, 'width', '24'), n($), n(L), n(x));
			var V = h(x, 2),
				q = o(V);
			{
				let N = yt(() => i()?.metadata?.focalPoint);
				ue(
					fn(q, {
						get initialImageSrc() {
							return i().url;
						},
						get focalPoint() {
							return t(N);
						},
						onsave: (D) => r()(D),
						oncancel: k
					}),
					(D) => f(u, D, !0),
					() => t(u)
				);
			}
			n(V);
			var p = h(V, 2);
			(vn(p, {}),
				n(S),
				Z(() => {
					((m.disabled = !d.canUndoState), (O.disabled = !d.canRedoState), Q(J, t(a) ? 'Exit Tool' : 'Cancel'));
				}),
				X(v, S));
		};
		rt(T, (v) => {
			i() && v(I);
		});
	}
	(X(y, _), vt());
}
At(['click']);
async function kn(y, e) {
	try {
		const i = await fetch(`/api/media/${encodeURIComponent(y)}`, {
			method: 'PATCH',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ metadata: e })
		});
		if (!i.ok) {
			const s = await i.text();
			throw new Error(`HTTP ${i.status}: ${s}`);
		}
		return await i.json();
	} catch (i) {
		throw (Tt.error('updateMediaMetadata failed', { id: y, error: i }), i);
	}
}
const Sn = async (y, e, i) => (
	y && y instanceof File && (y.path = e.path),
	i &&
		!(i instanceof File) &&
		y &&
		!(y instanceof File) &&
		y?._id !== i?._id &&
		i?._id &&
		Ge.value === 'edit' &&
		vi.add('media_images_remove', [i._id.toString()]),
	y || Ge.value === 'create' ? y : { _id: i?._id }
);
var Cn = K('<div><!></div>'),
	Tn = K('<div class="absolute cursor-move" role="button" tabindex="0" aria-label="Set focal point"><iconify-icon></iconify-icon></div>', 2),
	Rn = K('<div class="relative col-span-11 m-auto"><img alt="Preview" class="max-h-[200px] max-w-[500px] rounded"/> <!></div>'),
	An = K(
		'<div class="col-span-11 ml-2 grid grid-cols-2 gap-1 text-left"><p> </p> <p class="font-bold text-tertiary-500 dark:text-primary-500"> </p> <p>Path:</p> <p class="font-bold text-tertiary-500 dark:text-primary-500"> </p> <p> </p> <p class="font-bold text-tertiary-500 dark:text-primary-500"> </p> <p> </p> <p class="font-bold text-tertiary-500 dark:text-primary-500"> </p></div>'
	),
	Dn = K(
		'<div><div class="mx-2 flex flex-col gap-2"><div class="flex items-center justify-between gap-2"><p class="text-left"> <span class="text-tertiary-500 dark:text-primary-500"> </span></p> <p class="text-left"> <span class="text-tertiary-500 dark:text-primary-500"> </span></p></div> <div class="flex items-center justify-between"><!> <div class="col-span-1 flex flex-col items-end justify-between gap-2 p-2"><button aria-label="Edit image" class="preset-outlined-surface-500 btn-icon" title="Edit image"><iconify-icon></iconify-icon></button> <button aria-label="Flip" class="preset-outlined-surface-500 btn-icon" title="Flip details"><iconify-icon></iconify-icon></button> <button aria-label="Delete" class="preset-outlined-surface-500 btn-icon" title="Delete image"><iconify-icon></iconify-icon></button></div></div></div></div>',
		2
	),
	Fn = K('<p class="absolute -bottom-4 left-0 w-full text-center text-xs text-error-500" role="alert"> </p>'),
	En = K('<div class="relative mb-4 min-h-1"><!> <!> <!></div>');
function io(y, e) {
	pt(e, !0);
	let i = Y(!1),
		s = Y(null),
		r,
		l = Y(!1),
		u = dt(e, 'field', 7),
		a = dt(e, 'value', 15);
	const b = yt(() => u().watermark);
	wt(() => {
		a() === void 0 && Ne.value[re(u())] !== void 0 && a(Ne.value[re(u())]);
	});
	const R = ['image/png', 'image/jpeg', 'image/gif', 'image/webp', 'image/avif', 'image/svg+xml'],
		k = Li(
			zi(File),
			Mi((p) => R.includes(p.type), 'Invalid file format')
		),
		g = Pe({ width: se(), height: se(), url: $t() }),
		_ = Pe({ _id: $t(), name: $t(), type: $t(), size: se(), path: $t(), thumbnails: Oi($t(), g), createdAt: se(), updatedAt: se() }),
		T = Pi([k, _]);
	function I(p) {
		try {
			return (Ni(T, p), Ie.clearError(re(u())), null);
		} catch (N) {
			if (N.issues) {
				const E = N.issues[0]?.message || 'Invalid input';
				return (Ie.setError(re(u()), E), E);
			}
			return 'Invalid input';
		}
	}
	function v() {
		(r && clearTimeout(r),
			(r = window.setTimeout(() => {
				f(s, I(a()), !0);
			}, 300)));
	}
	async function S(p) {
		const { file: N } = p,
			D = new FormData();
		(D.append('processType', 'save'), D.append('files', N), t(b) && D.append('watermarkOptions', JSON.stringify(t(b))));
		try {
			const E = await fetch('/api/media/process', { method: 'POST', body: D });
			if (!E.ok) {
				const H = await E.json();
				throw new Error(H.error || 'Failed to save edited image');
			}
			const U = await E.json();
			if (!U.success || !U.data.data[0]?.success) throw new Error(U.data.data[0]?.error || 'Failed to process edited image');
			(a(U.data.data[0].data), f(l, !1));
		} catch (E) {
			Tt.error('Error saving edited image:', E);
		}
	}
	let x = Y(Ht({ x: 50, y: 50 })),
		c = Y(!1),
		C = Y(void 0);
	function F(p) {
		t(c) && t(C) && L(p, t(C));
	}
	function A() {
		t(c) && m();
	}
	(wt(() => {
		a() && !(a() instanceof File) && a().metadata?.focalPoint ? f(x, a().metadata.focalPoint, !0) : f(x, { x: 50, y: 50 }, !0);
	}),
		wt(
			() => (
				t(c)
					? (window.addEventListener('mousemove', F), window.addEventListener('mouseup', A))
					: (window.removeEventListener('mousemove', F), window.removeEventListener('mouseup', A)),
				() => {
					(window.removeEventListener('mousemove', F), window.removeEventListener('mouseup', A));
				}
			)
		));
	function L(p, N) {
		if (!t(c)) return;
		const D = N.getBoundingClientRect();
		let E = ((p.clientX - D.left) / D.width) * 100,
			U = ((p.clientY - D.top) / D.height) * 100;
		((t(x).x = Math.max(0, Math.min(100, E))), (t(x).y = Math.max(0, Math.min(100, U))));
	}
	async function m() {
		if ((f(c, !1), a() && !(a() instanceof File) && a()._id))
			try {
				await kn(a()._id, { focalPoint: t(x) });
			} catch (p) {
				Tt.error('Failed to save focal point', p);
			}
	}
	async function M() {
		return Sn(a(), u(), a());
	}
	function O(p) {
		return typeof p == 'number' ? p : typeof p == 'string' ? mi(p).getTime() : p.getTime();
	}
	var G = { WidgetDataExport: M },
		z = En(),
		J = o(z);
	{
		var lt = (p) => {
				var N = Cn();
				let D;
				var E = o(N);
				(aa(E, {
					onChange: v,
					get value() {
						return a();
					},
					set value(U) {
						a(U);
					},
					get multiple() {
						return u().multiupload;
					},
					set multiple(U) {
						u().multiupload = U;
					}
				}),
					n(N),
					Z(() => (D = nt(N, 1, 'rounded-lg border-2 border-dashed border-transparent', null, D, { '!border-error-500': !!t(s) }))),
					X(p, N));
			},
			et = (p) => {
				var N = Dn();
				let D;
				var E = o(N),
					U = o(E),
					H = o(U),
					at = o(H),
					B = h(at),
					ut = o(B, !0);
				(n(B), n(H));
				var st = h(H, 2),
					ot = o(st),
					ct = h(ot),
					ft = o(ct);
				(n(ct), n(st), n(U));
				var kt = h(U, 2),
					Gt = o(kt);
				{
					var jt = (it) => {
							var mt = Rn(),
								Dt = o(mt),
								Ft = h(Dt, 2);
							{
								var St = (Ct) => {
									var _t = Tn();
									_t.__mousedown = () => f(c, !0);
									var Mt = o(_t);
									(w(Mt, 'icon', 'mdi:plus-circle-outline'),
										w(Mt, 'width', '24'),
										nt(Mt, 1, 'text-primary-500 drop-shadow-lg'),
										n(_t),
										Z(() => hi(_t, `left: ${t(x).x}%; top: ${t(x).y}%; transform: translate(-50%, -50%);`)),
										X(Ct, _t));
								};
								rt(Ft, (Ct) => {
									a() && !(a() instanceof File) && Ct(St);
								});
							}
							(n(mt),
								ue(
									mt,
									(Ct) => f(C, Ct),
									() => t(C)
								),
								Z((Ct) => bt(Dt, 'src', Ct), [() => (a() instanceof File ? URL.createObjectURL(a()) : a().thumbnails?.sm?.url || a().url)]),
								X(it, mt));
						},
						Qt = (it) => {
							var mt = An(),
								Dt = o(mt),
								Ft = o(Dt, !0);
							n(Dt);
							var St = h(Dt, 2),
								Ct = o(St, !0);
							n(St);
							var _t = h(St, 4),
								Mt = o(_t, !0);
							n(_t);
							var Nt = h(_t, 2),
								Et = o(Nt, !0);
							n(Nt);
							var zt = h(Nt, 2),
								gt = o(zt, !0);
							n(zt);
							var Pt = h(zt, 2),
								Jt = o(Pt, !0);
							n(Pt);
							var Ot = h(Pt, 2),
								fe = o(Ot, !0);
							(n(Ot),
								n(mt),
								Z(
									(ve, ie, Kt, ae, ne) => {
										(Q(Ft, ve), Q(Ct, a().type), Q(Mt, a().path), Q(Et, ie), Q(gt, Kt), Q(Jt, ae), Q(fe, ne));
									},
									[
										() => Si(),
										() => Ci(),
										() => Ae(O(a() instanceof File ? a().lastModified : a().createdAt)),
										() => Ti(),
										() => Ae(O(a() instanceof File ? a().lastModified : a().updatedAt))
									]
								),
								X(it, mt));
						};
					rt(Gt, (it) => {
						t(i) ? it(Qt, !1) : it(jt);
					});
				}
				var Bt = h(Gt, 2),
					Vt = o(Bt);
				Vt.__click = () => f(l, !0);
				var Xt = o(Vt);
				(w(Xt, 'icon', 'material-symbols:edit'), w(Xt, 'width', '24'), nt(Xt, 1, 'text-primary-500'), n(Vt));
				var Lt = h(Vt, 2);
				Lt.__click = () => f(i, !t(i));
				var ee = o(Lt);
				(w(ee, 'icon', 'uiw:reload'), w(ee, 'width', '24'), n(Lt));
				var j = h(Lt, 2);
				j.__click = () => a(void 0);
				var tt = o(j);
				(w(tt, 'icon', 'material-symbols:delete-outline'),
					w(tt, 'width', '30'),
					nt(tt, 1, 'text-error-500'),
					n(j),
					n(Bt),
					n(kt),
					n(E),
					n(N),
					Z(
						(it, mt, Dt) => {
							((D = nt(
								N,
								1,
								'flex w-full max-w-full flex-col border-2 border-dashed border-surface-600 bg-surface-200 dark:border-surface-500 dark:bg-surface-700',
								null,
								D,
								{ error: !!t(s) }
							)),
								Q(at, `${it ?? ''} `),
								Q(ut, a() instanceof File ? a().name : a().path),
								Q(ot, `${mt ?? ''} `),
								Q(ft, `${Dt ?? ''} KB`),
								nt(
									ee,
									1,
									pe(t(i) ? ' rotate-90 text-yellow-500 transition-transform duration-300' : 'text-white  transition-transform duration-300')
								));
						},
						[() => wi(), () => ki(), () => ((a().size ?? 0) / 1024).toFixed(2)]
					),
					X(p, N));
			};
		rt(J, (p) => {
			a() ? p(et, !1) : p(lt);
		});
	}
	var $ = h(J, 2);
	{
		var P = (p) => {
			var N = Fn(),
				D = o(N, !0);
			(n(N),
				Z(
					(E) => {
						(bt(N, 'id', E), Q(D, t(s)));
					},
					[() => `${re(u())}-error`]
				),
				X(p, N));
		};
		rt($, (p) => {
			t(s) && p(P);
		});
	}
	var V = h($, 2);
	{
		var q = (p) => {
			{
				let N = yt(() => (a() instanceof File ? null : a()));
				wn(p, {
					get image() {
						return t(N);
					},
					get watermarkPreset() {
						return t(b);
					},
					onsave: S,
					close: () => f(l, !1)
				});
			}
		};
		rt(V, (p) => {
			t(l) && p(q);
		});
	}
	return (n(z), X(y, z), vt(G));
}
At(['mousedown', 'click']);
export { io as default };
//# sourceMappingURL=Cq1QVEmY.js.map
