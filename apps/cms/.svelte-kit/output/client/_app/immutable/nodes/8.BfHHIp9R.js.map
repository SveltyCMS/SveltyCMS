{"version":3,"file":"8.BfHHIp9R.js","sources":["../../../../../../src/routes/config/collectionbuilder/NestedContent/TreeViewNode.svelte","../../../../../../../../shared/utils/src/treeViewAdapter.ts","../../../../../../src/routes/config/collectionbuilder/NestedContent/TreeViewBoard.svelte","../../../../../../src/routes/config/collectionbuilder/NestedContent/ModalCategory.svelte","../../../../../../src/routes/config/collectionbuilder/+page.svelte"],"sourcesContent":["<!-- \n@files src/routes/(app)/config/collectionbuilder/NestedContent/TreeViewNode.svelte\n@component\n**Enhanced TreeView Node with improved design and drag & drop support**\n\nFeatures:\t\n- Modern card-like design with depth shadows\n- Smooth animations and transitions\n- Clear visual hierarchy between categories and collections\n- Action buttons with hover states\n- Drag handle with visual feedback\n-->\n\n<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\timport type { TreeViewItem } from '@shared/utils/treeViewAdapter';\n\timport { screen } from '@shared/stores/screenSizeStore.svelte';\n\t// Tree View\n\n\tinterface Props {\n\t\titem: TreeViewItem & { hasChildren?: boolean };\n\t\tisOpen?: boolean;\n\t\ttoggle?: () => void;\n\t\tonEditCategory: (item: TreeViewItem) => void;\n\t\tonDelete?: (item: TreeViewItem) => void;\n\t\tonDuplicate?: (item: TreeViewItem) => void;\n\t}\n\n\tlet { item, isOpen, toggle, onEditCategory, onDelete, onDuplicate }: Props = $props();\n\n\t// Computed properties\n\tconst name = $derived(item.name || 'Untitled');\n\tconst icon = $derived(item.icon || (item.nodeType === 'category' ? 'bi:folder' : 'bi:collection'));\n\tconst isCategory = $derived(item.nodeType === 'category');\n\n\t// Enhanced styling with better visual hierarchy\n\tconst containerClass = $derived(\n\t\tisCategory\n\t\t\t? 'group w-full min-h-[48px] p-2 sm:p-3 rounded bg-gradient-to-r from-tertiary-500/10 to-tertiary-600/5 border-2 border-tertiary-500/30 flex items-center gap-2 sm:gap-3 mb-2 cursor-pointer hover:border-tertiary-500 hover:shadow-lg hover:from-tertiary-500/20 hover:to-tertiary-600/10 transition-all duration-300 ease-out min-w-0 overflow-hidden'\n\t\t\t: 'group w-full min-h-[48px] p-2 sm:p-3 rounded bg-gradient-to-r from-surface-100 to-surface-50 dark:from-surface-700 dark:to-surface-800 border-2 border-l-4 border-surface-500/40 border-l-surface-500 flex items-center gap-2 sm:gap-3 mb-2 cursor-pointer hover:border-surface-500 hover:shadow-lg hover:translate-x-1 transition-all duration-300 ease-out min-w-0 overflow-hidden'\n\t);\n\n\tconst iconClass = $derived(\n\t\tisCategory\n\t\t\t? 'text-tertiary-500 group-hover:text-tertiary-600 transition-colors duration-200'\n\t\t\t: 'text-error-500 group-hover:text-error-600 transition-colors duration-200'\n\t);\n\n\tfunction handleClick(e: MouseEvent) {\n\t\tif ((e.target as HTMLElement).closest('button')) return;\n\t\ttoggle?.();\n\t}\n</script>\n\n<div\n\tclass={containerClass}\n\tonclick={handleClick}\n\tonkeydown={(e) => e.key === 'Enter' && handleClick(e as unknown as MouseEvent)}\n\trole=\"button\"\n\ttabindex=\"0\"\n>\n\t<!-- Expand/Collapse Toggle -->\n\t{#if item.hasChildren || isCategory}\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tclass=\"btn-icon preset-tonal hover:preset-filled transition-all duration-200 hover:scale-110\"\n\t\t\tonclick={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tconsole.log('Toggle clicked', { toggle, isOpen });\n\t\t\t\ttoggle?.();\n\t\t\t}}\n\t\t\taria-label={isOpen ? 'Collapse' : 'Expand'}\n\t\t>\n\t\t\t<iconify-icon icon={isOpen ? 'bi:chevron-down' : 'bi:chevron-right'} width=\"20\" class=\"transition-transform duration-200\"></iconify-icon>\n\t\t</button>\n\t{:else}\n\t\t<div class=\"w-10\"></div>\n\t{/if}\n\n\t<!-- Icon with Animation -->\n\t<div class=\"relative\">\n\t\t<iconify-icon {icon} width=\"24\" class={iconClass}></iconify-icon>\n\t\t{#if isCategory}\n\t\t\t<div class=\"absolute -top-1 -right-1 w-2 h-2 bg-tertiary-500 rounded-full animate-pulse\"></div>\n\t\t{/if}\n\t</div>\n\n\t<!-- Name & Badge Section -->\n\t<div class=\"flex flex-col gap-1 min-w-0 shrink\">\n\t\t<div class=\"flex items-center gap-1 sm:gap-2 flex-wrap\">\n\t\t\t<span class=\"font-bold text-sm sm:text-base leading-none truncate\">{name}</span>\n\t\t\t{#if isCategory}\n\t\t\t\t<span\n\t\t\t\t\tclass=\"badge font-semibold bg-tertiary-500 text-white text-[9px] sm:text-[10px] px-1.5 sm:px-2.5 py-0.5 sm:py-1 rounded-sm uppercase shadow-sm\"\n\t\t\t\t>\n\t\t\t\t\tCategory\n\t\t\t\t</span>\n\t\t\t{:else}\n\t\t\t\t<span\n\t\t\t\t\tclass=\"badge font-semibold bg-surface-500 text-white text-[9px] sm:text-[10px] px-1.5 sm:px-2.5 py-0.5 sm:py-1 rounded-sm uppercase shadow-sm\"\n\t\t\t\t>\n\t\t\t\t\tCollection\n\t\t\t\t</span>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t<!-- Description with Tooltip - hidden on mobile -->\n\t{#if screen.isDesktop}\n\t\t<div class=\"flex-1 px-4 min-w-0 flex justify-start\">\n\t\t\t{#if item.description}\n\t\t\t\t<div class=\"relative group/desc\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"italic text-sm opacity-70 truncate w-full max-w-[500px] text-left hover:opacity-100 transition-opacity duration-200\"\n\t\t\t\t\t\ttitle={item.description}\n\t\t\t\t\t>\n\t\t\t\t\t\t{item.description}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{/if}\n\n\t<!-- Slug Badge -->\n\t{#if item.slug}\n\t\t<span class=\"badge bg-surface-200 dark:bg-surface-700 text-surface-900 dark:text-surface-100 px-3 py-1 rounded-sm font-mono text-xs shadow-sm\">\n\t\t\t/{item.slug}\n\t\t</span>\n\t{/if}\n\n\t<!-- Action Buttons with Enhanced Design -->\n\t<div class=\"flex gap-1 sm:gap-2 ml-auto shrink-0 transition-opacity duration-200\">\n\t\t<!-- Edit Button -->\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tclass=\"btn-icon preset-tonal hover:preset-filled rounded transition-all duration-200 hover:scale-110\"\n\t\t\tonclick={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tif (isCategory) {\n\t\t\t\t\tonEditCategory(item);\n\t\t\t\t} else {\n\t\t\t\t\tgoto(`/config/collectionbuilder/edit/${item.id}`);\n\t\t\t\t}\n\t\t\t}}\n\t\t\ttitle=\"Edit\"\n\t\t>\n\t\t\t<iconify-icon icon=\"mdi:pencil-outline\" width=\"18\" class=\"text-primary-500\"></iconify-icon>\n\t\t</button>\n\n\t\t<!-- Duplicate Button -->\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tclass=\"btn-icon preset-tonal hover:preset-filled rounded transition-all duration-200 hover:scale-110\"\n\t\t\tonclick={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tonDuplicate?.(item);\n\t\t\t}}\n\t\t\ttitle=\"Duplicate\"\n\t\t>\n\t\t\t<iconify-icon icon=\"mdi:content-copy\" width=\"18\" class=\"text-tertiary-500\"></iconify-icon>\n\t\t</button>\n\n\t\t<!-- Delete Button -->\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tclass=\"btn-icon preset-tonal hover:preset-filled rounded transition-all duration-200 hover:scale-110\"\n\t\t\tonclick={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tonDelete?.(item);\n\t\t\t}}\n\t\t\ttitle=\"Delete\"\n\t\t>\n\t\t\t<iconify-icon icon=\"lucide:trash-2\" width=\"18\" class=\"text-error-500\"></iconify-icon>\n\t\t</button>\n\n\t\t<!-- Drag Handle with Enhanced Visual -->\n\t\t<div\n\t\t\tclass=\"btn-icon preset-tonal rounded cursor-grab active:cursor-grabbing opacity-60 hover:opacity-100 flex items-center justify-center ml-2 hover:bg-surface-300 dark:hover:bg-surface-600 transition-all duration-200 hover:scale-110\"\n\t\t\taria-hidden=\"true\"\n\t\t\ttitle=\"Drag to reorder\"\n\t\t>\n\t\t\t<iconify-icon icon=\"mdi:drag-vertical\" width=\"22\"></iconify-icon>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t/* Enhance focus states for accessibility */\n\tdiv[role='button']:focus-visible {\n\t\toutline: 3px solid rgb(var(--color-primary-500));\n\t\toutline-offset: 4px;\n\t\tborder-radius: 0.5rem;\n\t}\n\n\t/* Smooth badge animations */\n\t.badge {\n\t\ttransition: all 0.2s ease;\n\t}\n\n\t.group:hover .badge {\n\t\ttransform: translateY(-1px);\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n\t}\n\n\t/* Icon pulse animation for categories */\n\t@keyframes pulse {\n\t\t0%,\n\t\t100% {\n\t\t\topacity: 1;\n\t\t}\n\t\t50% {\n\t\t\topacity: 0.5;\n\t\t}\n\t}\n\n\t/* Action button enhancements */\n\tbutton.btn-icon {\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t}\n\n\tbutton.btn-icon::before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tinset: 0;\n\t\tbackground: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);\n\t\topacity: 0;\n\t\ttransition: opacity 0.3s ease;\n\t}\n\n\tbutton.btn-icon:hover::before {\n\t\topacity: 1;\n\t}\n\n\t/* Description tooltip enhancement */\n\t.group\\/desc:hover span {\n\t\tz-index: 10;\n\t\tposition: relative;\n\t}\n</style>\n","/**\n * @file src/utils/treeViewAdapter.ts\n * @description Adapter for converting ContentNode to TreeView data.\n *\n * This module provides functions for converting ContentNode structures to TreeView data\n * and vice versa. It is used for hierarchical organization of content in the CMS.\n */\n\nimport type { ContentNode } from '@shared/database/dbInterface';\n\nexport interface TreeViewItem extends Record<string, any> {\n\tid: string;\n\tname: string;\n\tparent: string | null;\n\t// children is NOT part of the flat item structure for TreeView\n\t// element references are handled by TreeView via path/id\n\tnodeType: 'category' | 'collection';\n\ticon?: string;\n\tpath: string;\n\torder?: number;\n\t_id?: any; // Preserve original ID reference\n\t// Drag-and-drop control\n\tisDraggable?: boolean;\n\tisDropAllowed?: boolean;\n}\n\n/**\n * Flattens a recursive ContentNode structure into a flat array for svelte-treeview\n */\nexport function toTreeViewData(nodes: ContentNode[], parentPath: string = ''): TreeViewItem[] {\n\tlet result: TreeViewItem[] = [];\n\n\tfor (const node of nodes) {\n\t\t// Access properties safely. ContentNode uses _id usually.\n\t\t// We cast to any to be flexible about input types during migration\n\t\tconst n = node as any;\n\t\tconst id = String(n.id || n._id || crypto.randomUUID());\n\n\t\t// Create LTree path: e.g. \"root.child.grandchild\"\n\t\tconst path = parentPath ? `${parentPath}.${id}` : id;\n\n\t\t// Destructure to exclude children from the rest spread\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\tconst { children, ...rest } = n;\n\n\t\tconst item: TreeViewItem = {\n\t\t\t...rest,\n\t\t\tid,\n\t\t\tname: n.name || 'Untitled',\n\t\t\tnodeType: n.type || n.nodeType || 'collection',\n\t\t\ticon: n.icon,\n\t\t\tpath: path,\n\t\t\tparent: parentPath ? parentPath.split('.').pop() || null : null,\n\t\t\t// Enable drag-and-drop for all items\n\t\t\tisDraggable: true,\n\t\t\tisDropAllowed: true\n\t\t};\n\n\t\tresult.push(item);\n\n\t\tif (children && Array.isArray(children) && children.length > 0) {\n\t\t\tconst childItems = toTreeViewData(children, path);\n\t\t\tresult = result.concat(childItems);\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Reconstructs recursive ContentNode structure from flat TreeView items\n */\nexport function fromTreeViewData(flatItems: TreeViewItem[]): ContentNode[] {\n\tconst nodeMap = new Map<string, ContentNode>();\n\tconst roots: ContentNode[] = [];\n\n\t// Create nodes\n\tfor (const item of flatItems) {\n\t\tconst { path, parent, text, ...rest } = item;\n\n\t\tconst node: any = {\n\t\t\t...rest,\n\t\t\t// Restore _id if available, else map id\n\t\t\t_id: rest._id || item.id,\n\t\t\t// Ensure children array exists\n\t\t\tchildren: []\n\t\t};\n\n\t\t// delete internal tree props if they leaked\n\t\tdelete node.path;\n\t\tdelete node.parent;\n\t\tdelete node.text;\n\n\t\tnodeMap.set(String(item.id), node as ContentNode);\n\t}\n\n\t// Build hierarchy\n\tfor (const item of flatItems) {\n\t\tconst node = nodeMap.get(String(item.id));\n\t\tif (!node) continue;\n\n\t\tif (item.path && item.path.includes('.')) {\n\t\t\tconst segments = item.path.split('.');\n\t\t\tsegments.pop(); // remove self\n\t\t\tconst parentId = segments.pop(); // get parent id\n\n\t\t\tif (parentId) {\n\t\t\t\tconst parent = nodeMap.get(parentId);\n\t\t\t\tif (parent && parent.children) {\n\t\t\t\t\tparent.children.push(node);\n\t\t\t\t} else {\n\t\t\t\t\troots.push(node);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\troots.push(node);\n\t\t\t}\n\t\t} else {\n\t\t\troots.push(node);\n\t\t}\n\t}\n\n\treturn roots;\n}\n\n/**\n * Converts flat TreeView items directly to flat ContentNodes for the backend.\n * Handles parentId mapping and recalculates order based on sibling position.\n */\nexport function toFlatContentNodes(flatItems: TreeViewItem[]): ContentNode[] {\n\t// Group items by parent to calculate order within siblings\n\tconst siblingGroups = new Map<string, TreeViewItem[]>();\n\n\tfor (const item of flatItems) {\n\t\tconst parentKey = item.parent || '__root__';\n\t\tif (!siblingGroups.has(parentKey)) {\n\t\t\tsiblingGroups.set(parentKey, []);\n\t\t}\n\t\tsiblingGroups.get(parentKey)!.push(item);\n\t}\n\n\t// Sort each sibling group by their path order (lexicographic within same level)\n\tfor (const [, siblings] of siblingGroups) {\n\t\tsiblings.sort((a, b) => {\n\t\t\t// Sort by path to maintain visual order\n\t\t\tconst aSegments = a.path.split('.');\n\t\t\tconst bSegments = b.path.split('.');\n\t\t\t// Compare the last segment (their position at this level)\n\t\t\treturn aSegments[aSegments.length - 1].localeCompare(bSegments[bSegments.length - 1]);\n\t\t});\n\t}\n\n\t// Create order lookup\n\tconst orderLookup = new Map<string, number>();\n\tfor (const [, siblings] of siblingGroups) {\n\t\tsiblings.forEach((item, index) => {\n\t\t\torderLookup.set(item.id, index);\n\t\t});\n\t}\n\n\treturn flatItems.map((item) => {\n\t\t// Extract parentId from path (second-to-last segment)\n\t\tlet parentId: string | undefined;\n\t\tif (item.path && item.path.includes('.')) {\n\t\t\tconst segments = item.path.split('.');\n\t\t\tsegments.pop(); // Remove self\n\t\t\tparentId = segments.pop(); // Get parent id\n\t\t}\n\n\t\treturn {\n\t\t\t...item,\n\t\t\t_id: item._id || item.id,\n\t\t\tid: undefined, // ContentNode uses _id\n\t\t\tparentId: parentId,\n\t\t\tname: item.name,\n\t\t\ticon: item.icon,\n\t\t\tnodeType: item.nodeType,\n\t\t\tpath: item.path,\n\t\t\torder: orderLookup.get(item.id) ?? 0,\n\n\t\t\t// Clean up internal props\n\t\t\tparent: undefined,\n\t\t\ttext: undefined\n\t\t} as unknown as ContentNode;\n\t});\n}\n\n/**\n * Recalculates paths for TreeView items after a drag-and-drop operation.\n * This is essential because svelte-treeview may not automatically maintain\n * consistent paths after complex moves.\n *\n * @param items Flat array of TreeView items with potentially stale paths\n * @returns Items with recalculated paths based on parent relationships\n */\nexport function recalculatePaths(items: TreeViewItem[]): TreeViewItem[] {\n\t// Build a map of id -> item for quick lookup\n\tconst itemMap = new Map<string, TreeViewItem>();\n\tfor (const item of items) {\n\t\titemMap.set(item.id, { ...item });\n\t}\n\n\t// Group by parent to determine order\n\tconst childrenByParent = new Map<string, TreeViewItem[]>();\n\tfor (const item of items) {\n\t\tconst parentKey = item.parent || '__root__';\n\t\tif (!childrenByParent.has(parentKey)) {\n\t\t\tchildrenByParent.set(parentKey, []);\n\t\t}\n\t\tchildrenByParent.get(parentKey)!.push(itemMap.get(item.id)!);\n\t}\n\n\t// Sort children within each parent group by their original order\n\tfor (const [, children] of childrenByParent) {\n\t\tchildren.sort((a, b) => (a.order ?? 0) - (b.order ?? 0));\n\t}\n\n\t// Recursively assign new paths starting from roots\n\tfunction assignPaths(parentId: string | null, parentPath: string): void {\n\t\tconst key = parentId || '__root__';\n\t\tconst children = childrenByParent.get(key);\n\t\tif (!children) return;\n\n\t\tchildren.forEach((child, index) => {\n\t\t\tconst newPath = parentPath ? `${parentPath}.${child.id}` : child.id;\n\t\t\tconst item = itemMap.get(child.id);\n\t\t\tif (item) {\n\t\t\t\titem.path = newPath;\n\t\t\t\titem.order = index;\n\t\t\t\titem.parent = parentId;\n\t\t\t}\n\t\t\t// Recurse into children\n\t\t\tassignPaths(child.id, newPath);\n\t\t});\n\t}\n\n\t// Start from roots\n\tassignPaths(null, '');\n\n\treturn Array.from(itemMap.values());\n}\n","<!--\n@files src/routes/(app)/config/collectionbuilder/NestedContent/TreeViewBoard.svelte\n@component\n**Board component for managing nested collections using svelte-dnd-action**\n\n### Props\n- `contentNodes` {ContentNode[]} - Array of content nodes representing collections and categories\n- `onNodeUpdate` {Function} - Callback function to handle updates to the content node\n- `onEditCategory` {Function} - Callback function to handle editing of categories\n- `onDeleteNode` {Function} - Callback function to handle node deletion\n- `onDuplicateNode` {Function} - Callback function to handle node duplication\n\n### Features:\n- Drag and drop reordering of collections using svelte-dnd-action\n- Support for nested categories with cross-level drag\n- Search/Filter functionality\n- Expand/Collapse all\n- Enhanced visual feedback for drag & drop\n-->\n<script lang=\"ts\">\n\t// Component\n\timport TreeViewNode from './TreeViewNode.svelte';\n\n\t// DB / Types\n\timport type { ContentNode } from '@shared/database/dbInterface';\n\n\t// Drag and Drop\n\timport { dndzone, TRIGGERS } from 'svelte-dnd-action';\n\timport { flip } from 'svelte/animate';\n\n\t// Adapter\n\timport { toTreeViewData, toFlatContentNodes, recalculatePaths, type TreeViewItem } from '@shared/utils/treeViewAdapter';\n\n\tinterface Props {\n\t\tcontentNodes: ContentNode[];\n\t\tonNodeUpdate: (updatedNodes: ContentNode[]) => void;\n\t\tonEditCategory: (category: Partial<ContentNode>) => void;\n\t\tonDeleteNode?: (node: Partial<ContentNode>) => void;\n\t\tonDuplicateNode?: (node: Partial<ContentNode>) => void;\n\t}\n\n\tlet { contentNodes = [], onNodeUpdate, onEditCategory, onDeleteNode, onDuplicateNode }: Props = $props();\n\n\t// Search state\n\tlet searchText = $state('');\n\n\t// Local state for the tree data - flat structure for dnd-action\n\tlet treeData = $state<TreeViewItem[]>([]);\n\tlet initialized = false;\n\n\t// Expanded nodes tracking\n\tlet expandedNodes = $state<Set<string>>(new Set());\n\n\t// Drag state for visual feedback\n\tlet isDragging = $state(false);\n\n\t$effect(() => {\n\t\tif (contentNodes.length > 0 && (!initialized || treeData.length === 0)) {\n\t\t\ttreeData = toTreeViewData(contentNodes);\n\t\t\tinitialized = true;\n\t\t\t// Auto-expand root level nodes\n\t\t\ttreeData.forEach((item) => {\n\t\t\t\tif (!item.parent) {\n\t\t\t\t\texpandedNodes.add(item.id);\n\t\t\t\t}\n\t\t\t});\n\t\t\texpandedNodes = new Set(expandedNodes);\n\t\t}\n\t});\n\n\t// Filter items based on search\n\tconst filteredItems = $derived.by(() => {\n\t\tif (!searchText.trim()) return treeData;\n\t\tconst searchLower = searchText.toLowerCase();\n\t\treturn treeData.filter((item) => item.name.toLowerCase().includes(searchLower));\n\t});\n\n\t// Build hierarchical structure for rendering\n\ttype EnhancedTreeViewItem = TreeViewItem & { children: EnhancedTreeViewItem[]; level: number };\n\n\tconst hierarchicalData = $derived.by(() => {\n\t\tconst items = filteredItems;\n\t\tconst itemMap = new Map<string, EnhancedTreeViewItem>();\n\n\t\t// First pass: create enhanced items with children arrays\n\t\titems.forEach((item) => {\n\t\t\titemMap.set(item.id, { ...item, children: [], level: 0 });\n\t\t});\n\n\t\t// Second pass: build hierarchy\n\t\tconst roots: EnhancedTreeViewItem[] = [];\n\t\titems.forEach((item) => {\n\t\t\tconst enhanced = itemMap.get(item.id);\n\t\t\tif (!enhanced) return; // Safety check\n\n\t\t\tif (item.parent && itemMap.has(item.parent)) {\n\t\t\t\tconst parent = itemMap.get(item.parent);\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.children.push(enhanced);\n\t\t\t\t\tenhanced.level = parent.level + 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\troots.push(enhanced);\n\t\t\t}\n\t\t});\n\n\t\treturn roots;\n\t});\n\n\t// Get root level items for top-level dnd zone\n\tconst rootItems = $derived(hierarchicalData);\n\n\t// Expand all nodes\n\tfunction expandAll(): void {\n\t\texpandedNodes = new Set(treeData.map((item) => item.id));\n\t}\n\n\t// Collapse all nodes\n\tfunction collapseAll(): void {\n\t\texpandedNodes = new Set();\n\t}\n\n\t// Clear the search\n\tfunction clearSearch(): void {\n\t\tsearchText = '';\n\t}\n\n\t// Toggle node expansion\n\tfunction toggleNode(id: string) {\n\t\tif (expandedNodes.has(id)) {\n\t\t\texpandedNodes.delete(id);\n\t\t} else {\n\t\t\texpandedNodes.add(id);\n\t\t}\n\t\texpandedNodes = new Set(expandedNodes);\n\t}\n\n\t// Handle drag and drop at root level\n\tfunction handleRootDndConsider(e: CustomEvent) {\n\t\tconst { items, info } = e.detail;\n\t\tif (info.trigger === TRIGGERS.DRAG_STARTED) {\n\t\t\tisDragging = true;\n\t\t}\n\t\tupdateRootItems(items);\n\t}\n\n\tfunction handleRootDndFinalize(e: CustomEvent) {\n\t\tconst { items } = e.detail;\n\t\tisDragging = false;\n\n\t\t// Update items with null parent (root level)\n\t\tconst updatedItems = items.map((item: EnhancedTreeViewItem) => ({\n\t\t\t...item,\n\t\t\tparent: null\n\t\t}));\n\n\t\tupdateRootItems(updatedItems);\n\t\tsaveTreeData();\n\t}\n\n\tfunction updateRootItems(newItems: EnhancedTreeViewItem[]) {\n\t\t// Get IDs of items now at root level\n\t\tconst newRootIds = new Set(newItems.map((item) => item.id));\n\n\t\t// For each item that moved TO root, we need to keep its descendants\n\t\t// For items that moved AWAY from root, they'll be handled by the nested zone\n\n\t\t// Start with items that are NOT in the new root list AND not descendants of moved items\n\t\tconst itemsToKeep: TreeViewItem[] = [];\n\t\tconst processedIds = new Set<string>();\n\n\t\t// First, add all new root items with updated parent\n\t\tnewItems.forEach((item, index) => {\n\t\t\titemsToKeep.push({\n\t\t\t\t...stripEnhanced(item),\n\t\t\t\tparent: null,\n\t\t\t\torder: index\n\t\t\t});\n\t\t\tprocessedIds.add(item.id);\n\n\t\t\t// Also add all descendants of this item (they keep their relative parent refs)\n\t\t\tconst descendants = getAllDescendants(item.id, treeData);\n\t\t\tdescendants.forEach((desc) => {\n\t\t\t\tif (!processedIds.has(desc.id)) {\n\t\t\t\t\titemsToKeep.push(desc);\n\t\t\t\t\tprocessedIds.add(desc.id);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Add remaining items that weren't processed (items still in nested zones)\n\t\ttreeData.forEach((item) => {\n\t\t\tif (!processedIds.has(item.id) && !newRootIds.has(item.id)) {\n\t\t\t\t// Check if this item's parent is still valid\n\t\t\t\tconst parentStillExists = itemsToKeep.some((i) => i.id === item.parent);\n\t\t\t\tif (parentStillExists || item.parent === null) {\n\t\t\t\t\titemsToKeep.push(item);\n\t\t\t\t\tprocessedIds.add(item.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\ttreeData = recalculatePaths(itemsToKeep);\n\t}\n\n\t// Handle drag and drop at nested level\n\tfunction handleNestedDndConsider(e: CustomEvent, parentId: string) {\n\t\tconst { items, info } = e.detail;\n\t\tif (info.trigger === TRIGGERS.DRAG_STARTED) {\n\t\t\tisDragging = true;\n\t\t}\n\t\tupdateItemsAtLevel(items, parentId);\n\t}\n\n\tfunction handleNestedDndFinalize(e: CustomEvent, parentId: string) {\n\t\tconst { items } = e.detail;\n\t\tisDragging = false;\n\t\tupdateItemsAtLevel(items, parentId);\n\t\tsaveTreeData();\n\t}\n\n\tfunction updateItemsAtLevel(newItems: EnhancedTreeViewItem[], parentId: string) {\n\t\t// Get IDs of items now at this level\n\t\tconst newChildIds = new Set(newItems.map((item) => item.id));\n\n\t\tconst itemsToKeep: TreeViewItem[] = [];\n\t\tconst processedIds = new Set<string>();\n\n\t\t// Add items at this level with updated parent reference\n\t\tnewItems.forEach((item, index) => {\n\t\t\titemsToKeep.push({\n\t\t\t\t...stripEnhanced(item),\n\t\t\t\tparent: parentId,\n\t\t\t\torder: index\n\t\t\t});\n\t\t\tprocessedIds.add(item.id);\n\n\t\t\t// Also add all descendants of this item (they keep their relative parent refs)\n\t\t\tconst descendants = getAllDescendants(item.id, treeData);\n\t\t\tdescendants.forEach((desc) => {\n\t\t\t\tif (!processedIds.has(desc.id)) {\n\t\t\t\t\titemsToKeep.push(desc);\n\t\t\t\t\tprocessedIds.add(desc.id);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Add all other items that weren't affected\n\t\ttreeData.forEach((item) => {\n\t\t\tif (!processedIds.has(item.id) && !newChildIds.has(item.id) && item.parent !== parentId) {\n\t\t\t\titemsToKeep.push(item);\n\t\t\t\tprocessedIds.add(item.id);\n\t\t\t}\n\t\t});\n\n\t\t// Also add items that are still children of this parent but not in newItems\n\t\t// (they were removed from this zone, handled elsewhere)\n\n\t\ttreeData = recalculatePaths(itemsToKeep);\n\t}\n\n\t// Helper: Get all descendants of an item\n\tfunction getAllDescendants(itemId: string, items: TreeViewItem[]): TreeViewItem[] {\n\t\tconst descendants: TreeViewItem[] = [];\n\t\tconst directChildren = items.filter((item) => item.parent === itemId);\n\n\t\tdirectChildren.forEach((child) => {\n\t\t\tdescendants.push(child);\n\t\t\tdescendants.push(...getAllDescendants(child.id, items));\n\t\t});\n\n\t\treturn descendants;\n\t}\n\n\t// Helper: Strip enhanced properties from item\n\tfunction stripEnhanced(item: EnhancedTreeViewItem): TreeViewItem {\n\t\tconst { children, level, ...base } = item;\n\t\treturn base;\n\t}\n\n\tfunction saveTreeData() {\n\t\t// Convert back to ContentNodes and notify parent\n\t\tconst contentNodes = toFlatContentNodes(treeData);\n\n\t\t// Defer update to prevent synchronous state update loop\n\t\tsetTimeout(() => {\n\t\t\tonNodeUpdate(contentNodes);\n\t\t}, 50);\n\t}\n\n\t// Helper to convert EnhancedTreeViewItem to Partial<ContentNode> for callbacks\n\tfunction toPartialContentNode(item: TreeViewItem | EnhancedTreeViewItem): Partial<ContentNode> {\n\t\t// Extract only the properties needed for ContentNode\n\t\tconst { children, level, parent, path, ...contentNodeProps } = item as any;\n\t\treturn {\n\t\t\t...contentNodeProps,\n\t\t\t_id: item._id || item.id,\n\t\t\tparentId: parent\n\t\t};\n\t}\n\n\t// Flip animation duration\n\tconst flipDurationMs = 300;\n</script>\n\n<!-- Toolbar -->\n<div class=\"mb-4 flex flex-wrap items-center gap-2\">\n\t<!-- Search Input -->\n\t<div class=\"relative flex-1 min-w-[200px]\">\n\t\t<iconify-icon icon=\"mdi:magnify\" width=\"18\" class=\"absolute left-3 top-1/2 -translate-y-1/2 opacity-50\"></iconify-icon>\n\t\t<input type=\"text\" placeholder=\"Search collections...\" bind:value={searchText} class=\"input w-full h-12 pl-10 pr-8 rounded shadow-sm\" />\n\t\t{#if searchText}\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={clearSearch}\n\t\t\t\tclass=\"absolute right-2 top-1/2 -translate-y-1/2 btn-icon preset-tonal hover:preset-filled transition-all\"\n\t\t\t\taria-label=\"Clear search\"\n\t\t\t>\n\t\t\t\t<iconify-icon icon=\"mdi:close\" width=\"16\"></iconify-icon>\n\t\t\t</button>\n\t\t{/if}\n\t</div>\n\n\t<!-- Expand/Collapse Buttons -->\n\t<div class=\"flex gap-2\">\n\t\t<button type=\"button\" onclick={expandAll} class=\"btn preset-tonal hover:preset-filled transition-all shadow-sm\" title=\"Expand All\">\n\t\t\t<iconify-icon icon=\"mdi:unfold-more-horizontal\" width=\"18\"></iconify-icon>\n\t\t\t<span class=\"hidden sm:inline ml-1\">Expand All</span>\n\t\t</button>\n\t\t<button type=\"button\" onclick={collapseAll} class=\"btn preset-tonal hover:preset-filled transition-all shadow-sm\" title=\"Collapse All\">\n\t\t\t<iconify-icon icon=\"mdi:unfold-less-horizontal\" width=\"18\"></iconify-icon>\n\t\t\t<span class=\"hidden sm:inline ml-1\">Collapse All</span>\n\t\t</button>\n\t</div>\n</div>\n\n<!-- Tree View with Drag and Drop -->\n<div class=\"collection-builder-tree relative w-full h-auto overflow-y-auto rounded p-2\">\n\t{#if hierarchicalData.length === 0}\n\t\t<div class=\"text-center p-8 text-surface-500\">\n\t\t\t{#if searchText}\n\t\t\t\t<iconify-icon icon=\"mdi:magnify-close\" width=\"48\" class=\"opacity-50 mb-2\"></iconify-icon>\n\t\t\t\t<p>No results found for \"{searchText}\"</p>\n\t\t\t{:else}\n\t\t\t\t<iconify-icon icon=\"mdi:folder-open-outline\" width=\"48\" class=\"opacity-50 mb-2\"></iconify-icon>\n\t\t\t\t<p>No categories or collections yet</p>\n\t\t\t{/if}\n\t\t</div>\n\t{:else}\n\t\t<!-- Root Level DnD Zone -->\n\t\t<div\n\t\t\tclass=\"root-dnd-zone\"\n\t\t\tuse:dndzone={{\n\t\t\t\titems: rootItems,\n\t\t\t\tflipDurationMs,\n\t\t\t\ttype: 'tree-items',\n\t\t\t\tdropFromOthersDisabled: false,\n\t\t\t\tdropTargetStyle: {}\n\t\t\t}}\n\t\t\tonconsider={handleRootDndConsider}\n\t\t\tonfinalize={handleRootDndFinalize}\n\t\t>\n\t\t\t{#each rootItems as item (item.id)}\n\t\t\t\t<div class=\"tree-node-wrapper\" animate:flip={{ duration: flipDurationMs }}>\n\t\t\t\t\t{@render treeNode(item, 0)}\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n\n\t<!-- Drop to Root Zone (visible during drag) -->\n\t{#if isDragging}\n\t\t<div class=\"drop-to-root-zone\">\n\t\t\t<iconify-icon icon=\"mdi:arrow-up\" width=\"20\"></iconify-icon>\n\t\t\t<span>Drop here to move to root level</span>\n\t\t</div>\n\t{/if}\n</div>\n\n<!-- Recursive Tree Node Renderer -->\n{#snippet treeNode(item: EnhancedTreeViewItem, level: number)}\n\t<div class=\"tree-node-container\" style=\"margin-left: {level * 0.75}rem\">\n\t\t<!-- Render the node -->\n\t\t<TreeViewNode\n\t\t\titem={{ ...item, hasChildren: item.children && item.children.length > 0 }}\n\t\t\tisOpen={expandedNodes.has(item.id)}\n\t\t\ttoggle={() => toggleNode(item.id)}\n\t\t\tonEditCategory={() => onEditCategory(toPartialContentNode(item))}\n\t\t\tonDelete={() => onDeleteNode?.(toPartialContentNode(item))}\n\t\t\tonDuplicate={() => onDuplicateNode?.(toPartialContentNode(item))}\n\t\t/>\n\n\t\t<!-- Render children if expanded and has children -->\n\t\t{#if expandedNodes.has(item.id) && item.children && item.children.length > 0}\n\t\t\t<div\n\t\t\t\tclass=\"tree-children\"\n\t\t\t\tuse:dndzone={{\n\t\t\t\t\titems: item.children,\n\t\t\t\t\tflipDurationMs,\n\t\t\t\t\ttype: 'tree-items',\n\t\t\t\t\tdropFromOthersDisabled: false,\n\t\t\t\t\tdropTargetStyle: {}\n\t\t\t\t}}\n\t\t\t\tonconsider={(e) => handleNestedDndConsider(e, item.id)}\n\t\t\t\tonfinalize={(e) => handleNestedDndFinalize(e, item.id)}\n\t\t\t>\n\t\t\t\t{#each item.children as child (child.id)}\n\t\t\t\t\t<div class=\"tree-node-wrapper\" animate:flip={{ duration: flipDurationMs }}>\n\t\t\t\t\t\t{@render treeNode(child, level + 1)}\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else if expandedNodes.has(item.id) && item.nodeType === 'category'}\n\t\t\t<!-- Empty drop zone for categories with no children -->\n\t\t\t<div\n\t\t\t\tclass=\"tree-children empty-drop-zone\"\n\t\t\t\tuse:dndzone={{\n\t\t\t\t\titems: [],\n\t\t\t\t\tflipDurationMs,\n\t\t\t\t\ttype: 'tree-items',\n\t\t\t\t\tdropFromOthersDisabled: false,\n\t\t\t\t\tdropTargetStyle: {}\n\t\t\t\t}}\n\t\t\t\tonconsider={(e) => handleNestedDndConsider(e, item.id)}\n\t\t\t\tonfinalize={(e) => handleNestedDndFinalize(e, item.id)}\n\t\t\t>\n\t\t\t\t<span class=\"empty-hint\">Drop items here</span>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n{/snippet}\n\n<style>\n\t/* Base Tree Styling */\n\t.collection-builder-tree {\n\t\tbackground: transparent;\n\t\tcolor: inherit;\n\t\tfont-family: inherit;\n\t\tpadding: 0.5rem;\n\t\tmin-height: 200px;\n\t}\n\n\t/* Root DnD Zone */\n\t.root-dnd-zone {\n\t\tmin-height: 100px;\n\t}\n\n\t/* Tree Node Wrapper for animations */\n\t.tree-node-wrapper {\n\t\tmargin-bottom: 0.5rem;\n\t}\n\n\t/* Tree Node Container */\n\t.tree-node-container {\n\t\ttransition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n\t\tposition: relative;\n\t}\n\n\t/* Tree Children Container */\n\t.tree-children {\n\t\tpadding-left: 0.5rem;\n\t\tborder-left: 2px solid rgb(var(--color-surface-300));\n\t\tmargin-left: 0.5rem;\n\t\tmargin-top: 0.5rem;\n\t\tmin-height: 40px;\n\t\ttransition: all 0.2s ease;\n\t}\n\n\t.tree-children.empty-drop-zone {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tborder: 2px dashed rgb(var(--color-surface-300));\n\t\tborder-left: 2px solid rgb(var(--color-surface-300));\n\t\tborder-radius: 4px;\n\t\tbackground: rgb(var(--color-surface-50) / 0.3);\n\t}\n\n\t.empty-hint {\n\t\tcolor: rgb(var(--color-surface-500));\n\t\tfont-size: 0.85rem;\n\t\tfont-style: italic;\n\t}\n\n\t/* Drop to Root Zone */\n\t.drop-to-root-zone {\n\t\tmargin-top: 1rem;\n\t\tpadding: 1rem;\n\t\tborder: 2px dashed rgb(var(--color-primary-500));\n\t\tborder-radius: 8px;\n\t\tbackground: rgb(var(--color-primary-500) / 0.1);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tgap: 0.5rem;\n\t\tcolor: rgb(var(--color-primary-500));\n\t\tfont-weight: 500;\n\t\tanimation: pulse-border 1.5s ease-in-out infinite;\n\t}\n\n\t@keyframes pulse-border {\n\t\t0%,\n\t\t100% {\n\t\t\tborder-color: rgb(var(--color-primary-500));\n\t\t}\n\t\t50% {\n\t\t\tborder-color: rgb(var(--color-primary-300));\n\t\t}\n\t}\n\n\t/* Dragging State - Applied by svelte-dnd-action */\n\t:global(.tree-node-wrapper[aria-grabbed='true']) {\n\t\topacity: 0.5;\n\t\ttransform: scale(0.98);\n\t}\n\n\t/* Drop target visual feedback */\n\t:global(.tree-children:has([aria-grabbed='true'])) {\n\t\tbackground: rgb(var(--color-primary-500) / 0.05);\n\t\tborder-left-color: rgb(var(--color-primary-500));\n\t}\n\n\t/* Hover Effects */\n\t.tree-node-container:hover {\n\t\ttransform: translateX(2px);\n\t}\n\n\t/* Smooth Scrollbar */\n\t.collection-builder-tree {\n\t\tscrollbar-width: thin;\n\t\tscrollbar-color: rgb(var(--color-surface-400)) transparent;\n\t}\n\n\t.collection-builder-tree::-webkit-scrollbar {\n\t\twidth: 8px;\n\t}\n\n\t.collection-builder-tree::-webkit-scrollbar-track {\n\t\tbackground: transparent;\n\t}\n\n\t.collection-builder-tree::-webkit-scrollbar-thumb {\n\t\tbackground: rgb(var(--color-surface-400));\n\t\tborder-radius: 4px;\n\t}\n\n\t.collection-builder-tree::-webkit-scrollbar-thumb:hover {\n\t\tbackground: rgb(var(--color-surface-500));\n\t}\n</style>\n","<!--\n@files src/routes/(app)/config/collection/ModalCategory.svelte\n@component\n**This component displays a modal for editing a category**\n-->\n<script lang=\"ts\">\n\t// Stores\n\timport { contentStructure } from '@shared/stores/collectionStore.svelte';\n\timport { logger } from '@shared/utils/logger';\n\n\t// Components\n\timport IconifyPicker from '@cms/components/IconifyPicker.svelte';\n\n\t//ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\timport type { ContentNode } from '@shared/database/dbInterface';\n\n\tinterface Props {\n\t\tparent?: {\n\t\t\tonClose?: () => void;\n\t\t\tregionFooter?: string;\n\t\t\tbuttonPositive?: string;\n\t\t};\n\t\texistingCategory?: Partial<ContentNode>;\n\t\ttitle?: string;\n\t\tbody?: string;\n\t\tclose?: (result?: any) => void;\n\t}\n\n\tinterface FormData {\n\t\tnewCategoryName: string;\n\t\tnewCategoryIcon: string;\n\t\tid?: string;\n\t}\n\n\tconst { existingCategory = { name: '', icon: '' }, close }: Props = $props();\n\n\t// State variables for form and UI\n\tconst formData = $state<FormData>({\n\t\tnewCategoryName: '',\n\t\tnewCategoryIcon: ''\n\t});\n\tlet isSubmitting = $state(false);\n\tlet formError = $state<string | null>(null);\n\tlet validationErrors = $state<Record<string, string>>({});\n\n\t$effect(() => {\n\t\tformData.newCategoryName = existingCategory.name ?? '';\n\t\tformData.newCategoryIcon = existingCategory.icon ?? '';\n\t});\n\n\t/**\n\t * Validates the form input fields.\n\t * @returns True if the form is valid, false otherwise.\n\t */\n\tfunction validateForm(): boolean {\n\t\tconst errors: Record<string, string> = {};\n\n\t\tif (!formData.newCategoryName.trim()) {\n\t\t\terrors.name = 'Category name is required';\n\t\t} else if (formData.newCategoryName.length < 2) {\n\t\t\terrors.name = 'Category name must be at least 2 characters';\n\t\t}\n\n\t\tif (!formData.newCategoryIcon.trim()) {\n\t\t\terrors.icon = 'Icon is required';\n\t\t}\n\n\t\tvalidationErrors = errors;\n\t\treturn Object.keys(errors).length === 0;\n\t}\n\n\t/**\n\t * Handles form submission. Validates, then sends data back via the modal's response callback.\n\t * @param event The form submission event.\n\t */\n\tasync function onFormSubmit(event: Event): Promise<void> {\n\t\tevent.preventDefault(); // Prevent default form submission\n\t\tif (!validateForm()) {\n\t\t\tlogger.error('Form validation failed.');\n\t\t\treturn;\n\t\t}\n\n\t\tisSubmitting = true;\n\t\tformError = null;\n\n\t\ttry {\n\t\t\tif (close) {\n\t\t\t\t// If adding a new category, generate a UUID\n\t\t\t\tif (!existingCategory._id) {\n\t\t\t\t\tclose(formData); // `+page.svelte` will assign ID\n\t\t\t\t} else {\n\t\t\t\t\tclose(formData); // For editing, pass existing ID implied\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error('Error submitting category form:', error);\n\t\t\tformError = error instanceof Error ? error.message : 'Error submitting form';\n\t\t} finally {\n\t\t\tisSubmitting = false;\n\t\t}\n\t}\n\n\t/**\n\t * Handles deletion of an existing category.\n\t * Requires confirmation and checks for child categories.\n\t */\n\tasync function deleteCategory(): Promise<void> {\n\t\t// Prevent deletion if category has children (collections or subcategories)\n\t\t// This check is a simplification; a more robust solution would determine if `existingCategory.children`\n\t\t// holds any values based on your `ContentNode` definition or fetch it live.\n\t\t// For now, assuming `existingCategory.children` refers to a property that exists if children are present.\n\t\tif (existingCategory.nodeType === 'category' && contentStructure.value.some((node) => node.parentId === existingCategory._id)) {\n\t\t\tformError = 'Cannot delete category with nested items (collections or subcategories). Please move or delete them first.';\n\t\t\treturn;\n\t\t}\n\n\t\t// Using a simple confirm dialog for now, as the modalStore is being removed.\n\t\t// In a real application, you'd likely replace this with a custom confirmation modal component.\n\t\tconst confirmed = confirm(`Are you sure you wish to delete the category \"${existingCategory.name}\"? This action cannot be undone.`);\n\n\t\tif (!confirmed) return; // User cancelled confirmation\n\n\t\tisSubmitting = true;\n\t\tformError = null;\n\n\t\ttry {\n\t\t\t// Persist to backend\n\t\t\tconst response = await fetch('/api/content-structure', {\n\t\t\t\tmethod: 'POST', // Use POST for actions that modify data\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\taction: 'updateContentStructure', // Re-use updateContentStructure for deletion\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'delete', // Define a 'delete' operation type\n\t\t\t\t\t\t\tnode: existingCategory // Pass the node to be deleted\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tconst errorResult = await response.json();\n\t\t\t\tthrow new Error(errorResult.error || 'Failed to delete category');\n\t\t\t}\n\t\t\tconst {\n\t\t\t\tsuccess,\n\t\t\t\tcontentStructure: newStructure // API should return updated full structure\n\t\t\t}: {\n\t\t\t\tsuccess: boolean;\n\t\t\t\tcontentStructure: ContentNode[];\n\t\t\t} = await response.json();\n\t\t\tif (!success) {\n\t\t\t\tthrow new Error('API reported failure to delete category.');\n\t\t\t}\n\n\t\t\tcontentStructure.value = newStructure;\n\t\t\tclose?.(null); // Close modal after successful deletion, passing null as no data is returned\n\t\t} catch (error) {\n\t\t\tlogger.error('Error deleting category:', error);\n\t\t\tformError = error instanceof Error ? error.message : 'Failed to delete category';\n\t\t} finally {\n\t\t\tisSubmitting = false;\n\t\t}\n\t}\n\n\t// Base Classes for Skeleton modal\n\tconst cForm = 'border border-surface-500 p-4 space-y-4 rounded-xl';\n</script>\n\n<div class=\"modal-example-form space-y-4\">\n\t{#if formError}\n\t\t<div class=\"rounded bg-error-500/10 p-2 text-error-500\" role=\"alert\">\n\t\t\t{formError}\n\t\t</div>\n\t{/if}\n\n\t<form class=\"modal-form {cForm}\" onsubmit={onFormSubmit}>\n\t\t<label class=\"label\" for=\"category_name\">\n\t\t\t<span>{m.modalcategory_categoryname()}</span>\n\t\t\t<input\n\t\t\t\tclass=\"input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tid=\"category_name\"\n\t\t\t\tbind:value={formData.newCategoryName}\n\t\t\t\tplaceholder={m.modalcategory_placeholder()}\n\t\t\t\taria-invalid={!!validationErrors.name}\n\t\t\t\taria-describedby={validationErrors.name ? 'name-error' : undefined}\n\t\t\t\tdisabled={isSubmitting}\n\t\t\t/>\n\t\t\t{#if validationErrors.name}\n\t\t\t\t<span id=\"name-error\" class=\"text-sm text-error-500\">{validationErrors.name}</span>\n\t\t\t{/if}\n\t\t</label>\n\n\t\t<label class=\"label\" for=\"icon-picker\">\n\t\t\t<span>Icon</span>\n\t\t\t<IconifyPicker bind:iconselected={formData.newCategoryIcon} searchQuery={formData.newCategoryIcon} />\n\t\t\t{#if validationErrors.icon}\n\t\t\t\t<span id=\"icon-error\" class=\"text-sm text-error-500\">{validationErrors.icon}</span>\n\t\t\t{/if}\n\t\t</label>\n\t\t<footer class=\"modal-footer flex {existingCategory.name ? 'justify-between' : 'justify-end'} pt-4 border-t border-surface-500/20\">\n\t\t\t{#if existingCategory.name}\n\t\t\t\t<button type=\"button\" onclick={deleteCategory} class=\"preset-filled-error-500 btn\" aria-label=\"Delete category\" disabled={isSubmitting}>\n\t\t\t\t\t<iconify-icon icon=\"icomoon-free:bin\" width=\"24\"></iconify-icon>\n\t\t\t\t\t<span class=\"hidden md:inline\">{m.button_delete()}</span>\n\t\t\t\t</button>\n\t\t\t{/if}\n\n\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t<button type=\"button\" class=\"preset-outlined-secondary-500 btn\" onclick={() => close?.(null)} disabled={isSubmitting}>\n\t\t\t\t\t{m.button_cancel()}\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tclass=\"preset-filled-tertiary-500 btn dark:preset-filled-primary-500\"\n\t\t\t\t\taria-label={m.button_save()}\n\t\t\t\t\tdisabled={isSubmitting}\n\t\t\t\t>\n\t\t\t\t\t{#if isSubmitting}\n\t\t\t\t\t\t<iconify-icon icon=\"eos-icons:loading\" class=\"animate-spin\" width=\"24\"></iconify-icon>\n\t\t\t\t\t{/if}\n\t\t\t\t\t{m.button_save()}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</footer>\n\t</form>\n</div>\n","<!--\n @file src/routes/(app)/config/collection/+page.svelte\n @component\n **This component sets up and displays the collection page with nested category support**\n\n### Props:\n - `collection` {object} - Collection object\n\n ### Features:\n - Collection Name\n - Collection Icon\n - Collection Description\n - Collection Status\n - Collection Slug\n - Collection Description\n - Collection Permissions\n - Collection Fields\n - Collection Categories\n-->\n\n<script lang=\"ts\">\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/state';\n\t// Simple ID generator (no need for crypto UUID)\n\tfunction generateId(): string {\n\t\treturn Math.random().toString(36).substring(2, 15) + Date.now().toString(36);\n\t}\n\n\t// Logger\n\timport { logger } from '@shared/utils/logger';\n\n\t// Stores\n\timport { setCollectionValue, setMode, setContentStructure, contentStructure } from '@shared/stores/collectionStore.svelte';\n\timport { setRouteContext, ui } from '@shared/stores/UIStore.svelte';\n\timport { screen } from '@shared/stores/screenSizeStore.svelte';\n\n\t// Components\n\timport PageTitle from '@cms/components/PageTitle.svelte';\n\timport TreeViewBoard from './NestedContent/TreeViewBoard.svelte';\n\timport ModalCategory from './NestedContent/ModalCategory.svelte';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Skeleton\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\timport type { ContentNode, DatabaseId } from '@shared/database/dbInterface';\n\timport type { ISODateString } from '@cms-types';\n\n\tinterface NodeOperation {\n\t\ttype: 'create' | 'update' | 'move' | 'rename';\n\t\tnode: ContentNode;\n\t}\n\n\tinterface CategoryModalResponse {\n\t\tnewCategoryName: string;\n\t\tnewCategoryIcon: string;\n\t}\n\n\tinterface ApiResponse {\n\t\terror?: string;\n\t\tsuccess?: boolean;\n\t\tcontentStructure?: ContentNode[];\n\t\t[key: string]: any; // Allows for success, contentStructure, message\n\t}\n\n\tinterface CollectionBuilderProps {\n\t\tdata: { contentStructure: ContentNode[] };\n\t}\n\n\tconst { data }: CollectionBuilderProps = $props();\n\n\t// `currentConfig` holds the live, mutable state of the content structure for the UI.\n\t// It's initialized from `data.contentStructure` and updated by DnD operations.\n\tlet currentConfig: ContentNode[] = $state([]);\n\t// `nodesToSave` stores operations (create, update, move, rename) that need to be persisted to the backend.\n\tlet nodesToSave: Record<string, NodeOperation> = $state({});\n\n\t$effect(() => {\n\t\tif (data.contentStructure) {\n\t\t\tcurrentConfig = data.contentStructure;\n\t\t}\n\t});\n\n\t// State for UI feedback\n\tlet isLoading = $state(false);\n\tlet apiError: string | null = $state(null);\n\n\t/**\n\t * Opens the modal for adding or editing a category.\n\t * @param existingCategory Optional Partial<DndItem> if editing an existing category.\n\t */\n\tfunction modalAddCategory(existingCategory?: Partial<ContentNode>): void {\n\t\tmodalState.trigger(\n\t\t\tModalCategory as any,\n\t\t\t{\n\t\t\t\texistingCategory: existingCategory as ContentNode | undefined,\n\t\t\t\ttitle: existingCategory ? 'Edit Category' : 'Add New Category',\n\t\t\t\tbody: existingCategory ? 'Modify Category Details' : 'Enter Unique Name and an Icon for your new category column'\n\t\t\t},\n\t\t\tasync (response: CategoryModalResponse | boolean) => {\n\t\t\t\tif (!response || typeof response === 'boolean') return;\n\n\t\t\t\ttry {\n\t\t\t\t\tif (existingCategory && existingCategory._id) {\n\t\t\t\t\t\tupdateExistingCategory(existingCategory as ContentNode, response);\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddNewCategory(response);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlogger.error('Error handling category modal response:', error);\n\t\t\t\t\ttoaster.error({ description: 'Error updating categories' });\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t/**\n\t * Updates an existing category in `currentConfig` and marks it for saving.\n\t * @param existingCategory The original category node.\n\t * @param response The new data from the modal.\n\t */\n\tfunction updateExistingCategory(existingCategory: ContentNode, response: CategoryModalResponse): void {\n\t\tconst updatedCategory: ContentNode = {\n\t\t\t...existingCategory,\n\t\t\tname: response.newCategoryName,\n\t\t\ticon: response.newCategoryIcon,\n\t\t\tupdatedAt: new Date().toISOString() as ISODateString\n\t\t};\n\n\t\t// Update currentConfig immutably to trigger Svelte's reactivity\n\t\tcurrentConfig = currentConfig.map((node) => (node._id === updatedCategory._id ? updatedCategory : node));\n\n\t\t// Prepare operation for saving\n\t\tif (existingCategory.name !== updatedCategory.name) {\n\t\t\tnodesToSave[updatedCategory._id] = {\n\t\t\t\ttype: 'rename', // 'rename' specifically implies name change\n\t\t\t\tnode: updatedCategory\n\t\t\t};\n\t\t} else {\n\t\t\tnodesToSave[updatedCategory._id] = {\n\t\t\t\ttype: 'update', // 'update' for icon or other property changes\n\t\t\t\tnode: updatedCategory\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * Adds a new category to `currentConfig` and marks it for saving.\n\t * @param response The data for the new category from the modal.\n\t */\n\tfunction addNewCategory(response: CategoryModalResponse): void {\n\t\tconst newCategoryId = generateId() as DatabaseId;\n\n\t\tconst newCategory: ContentNode = {\n\t\t\t_id: newCategoryId,\n\t\t\tname: response.newCategoryName,\n\t\t\ticon: response.newCategoryIcon,\n\t\t\torder: currentConfig.length, // Assign an initial order (can be refined later by DnD)\n\t\t\ttranslations: [], // Initialize empty, assuming structure doesn't manage translations directly\n\t\t\tupdatedAt: new Date().toISOString() as ISODateString,\n\t\t\tcreatedAt: new Date().toISOString() as ISODateString,\n\t\t\tparentId: undefined, // New categories are top-level by default\n\t\t\tnodeType: 'category'\n\t\t};\n\n\t\tcurrentConfig = [...currentConfig, newCategory]; // Add to current config\n\t\tnodesToSave[newCategory._id] = {\n\t\t\ttype: 'create',\n\t\t\tnode: newCategory\n\t\t};\n\t}\n\n\t/**\n\t * Callback from Board.svelte when nodes are reordered or moved between parents.\n\t * This updates the `currentConfig` and stages nodes for saving.\n\t * @param updatedNodes The complete, flattened list of ContentNodes after a DnD operation, with updated `parentId` and `order`.\n\t */\n\tfunction handleNodeUpdate(updatedNodes: ContentNode[]) {\n\t\tconsole.debug('Page: handleNodeUpdate received', updatedNodes);\n\t\t// Update the local `currentConfig` to reflect the UI state\n\t\tcurrentConfig = updatedNodes;\n\n\t\t// Mark all updated nodes as 'move' operations for saving.\n\t\t// The `contentManager` should handle 'move' operations by updating `parentId` and `order`.\n\t\tupdatedNodes.forEach((node) => {\n\t\t\tnodesToSave[node._id] = {\n\t\t\t\ttype: 'move',\n\t\t\t\tnode: node\n\t\t\t};\n\t\t});\n\t\tconsole.debug('Nodes to save (after move):', nodesToSave);\n\t}\n\n\t// Handles saving all pending changes (`nodesToSave`) to the backend.\n\tasync function handleSave() {\n\t\tconst items = Object.values(nodesToSave);\n\t\tif (items.length === 0) {\n\t\t\ttoaster.info({ description: 'No changes to save.' });\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tisLoading = true;\n\t\t\tconst response = await fetch('/api/content-structure', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\taction: 'updateContentStructure',\n\t\t\t\t\titems\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tconst result: ApiResponse = await response.json();\n\n\t\t\tif (response.ok && result.success) {\n\t\t\t\ttoaster.success({ description: 'Categories and Collections updated successfully' });\n\t\t\t\t// Clear pending saves after successful API call\n\t\t\t\tnodesToSave = {};\n\t\t\t\t// Re-sync `currentConfig` with the *actual* structure returned by the server\n\t\t\t\t// This is crucial for consistency, especially after complex reorders.\n\t\t\t\tif (result.contentStructure) {\n\t\t\t\t\tsetContentStructure(result.contentStructure);\n\t\t\t\t\tcurrentConfig = result.contentStructure;\n\t\t\t\t}\n\t\t\t\tconsole.debug('API save successful. New contentStructure:', result.contentStructure);\n\t\t\t} else {\n\t\t\t\t// Revert currentConfig to the last known good state if save fails\n\t\t\t\tcurrentConfig = contentStructure.value; // Revert to the state from the store\n\t\t\t\tthrow new Error(result.error || 'Failed to update categories');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error('Error saving categories:', error);\n\t\t\ttoaster.error({ description: error instanceof Error ? error.message : 'Failed to save categories' });\n\t\t\tapiError = error instanceof Error ? error.message : 'Unknown error occurred';\n\t\t} finally {\n\t\t\tisLoading = false;\n\t\t}\n\t}\n\n\tfunction handleAddCollectionClick(): void {\n\t\tsetMode('create');\n\t\tsetCollectionValue({\n\t\t\tname: 'new',\n\t\t\ticon: '',\n\t\t\tdescription: '',\n\t\t\tstatus: 'unpublished',\n\t\t\tslug: '',\n\t\t\tfields: []\n\t\t});\n\t\tgoto('/config/collectionbuilder/new');\n\t}\n\n\t$effect(() => {\n\t\tif (!ui.routeContext.isCollectionBuilder) {\n\t\t\tsetRouteContext({ isCollectionBuilder: true });\n\t\t}\n\t\treturn () => {\n\t\t\tif (!page.url.pathname.includes('/config/collectionbuilder')) {\n\t\t\t\tsetRouteContext({ isCollectionBuilder: false });\n\t\t\t}\n\t\t};\n\t});\n</script>\n\n<PageTitle name={m.collection_pagetitle()} icon=\"fluent-mdl2:build-definition\" showBackButton={true} backUrl=\"/config\">\n\t<!-- Desktop action buttons - hidden on mobile/tablet -->\n\t{#snippet children()}\n\t\t{#if screen.isDesktop}\n\t\t\t<!-- Add Category Button -->\n\t\t\t<button\n\t\t\t\tonclick={() => modalAddCategory()}\n\t\t\t\ttype=\"button\"\n\t\t\t\taria-label=\"Add New Category\"\n\t\t\t\tclass=\"preset-filled-tertiary-500 btn flex w-auto min-w-[140px] items-center justify-center gap-1\"\n\t\t\t\tdisabled={isLoading}\n\t\t\t>\n\t\t\t\t<iconify-icon icon=\"bi:collection\" width=\"18\" class=\"text-white\"></iconify-icon>\n\t\t\t\t<span>{m.collection_addcategory()}</span>\n\t\t\t</button>\n\n\t\t\t<!-- Add Collection Button -->\n\t\t\t<button\n\t\t\t\tonclick={handleAddCollectionClick}\n\t\t\t\ttype=\"button\"\n\t\t\t\taria-label=\"Add New Collection\"\n\t\t\t\tclass=\"preset-filled-surface-500 btn flex w-auto min-w-[140px] items-center justify-center gap-1 rounded font-bold\"\n\t\t\t\tdisabled={isLoading}\n\t\t\t>\n\t\t\t\t<iconify-icon icon=\"material-symbols:category\" width=\"18\"></iconify-icon>\n\t\t\t\t<span>{m.collection_add()}</span>\n\t\t\t</button>\n\n\t\t\t<!-- Save Button -->\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={handleSave}\n\t\t\t\taria-label=\"Save\"\n\t\t\t\tclass=\"preset-filled-primary-500 btn flex w-auto min-w-[140px] items-center justify-center gap-1\"\n\t\t\t\tdisabled={isLoading}\n\t\t\t>\n\t\t\t\t{#if isLoading}\n\t\t\t\t\t<iconify-icon icon=\"eos-icons:loading\" width=\"24\" class=\"animate-spin text-white\"></iconify-icon>\n\t\t\t\t{:else}\n\t\t\t\t\t<iconify-icon icon=\"material-symbols:save\" width=\"24\" class=\"text-white\"></iconify-icon>\n\t\t\t\t{/if}\n\t\t\t\t<span>{m.button_save()}</span>\n\t\t\t</button>\n\t\t{/if}\n\t{/snippet}\n</PageTitle>\n\n<!-- Mobile/Tablet action buttons (shown below title, horizontal row, equal width) -->\n{#if !screen.isDesktop}\n\t<div class=\"flex gap-2 mb-2 px-2\">\n\t\t<button\n\t\t\tonclick={() => modalAddCategory()}\n\t\t\ttype=\"button\"\n\t\t\taria-label=\"Add New Category\"\n\t\t\tclass=\"preset-filled-tertiary-500 btn flex flex-1 items-center justify-center gap-1\"\n\t\t\tdisabled={isLoading}\n\t\t>\n\t\t\t<iconify-icon icon=\"bi:collection\" width=\"18\" class=\"text-white\"></iconify-icon>\n\t\t\t<span>{m.collection_addcategory()}</span>\n\t\t</button>\n\n\t\t<button\n\t\t\tonclick={handleAddCollectionClick}\n\t\t\ttype=\"button\"\n\t\t\taria-label=\"Add New Collection\"\n\t\t\tclass=\"preset-filled-surface-500 btn flex flex-1 items-center justify-center gap-1 rounded font-bold\"\n\t\t\tdisabled={isLoading}\n\t\t>\n\t\t\t<iconify-icon icon=\"material-symbols:category\" width=\"18\"></iconify-icon>\n\t\t\t<span>{m.collection_add()}</span>\n\t\t</button>\n\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonclick={handleSave}\n\t\t\taria-label=\"Save\"\n\t\t\tclass=\"preset-filled-primary-500 btn flex flex-1 items-center justify-center gap-1\"\n\t\t\tdisabled={isLoading}\n\t\t>\n\t\t\t{#if isLoading}\n\t\t\t\t<iconify-icon icon=\"eos-icons:loading\" width=\"24\" class=\"animate-spin text-white\"></iconify-icon>\n\t\t\t{:else}\n\t\t\t\t<iconify-icon icon=\"material-symbols:save\" width=\"24\" class=\"text-white\"></iconify-icon>\n\t\t\t{/if}\n\t\t\t<span>{m.button_save()}</span>\n\t\t</button>\n\t</div>\n{/if}\n\n{#if apiError}\n\t<div class=\"mb-4 rounded bg-error-500/10 p-4 text-error-500\" role=\"alert\">\n\t\t{apiError}\n\t</div>\n{/if}\n\n<div class=\"max-h-[calc(100vh-65px)] overflow-auto\">\n\t<div class=\"wrapper mb-2\">\n\t\t<p class=\"mb-4 text-center dark:text-primary-500\">\n\t\t\t{m.collection_description()}\n\t\t</p>\n\n\t\t<TreeViewBoard contentNodes={currentConfig ?? []} onNodeUpdate={handleNodeUpdate} onEditCategory={modalAddCategory} />\n\t</div>\n</div>\n"],"names":["name","$.derived","$$props","icon","isCategory","containerClass","$.get","iconClass","handleClick","e","div","root","node","$.child","button","root_1","iconify_icon","$.reset","$.append","$$anchor","div_1","root_2","$$render","consequent","alternate","div_2","$.sibling","iconify_icon_1","$.template_effect","$.set_custom_element_data","div_3","root_3","consequent_1","div_4","div_5","span","span_1","root_4","span_2","root_5","consequent_2","alternate_1","div_6","root_6","div_7","root_7","span_3","text_1","$.set_attribute","consequent_3","screen","consequent_4","span_4","root_8","consequent_5","div_8","node_5","button_1","goto","iconify_icon_2","button_2","iconify_icon_3","button_3","iconify_icon_4","div_9","iconify_icon_5","$.set_class","$.clsx","toTreeViewData","nodes","parentPath","result","n","id","path","children","rest","item","childItems","toFlatContentNodes","flatItems","siblingGroups","parentKey","siblings","a","b","aSegments","bSegments","orderLookup","index","parentId","segments","recalculatePaths","items","itemMap","childrenByParent","assignPaths","key","child","newPath","treeNode","$.noop","level","$1","expandedNodes","TreeViewNode","toggleNode","toPartialContentNode","node_2","flip","flipDurationMs","$.action","$$node","$$action_arg","dndzone","handleNestedDndConsider","handleNestedDndFinalize","contentNodes","$.prop","searchText","$.state","treeData","$.proxy","initialized","isDragging","$.user_effect","filteredItems","searchLower","hierarchicalData","roots","enhanced","parent","rootItems","expandAll","collapseAll","$.set","clearSearch","handleRootDndConsider","info","TRIGGERS","updateRootItems","handleRootDndFinalize","updatedItems","saveTreeData","newItems","newRootIds","itemsToKeep","processedIds","stripEnhanced","getAllDescendants","desc","i","updateItemsAtLevel","newChildIds","itemId","descendants","base","contentNodeProps","$.first_child","fragment_1","input","fragment_2","p","fragment_3","root_10","div_10","root_11","node_7","$.event","alternate_2","div_11","root_12","iconify_icon_6","$$value","existingCategory","formData","isSubmitting","formError","validationErrors","validateForm","errors","onFormSubmit","event","logger","error","deleteCategory","contentStructure","response","errorResult","success","newStructure","form","node_1","label","$.remove_input_defaults","$.set_text","text_2","label_1","IconifyPicker","node_3","text_3","footer","m.button_delete","node_6","$3","m.modalcategory_categoryname","m.modalcategory_placeholder","m.button_cancel","m.button_save","$.bind_value","generateId","currentConfig","nodesToSave","isLoading","apiError","modalAddCategory","modalState","ModalCategory","updateExistingCategory","addNewCategory","toaster","updatedCategory","newCategory","handleNodeUpdate","updatedNodes","handleSave","setContentStructure","handleAddCollectionClick","setMode","setCollectionValue","ui","setRouteContext","page","m.collection_addcategory","m.collection_add","$0","m.collection_pagetitle","PageTitle","button_4","button_5","iconify_icon_7","span_5","TreeViewBoard","text_7","m.collection_description"],"mappings":"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"}