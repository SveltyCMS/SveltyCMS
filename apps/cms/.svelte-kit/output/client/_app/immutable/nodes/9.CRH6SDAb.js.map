{"version":3,"file":"9.CRH6SDAb.js","sources":["../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/+page.ts","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionForm.svelte","../../../../../../../../shared/components/src/VerticalList.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget/ModalSelectWidget.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget/tabsFields/Default.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget/tabsFields/Permission.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget/tabsFields/Specific.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget/ModalWidgetForm.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/tabs/CollectionWidget.svelte","../../../../../../src/routes/config/collectionbuilder/[action]/[...contentPath]/+page.svelte"],"sourcesContent":["/**\n * @file src/routes/(app)/config/collectionbuilder/[action]/[...contentPath]/+page.ts\n * @description Client-side logic for Collection Builder configuration pages.\n *\n * Features:\n * - Loads data prepared by the corresponding +page.server.ts file.\n * - Passes server-loaded data to the client for rendering.\n */\n\nimport type { PageLoad } from './$types';\n\nexport const load: PageLoad = ({ data }) => {\n\treturn data;\n};\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionForm.svelte\n@component\n**This component displays the collection form**\n\n### Props:\n- `collection` {object} - Collection object\n- `handlePageTitleUpdate` {function} - Function to update the page title\n\n### Features:\n- Collection Name\n- Collection Icon\n- Collection Description\n-->\n\n<script lang=\"ts\">\n\timport { untrack } from 'svelte';\n\t// Stores\n\timport { page } from '$app/state';\n\timport { tabSet } from '@shared/stores/store.svelte';\n\timport { collection, setCollection } from '@shared/stores/collectionStore.svelte';\n\n\t// Components\n\timport IconifyPicker from '@cms/components/IconifyPicker.svelte';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Skeleton\n\t// Collection Manager\n\n\tconst props = $props();\n\n\t//action\n\tconst action = page.params.action;\n\n\t// Form fields\n\tlet searchQuery = $state('');\n\tlet autoUpdateSlug = $state(true);\n\tlet selectedIcon = $state(props.data?.icon || '');\n\n\t// Form field values\n\tlet name = $state(props.data?.name ?? '');\n\tlet slug = $state(props.data?.slug ?? '');\n\tlet description = $state(props.data?.description ?? '');\n\tlet status = $state(props.data?.status ?? 'unpublished');\n\n\t// Update form fields when props.data changes (for async loading)\n\t$effect(() => {\n\t\tif (props.data) {\n\t\t\tname = props.data.name ?? '';\n\t\t\tslug = props.data.slug ?? '';\n\t\t\tdescription = props.data.description ?? '';\n\t\t\tstatus = props.data.status ?? 'unpublished';\n\t\t\tselectedIcon = props.data.icon ?? '';\n\t\t}\n\t});\n\n\t// Derived values\n\tconst DBName = $derived(name ? name.toLowerCase().replace(/ /g, '_') : '');\n\n\t// Update collection value when icon changes\n\t$effect(() => {\n\t\t// Only track the selectedIcon, not the collection\n\t\tconst currentIcon = selectedIcon;\n\n\t\tuntrack(() => {\n\t\t\tif (collection.value && currentIcon !== collection.value.icon) {\n\t\t\t\tsetCollection({\n\t\t\t\t\t...collection.value,\n\t\t\t\t\ticon: currentIcon\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\t// Update collection value when form fields change (only if editing an existing collection)\n\t$effect(() => {\n\t\t// Only track the form field changes, not the collection itself\n\t\tconst currentName = name;\n\t\tconst currentSlug = slug;\n\t\tconst currentDescription = description;\n\t\tconst currentStatus = status;\n\t\tconst currentIcon = selectedIcon;\n\n\t\t// Use untrack to prevent reading collection.value from triggering this effect again\n\t\tuntrack(() => {\n\t\t\tif (collection.value?._id) {\n\t\t\t\t// Check if values have actually changed to avoid unnecessary updates\n\t\t\t\tif (\n\t\t\t\t\tcollection.value.name === currentName &&\n\t\t\t\t\tcollection.value.slug === currentSlug &&\n\t\t\t\t\tcollection.value.description === currentDescription &&\n\t\t\t\t\tcollection.value.status === currentStatus &&\n\t\t\t\t\tcollection.value.icon === currentIcon\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsetCollection({\n\t\t\t\t\t...collection.value, // Spread existing values (including _id)\n\t\t\t\t\tname: currentName,\n\t\t\t\t\tslug: currentSlug,\n\t\t\t\t\tdescription: currentDescription,\n\t\t\t\t\tstatus: currentStatus,\n\t\t\t\t\ticon: currentIcon // Ensure icon is updated\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\tfunction handleNameInput() {\n\t\tif (typeof name === 'string' && name) {\n\t\t\t// Update the URL\n\t\t\twindow.history.replaceState({}, '', `/config/collectionbuilder/${action}/${slug}`);\n\n\t\t\t// Update the page title\n\t\t\tprops.handlePageTitleUpdate(name);\n\n\t\t\t// Update the linked slug input\n\t\t\tslug = name.toLowerCase().replace(/\\s+/g, '_');\n\n\t\t\t// Call the `onSlugInput` function to update the slug variable\n\t\t\tonSlugInput();\n\t\t}\n\t}\n\n\tfunction onSlugInput() {\n\t\t// Update the slug field whenever the name field is changed\n\t\tif (name) {\n\t\t\tslug = name.toLowerCase().replace(/\\s+/g, '_');\n\t\t\treturn slug;\n\t\t}\n\t\t// Disable automatic slug updates\n\t\tautoUpdateSlug = false;\n\t}\n\n\t// Update slug and page title when name changes\n\t$effect(() => {\n\t\t// Only track the name and autoUpdateSlug, not the collection\n\t\tconst currentName = name;\n\t\tconst shouldAutoUpdate = autoUpdateSlug;\n\n\t\t// Automatically update slug when name changes\n\t\tif (shouldAutoUpdate && currentName) {\n\t\t\tslug = currentName.toLowerCase().replace(/ /g, '_');\n\t\t}\n\n\t\t// Update page title based on action and collection name\n\t\tif (action === 'edit') {\n\t\t\tprops.handlePageTitleUpdate(currentName);\n\t\t} else if (currentName) {\n\t\t\tprops.handlePageTitleUpdate(currentName);\n\t\t} else {\n\t\t\tprops.handlePageTitleUpdate(`new`);\n\t\t}\n\t});\n\n\t// Import status types from the content types\n\timport { StatusTypes } from '@cms-types';\n\tconst statuses = Object.values(StatusTypes);\n\n\tfunction handleNextClick() {\n\t\ttabSet.set(1);\n\t}\n</script>\n\n<!-- Single Column Layout Container -->\n<div class=\"flex w-full flex-col\">\n\t<!-- Form Fields Section -->\n\t<div class=\"flex flex-col gap-2 rounded border p-4\">\n\t\t<!-- Collection Name -->\n\t\t<div class=\"flex flex-col\">\n\t\t\t<label for=\"name\" class=\"mb-1 flex items-center font-medium\">\n\t\t\t\t{m.collection_name()} <span class=\"mx-1 text-error-500\">*</span>\n\t\t\t\t<iconify-icon\n\t\t\t\t\ticon=\"material-symbols:info\"\n\t\t\t\t\ttitle={`${m.collection_name_tooltip1()} ${m.collection_name_tooltip2()}`}\n\t\t\t\t\twidth=\"18\"\n\t\t\t\t\tclass=\"ml-1 cursor-pointer text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t></iconify-icon>\n\t\t\t</label>\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\trequired\n\t\t\t\tid=\"name\"\n\t\t\t\tname=\"name\"\n\t\t\t\tdata-testid=\"collection-name-input\"\n\t\t\t\tbind:value={name}\n\t\t\t\toninput={handleNameInput}\n\t\t\t\tplaceholder={m.collection_name_placeholder()}\n\t\t\t\taria-label={m.collection_name()}\n\t\t\t\tclass=\"input w-full text-black dark:text-primary-500\"\n\t\t\t/>\n\t\t\t{#if name}\n\t\t\t\t<!-- Show DBName if name is entered -->\n\t\t\t\t<p class=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t{m.collection_DBname()}\n\t\t\t\t\t<span class=\"font-bold text-tertiary-500 dark:text-primary-500\">{DBName}</span>\n\t\t\t\t</p>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<!-- Separator (Optional) -->\n\t\t<hr class=\"my-2 border-gray-300 dark:border-gray-600\" />\n\n\t\t<p class=\"base-font-color mb-0 text-center font-bold\">{m.collectionname_optional()}:</p>\n\n\t\t<!-- Icon -->\n\t\t<div class=\"flex flex-col\">\n\t\t\t<label for=\"icon\" class=\"mb-1 flex items-center font-medium\">\n\t\t\t\t{m.collectionname_labelicon()}\n\t\t\t\t<iconify-icon\n\t\t\t\t\ticon=\"material-symbols:info\"\n\t\t\t\t\ttitle={m.collection_icon_tooltip()}\n\t\t\t\t\twidth=\"18\"\n\t\t\t\t\tclass=\"ml-1 cursor-pointer text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t></iconify-icon>\n\t\t\t</label>\n\t\t\t<IconifyPicker bind:iconselected={selectedIcon} bind:searchQuery />\n\t\t</div>\n\n\t\t<!-- Slug -->\n\t\t<div class=\"flex flex-col\">\n\t\t\t<label for=\"slug\" class=\"mb-1 flex items-center font-medium\">\n\t\t\t\t{m.collection_slug()}\n\t\t\t\t<iconify-icon\n\t\t\t\t\ticon=\"material-symbols:info\"\n\t\t\t\t\ttitle={m.collection_slug_tooltip()}\n\t\t\t\t\twidth=\"18\"\n\t\t\t\t\tclass=\"ml-1 cursor-pointer text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t></iconify-icon>\n\t\t\t</label>\n\t\t\t<input type=\"text\" id=\"slug\" bind:value={slug} placeholder={m.collection_slug_input()} class=\"input w-full text-black dark:text-primary-500\" />\n\t\t</div>\n\n\t\t<!-- Description -->\n\t\t<div class=\"flex flex-col\">\n\t\t\t<label for=\"description\" class=\"mb-1 flex items-center font-medium\">\n\t\t\t\t{m.collectionname_description()}\n\t\t\t\t<iconify-icon\n\t\t\t\t\ticon=\"material-symbols:info\"\n\t\t\t\t\ttitle={m.collection_description()}\n\t\t\t\t\twidth=\"18\"\n\t\t\t\t\tclass=\"ml-1 cursor-pointer text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t></iconify-icon>\n\t\t\t</label>\n\t\t\t<textarea\n\t\t\t\tid=\"description\"\n\t\t\t\trows=\"2\"\n\t\t\t\tbind:value={description}\n\t\t\t\tplaceholder={m.collection_description_placeholder()}\n\t\t\t\tclass=\"input w-full text-black dark:text-primary-500\"\n\t\t\t></textarea>\n\t\t</div>\n\n\t\t<!-- Status -->\n\t\t<div class=\"flex flex-col\">\n\t\t\t<label for=\"status\" class=\"mb-1 flex items-center font-medium\">\n\t\t\t\t{m.collection_status()}\n\t\t\t\t<iconify-icon\n\t\t\t\t\ticon=\"material-symbols:info\"\n\t\t\t\t\ttitle={m.collection_status_tooltip()}\n\t\t\t\t\twidth=\"18\"\n\t\t\t\t\tclass=\"ml-1 cursor-pointer text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t></iconify-icon>\n\t\t\t</label>\n\t\t\t<select id=\"status\" bind:value={status} class=\"select w-full text-black dark:text-primary-500\">\n\t\t\t\t{#each statuses as statusOption}\n\t\t\t\t\t<option value={statusOption}>{statusOption}</option>\n\t\t\t\t{/each}\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\n\t<!-- Buttons Section -->\n\t<div class=\"mt-6 flex flex-col gap-2 sm:flex-row sm:justify-between\">\n\t\t<a href=\"/config/collectionbuilder\" class=\"preset-outlined-secondary-500 btn sm:w-auto\">{m.button_cancel()}</a>\n\t\t<button type=\"button\" onclick={handleNextClick} class=\"preset-filled-tertiary-500 btn dark:preset-filled-primary-500 sm:w-auto\"\n\t\t\t>{m.button_next()}</button\n\t\t>\n\t</div>\n</div>\n","<!-- \n@file src/components/VerticalList.svelte\n@component\n**VerticalList component for displaying items in a vertical list with drag-and-drop functionality**\n\n```tsx\n<VerticalList  items={items}  headers={headers} flipDurationMs={200} handleDndConsider={handleDndConsider} handleDndFinalize={handleDndFinalize}  children={children} />\n```\n\n### Props\n- `items` {array} - Array of items to be displayed in the list\n- `headers` {array} - Array of headers for the table columns\n- `flipDurationMs` {number} - Duration of the flip animation in milliseconds\n- `handleDndConsider` {function} - Function to handle drag-and-drop consider event\n- `handleDndFinalize` {function} - Function to handle drag-and-drop finalize event\n- `children` {function} - Function to render the content of the list\n-->\n\n<script lang=\"ts\">\n\timport { dndzone } from 'svelte-dnd-action';\n\timport type { DndEvent } from 'svelte-dnd-action';\n\n\tinterface Props {\n\t\titems: Record<string, unknown>[];\n\t\theaders?: string[];\n\t\tflipDurationMs: number;\n\t\thandleDndConsider: (e: CustomEvent<DndEvent>) => void;\n\t\thandleDndFinalize: (e: CustomEvent<DndEvent>) => void;\n\t\tchildren?: import('svelte').Snippet;\n\t}\n\n\tconst { items, headers = [], flipDurationMs, handleDndConsider, handleDndFinalize, children }: Props = $props();\n\n\tconst gridClass = $derived(\n\t\t`grid grid-cols-${headers.length + 1} preset-outlined-tertiary-500 dark:preset-outlined-primary-500 w-full items-start justify-start p-1 py-2 pl-3 text-center font-semibold`\n\t);\n</script>\n\n<div class=\"h-full overflow-y-auto\">\n\t<!-- Header -->\n\t{#if headers.length > 0}\n\t\t<div class={gridClass}>\n\t\t\t{#each headers as header, index (index)}\n\t\t\t\t<div class=\"ml-2 text-left\">{header}:</div>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n\n\t<section use:dndzone={{ items: items, flipDurationMs }} onconsider={handleDndConsider} onfinalize={handleDndFinalize} class=\"my-1 w-full\">\n\t\t<!-- Data -->\n\t\t{@render children?.()}\n\t</section>\n</div>\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionWidget/ModalSelectWidget.svelte\n@component\n**This component displays a modal for selecting a widget**\n-->\n\n<script lang=\"ts\">\n\t// Modern widget system\n\timport { widgets } from '@shared/stores/widgetStore.svelte';\n\timport { logger } from '@shared/utils/logger';\n\timport { onMount } from 'svelte';\n\n\t// Skeleton Stores\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\n\t// Props\n\tinterface Props {\n\t\t/** Exposes parent props to this component. */\n\t\tparent: any;\n\t}\n\tconst { parent }: Props = $props();\n\n\t// Define the search term variable\n\tlet searchTerm: string = $state('');\n\n\t// Get available widgets from the modern store\n\tconst availableWidgets = $derived(widgets.widgetFunctions || {});\n\n\t// Initialize widgets on mount\n\tonMount(async () => {\n\t\tawait widgets.initialize();\n\t});\n\n\t// We've created a custom submit function to pass the response and close the modal.\n\tfunction onFormSubmit(selected: any): void {\n\t\tif (selected !== null) {\n\t\t\t// close the modal and pass response\n\t\t\tmodalState.close({ selectedWidget: selected });\n\t\t} else {\n\t\t\tlogger.error('No widget selected');\n\t\t}\n\t}\n\n\t// Base Classes\n\tconst cBase = 'card p-6 w-full max-w-5xl h-[85vh] flex flex-col shadow-2xl bg-white dark:bg-surface-800';\n\tconst cHeader = 'text-3xl font-bold text-center mb-6 text-surface-900 dark:text-white';\n\n\t// Tooltip not needed with new card design showing description\n</script>\n\n{#if modalState.active}\n\t<div class={cBase}>\n\t\t<header class=\"flex items-center justify-between border-b border-surface-200 pb-4 dark:text-surface-50\">\n\t\t\t<h2 class={cHeader}>\n\t\t\t\t{modalState.active?.props?.title || 'Select Widget'}\n\t\t\t</h2>\n\t\t\t<button class=\"btn-icon preset-outlined-surface-500\" onclick={parent.onClose} aria-label=\"Close modal\">\n\t\t\t\t<iconify-icon icon=\"mdi:close\" width=\"24\"></iconify-icon>\n\t\t\t</button>\n\t\t</header>\n\n\t\t<!-- Search -->\n\t\t<div class=\"relative my-4\">\n\t\t\t<iconify-icon icon=\"mdi:magnify\" width=\"24\" class=\"absolute left-4 top-1/2 -translate-y-1/2 text-surface-400\"></iconify-icon>\n\t\t\t<input type=\"text\" placeholder=\"Search widgets...\" class=\"input h-12 w-full pl-12 text-lg\" bind:value={searchTerm} />\n\t\t</div>\n\n\t\t<!-- Grid -->\n\t\t<div class=\"flex-1 overflow-y-auto p-6\">\n\t\t\t{#each ['Core', 'Custom', 'Marketplace'] as category}\n\t\t\t\t{@const categoryKeys =\n\t\t\t\t\tcategory === 'Core'\n\t\t\t\t\t\t? widgets.coreWidgets\n\t\t\t\t\t\t: category === 'Custom'\n\t\t\t\t\t\t\t? widgets.customWidgets\n\t\t\t\t\t\t\t: category === 'Marketplace'\n\t\t\t\t\t\t\t\t? widgets.marketplaceWidgets\n\t\t\t\t\t\t\t\t: []}\n\n\t\t\t\t{@const filteredKeys = categoryKeys.filter((key) => !searchTerm || key.toLowerCase().includes(searchTerm.toLowerCase()))}\n\n\t\t\t\t{#if filteredKeys.length > 0}\n\t\t\t\t\t<div class=\"mb-8 last:mb-0\">\n\t\t\t\t\t\t<h3 class=\"mb-4 text-xl font-bold uppercase tracking-wider text-surface-500 dark:text-surface-50\">\n\t\t\t\t\t\t\t{category} Widgets\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<div class=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n\t\t\t\t\t\t\t{#each filteredKeys as item}\n\t\t\t\t\t\t\t\t{#if item && (availableWidgets[item] as any)?.GuiSchema}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tonclick={() => onFormSubmit(item)}\n\t\t\t\t\t\t\t\t\t\tclass=\"group relative flex flex-col gap-3 rounded-xl border border-surface-200 bg-surface-50 p-5 text-left transition-all hover:-translate-y-1 hover:border-primary-500 hover:shadow-lg dark:text-surface-50 dark:bg-surface-800 dark:hover:border-primary-500\"\n\t\t\t\t\t\t\t\t\t\taria-label={item}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex items-start justify-between w-full\">\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"flex h-12 w-12 items-center justify-center rounded-lg bg-surface-200 text-surface-600 transition-colors group-hover:bg-primary-500 group-hover:text-white dark:bg-surface-700 dark:text-surface-300\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<iconify-icon icon={availableWidgets[item]?.Icon} width=\"28\"></iconify-icon>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<!-- Optional: Add specific badges here if metadata existed -->\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<h3 class=\"text-lg font-bold text-surface-900 group-hover:text-primary-500 dark:text-white dark:group-hover:text-primary-400\">\n\t\t\t\t\t\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"mt-1 line-clamp-2 text-xs text-surface-500 dark:text-surface-50\">\n\t\t\t\t\t\t\t\t\t\t\t\t{availableWidgets[item]?.Description || 'No description available'}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t{/each}\n\n\t\t\t<!-- Empty State -->\n\t\t\t{#if [...widgets.coreWidgets, ...widgets.customWidgets, ...widgets.marketplaceWidgets].filter((key) => key\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.includes(searchTerm.toLowerCase())).length === 0}\n\t\t\t\t<div class=\"flex flex-col items-center justify-center py-20 opacity-50\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:package-variant-closed\" width=\"64\" class=\"mb-4\"></iconify-icon>\n\t\t\t\t\t<p class=\"text-xl\">No widgets found for \"{searchTerm}\"</p>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n{/if}\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionWidget/tabsFields/Default.svelte\n@component\n**This component displays the default tab fields**\n\nFeatures:\n- Label\n- Display\n- DB Field Name\n- Required\n- Translated\n- Icon\n- Helper\n- Width\n\n-->\n\n<script lang=\"ts\">\n\timport { asAny } from '@shared/utils/utils';\n\timport type { Component } from 'svelte';\n\n\t// Components\n\timport InputSwitch from '@cms/components/system/builder/InputSwitch.svelte';\n\n\t// Skeleton Stores\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\n\t// Stores\n\timport { collections } from '@shared/stores/collectionStore.svelte';\n\n\t// GuiSchema is a record of field properties with their widget configs\n\ttype GuiSchema = Record<string, { widget: Component<any> }>;\n\n\tinterface Props {\n\t\tguiSchema: GuiSchema;\n\t}\n\n\tconst { guiSchema }: Props = $props();\n\n\t// Get all properties from the guiSchema\n\tconst allProperties = $derived(Object.keys(guiSchema || {}));\n\n\t// Define standard/default properties that should appear first\n\tconst standardProperties = ['label', 'db_fieldName', 'required', 'translated', 'icon', 'helper', 'width'];\n\n\t// Get additional properties from the widget's GuiSchema\n\tconst additionalProperties = $derived(allProperties.filter((prop) => !standardProperties.includes(prop) && prop !== 'permissions'));\n\n\t// Combine them in order: standard first, then additional\n\tconst displayProperties = $derived([...standardProperties, ...additionalProperties]);\n\n\tfunction defaultValue(property: string) {\n\t\tif (property === 'required' || property === 'translated') {\n\t\t\treturn false;\n\t\t} else return (collections.targetWidget.widget as any)?.Name;\n\t}\n\n\tfunction handleUpdate(detail: { value: any }, property: string) {\n\t\t// Update the targetWidget store\n\t\tconst currentWidget = collections.targetWidget;\n\t\tcurrentWidget[property] = detail.value;\n\t\tcollections.setTargetWidget(currentWidget);\n\t}\n</script>\n\n{#if modalState.active}\n\t<!-- Default section -->\n\t<div class=\"flex flex-col gap-4\">\n\t\t{#each displayProperties as property}\n\t\t\t{#if guiSchema[property]}\n\t\t\t\t<InputSwitch\n\t\t\t\t\tvalue={collections.targetWidget[property] ?? defaultValue(property)}\n\t\t\t\t\ticon={collections.targetWidget[property] as string}\n\t\t\t\t\twidget={asAny(guiSchema[property]?.widget)}\n\t\t\t\t\tkey={property}\n\t\t\t\t\tonupdate={(e: { value: any }) => handleUpdate(e, property)}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t{/each}\n\t</div>\n{/if}\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionWidget/tabsFields/Permission.svelte\n@component\n**This component handles permission settings for widget fields**\n\nFeatures:\n- Permissions settings\n\n-->\n\n<script lang=\"ts\">\n\t// Components\n\timport PermissionsSetting from '@cms/components/PermissionsSetting.svelte';\n\t// Skeleton Stores\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\timport { collections } from '@shared/stores/collectionStore.svelte';\n\n\t// Function to handle permission updates\n\tfunction handlePermissionUpdate(updatedPermissions: Record<string, Record<string, boolean>>) {\n\t\tconst w = collections.targetWidget;\n\t\tif (!w) return;\n\t\tw.permissions = updatedPermissions;\n\t\tcollections.setTargetWidget(w);\n\t}\n\n\t// Get roles from the modal props\n\tconst roles = $derived(modalState.active?.props?.value?.roles || []);\n</script>\n\n{#if modalState.active}\n\t<div class=\"mb-4\">\n\t\t<PermissionsSetting {roles} permissions={collections.targetWidget.permissions || {}} onUpdate={handlePermissionUpdate} />\n\t</div>\n{/if}\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionWidget/tabsFields/Specific.svelte\n@component\n**This component displays specific tab fields for a widget**\n\nFeatures:\n- Specific tab fields\n\n-->\n\n<script lang=\"ts\">\n\timport { asAny } from '@shared/utils/utils';\n\n\t// Components\n\timport { widgets } from '@shared/stores/widgetStore.svelte';\n\timport InputSwitch from '@cms/components/system/builder/InputSwitch.svelte';\n\n\t// Skeleton Stores\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\timport { collections } from '@shared/stores/collectionStore.svelte';\n\n\t// Removed modalStore\n\n\t// Define widget keys and excluded fields for specificity\n\tconst defaultFields = ['label', 'display', 'db_fieldName', 'required', 'translated', 'icon', 'helper', 'width', 'permissions'];\n\n\t// Reactive statements to derive widget-related data\n\tconst currentWidgetName = $derived((collections.targetWidget as any)?.widget?.Name);\n\tconst currentGuiSchema = $derived(currentWidgetName ? (widgets.widgetFunctions[currentWidgetName] as any)?.GuiSchema || null : null);\n\tconst specificFields = $derived(currentGuiSchema ? Object.keys(currentGuiSchema).filter((key) => !defaultFields.includes(key)) : []);\n\n\t/** Updates the target widget property */\n\tfunction handleUpdate(detail: { value: any }, property: string) {\n\t\tconst currentWidget = collections.targetWidget;\n\t\tcurrentWidget[property] = detail.value;\n\t\tcollections.setTargetWidget(currentWidget);\n\t}\n</script>\n\n{#if modalState.active && currentGuiSchema && specificFields.length > 0}\n\t{#each specificFields as property}\n\t\t<InputSwitch\n\t\t\tvalue={collections.targetWidget[property]}\n\t\t\tonupdate={(e: { value: any }) => handleUpdate(e, property)}\n\t\t\twidget={asAny((currentGuiSchema as any)[property]?.widget)}\n\t\t\tkey={property}\n\t\t/>\n\t{/each}\n{:else if modalState.active && currentWidgetName}\n\t<div class=\"text-center text-sm text-gray-500\">No specific options for this widget type</div>\n{/if}\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/tabs/CollectionWidget/ModalWidgetForm.svelte\n@component\n**The ModalWidgetForm component is used to display and manage the form for the selected widget in the CollectionWidget component** \nIt handles widget configuration, permissions, and specific options.\n-->\n\n<script lang=\"ts\">\n\timport { type SvelteComponent } from 'svelte';\n\n\t// Components\n\timport { widgetFunctions } from '@shared/stores/widgetStore.svelte';\n\timport Default from './tabsFields/Default.svelte';\n\timport Permission from './tabsFields/Permission.svelte';\n\timport Specific from './tabsFields/Specific.svelte';\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Stores\n\timport { collectionValue, setCollectionValue, targetWidget } from '@shared/stores/collectionStore.svelte';\n\n\timport { Tabs } from '@skeletonlabs/skeleton-svelte';\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\n\tlet localTabSet = $state('0');\n\n\t// Props\n\n\tinterface Props {\n\t\t/** Exposes parent props to this component. */\n\t\tparent?: any;\n\t\tvalue: any;\n\t\tresponse?: (r: any) => void;\n\t\ttitle?: string;\n\t\tbody?: string;\n\t}\n\n\tconst { value, response, title, body }: Props = $props();\n\n\t// Local variables\n\t// const modalData = $derived($modalStore[0]);\n\t// Use props directly instead of modalData\n\t// Widget key is the folder name (lowercase), not the widget Name\n\tconst widgetKey = $derived(value?.widget?.key || (value?.widget?.Name?.toLowerCase() as string));\n\tconst availableWidgets = $derived($widgetFunctions || {});\n\tconst guiSchema = $derived((availableWidgets[widgetKey]?.GuiSchema || {}) as Record<string, { widget: typeof SvelteComponent }>);\n\n\t// Derive options from guiSchema\n\tconst options = $derived(guiSchema ? Object.keys(guiSchema) : []);\n\tconst specificOptions = $derived(\n\t\toptions.filter(\n\t\t\t(option) => !['label', 'display', 'db_fieldName', 'required', 'translated', 'icon', 'helper', 'width', 'permissions'].includes(option)\n\t\t)\n\t);\n\n\t// We've created a custom submit function to pass the response and close the modal.\n\tasync function onFormSubmit(): Promise<void> {\n\t\tif (response) {\n\t\t\tresponse(targetWidget);\n\t\t}\n\t\tmodalState.close();\n\t}\n\n\t// Function to delete the widget\n\tfunction deleteWidget() {\n\t\tconst confirmDelete = confirm('Are you sure you want to delete this widget?');\n\t\tif (confirmDelete) {\n\t\t\t// Perform deletion logic here\n\t\t\tif (collectionValue && Array.isArray(collectionValue.value.fields)) {\n\t\t\t\tconst newFields = (collectionValue.value.fields as any[]).filter((field: any) => field.id !== value.id);\n\t\t\t\tsetCollectionValue({\n\t\t\t\t\t...collectionValue.value,\n\t\t\t\t\tfields: newFields\n\t\t\t\t});\n\t\t\t}\n\t\t\tmodalState.close();\n\t\t}\n\t}\n\n\t// Base Classes\n\tconst cForm = 'border border-surface-500 p-4 space-y-4 rounded-xl';\n</script>\n\n<div class=\"space-y-4\">\n\t<header class=\"text-2xl font-bold text-center\">\n\t\t{title ?? '(title missing)'}\n\t</header>\n\t<article class=\"text-center\">\n\t\t{body ?? '(body missing)'}\n\t</article>\n\n\t<!-- Tabs Headers -->\n\t<form class={cForm}>\n\t\t<Tabs value={localTabSet} onValueChange={(e) => (localTabSet = e.value)}>\n\t\t\t<Tabs.List class=\"flex justify-between lg:justify-start border-b border-surface-200-800\">\n\t\t\t\t<Tabs.Trigger value=\"0\">\n\t\t\t\t\t<div class=\"flex items-center gap-1 py-2 px-4\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:required\" width=\"24\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t<span>Default</span>\n\t\t\t\t\t</div>\n\t\t\t\t</Tabs.Trigger>\n\t\t\t\t<Tabs.Trigger value=\"1\">\n\t\t\t\t\t<div class=\"flex items-center gap-1 py-2 px-4\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:security-lock\" width=\"24\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t<span>{m.system_permission()}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</Tabs.Trigger>\n\n\t\t\t\t{#if specificOptions.length > 0}\n\t\t\t\t\t<Tabs.Trigger value=\"2\">\n\t\t\t\t\t\t<div class=\"flex items-center gap-1 py-2 px-4\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"ph:star-fill\" width=\"24\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t<span>Specific</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Tabs.Trigger>\n\t\t\t\t{/if}\n\t\t\t</Tabs.List>\n\n\t\t\t<Tabs.Content value=\"0\">\n\t\t\t\t<Default guiSchema={guiSchema as any} />\n\t\t\t</Tabs.Content>\n\t\t\t<Tabs.Content value=\"1\">\n\t\t\t\t<Permission />\n\t\t\t</Tabs.Content>\n\t\t\t{#if specificOptions.length > 0}\n\t\t\t\t<Tabs.Content value=\"2\">\n\t\t\t\t\t<Specific />\n\t\t\t\t</Tabs.Content>\n\t\t\t{/if}\n\t\t</Tabs>\n\t</form>\n\n\t<div class=\"hidden\"></div>\n\n\t<footer class=\"flex justify-between pt-4 border-t border-surface-500/20\">\n\t\t<!-- Delete Button -->\n\t\t<button type=\"button\" onclick={deleteWidget} aria-label=\"Delete\" class=\"preset-filled-error-500 btn\">\n\t\t\t<iconify-icon icon=\"icomoon-free:bin\" width=\"24\"></iconify-icon>\n\t\t\t<span class=\"hidden sm:block\">{m.button_delete()}</span>\n\t\t</button>\n\n\t\t<!-- Cancel & Save Buttons -->\n\t\t<div class=\"flex justify-between gap-4\">\n\t\t\t<button type=\"button\" aria-label={m.button_cancel()} class=\"btn preset-outlined-secondary-500\" onclick={() => modalState.close()}\n\t\t\t\t>{m.button_cancel()}</button\n\t\t\t>\n\t\t\t<button type=\"button\" aria-label={m.button_save()} class=\"btn preset-filled-primary-500\" onclick={onFormSubmit}>{m.button_save()}</button>\n\t\t</div>\n\t</footer>\n</div>\n","<!--\n@fil src/routes/(app)/config/collectionbuilder/[...ContentTypes]/tabs/CollectionWidget.svelte\ncomponent\n**This component displays the collection widget**\n-->\n\n<script lang=\"ts\">\n\t// Stores\n\timport { page } from '$app/state';\n\timport { logger } from '@shared/utils/logger';\n\timport { collection, setTargetWidget } from '@shared/stores/collectionStore.svelte';\n\timport { tabSet } from '@shared/stores/store.svelte';\n\timport { asAny, getGuiFields } from '@shared/utils/utils';\n\t// Components\n\timport VerticalList from '@cms/components/VerticalList.svelte';\n\timport { widgetFunctions } from '@shared/stores/widgetStore.svelte';\n\timport { get } from 'svelte/store';\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Skeleton\n\n\timport { modalState } from '@shared/utils/modalState.svelte';\n\timport ModalSelectWidget from './CollectionWidget/ModalSelectWidget.svelte';\n\timport ModalWidgetForm from './CollectionWidget/ModalWidgetForm.svelte';\n\n\tconst props = $props();\n\n\t// Extract the collection path from the URL\n\tconst contentPath = page.params.contentPath;\n\n\t// Helper function to map fields\n\tfunction mapFieldsWithWidgets(fields: any[]) {\n\t\tif (!fields) return [];\n\t\treturn fields.map((field, index) => {\n\t\t\tconst widgetType =\n\t\t\t\tfield.widget?.key || // For new widgets\n\t\t\t\tfield.widget?.Name || // For existing widgets\n\t\t\t\tfield.__type || // For schema-defined widgets\n\t\t\t\tfield.type || // Backup type field\n\t\t\t\tObject.keys(get(widgetFunctions)).find((key) => field[key]) || // Check if field has widget property\n\t\t\t\t'Unknown Widget'; // Fallback\n\n\t\t\treturn {\n\t\t\t\tid: index + 1,\n\t\t\t\t...field,\n\t\t\t\twidget: {\n\t\t\t\t\tkey: widgetType,\n\t\t\t\t\tName: widgetType,\n\t\t\t\t\t...field.widget\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t}\n\n\t// Use state for fields (not derived, since we need to mutate it via drag-and-drop)\n\tlet fields = $state(mapFieldsWithWidgets(props.fields ?? []));\n\n\t// Watch for changes in props.fields and update our state\n\t$effect(() => {\n\t\tif (props.fields) {\n\t\t\tfields = mapFieldsWithWidgets(props.fields);\n\t\t}\n\t});\n\n\t// Collection headers\n\tconst headers = ['Id', 'Icon', 'Name', 'DBName', 'Widget'];\n\n\t// svelte-dnd-action\n\tconst flipDurationMs = 300;\n\n\tconst handleDndConsider = (e: CustomEvent) => {\n\t\tfields = e.detail.items;\n\t};\n\n\tconst handleDndFinalize = (e: CustomEvent) => {\n\t\tfields = e.detail.items;\n\t};\n\n\tfunction modalSelectWidget(): void {\n\t\tmodalState.trigger(\n\t\t\tModalSelectWidget as any,\n\t\t\t{\n\t\t\t\ttitle: 'Select a Widget',\n\t\t\t\tbody: 'Select your widget and then press submit.'\n\t\t\t},\n\t\t\t(r: { selectedWidget: string } | undefined) => {\n\t\t\t\tif (!r) return;\n\t\t\t\tconst { selectedWidget } = r;\n\t\t\t\tconst widgetInstance = get(widgetFunctions)[selectedWidget];\n\t\t\t\tif (selectedWidget && widgetInstance) {\n\t\t\t\t\t// Create a new widget object with the selected widget data\n\t\t\t\t\tconst newWidget = {\n\t\t\t\t\t\twidget: { key: selectedWidget, Name: selectedWidget },\n\t\t\t\t\t\tGuiFields: getGuiFields({ key: selectedWidget }, asAny(widgetInstance.GuiSchema)),\n\t\t\t\t\t\tpermissions: {} // Initialize empty permissions object\n\t\t\t\t\t};\n\t\t\t\t\t// Call modalWidgetForm with the new widget object\n\t\t\t\t\tmodalWidgetForm(newWidget);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t// Modal 2 to Edit a selected widget\n\tfunction modalWidgetForm(selectedWidget: any): void {\n\t\t// Ensure permissions object exists\n\t\tif (!selectedWidget.permissions) {\n\t\t\tselectedWidget.permissions = {};\n\t\t}\n\t\tsetTargetWidget(selectedWidget);\n\t\tmodalState.trigger(\n\t\t\tModalWidgetForm as any,\n\t\t\t{\n\t\t\t\ttitle: 'Define your Widget',\n\t\t\t\tbody: 'Setup your widget and then press Save.',\n\t\t\t\tvalue: selectedWidget\n\t\t\t},\n\t\t\t(r: any) => {\n\t\t\t\tif (!r) return;\n\t\t\t\t// Find the index of the existing widget based on its ID\n\t\t\t\tconst existingIndex = fields.findIndex((widget) => widget.id === r.id);\n\n\t\t\t\tif (existingIndex !== -1) {\n\t\t\t\t\t// If the existing widget is found, update its properties\n\t\t\t\t\tconst updatedFields = [\n\t\t\t\t\t\t...fields.slice(0, existingIndex), // Copy widgets before the updated one\n\t\t\t\t\t\t{ ...r }, // Update the existing widget\n\t\t\t\t\t\t...fields.slice(existingIndex + 1) // Copy widgets after the updated one\n\t\t\t\t\t];\n\t\t\t\t\tfields = updatedFields;\n\t\t\t\t} else {\n\t\t\t\t\t// If the existing widget is not found, add it as a new widget\n\t\t\t\t\tconst newField = {\n\t\t\t\t\t\tid: fields.length + 1,\n\t\t\t\t\t\t...r\n\t\t\t\t\t};\n\t\t\t\t\tfields = [...fields, newField];\n\t\t\t\t}\n\t\t\t\t// Update the collectionValue store\n\t\t\t\tif (collection?.value) {\n\t\t\t\t\tcollection.value.fields = fields;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\t// Function to save data by sending a POST request\n\tasync function handleSave() {\n\t\ttry {\n\t\t\tconst updatedFields = fields.map((field) => {\n\t\t\t\tconst widgetInstance = field.widget?.Name ? get(widgetFunctions)[field.widget.Name] : undefined;\n\t\t\t\tif (field.widget?.Name && widgetInstance) {\n\t\t\t\t\tconst GuiFields = getGuiFields({ key: field.widget.Name }, asAny(widgetInstance.GuiSchema));\n\t\t\t\t\tfor (const [property, value] of Object.entries(field)) {\n\t\t\t\t\t\tif (typeof value !== 'object' && property !== 'id') {\n\t\t\t\t\t\t\tGuiFields[property] = field[property];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfield.widget.GuiFields = GuiFields;\n\t\t\t\t}\n\t\t\t\treturn field;\n\t\t\t});\n\n\t\t\t// Update the collection fields\n\t\t\tif (collection?.value) {\n\t\t\t\tcollection.value.fields = updatedFields;\n\t\t\t}\n\n\t\t\tawait props.handleCollectionSave();\n\t\t} catch (error) {\n\t\t\tlogger.error('Error saving collection:', error);\n\t\t}\n\t}\n</script>\n\n<div class=\"flex w-full flex-col\">\n\t<div class=\"preset-outlined-tertiary-500 rounded-t-md p-2 text-center dark:preset-outlined-primary-500\">\n\t\t<p>\n\t\t\t{m.collection_widgetfield_addrequired()}\n\t\t\t<span class=\"text-tertiary-500 dark:text-primary-500\">{contentPath}</span> Collection inputs.\n\t\t</p>\n\t\t<p class=\"mb-2\">{m.collection_widgetfield_drag()}</p>\n\t</div>\n\t<div style=\"max-height: 55vh !important;\">\n\t\t<VerticalList items={fields} {headers} {flipDurationMs} {handleDndConsider} {handleDndFinalize}>\n\t\t\t{#each fields as field (field.id)}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"border-blue preset-outlined-surface-500 my-2 grid w-full grid-cols-6 items-center rounded-md border p-1 text-left hover:preset-filled-surface-500 dark:text-white\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"preset-ghost-tertiary-500 badge h-10 w-10 rounded-full dark:preset-ghost-primary-500\">\n\t\t\t\t\t\t{field.id}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<iconify-icon icon={field.icon} width=\"24\" class=\"text-tertiary-500\"></iconify-icon>\n\t\t\t\t\t<div class=\"font-bold dark:text-primary-500\">{field.label}</div>\n\t\t\t\t\t<div class=\" \">{field?.db_fieldName ? field.db_fieldName : '-'}</div>\n\t\t\t\t\t<div class=\" \">{field.widget?.key || field.__type || 'Unknown Widget'}</div>\n\n\t\t\t\t\t<button onclick={() => modalWidgetForm(field)} type=\"button\" aria-label={m.button_edit()} class=\"preset-ghost-primary-500 btn-icon ml-auto\">\n\t\t\t\t\t\t<iconify-icon icon=\"ic:baseline-edit\" width=\"24\" class=\"dark:text-white\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</VerticalList>\n\t</div>\n\t<div>\n\t\t<div class=\"mt-2 flex items-center justify-center gap-3\">\n\t\t\t<button\n\t\t\t\tonclick={() => modalSelectWidget()}\n\t\t\t\tclass=\"preset-filled-tertiary-500 btn\"\n\t\t\t\taria-label={m.collection_widgetfield_addFields()}\n\t\t\t\tdata-testid=\"add-field-button\"\n\t\t\t>\n\t\t\t\t{m.collection_widgetfield_addFields()}\n\t\t\t</button>\n\t\t</div>\n\t\t<div class=\" flex items-center justify-between\">\n\t\t\t<button onclick={() => tabSet.set(0)} type=\"button\" aria-label={m.button_previous()} class=\"preset-filled-secondary-500 btn mt-2 justify-end\">\n\t\t\t\t{m.button_previous()}\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tonclick={handleSave}\n\t\t\t\ttype=\"button\"\n\t\t\t\taria-label={m.button_save()}\n\t\t\t\tclass=\"preset-filled-tertiary-500 btn mt-2 justify-end dark:preset-filled-primary-500 dark:text-black\">{m.button_save()}</button\n\t\t\t>\n\t\t</div>\n\t</div>\n</div>\n","<!-- \n@files src/routes/(app)/config/collectionbuilder/[...contentTypes]/+page.svelte\n@component  \n**This component sets up and displays the collection page.**\n\nIt provides a user-friendly interface for creating, editing, and deleting collections.\n\n### Props\n- `data`: An object containing:\n- `collection`: The collection schema data (if editing an existing collection).\n- `contentLanguage`: The current content language setting.\n- `user`: The authenticated user information.\n\n### Features\n- Dynamically sets the page title based on whether the user is creating a new collection or editing an existing one.\n- Loads collection data when editing, and initializes state accordingly.\n- Provides tabs for editing collection forms and widget fields.\n-->\n\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport axios from 'axios';\n\timport { onMount } from 'svelte';\n\timport { goto } from '$app/navigation';\n\n\timport { obj2formData } from '@shared/utils/utils';\n\n\t// Stores\n\timport { page } from '$app/state';\n\timport { tabSet } from '@shared/stores/store.svelte';\n\timport { collection, setCollection } from '@shared/stores/collectionStore.svelte';\n\timport { setRouteContext } from '@shared/stores/UIStore.svelte';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Components\n\timport CollectionForm from './tabs/CollectionForm.svelte';\n\timport CollectionWidget from './tabs/CollectionWidget.svelte';\n\timport PageTitle from '@cms/components/PageTitle.svelte';\n\n\t// Skeleton\n\timport { Tabs } from '@skeletonlabs/skeleton-svelte';\n\t// import { Tab, TabGroup } from '@skeletonlabs/skeleton-svelte';\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { showConfirm } from '@shared/utils/modalUtils';\n\n\timport { widgetStoreActions } from '@shared/stores/widgetStore.svelte';\n\n\t// Create local tabSet variable for binding\n\tlet localTabSet = $state(String(tabSet.value));\n\n\t// Sync with store when local value changes\n\t$effect(() => {\n\t\ttabSet.set(Number(localTabSet));\n\t});\n\n\t// Sync local value when store changes\n\t$effect(() => {\n\t\tlocalTabSet = String(tabSet.value);\n\t});\n\n\timport type { User } from '@shared/database/auth/types';\n\timport type { FieldInstance, Schema } from '@cms-types';\n\n\t// Extract the collection name from the URL\n\tlet collectionPath = $state(page.params.contentPath);\n\tconst action = $state(page.params.action);\n\n\tinterface Props {\n\t\tdata: {\n\t\t\tcollection?: Schema;\n\t\t\tcontentLanguage: string;\n\t\t\tuser: User;\n\t\t};\n\t}\n\n\tconst { data }: Props = $props();\n\n\tlet originalName = $state('');\n\tonMount(() => {\n\t\tif (action === 'edit') {\n\t\t\tloadCollection();\n\t\t} else {\n\t\t\tsetCollection(null);\n\t\t\toriginalName = '';\n\t\t}\n\t});\n\n\tfunction loadCollection() {\n\t\tif (data.collection) {\n\t\t\tsetCollection(data.collection);\n\t\t\toriginalName = String(data.collection.name || '');\n\t\t} else {\n\t\t\tlogger.error('Collection data not found for editing.');\n\t\t\t// Optionally, redirect or show a proper error message\n\t\t}\n\t}\n\n\t// Default widget data (tab1)\n\t// Unwrap the `collection` store value for TS and template usage\n\tconst collectionValue = $derived(collection.value);\n\n\t// Page title\n\tlet pageTitle = $state('');\n\tlet highlightedPart = $state('');\n\n\t// Effect to update page title based on action and collection name\n\t$effect.root(() => {\n\t\t// Set the base page title according to the action\n\t\tif (action === 'edit') {\n\t\t\tpageTitle = `Edit ${collectionPath} Collection`;\n\t\t} else if (collectionPath) {\n\t\t\tpageTitle = `Create ${collectionPath} Collection`;\n\t\t} else {\n\t\t\tpageTitle = 'Create new Collection';\n\t\t}\n\n\t\t// Ensure the highlighted part (e.g., contentTypes) is unique in the title\n\t\thighlightedPart = collectionPath || 'new';\n\n\t\t// Avoid repeating the contentTypes if it's already included in the string\n\t\tif (pageTitle.includes(highlightedPart)) {\n\t\t\tpageTitle = pageTitle.replace(new RegExp(`\\\\b${highlightedPart}\\\\b`, 'g'), highlightedPart);\n\t\t}\n\t});\n\n\tfunction handlePageTitleUpdate(title: string) {\n\t\thighlightedPart = title;\n\t\tcollectionPath = title;\n\t\tif (action === 'edit') {\n\t\t\tpageTitle = `Edit ${highlightedPart} Collection`;\n\t\t} else {\n\t\t\tpageTitle = `Create ${highlightedPart} Collection`;\n\t\t}\n\t}\n\n\t// Import validation store\n\timport { validationStore } from '@shared/stores/store.svelte';\n\n\t// Function to save data by sending a POST request\n\tasync function handleCollectionSave() {\n\t\tconst currentCollection = collection.value;\n\t\tconst currentName = String(currentCollection?.name || '');\n\n\t\t// Check validation errors before submission\n\t\tif (validationStore.errors && Object.keys(validationStore.errors).length > 0) {\n\t\t\ttoaster.error({ description: 'Please fix validation errors before saving' });\n\t\t\treturn;\n\t\t}\n\n\t\t// Prepare form data\n\t\tconst data =\n\t\t\taction == 'edit'\n\t\t\t\t? obj2formData({\n\t\t\t\t\t\toriginalName: originalName,\n\t\t\t\t\t\tname: currentName,\n\t\t\t\t\t\ticon: currentCollection?.icon,\n\t\t\t\t\t\tstatus: currentCollection?.status,\n\t\t\t\t\t\tslug: currentCollection?.slug,\n\t\t\t\t\t\tdescription: currentCollection?.description,\n\t\t\t\t\t\tpermissions: currentCollection?.permissions,\n\t\t\t\t\t\tfields: currentCollection?.fields\n\t\t\t\t\t})\n\t\t\t\t: obj2formData({\n\t\t\t\t\t\tname: currentName,\n\t\t\t\t\t\ticon: currentCollection?.icon,\n\t\t\t\t\t\tstatus: currentCollection?.status,\n\t\t\t\t\t\tslug: currentCollection?.slug,\n\t\t\t\t\t\tdescription: currentCollection?.description,\n\t\t\t\t\t\tpermissions: currentCollection?.permissions,\n\t\t\t\t\t\tfields: currentCollection?.fields\n\t\t\t\t\t});\n\n\t\t// Send the form data to the server\n\t\tconst resp = await axios.post(`?/saveCollection`, data, {\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'multipart/form-data'\n\t\t\t}\n\t\t});\n\n\t\tif (resp.data.status === 200) {\n\t\t\ttoaster.success({ description: \"Collection Saved. You're all set to build your content.\" });\n\t\t\tif (originalName && originalName !== currentName && currentName) {\n\t\t\t\tconst newPath = page.url.pathname.replace(originalName, currentName);\n\t\t\t\tgoto(newPath);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction handleCollectionDelete() {\n\t\tconst currentCollection = collection.value;\n\n\t\tshowConfirm({\n\t\t\ttitle: 'Please Confirm',\n\t\t\tbody: 'Are you sure you wish to delete this collection?',\n\t\t\tonConfirm: async () => {\n\t\t\t\t// Send the form data to the server\n\t\t\t\tawait axios.post(`?/deleteCollections`, obj2formData({ contentTypes: String(currentCollection?.name || '') }), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'multipart/form-data'\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Notify via global toast helper\n\t\t\t\ttoaster.error({ description: 'Collection Deleted.' });\n\t\t\t\tgoto(`/collection`);\n\t\t\t},\n\t\t\tonCancel: () => {\n\t\t\t\t// User cancelled, do not delete\n\t\t\t\tlogger.debug('User cancelled deletion.');\n\t\t\t}\n\t\t});\n\t}\n\n\tonMount(() => {\n\t\t// Set the initial tab\n\t\twidgetStoreActions.initializeWidgets();\n\t\ttabSet.set(0);\n\t});\n\n\t$effect(() => {\n\t\tsetRouteContext({ isCollectionBuilder: true });\n\t\treturn () => setRouteContext({ isCollectionBuilder: false });\n\t});\n</script>\n\n<!-- Page Title -->\n<div class=\"my-2 flex items-center justify-between gap-2\">\n\t<PageTitle name={pageTitle} highlight={highlightedPart} icon=\"ic:baseline-build\" />\n\n\t<!-- Back -->\n\t<button onclick={() => history.back()} type=\"button\" aria-label=\"Back\" class=\"preset-outlined-primary-500 btn-icon\">\n\t\t<iconify-icon icon=\"ri:arrow-left-line\" width=\"20\"></iconify-icon>\n\t</button>\n</div>\n\n<div class=\"wrapper\">\n\t{#if action == 'edit'}\n\t\t<div class=\"flex justify-center gap-3\">\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={handleCollectionDelete}\n\t\t\t\tclass=\" preset-filled-error-500 btn mb-3 mr-1 mt-1 justify-end dark:preset-filled-error-500 dark:text-black\"\n\t\t\t\t>{m.button_delete()}\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonclick={handleCollectionSave}\n\t\t\t\tclass=\"preset-filled-tertiary-500 btn mb-3 mr-1 mt-1 justify-end dark:preset-filled-tertiary-500 dark:text-black\">{m.button_save()}</button\n\t\t\t>\n\t\t</div>\n\t{/if}\n\n\t<p class=\"mb-2 hidden text-center text-tertiary-500 dark:text-primary-500 sm:block\">\n\t\t{m.collection_helptext()}\n\t</p>\n\t<!-- Required Text  -->\n\t<div class=\"mb-2 text-center text-xs text-error-500\" data-testid=\"required-indicator\">* {m.collection_required()}</div>\n\t<Tabs value={localTabSet} onValueChange={(e) => (localTabSet = e.value)}>\n\t\t<Tabs.List class=\"flex border-b border-surface-200-800 mb-4\">\n\t\t\t<!-- User Permissions -->\n\t\t\t{#if page.data.isAdmin}\n\t\t\t\t<!-- Edit -->\n\t\t\t\t<Tabs.Trigger value=\"0\">\n\t\t\t\t\t<div class=\"flex items-center gap-1 py-2 px-4\">\n\t\t\t\t\t\t<iconify-icon icon=\"ic:baseline-edit\" width=\"24\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t<span class:active={tabSet.value === 0} class:text-tertiary-500={tabSet.value === 0} class:text-primary-500={tabSet.value === 0}\n\t\t\t\t\t\t\t>{m.button_edit()}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</Tabs.Trigger>\n\n\t\t\t\t<!-- Widget Fields -->\n\t\t\t\t<Tabs.Trigger value=\"1\" data-testid=\"widget-fields-tab\">\n\t\t\t\t\t<div class=\"flex items-center gap-1 py-2 px-4\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:widgets-outline\" width=\"24\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t<span class:active={tabSet.value === 1} class:text-tertiary-500={tabSet.value === 2} class:text-primary-500={tabSet.value === 2}\n\t\t\t\t\t\t\t>{m.collection_widgetfields()}</span\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</Tabs.Trigger>\n\t\t\t{/if}\n\t\t</Tabs.List>\n\n\t\t<!-- Tab Panels -->\n\t\t<Tabs.Content value=\"0\">\n\t\t\t<CollectionForm data={collectionValue} {handlePageTitleUpdate} />\n\t\t</Tabs.Content>\n\t\t<Tabs.Content value=\"1\">\n\t\t\t<CollectionWidget fields={collectionValue?.fields as FieldInstance[] | undefined} {handleCollectionSave} />\n\t\t</Tabs.Content>\n\t</Tabs>\n</div>\n"],"names":["load","data","action","page","searchQuery","$.state","autoUpdateSlug","selectedIcon","$.proxy","$$props","name","slug","description","status","$.user_effect","$.set","DBName","$.derived","$.get","currentIcon","untrack","collection","setCollection","currentName","currentSlug","currentDescription","currentStatus","handleNameInput","onSlugInput","statuses","StatusTypes","handleNextClick","tabSet","div","root","div_1","div_2","label","iconify_icon","$.sibling","text","$.template_effect","$.set_custom_element_data","m.collection_name_tooltip1","m.collection_name_tooltip2","input","$.remove_input_defaults","node","p","root_1","span","text_1","m.collection_DBname","$$render","consequent","p_1","div_3","label_1","iconify_icon_1","text_4","m.collection_icon_tooltip","IconifyPicker","node_1","$$value","div_4","label_2","iconify_icon_2","text_5","m.collection_slug_tooltip","input_1","div_5","label_3","iconify_icon_3","text_6","m.collection_description","textarea","$.remove_textarea_child","div_6","label_4","iconify_icon_4","text_7","m.collection_status_tooltip","select","$.index","$$anchor","statusOption","option","root_2","div_7","a","button","$.set_attribute","$1","$2","$6","$8","m.collection_name","m.collection_name_placeholder","m.collectionname_optional","m.collectionname_labelicon","m.collection_slug","m.collection_slug_input","m.collectionname_description","m.collection_description_placeholder","m.collection_status","m.button_cancel","m.button_next","headers","$.prop","gridClass","header","$.set_class","section","$$node","$$action_arg","dndzone","$$args","searchTerm","availableWidgets","widgets","onMount","onFormSubmit","selected","modalState","logger","cBase","cHeader","h2","$.each","category","categoryKeys","filteredKeys","key","root_3","h3","item","button_1","root_5","$.child","$.reset","h3_1","$.set_text","text_3","$.append","consequent_1","div_8","root_6","consequent_2","consequent_3","allProperties","standardProperties","additionalProperties","prop","displayProperties","defaultValue","property","collections","handleUpdate","detail","currentWidget","$0","asAny","InputSwitch","e","handlePermissionUpdate","updatedPermissions","w","roles","PermissionsSetting","defaultFields","currentWidgetName","currentGuiSchema","specificFields","root_4","alternate","localTabSet","widgetKey","$widgetFunctions","guiSchema","options","specificOptions","targetWidget","deleteWidget","collectionValue","newFields","field","setCollectionValue","cForm","article","form","Tabs","Tabs_List","Tabs_Trigger","Tabs_Trigger_1","text_2","m.system_permission","Tabs_Trigger_2","Tabs_Content","Default","Tabs_Content_1","Permission","Tabs_Content_2","Specific","footer","span_1","button_2","$3","m.button_delete","m.button_save","contentPath","mapFieldsWithWidgets","fields","index","widgetType","get","widgetFunctions","flipDurationMs","handleDndConsider","handleDndFinalize","modalSelectWidget","ModalSelectWidget","r","selectedWidget","widgetInstance","newWidget","getGuiFields","modalWidgetForm","setTargetWidget","ModalWidgetForm","existingIndex","widget","updatedFields","newField","handleSave","GuiFields","value","error","VerticalList","m.button_edit","div_9","div_10","button_3","text_9","$4","m.collection_widgetfield_addrequired","m.collection_widgetfield_drag","m.collection_widgetfield_addFields","m.button_previous","collectionPath","originalName","loadCollection","pageTitle","highlightedPart","$.effect_root","handlePageTitleUpdate","title","handleCollectionSave","currentCollection","validationStore","toaster","obj2formData","axios","newPath","goto","handleCollectionDelete","showConfirm","widgetStoreActions","setRouteContext","$.first_child","fragment","PageTitle","node_2","classes","classes_1","m.collection_widgetfields","CollectionForm","CollectionWidget","m.collection_helptext","m.collection_required"],"mappings":"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"}