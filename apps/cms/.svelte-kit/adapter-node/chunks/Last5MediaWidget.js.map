{"version":3,"file":"Last5MediaWidget.js","sources":["../../../../../../shared/features/src/dashboard/widgets/Last5MediaWidget.svelte"],"sourcesContent":["<!--\n@file src/routes/(app)/dashboard/widgets/Last5MediaWidget.svelte\n@component\n**A reusable widget component for displaying last 5 media information with improved rendering and error handling**\n\n@example\n<Last5MediaWidget label=\"Last 5 Media\" />\n\n### Props\n- `label`: The label for the widget (default: 'Last 5 Media')\n\n### Features:\n- Responsive doughnut chart visualization\n- Theme-aware rendering (light/dark mode support)\n- Real-time data updates\n- Customizable widget properties (size, position, etc.)\n- Improved error handling and data validation\n- Enhanced debugging and logging\n-->\n<script lang=\"ts\" module>\n\texport const widgetMeta = {\n\t\tname: 'Last 5 Media',\n\t\ticon: 'mdi:image-multiple-outline',\n\t\tdefaultSize: { w: 1, h: 2 }\n\t};\n</script>\n\n<script lang=\"ts\">\n\timport { formatDisplayDate } from '@shared/utils/dateUtils';\n\timport BaseWidget from '../BaseWidget.svelte';\n\timport type { WidgetSize } from '@cms-types';\n\n\tinterface MediaFile {\n\t\tid: string;\n\t\tname: string;\n\t\tsize: number;\n\t\tmodified: string;\n\t\ttype: string;\n\t\turl: string;\n\t\tcreatedBy?: string;\n\t}\n\n\ttype FetchedData = MediaFile[] | undefined;\n\n\tconst {\n\t\tlabel = 'Last 5 Media',\n\t\ttheme = 'light',\n\t\ticon = 'mdi:image-multiple-outline',\n\t\twidgetId = undefined,\n\t\tsize = { w: 1, h: 1 } as WidgetSize,\n\t\tonSizeChange = (_newSize: WidgetSize) => {},\n\t\tonRemove = () => {}\n\t}: {\n\t\tlabel?: string;\n\t\ttheme?: 'light' | 'dark';\n\t\ticon?: string;\n\t\twidgetId?: string;\n\t\tsize?: WidgetSize;\n\t\tonSizeChange?: (newSize: WidgetSize) => void;\n\t\tonRemove?: () => void;\n\t} = $props();\n\n\tfunction formatFileSize(bytes: number): string {\n\t\tif (bytes === 0) return '0 B';\n\t\tconst k = 1024;\n\t\tconst sizes = ['B', 'KB', 'MB', 'GB'];\n\t\tconst i = Math.floor(Math.log(bytes) / Math.log(k));\n\t\treturn `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;\n\t}\n\n\tfunction getFileIcon(type: string): string {\n\t\tif (!type) return 'mdi:file';\n\t\tconst imageTypes = ['jpg', 'jpeg', 'png', 'gif', 'webp'];\n\t\tconst videoTypes = ['mp4', 'mov', 'avi'];\n\t\tif (imageTypes.includes(type.toLowerCase())) {\n\t\t\treturn 'mdi:image';\n\t\t} else if (videoTypes.includes(type.toLowerCase())) {\n\t\t\treturn 'mdi:video';\n\t\t}\n\t\treturn 'mdi:file';\n\t}\n</script>\n\n<BaseWidget\n\t{label}\n\t{theme}\n\tendpoint=\"/api/dashboard/last5media\"\n\tpollInterval={30000}\n\t{icon}\n\t{widgetId}\n\t{size}\n\t{onSizeChange}\n\tonCloseRequest={onRemove}\n>\n\t{#snippet children({ data: fetchedData }: { data: FetchedData })}\n\t\t{#if fetchedData && Array.isArray(fetchedData) && fetchedData.length > 0}\n\t\t\t<div class=\"grid gap-2\" style=\"max-height: 180px; overflow-y: auto;\" role=\"list\" aria-label=\"Last 5 media files\">\n\t\t\t\t{#each fetchedData.slice(0, 5) as file (file.id || file.name)}\n\t\t\t\t\t<div class=\"flex items-center justify-between rounded-lg bg-surface-100/80 px-3 py-2 text-xs dark:bg-surface-700/60\" role=\"listitem\">\n\t\t\t\t\t\t<div class=\"flex min-w-0 items-center gap-2\">\n\t\t\t\t\t\t\t<iconify-icon icon={getFileIcon(file.type)} class=\"shrink-0 text-primary-400\" width=\"18\" aria-label={file.type + ' file icon'}\n\t\t\t\t\t\t\t></iconify-icon>\n\t\t\t\t\t\t\t<div class=\"flex min-w-0 flex-col\">\n\t\t\t\t\t\t\t\t<span class=\"text-text-900 dark:text-text-100 truncate font-medium\" title={file.name}>\n\t\t\t\t\t\t\t\t\t{file.name}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"text-xs text-surface-500 dark:text-surface-50\" title={`Size: ${formatFileSize(file.size)}`}>\n\t\t\t\t\t\t\t\t\t{formatFileSize(file.size)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t<span class=\"text-xs font-medium uppercase text-surface-600 dark:text-surface-300\">\n\t\t\t\t\t\t\t\t{file.type}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"text-xs text-surface-500 dark:text-surface-50\" title={`Modified: ${formatDisplayDate(file.modified)}`}>\n\t\t\t\t\t\t\t\t{formatDisplayDate(file.modified)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex flex-1 flex-col items-center justify-center py-6 text-xs text-gray-500 dark:text-gray-400\" role=\"status\" aria-live=\"polite\">\n\t\t\t\t<iconify-icon icon=\"mdi:file-remove-outline\" width=\"32\" class=\"mb-2 text-surface-400 dark:text-surface-500\" aria-hidden=\"true\"></iconify-icon>\n\t\t\t\t<span>No media files found</span>\n\t\t\t</div>\n\t\t{/if}\n\t{/snippet}\n</BaseWidget>\n"],"names":["$$renderer","$.ensure_array_like","$.escape","$.attr"],"mappings":";;;MAoBc,aAAU;AAAA,EACtB,MAAM;AAAA,EACN,MAAM;AAAA,EACN,eAAe,GAAG,GAAG,GAAG,EAAC;;;wCAI3B;;MAkBE,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,GAAG,GAAG,GAAG,EAAC;AAAA,MACnB,eAAY,CAAI,aAAyB;AAAA,MAAC;AAAA,MAC1C,iBAAiB;AAAA,MAAC;AAAA;aAWV,eAAe,OAAuB;UAC1C,UAAU,EAAC,QAAS;AAClB,YAAA,IAAI;AACJ,YAAA,SAAS,KAAK,MAAM,MAAM,IAAI;AAC9B,YAAA,IAAI,KAAK,MAAM,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,CAAC,CAAA;AACvC,aAAA,GAAA,YAAY,QAAQ,KAAK,IAAI,GAAG,CAAC,GAAG,QAAQ,CAAC,CAAA,CAAA,IAAM,MAAM,CAAC,CAAA;AAAA,IACrE;aAES,YAAY,MAAsB;AACrC,UAAA,CAAA,aAAa;YACZ,aAAU,CAAI,OAAO,QAAQ,OAAO,OAAO,MAAM;AACjD,YAAA,aAAU,CAAI,OAAO,OAAO,KAAK;AACnC,UAAA,WAAW,SAAS,KAAK,YAAW,CAAA,GAAK;eACrC;AAAA,MACR,WAAW,WAAW,SAAS,KAAK,YAAW,CAAA,GAAK;eAC5C;AAAA,MACR;aACO;AAAA,IACR;;UAcU,oBAAQA,aAAA,EAAG,MAAM,YAAW,GAAA;YAChC,eAAe,MAAM,QAAQ,WAAW,KAAK,YAAY,SAAS,GAAC;;;AAE/D,gBAAA,aAAAC,kBAAA,YAAY,MAAM,GAAG,CAAC,CAAA;;gBAAK,OAAI,WAAA,OAAA;4OAGf,YAAY,KAAK,IAAI,qEAA4D,KAAK,OAAO,YAAY,yIAGjD,KAAK,IAAI,CAAA,IAAAC,YAClF,KAAK,IAAI,CAAA,sEAAAC,KAAA,SAAA,SAEiE,eAAe,KAAK,IAAI,CAAA,EAAA,CAAA,IAAAD,YAClG,eAAe,KAAK,IAAI,CAAA,CAAA,+IAAAA,YAMzB,KAAK,IAAI,kGAEqE,kBAAkB,KAAK,QAAQ,oBAC7G,kBAAkB,KAAK,QAAQ,CAAA,CAAA,qBAAA;AAAA;;;;;;;;;QAhCtC;AAAA,QACA;AAAA;sBAEa;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,wBACe;AAAA,QAEN;AAAA;;EAbH,CAAA;;"}