{"version":3,"file":"TableFilter.js","sources":["../../../../../../shared/components/src/system/table/TableFilter.svelte"],"sourcesContent":["<!-- \n@file src/components/system/table/TableFilter.svelte\n@component\n**Optimized table filter component for search, filter, and column controls in a CMS.**\n\nThis component provides a lightweight, flexible interface for table filtering.  \nIt includes search, filter toggles, column visibility, and density controls, optimized for performance and reusability.\n\n@example\n<TableFilter bind:globalSearchValue bind:searchShow bind:filterShow bind:columnShow bind:density />\n\n### Props\n- `globalSearchValue` {string}: Current value of the global search input (default: '')\n- `searchShow` {boolean}: Visibility of the search input (default: false)\n- `filterShow` {boolean}: Visibility of filter controls (default: false)\n- `columnShow` {boolean}: Visibility of column controls (default: false)\n- `density` {string}: Table density ('compact', 'normal', 'comfortable') (default: 'normal')\n- `densityOptions` {string[]}: Custom density options (default: ['compact', 'normal', 'comfortable'])\n- `showDeleted` {boolean}: Whether to show deleted items (default: false)\n\n### Features\n- Provides a responsive layout for table filtering controls\n- Supports dynamic updates to filter and search criteria\n- Allows customization of table density and column visibility\n- Integrates with global search and filter states\n- Optimized for performance with minimal re-renders\n-->\n\n<script lang=\"ts\">\n\timport { browser } from '$app/environment';\n\n\t// Stores\n\timport { app } from '@shared/stores/store.svelte';\n\n\t// Logger\n\timport { logger } from '@shared/utils/logger';\n\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Props with types\n\tlet {\n\t\tglobalSearchValue = $bindable(''),\n\t\tsearchShow = $bindable(false),\n\t\tfilterShow = $bindable(false),\n\t\tcolumnShow = $bindable(false),\n\t\tdensity = $bindable('normal'),\n\t\tdensityOptions = $bindable(['compact', 'normal', 'comfortable']),\n\t\tshowDeleted = $bindable(false)\n\t} = $props();\n\n\tlet searchInput = $state<HTMLInputElement>();\n\n\t$effect(() => {\n\t\tif (searchShow && searchInput) {\n\t\t\tsearchInput.focus();\n\t\t}\n\t});\n\n\t// Storage key for user settings\n\tconst USER_SETTINGS_KEY = 'userTableSettings';\n\n\t// Load density from localStorage on component mount\n\t$effect(() => {\n\t\tif (browser) {\n\t\t\ttry {\n\t\t\t\tconst settings = JSON.parse(localStorage.getItem(USER_SETTINGS_KEY) || '{}');\n\t\t\t\tif (settings.density && densityOptions.includes(settings.density)) {\n\t\t\t\t\tdensity = settings.density;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error('Failed to load user table settings', e);\n\t\t\t\t// Keep default if error\n\t\t\t}\n\t\t}\n\t});\n\n\t// Store user settings when density changes\n\t$effect(() => {\n\t\tif (browser && density) {\n\t\t\ttry {\n\t\t\t\tconst settings = JSON.parse(localStorage.getItem(USER_SETTINGS_KEY) || '{}');\n\t\t\t\tsettings.density = density;\n\t\t\t\tlocalStorage.setItem(USER_SETTINGS_KEY, JSON.stringify(settings));\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error('Failed to save user table settings', e);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Function to close all open states except the specified one\n\tfunction closeOpenStates(except?: 'search' | 'filter' | 'column' | 'density') {\n\t\tif (except !== 'search') {\n\t\t\tsearchShow = false;\n\t\t}\n\t\tif (except !== 'filter') {\n\t\t\tfilterShow = false;\n\t\t}\n\t\tif (except !== 'column') {\n\t\t\tcolumnShow = false;\n\t\t}\n\t\tapp.setTranslationStatusOpen(false);\n\t}\n\n\t// Function to cycle density\n\tfunction cycleDensity() {\n\t\tconst currentIndex = densityOptions.indexOf(density);\n\t\tconst nextIndex = (currentIndex + 1) % densityOptions.length;\n\t\tdensity = densityOptions[nextIndex];\n\t}\n\n\t// Get density display name with first letter capitalized\n\tfunction getDensityDisplayName() {\n\t\treturn density.charAt(0).toUpperCase() + density.slice(1);\n\t}\n\n\t// Function to get density icon based on current setting\n\tfunction getDensityIcon() {\n\t\tswitch (density) {\n\t\t\tcase 'compact':\n\t\t\t\treturn 'material-symbols:align-space-even-rounded';\n\t\t\tcase 'normal':\n\t\t\t\treturn 'material-symbols:align-space-around-rounded';\n\t\t\tcase 'comfortable':\n\t\t\t\treturn 'material-symbols:align-space-between-rounded';\n\t\t\tdefault:\n\t\t\t\treturn 'material-symbols:align-space-around-rounded';\n\t\t}\n\t}\n</script>\n\n<!-- Expanding Search -->\n{#if searchShow}\n\t<div class=\"input-group input-group-divider grid grid-cols-[1fr_auto] h-10 w-full max-w-xs sm:max-w-sm transition-all duration-300 z-50\">\n\t\t<input\n\t\t\tbind:this={searchInput}\n\t\t\ttype=\"text\"\n\t\t\tplaceholder={m.table_search_placeholder()}\n\t\t\taria-label={m.table_search_aria()}\n\t\t\tbind:value={globalSearchValue}\n\t\t\tonkeydown={(e) => e.key === 'Enter' && closeOpenStates()}\n\t\t\tclass=\"input w-full h-full outline-none border-none bg-transparent px-4 transition-all duration-500 ease-in-out focus:border-tertiary-500 dark:text-surface-50 dark:bg-surface-800 dark:focus:border-primary-500\"\n\t\t/>\n\t\t<button\n\t\t\tonclick={() => {\n\t\t\t\tglobalSearchValue = '';\n\t\t\t\tsearchShow = false;\n\t\t\t}}\n\t\t\tonkeydown={(event) => {\n\t\t\t\tif (event.key === 'Enter' || event.key === ' ') {\n\t\t\t\t\tglobalSearchValue = '';\n\t\t\t\t\tsearchShow = false;\n\t\t\t\t}\n\t\t\t}}\n\t\t\taria-label={m.table_clear_search()}\n\t\t\tclass=\"preset-filled-surface-500 w-10 flex items-center justify-center\"\n\t\t>\n\t\t\t<iconify-icon icon=\"ic:outline-search-off\" width=\"20\"></iconify-icon>\n\t\t</button>\n\t</div>\n{:else}\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={() => {\n\t\t\tsearchShow = !searchShow;\n\t\t\tif (searchShow) closeOpenStates('search');\n\t\t}}\n\t\taria-label={m.table_search_toggle()}\n\t\ttitle={m.table_search_toggle()}\n\t\tclass=\"btn preset-outlined-surface-500 rounded-full\"\n\t>\n\t\t<iconify-icon icon=\"material-symbols:search-rounded\" width=\"24\" class={searchShow ? 'text-tertiary-500 dark:text-primary-500' : ''}\n\t\t></iconify-icon>\n\t</button>\n\n\t<!-- Filter -->\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={() => {\n\t\t\tfilterShow = !filterShow;\n\t\t\tif (filterShow) closeOpenStates('filter');\n\t\t}}\n\t\taria-label={m.table_filter_toggle()}\n\t\ttitle={m.table_filter_toggle()}\n\t\tclass=\"btn preset-outlined-surface-500 rounded-full\"\n\t>\n\t\t<iconify-icon icon=\"carbon:filter-edit\" width=\"24\" class={filterShow ? 'text-tertiary-500 dark:text-primary-500' : ''}></iconify-icon>\n\t</button>\n\n\t<!-- Column Order & Visibility -->\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={() => {\n\t\t\tcolumnShow = !columnShow;\n\t\t\tif (columnShow) closeOpenStates('column');\n\t\t}}\n\t\taria-label={m.table_column_toggle()}\n\t\ttitle={m.table_column_toggle()}\n\t\tclass=\"btn preset-outlined-surface-500 rounded-full\"\n\t>\n\t\t<iconify-icon icon=\"fluent:column-triple-edit-24-regular\" width=\"24\" class={columnShow ? 'text-tertiary-500 dark:text-primary-500' : ''}\n\t\t></iconify-icon>\n\t</button>\n\n\t<!-- Spacing/Density -->\n\t<button\n\t\ttype=\"button\"\n\t\tonclick={() => {\n\t\t\tcycleDensity();\n\t\t\tcloseOpenStates('density');\n\t\t}}\n\t\taria-label={m.table_density_toggle()}\n\t\ttitle={m.table_density_label({ density: getDensityDisplayName() })}\n\t\tclass=\"btn preset-outlined-surface-500 rounded-full\"\n\t>\n\t\t<iconify-icon icon={getDensityIcon()} width=\"24\"></iconify-icon>\n\t</button>\n{/if}\n"],"names":["m.table_search_placeholder","$.attr","m.table_search_aria","m.table_clear_search","m.table_search_toggle","$.attr_class","$.clsx","m.table_filter_toggle","m.table_column_toggle","m.table_density_toggle","m.table_density_label"],"mappings":";;;;;wCA4BA;;MAcE,oBAA8B;AAAA,MAC9B,aAAuB;AAAA,MACvB,aAAuB;AAAA,MACvB,aAAuB;AAAA,MACvB,UAAoB;AAAA,MACpB,iBAAc,CAAc,WAAW,UAAU,aAAa;AAAA,MAC9D,cAAwB;AAAA;AAgEhB,aAAA,wBAAwB;aACzB,QAAQ,OAAO,CAAC,EAAE,YAAW,IAAK,QAAQ,MAAM,CAAC;AAAA,IACzD;AAGS,aAAA,iBAAiB;cACjB,SAAO;AAAA,aACT;iBACG;AAAA,aACH;iBACG;AAAA,aACH;iBACG;AAAA;iBAEA;AAAA;IAEV;QAII,YAAU;;yMAKCA,yBAA0B,CAAA,CAAA,GAAAC,KAAA,cAC3BC,kBAAmB,CAAA,CAAA,GAAAD,KAAA,SACnB,iBAAiB,CAAA,+NAAAA,KAAA,cAejBE,mBAAoB,CAAA,CAAA,+JAAA;AAAA;;kEAarBC,oBAAqB,CAAA,CAAA,GAAAH,KAAA,SAC1BG,oBAAqB,CAAA,CAAA,wHAAAC,WAAAC,KAG2C,aAAa,4CAA4C,EAAE,uEAWtHC,oBAAqB,CAAA,CAAA,GAAAN,KAAA,SAC1BM,oBAAqB,CAAA,CAAA,2GAAAF,WAAAC,KAG8B,aAAa,4CAA4C,EAAE,uEAUzGE,oBAAqB,CAAA,CAAA,GAAAP,KAAA,SAC1BO,oBAAqB,CAAA,CAAA,6HAAAH,WAAAC,KAGgD,aAAa,4CAA4C,EAAE,uEAW3HG,qBAAsB,CAAA,CAAA,GAAAR,KAAA,SAC3BS,oBAAqB,EAAG,SAAS,sBAAqB,EAAA,CAAA,CAAA,CAAA,sEAAAT,KAAA,QAGzC,eAAc,CAAA,CAAA,sCAAA;AAAA;;;;;;;;;;;EAtF5B,CAAA;;"}