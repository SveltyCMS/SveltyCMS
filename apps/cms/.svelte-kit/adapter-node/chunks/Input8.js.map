{"version":3,"file":"Input8.js","sources":["../../../../src/widgets/core/Relation/Input.svelte"],"sourcesContent":["<!--\n@file src/widgets/core/Relation/Input.svelte\n@component\n**Relation Widget Input Component**\n\nProvides entry selection interface with modal-based browsing and relationship management.\nPart of the Three Pillars Architecture for widget system.\n\n@example\n<RelationInput bind:value={relationId} field={fieldDefinition} />\nInteractive selector with \"Select\" button and clear functionality\n\n### Props\n- `field: FieldType` - Widget field definition with collection and display field config\n- `value: string | string[] | null | undefined` - Entry ID(s) for relations (bindable)\n- `error?: string | null` - Validation error message for display\n\n### Features\n- **Modal Selection**: Skeleton Labs modal integration for entry browsing\n- **Single/Multi Relations**: Handles both single and array-based relations\n- **Async Entry Loading**: Fetches full entry data for display preview\n- **Clear Functionality**: Easy removal of selected relations with Ã— button\n- **Multilingual Display**: Shows display field in current content language\n- **Loading States**: Handles async data loading with proper UX\n- **Error Handling**: Accessible error display with ARIA attributes\n- **Collection Filtering**: Scoped to specific collection as configured\n-->\n\n<script lang=\"ts\">\n\timport { showModal } from '@shared/utils/modalUtils';\n\timport type { FieldType } from './';\n\timport { app } from '@shared/stores/store.svelte';\n\n\tlet { field, value, error }: { field: FieldType; value: string | string[] | null | undefined; error?: string | null } = $props();\n\n\t// A local, reactive copy of the full, resolved entry object for display.\n\tlet selectedEntry = $state<Record<string, any> | null>(null);\n\tconst lang = $derived(app.contentLanguage);\n\n\t// Stub function for fetching entry data - implement with your API\n\tasync function fetchEntryData(_id: string): Promise<Record<string, any> | null> {\n\t\t// TODO: Implement API call to fetch entry by ID\n\t\treturn null;\n\t}\n\n\t// Fetch the full entry data when the ID `value` changes.\n\t$effect(() => {\n\t\tconst id = Array.isArray(value) ? value[0] : value;\n\t\tif (id) {\n\t\t\t// API Call: GET /api/entries/{field.collection}/{id}\n\t\t\t// This fetches the data needed to display the summary.\n\t\t\tfetchEntryData(id).then((entry: Record<string, any> | null) => (selectedEntry = entry));\n\t\t} else {\n\t\t\tselectedEntry = null;\n\t\t}\n\t});\n\n\t// The text to display in the selector button.\n\tconst displayText = $derived(selectedEntry?.[field.displayField as string]?.[lang] || 'Select an Entry');\n\n\t// Function to open the selection/creation modal.\n\tfunction openRelationModal() {\n\t\tshowModal({\n\t\t\tcomponent: 'relationModal', // This would be your entry selection modal\n\t\t\tmeta: {\n\t\t\t\tcollectionId: field.collection,\n\t\t\t\t// Callback to update the value when an entry is selected in the modal\n\t\t\t\tcallback: (selectedId: string | undefined) => {\n\t\t\t\t\tif (selectedId) {\n\t\t\t\t\t\tvalue = selectedId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n</script>\n\n<div class=\"relation-container\" class:invalid={error}>\n\t<div class=\"selection-box\">\n\t\t<span>{displayText}</span>\n\t\t<div class=\"actions\">\n\t\t\t<button onclick={openRelationModal} aria-label=\"Select Entry\">Select</button>\n\t\t\t{#if value}\n\t\t\t\t<button onclick={() => (value = null)} aria-label=\"Clear Selection\">&times;</button>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t{#if error}\n\t\t<p class=\"error-message\" role=\"alert\">{error}</p>\n\t{/if}\n</div>\n"],"names":["$$renderer","$.attr_class"],"mappings":";;;;wCA4BA;UAKO,OAAO,OAAO,MAAK,IAAA;AAIH,QAAI;UAqBpB,cAAgF;AAmBxC,IAAAA,YAAA,KAAA,OAAAC,WAAA,sBAAA,QAAA,EAAA,WAAA,MAAK,mDAE3C,WAAW,CAAA,iFAAA;QAGZ,OAAK;;;;;;;QAMP,OAAK;;4EAC8B,KAAK,CAAA,MAAA;AAAA;;;;EAdtC,CAAA;;"}