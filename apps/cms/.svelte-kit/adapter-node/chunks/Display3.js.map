{"version":3,"file":"Display3.js","sources":["../../../../src/widgets/core/DateRange/Display.svelte"],"sourcesContent":["<!--\n@file src/widgets/core/DateRange/Display.svelte\n@component\n**DateRange Display Component**\n\nA lightweight renderer for the DateRange widget. Formats a `{ start, end }` value\n(ISO 8601 strings) into a human-readable date range string with duration and context.\n\n@example\n<DateRangeDisplay value={value} format=\"medium\" />\n\n#### Props\n- `value: DateRangeWidgetData | null | undefined` - The date range value ({ start, end })\n- `format?: 'short' | 'medium' | 'long' | 'full'` - Display month formatting (default: 'medium')\n\n#### Features\n- Compact synchronous renderer optimized for lists\n- Shows duration (days, weeks, months, years)\n- Shows temporal context (Current / Past / Future)\n- Locale-aware formatting using browser locale\n- Single date display when start equals end\n- Graceful error handling\n-->\n\n<script lang=\"ts\">\n\timport type { DateRangeWidgetData } from './';\n\timport { logger } from '@shared/utils/logger';\n\n\tinterface Props {\n\t\tvalue: DateRangeWidgetData | null | undefined;\n\t\tformat?: 'short' | 'medium' | 'long' | 'full';\n\t}\n\n\tconst { value, format = 'medium' }: Props = $props();\n\n\t// Get the user's preferred language from the browser\n\tconst userLocale = $derived(typeof document !== 'undefined' ? document.documentElement.lang || 'en-US' : 'en-US');\n\n\t/**\n\t * Format the date range string\n\t */\n\tconst formattedRange = $derived.by(() => {\n\t\tif (!value?.start || !value?.end) return '–';\n\n\t\ttry {\n\t\t\tconst start = new Date(value.start);\n\t\t\tconst end = new Date(value.end);\n\n\t\t\tif (isNaN(start.getTime()) || isNaN(end.getTime())) {\n\t\t\t\treturn 'Invalid Range';\n\t\t\t}\n\n\t\t\tconst dateFormatter = new Intl.DateTimeFormat(userLocale, {\n\t\t\t\tyear: 'numeric',\n\t\t\t\tmonth: format === 'short' ? 'short' : 'long',\n\t\t\t\tday: 'numeric'\n\t\t\t});\n\n\t\t\tconst startFormatted = dateFormatter.format(start);\n\t\t\tconst endFormatted = dateFormatter.format(end);\n\n\t\t\t// If dates are the same, show single date\n\t\t\tif (start.toDateString() === end.toDateString()) {\n\t\t\t\treturn startFormatted;\n\t\t\t}\n\n\t\t\treturn `${startFormatted} → ${endFormatted}`;\n\t\t} catch (e) {\n\t\t\tlogger.warn('Date range formatting error:', e);\n\t\t\treturn 'Invalid Range';\n\t\t}\n\t});\n\n\t/**\n\t * Calculate duration for additional context\n\t */\n\tconst duration = $derived.by(() => {\n\t\tif (!value?.start || !value?.end) return null;\n\n\t\ttry {\n\t\t\tconst start = new Date(value.start);\n\t\t\tconst end = new Date(value.end);\n\t\t\tconst diffTime = end.getTime() - start.getTime();\n\t\t\tconst diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n\t\t\tif (diffDays === 1) return '1 day';\n\t\t\tif (diffDays < 7) return `${diffDays} days`;\n\t\t\tif (diffDays < 30) {\n\t\t\t\tconst weeks = Math.ceil(diffDays / 7);\n\t\t\t\treturn `${weeks} week${weeks > 1 ? 's' : ''}`;\n\t\t\t}\n\t\t\tif (diffDays < 365) {\n\t\t\t\tconst months = Math.ceil(diffDays / 30);\n\t\t\t\treturn `${months} month${months > 1 ? 's' : ''}`;\n\t\t\t}\n\t\t\tconst years = Math.ceil(diffDays / 365);\n\t\t\treturn `${years} year${years > 1 ? 's' : ''}`;\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\t/**\n\t * Determine temporal context (Current / Past / Future)\n\t */\n\tconst relativeContext = $derived.by(() => {\n\t\tif (!value?.start || !value?.end) return null;\n\n\t\ttry {\n\t\t\tconst now = new Date();\n\t\t\tconst start = new Date(value.start);\n\t\t\tconst end = new Date(value.end);\n\n\t\t\tif (start <= now && end >= now) return 'Current';\n\t\t\tif (end < now) return 'Past';\n\t\t\tif (start > now) return 'Future';\n\n\t\t\treturn null;\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\t/**\n\t * Get context badge classes\n\t */\n\tconst contextClasses = $derived.by(() => {\n\t\tconst baseClasses = 'ml-2 inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium';\n\t\tconst contextMap = {\n\t\t\tCurrent: 'bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200',\n\t\t\tPast: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',\n\t\t\tFuture: 'bg-success-100 text-success-800 dark:bg-success-900 dark:text-success-200'\n\t\t};\n\t\treturn `${baseClasses} ${relativeContext ? contextMap[relativeContext as keyof typeof contextMap] : ''}`;\n\t});\n\n\t/**\n\t * Get tooltip text\n\t */\n\tconst tooltipText = $derived.by(() => {\n\t\tif (!value?.start || !value?.end) return undefined;\n\t\ttry {\n\t\t\tconst start = new Date(value.start).toISOString();\n\t\t\tconst end = new Date(value.end).toISOString();\n\t\t\treturn `${start} to ${end}`;\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t});\n</script>\n\n<span class=\"inline-flex items-center font-medium text-gray-900 dark:text-gray-100\" title={tooltipText}>\n\t<span>{formattedRange}</span>\n\t{#if duration}\n\t\t<span class=\"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400\" aria-label=\"Duration: {duration}\">\n\t\t\t({duration})\n\t\t</span>\n\t{/if}\n\t{#if relativeContext}\n\t\t<span class={contextClasses} aria-label=\"Time context: {relativeContext}\">\n\t\t\t{relativeContext}\n\t\t</span>\n\t{/if}\n</span>\n"],"names":["$$renderer","$.attr","$.stringify","$.escape"],"mappings":"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"}