{"version":3,"file":"Display2.js","sources":["../../../../src/widgets/core/Date/Display.svelte"],"sourcesContent":["<!--\n@file src/widgets/core/Date/Display.svelte\n@component\n**Date Widget Display Component**\n\nRenders ISO 8601 date values in localized format using the browser's language settings.\nPart of the Three Pillars Architecture for widget system.\n\n@example\n<DateDisplay value=\"2025-09-24T00:00:00.000Z\" />\n<DateDisplay value=\"2025-09-24T00:00:00.000Z\" format=\"long\" showRelative={true} />\n\n#### Props\n- `value: DateWidgetData` - ISO 8601 date string from validated input\n- `format: 'short' | 'medium' | 'long' | 'full'` - Date format style (default: 'medium')\n- `showRelative: boolean` - Show relative time for recent dates (default: true)\n\n#### Features\n- Automatic localization using browser locale\n- Intl.DateTimeFormat for native date formatting\n- Relative time for recent dates (Today, Yesterday, etc.)\n- Graceful fallbacks for invalid dates\n- Tooltip with ISO string\n- Zero dependencies\n-->\n\n<script lang=\"ts\">\n\timport type { DateWidgetData } from './';\n\timport { logger } from '@shared/utils/logger';\n\n\tinterface Props {\n\t\tvalue: DateWidgetData;\n\t\tformat?: 'short' | 'medium' | 'long' | 'full';\n\t\tshowRelative?: boolean;\n\t}\n\n\tconst { value, format = 'medium', showRelative = true }: Props = $props();\n\n\t// Get the user's preferred language from the browser\n\tconst userLocale = $derived(typeof document !== 'undefined' ? document.documentElement.lang || 'en-US' : 'en-US');\n\n\t// Get date formatting options based on format prop\n\tconst dateOptions = $derived.by(() => {\n\t\tconst optionsMap = {\n\t\t\tshort: { dateStyle: 'short' as const },\n\t\t\tmedium: { dateStyle: 'medium' as const },\n\t\t\tlong: { dateStyle: 'long' as const },\n\t\t\tfull: { dateStyle: 'full' as const }\n\t\t};\n\t\treturn optionsMap[format];\n\t});\n\n\t// Calculate relative time for recent dates\n\tconst relativeTime = $derived.by(() => {\n\t\tif (!value || !showRelative) return null;\n\n\t\ttry {\n\t\t\tconst date = new Date(value);\n\t\t\tif (isNaN(date.getTime())) return null;\n\n\t\t\tconst now = new Date();\n\t\t\tconst diffTime = now.getTime() - date.getTime();\n\t\t\tconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n\t\t\t// Return relative time for dates within a week\n\t\t\tif (diffDays === 0) return 'Today';\n\t\t\tif (diffDays === 1) return 'Yesterday';\n\t\t\tif (diffDays === -1) return 'Tomorrow';\n\t\t\tif (diffDays > 1 && diffDays <= 7) return `${diffDays} days ago`;\n\t\t\tif (diffDays < -1 && diffDays >= -7) return `In ${Math.abs(diffDays)} days`;\n\n\t\t\treturn null; // Use formatted date for older dates\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t});\n\n\t// Format date using Intl.DateTimeFormat\n\tconst formattedDate = $derived.by(() => {\n\t\tif (!value) return 'â€“';\n\n\t\ttry {\n\t\t\tconst date = new Date(value);\n\t\t\tif (isNaN(date.getTime())) return 'Invalid Date';\n\n\t\t\treturn new Intl.DateTimeFormat(userLocale, dateOptions).format(date);\n\t\t} catch (e) {\n\t\t\tlogger.warn('Date formatting error:', e);\n\t\t\treturn 'Invalid Date';\n\t\t}\n\t});\n\n\t// Get ISO string for tooltip\n\tconst isoString = $derived.by(() => {\n\t\tif (!value) return undefined;\n\t\ttry {\n\t\t\tconst date = new Date(value);\n\t\t\treturn isNaN(date.getTime()) ? undefined : date.toISOString();\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t});\n\n\t// Final display text\n\tconst displayText = $derived(relativeTime || formattedDate);\n</script>\n\n<time class=\"inline-flex items-center font-medium text-gray-900 dark:text-gray-100\" title={isoString} datetime={isoString}>\n\t{#if relativeTime}\n\t\t<span class=\"mr-1 text-primary-600 dark:text-primary-400\">\n\t\t\t{displayText}\n\t\t</span>\n\t\t<span class=\"text-xs text-gray-500 dark:text-gray-400\">\n\t\t\t({formattedDate})\n\t\t</span>\n\t{:else}\n\t\t{displayText}\n\t{/if}\n</time>\n"],"names":["$$renderer","$.attr","$.escape"],"mappings":";;;wCA0BA;AAUS,UAAA,EAAA,OAAO,SAAS,UAAU,eAAe,KAAI,IAAA;AAG/C,UAAA,aAAU,OAAmB,aAAa,cAAc,SAAS,gBAAgB,QAAQ,UAAU;AAGnG,UAAA,eAAW,MAAqB;YAC/B,aAAU;AAAA,QACf,OAAK,EAAI,WAAW,QAAO;AAAA,QAC3B,QAAM,EAAI,WAAW,SAAQ;AAAA,QAC7B,MAAI,EAAI,WAAW,OAAM;AAAA,QACzB,MAAI,EAAI,WAAW,OAAM;AAAA;AAEnB,aAAA,WAAW,MAAM;AAAA,IACzB,GAAC;AAGK,UAAA,gBAAY,MAAqB;WACjC,SAAK,CAAK,aAAY,QAAS;AAEhC,UAAA;cACG,OAAI,IAAO,KAAK,KAAK;AACvB,YAAA,MAAM,KAAK,QAAO,WAAY;AAE5B,cAAA,0BAAU,KAAI;AACd,cAAA,WAAW,IAAI,QAAO,IAAK,KAAK,QAAO;AACvC,cAAA,WAAW,KAAK,MAAM,YAAY,MAAO,KAAK,KAAK,GAAE;YAGvD,aAAa,EAAC,QAAS;YACvB,aAAa,EAAC,QAAS;YACvB,aAAQ,GAAO,QAAS;AACxB,YAAA,WAAW,KAAK,YAAY,aAAa,QAAQ;YACjD,WAAQ,MAAS,YAAQ,GAAM,QAAA,MAAe,KAAK,IAAI,QAAQ,CAAA;eAE5D;AAAA,MACR,QAAQ;eACA;AAAA,MACR;AAAA,IACD,GAAC;AAGK,UAAA,iBAAa,MAAqB;AAClC,UAAA,CAAA,cAAc;AAEf,UAAA;cACG,OAAI,IAAO,KAAK,KAAK;AACvB,YAAA,MAAM,KAAK,QAAO,WAAY;mBAEvB,KAAK,eAAe,YAAY,WAAW,EAAE,OAAO,IAAI;AAAA,MACpE,SAAS,GAAG;AACX,eAAO,KAAK,0BAA0B,CAAC;eAChC;AAAA,MACR;AAAA,IACD,GAAC;AAGK,UAAA,aAAS,MAAqB;AAC9B,UAAA,CAAA,cAAc;AACf,UAAA;cACG,OAAI,IAAO,KAAK,KAAK;eACpB,MAAM,KAAK,QAAO,KAAM,SAAY,KAAK,YAAW;AAAA,MAC5D,QAAQ;eACA;AAAA,MACR;AAAA,IACD,GAAC;UAGK,cAAuB,gBAAgB;AAG6C,IAAAA,YAAA,KAAA,sFAAAC,KAAA,SAAA,SAAS,qBAAY,SAAS,CAAA,GAAA;QACnH,cAAY;;AAEd,MAAAD,YAAA,KAAA,6DAAAE,YAAA,WAAW,gFAGV,aAAa,CAAA,UAAA;AAAA;;sCAGf,WAAW,CAAA,EAAA;AAAA;;EAXN,CAAA;;"}