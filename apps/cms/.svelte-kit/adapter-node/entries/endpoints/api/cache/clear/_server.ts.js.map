{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/cache/clear/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/cache/clear/+server.ts\n * @description API endpoint for clearing all cache entries\n *\n * Features:\n * - Clear all cache entries\n */\n\nimport { json } from '@sveltejs/kit';\nimport type { RequestHandler } from './$types';\nimport { cacheService } from '@shared/database/CacheService';\nimport { logger } from '@shared/utils/logger.server';\n\n/**\n * POST - Clear all cache entries\n */\nexport const POST: RequestHandler = async ({ locals }) => {\n\ttry {\n\t\t// Check admin permission\n\t\tif (!locals.user?.isAdmin) {\n\t\t\treturn json({ error: 'Unauthorized' }, { status: 403 });\n\t\t}\n\n\t\t// Invalidate all cache\n\t\tawait cacheService.invalidateAll();\n\n\t\tlogger.info('Cache cleared by admin user', {\n\t\t\tuserId: locals.user.id,\n\t\t\tusername: locals.user.username\n\t\t});\n\n\t\treturn json({\n\t\t\tsuccess: true,\n\t\t\tmessage: 'All cache entries cleared successfully'\n\t\t});\n\t} catch (error) {\n\t\tlogger.error('Failed to clear cache:', error);\n\t\treturn json(\n\t\t\t{\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error instanceof Error ? error.message : 'Failed to clear cache'\n\t\t\t},\n\t\t\t{ status: 500 }\n\t\t);\n\t}\n};\n"],"names":[],"mappings":";;;AAgBO,MAAM,OAAuB,OAAO,EAAE,aAAa;AACzD,MAAI;AAEH,QAAI,CAAC,OAAO,MAAM,SAAS;AAC1B,aAAO,KAAK,EAAE,OAAO,eAAA,GAAkB,EAAE,QAAQ,KAAK;AAAA,IACvD;AAGA,UAAM,aAAa,cAAA;AAEnB,WAAO,KAAK,+BAA+B;AAAA,MAC1C,QAAQ,OAAO,KAAK;AAAA,MACpB,UAAU,OAAO,KAAK;AAAA,IAAA,CACtB;AAED,WAAO,KAAK;AAAA,MACX,SAAS;AAAA,MACT,SAAS;AAAA,IAAA,CACT;AAAA,EACF,SAAS,OAAO;AACf,WAAO,MAAM,0BAA0B,KAAK;AAC5C,WAAO;AAAA,MACN;AAAA,QACC,SAAS;AAAA,QACT,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MAAA;AAAA,MAEjD,EAAE,QAAQ,IAAA;AAAA,IAAI;AAAA,EAEhB;AACD;"}