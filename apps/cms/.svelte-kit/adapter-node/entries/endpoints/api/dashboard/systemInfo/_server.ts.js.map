{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/dashboard/systemInfo/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/dashboard/systemInfo/+server.ts\n * @description Enhanced API endpoint for fetching comprehensive system information.\n *\n * This module provides functionality to:\n * - Fetch and track CPU usage over time with core-specific data\n * - Retrieve detailed disk usage information for multiple mount points\n * - Get memory usage details with swap information\n * - Monitor network usage statistics\n * - Track process information including top processes by CPU and memory\n * - Collect overall system information including OS details\n * - Provide system uptime and load averages\n *\n * Features:\n * - Real-time CPU usage tracking with historical data\n * - Disk space utilization reporting across multiple drives\n * - Memory usage statistics with detailed breakdown\n * - Network interface monitoring\n * - OS information collection\n * - Process monitoring\n * - Error handling and logging\n * - Response caching to reduce system load\n *\n * Usage:\n * GET /api/dashboard/systemInfo - Full system information\n * GET /api/dashboard/systemInfo?type=cpu - Only CPU information\n * GET /api/dashboard/systemInfo?type=disk - Only disk information\n * GET /api/dashboard/systemInfo?type=memory - Only memory information\n * GET /api/dashboard/systemInfo?type=network - Only network information\n * GET /api/dashboard/systemInfo?type=os - Only OS information\n * GET /api/dashboard/systemInfo?type=process - Only process information\n *\n * Returns: JSON object with requested system information\n *\n * Note: This endpoint may expose sensitive system information.\n * Ensure proper access controls are in place.\n */\n\nimport type { RequestHandler } from '@sveltejs/kit';\nimport { error } from '@sveltejs/kit';\nimport os from 'os';\nimport { createOSUtils } from 'node-os-utils';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport { performance } from 'perf_hooks';\n\n// Permissions\n\n// System Logger\nimport { logger } from '@shared/utils/logger.server';\n\n// Create OSUtils instance\nconst osUtils = createOSUtils();\nconst execAsync = promisify(exec);\n\n// Configuration\nconst MAX_DATA_POINTS = 100;\nconst CACHE_DURATION = 1000; // 1 second cache to prevent hammering\nconst PROCESS_LIMIT = 10; // Number of top processes to return\n\n// Cache storage\ntype CacheEntry = {\n\ttimestamp: number;\n\tdata: unknown;\n};\n\nconst cache: Record<string, CacheEntry> = {\n\tcpu: { timestamp: 0, data: null },\n\tdisk: { timestamp: 0, data: null },\n\tmemory: { timestamp: 0, data: null },\n\tnetwork: { timestamp: 0, data: null },\n\tos: { timestamp: 0, data: null },\n\tprocess: { timestamp: 0, data: null },\n\tall: { timestamp: 0, data: null }\n};\n\n// Historical data storage\nconst cpuData: number[] = [];\nconst cpuCoreData: number[][] = [];\nconst timeStamps: string[] = [];\nlet networkBaseline: { rx: number; tx: number; timestamp: number } | null = null;\n\n// Initialize core data array\nconst initCoreDatas = () => {\n\tconst cpuCount = os.cpus().length;\n\tfor (let i = 0; i < cpuCount; i++) {\n\t\tcpuCoreData[i] = [];\n\t}\n};\ninitCoreDatas();\n\n// Check if data is stale and needs refresh\nconst isStale = (type: string): boolean => {\n\tconst now = performance.now();\n\treturn now - (cache[type]?.timestamp || 0) > CACHE_DURATION;\n};\n\n// Get data from cache or fetch fresh\nconst getCachedOrFresh = async <T>(type: string, fetchFunction: () => Promise<T>): Promise<T> => {\n\tif (isStale(type)) {\n\t\ttry {\n\t\t\tconst data = await fetchFunction();\n\t\t\tcache[type] = { timestamp: performance.now(), data };\n\t\t} catch (error) {\n\t\t\tlogger.error(`Error fetching ${type} info:`, error instanceof Error ? error.message : String(error));\n\t\t\t// If we had previous data, keep using it even if stale\n\t\t\tif (!cache[type]?.data) {\n\t\t\t\tthrow new Error(`Failed to fetch ${type} information`);\n\t\t\t}\n\t\t}\n\t}\n\treturn cache[type].data as T;\n};\n\n// Fetches detailed CPU usage information and tracks it over time\nconst fetchCPUInfo = async () => {\n\tconst cpuUsageResult = await osUtils.cpu.usage();\n\t// node-os-utils v2.x returns MonitorResult<number>\n\tconst cpuUsage = cpuUsageResult.success ? cpuUsageResult.data : 0;\n\tconst cpuCount = os.cpus().length;\n\tconst timeStamp = new Date().toISOString();\n\n\t// Store the overall CPU usage and timestamp\n\tcpuData.push(cpuUsage);\n\ttimeStamps.push(timeStamp);\n\n\t// Maintain a fixed size for the data arrays\n\tif (cpuData.length > MAX_DATA_POINTS) {\n\t\tcpuData.shift();\n\t\ttimeStamps.shift();\n\t}\n\n\t// Get per-core information\n\tconst coreInfo = os.cpus().map((core, index) => {\n\t\tconst total = Object.values(core.times).reduce((acc, time) => acc + time, 0);\n\t\tconst idle = core.times.idle;\n\t\tconst usage = ((total - idle) / total) * 100;\n\n\t\t// Store historical core data\n\t\tif (!cpuCoreData[index]) cpuCoreData[index] = [];\n\t\tcpuCoreData[index].push(usage);\n\t\tif (cpuCoreData[index].length > MAX_DATA_POINTS) cpuCoreData[index].shift();\n\n\t\treturn {\n\t\t\tmodel: core.model,\n\t\t\tspeed: core.speed,\n\t\t\tusage: usage,\n\t\t\ttimes: core.times\n\t\t};\n\t});\n\n\treturn {\n\t\tcurrentLoad: cpuUsage,\n\t\thistoricalLoad: {\n\t\t\tusage: cpuData,\n\t\t\ttimestamps: timeStamps\n\t\t},\n\t\tcores: {\n\t\t\tcount: cpuCount,\n\t\t\tperCore: coreInfo,\n\t\t\thistoricalPerCore: cpuCoreData\n\t\t}\n\t};\n};\n\n// Fetches detailed disk usage information for multiple mount points\nconst fetchDiskInfo = async () => {\n\t// Get the root drive info\n\tconst rootDiskUsageResult = await osUtils.disk.info();\n\t// node-os-utils v2.x returns { success, data, timestamp, cached, platform }\n\t// data is an array of disk objects with nested byte values\n\tlet rootDiskUsage: { totalGb: number; usedGb: number; freeGb: number; usedPercentage: number; freePercentage: number } | undefined;\n\n\tif (rootDiskUsageResult.success && 'data' in rootDiskUsageResult && Array.isArray(rootDiskUsageResult.data)) {\n\t\t// v2.x format - find the main filesystem\n\t\tconst diskData =\n\t\t\trootDiskUsageResult.data.find((d: { filesystem: string }) => d.filesystem.includes('/dev/')) ||\n\t\t\trootDiskUsageResult.data[1] ||\n\t\t\trootDiskUsageResult.data[0];\n\n\t\tif (diskData) {\n\t\t\t// Convert v2.x format to expected format\n\t\t\trootDiskUsage = {\n\t\t\t\ttotalGb: parseFloat((diskData.total.bytes / 1024 / 1024 / 1024).toFixed(2)),\n\t\t\t\tusedGb: parseFloat((diskData.used.bytes / 1024 / 1024 / 1024).toFixed(2)),\n\t\t\t\tfreeGb: parseFloat((diskData.available.bytes / 1024 / 1024 / 1024).toFixed(2)),\n\t\t\t\tusedPercentage: parseFloat(diskData.usagePercentage.toFixed(2)),\n\t\t\t\tfreePercentage: parseFloat((100 - diskData.usagePercentage).toFixed(2))\n\t\t\t};\n\t\t}\n\t}\n\n\t// Try to get all mount points on Linux/Unix systems\n\tlet allMounts: Array<{\n\t\tfilesystem: string;\n\t\tmountpoint: string;\n\t\ttotalGb: number;\n\t\tusedGb: number;\n\t\tfreeGb: number;\n\t\tusedPercentage: number;\n\t\tfreePercentage: number;\n\t}> = [];\n\ttry {\n\t\tif (os.platform() !== 'win32') {\n\t\t\tconst { stdout } = await execAsync('df -kP | grep -v Filesystem');\n\t\t\tallMounts = stdout\n\t\t\t\t.trim()\n\t\t\t\t.split('\\n')\n\t\t\t\t.map((line) => {\n\t\t\t\t\tconst parts = line.split(/\\s+/);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tfilesystem: parts[0],\n\t\t\t\t\t\tmountpoint: parts[5],\n\t\t\t\t\t\ttotalGb: parseFloat((parseInt(parts[1]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\t\tusedGb: parseFloat((parseInt(parts[2]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\t\tfreeGb: parseFloat((parseInt(parts[3]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\t\tusedPercentage: parseFloat(parts[4].replace('%', '')),\n\t\t\t\t\t\tfreePercentage: 100 - parseFloat(parts[4].replace('%', ''))\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t} else if (rootDiskUsage) {\n\t\t\t// Windows - fallback to just root disk for now\n\t\t\tallMounts = [\n\t\t\t\t{\n\t\t\t\t\tfilesystem: 'C:',\n\t\t\t\t\tmountpoint: 'C:',\n\t\t\t\t\ttotalGb: rootDiskUsage.totalGb,\n\t\t\t\t\tusedGb: rootDiskUsage.usedGb,\n\t\t\t\t\tfreeGb: rootDiskUsage.freeGb,\n\t\t\t\t\tusedPercentage: rootDiskUsage.usedPercentage,\n\t\t\t\t\tfreePercentage: rootDiskUsage.freePercentage\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t} catch (error) {\n\t\tlogger.warn('Failed to get detailed mount points, falling back to root:', error instanceof Error ? error.message : String(error));\n\t\t// Fallback to just root disk\n\t\tif (rootDiskUsage) {\n\t\t\tallMounts = [\n\t\t\t\t{\n\t\t\t\t\tfilesystem: '/',\n\t\t\t\t\tmountpoint: '/',\n\t\t\t\t\ttotalGb: rootDiskUsage.totalGb,\n\t\t\t\t\tusedGb: rootDiskUsage.usedGb,\n\t\t\t\t\tfreeGb: rootDiskUsage.freeGb,\n\t\t\t\t\tusedPercentage: rootDiskUsage.usedPercentage,\n\t\t\t\t\tfreePercentage: rootDiskUsage.freePercentage\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t}\n\n\t// Get I/O statistics if available (Linux only)\n\tlet diskIO = null;\n\ttry {\n\t\tif (os.platform() === 'linux') {\n\t\t\tconst { stdout } = await execAsync('cat /proc/diskstats');\n\t\t\tconst diskstats = stdout.trim().split('\\n');\n\n\t\t\t// Process the most important disk (usually sda or nvme0n1)\n\t\t\tconst mainDisk = diskstats.find((line) => line.includes('sda') || line.includes('nvme0n1'));\n\t\t\tif (mainDisk) {\n\t\t\t\tconst parts = mainDisk.trim().split(/\\s+/);\n\t\t\t\tdiskIO = {\n\t\t\t\t\tdevice: parts[2],\n\t\t\t\t\treads: parseInt(parts[5]),\n\t\t\t\t\twrites: parseInt(parts[9]),\n\t\t\t\t\treadBytes: parseInt(parts[5]) * 512, // Assuming 512 byte sectors\n\t\t\t\t\twriteBytes: parseInt(parts[9]) * 512 // Assuming 512 byte sectors\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tlogger.warn('Failed to get disk I/O stats:', error instanceof Error ? error.message : String(error));\n\t}\n\n\treturn {\n\t\troot: rootDiskUsage,\n\t\tmounts: allMounts,\n\t\tio: diskIO\n\t};\n};\n\n// Fetches detailed memory usage information\nconst fetchMemoryInfo = async () => {\n\tconst memoryInfoResult = await osUtils.memory.info();\n\t// node-os-utils v2.x returns { success, data: { total: {bytes}, used: {bytes}, ... }, timestamp, cached, platform }\n\tlet memoryInfo: { totalMemMb: number; usedMemMb: number; freeMemMb: number; usedMemPercentage: number; freeMemPercentage: number } | undefined;\n\n\tif (memoryInfoResult.success && 'data' in memoryInfoResult && memoryInfoResult.data) {\n\t\t// v2.x format - convert to expected format\n\t\tconst memData = memoryInfoResult.data;\n\t\tmemoryInfo = {\n\t\t\ttotalMemMb: parseFloat((memData.total.bytes / 1024 / 1024).toFixed(2)),\n\t\t\tusedMemMb: parseFloat((memData.used.bytes / 1024 / 1024).toFixed(2)),\n\t\t\tfreeMemMb: parseFloat((memData.free.bytes / 1024 / 1024).toFixed(2)),\n\t\t\tusedMemPercentage: parseFloat(memData.usagePercentage.toFixed(2)),\n\t\t\tfreeMemPercentage: parseFloat((100 - memData.usagePercentage).toFixed(2))\n\t\t};\n\t}\n\n\t// Get swap information if available\n\tlet swapInfo = null;\n\ttry {\n\t\tif (os.platform() !== 'win32') {\n\t\t\tconst { stdout } = await execAsync('free -b');\n\t\t\tconst lines = stdout.trim().split('\\n');\n\t\t\tconst swapLine = lines.find((line) => line.startsWith('Swap:'));\n\t\t\tif (swapLine) {\n\t\t\t\tconst parts = swapLine.split(/\\s+/);\n\t\t\t\tswapInfo = {\n\t\t\t\t\ttotalSwapMb: parseFloat((parseInt(parts[1]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\tusedSwapMb: parseFloat((parseInt(parts[2]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\tfreeSwapMb: parseFloat((parseInt(parts[3]) / 1024 / 1024).toFixed(2)),\n\t\t\t\t\tusedSwapPercentage: parseFloat(((parseInt(parts[2]) / parseInt(parts[1])) * 100).toFixed(2)),\n\t\t\t\t\tfreeSwapPercentage: parseFloat(((parseInt(parts[3]) / parseInt(parts[1])) * 100).toFixed(2))\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\t// Windows - use os.totalmem() and os.freemem()\n\t\t\tconst { stdout } = await execAsync('wmic pagefile get AllocatedBaseSize, CurrentUsage');\n\t\t\tconst lines = stdout.trim().split('\\n');\n\t\t\tif (lines.length > 1) {\n\t\t\t\tconst parts = lines[1].trim().split(/\\s+/);\n\t\t\t\tconst totalSwap = parseInt(parts[0]);\n\t\t\t\tconst usedSwap = parseInt(parts[1]);\n\t\t\t\tswapInfo = {\n\t\t\t\t\ttotalSwapMb: totalSwap,\n\t\t\t\t\tusedSwapMb: usedSwap,\n\t\t\t\t\tfreeSwapMb: totalSwap - usedSwap,\n\t\t\t\t\tusedSwapPercentage: parseFloat(((usedSwap / totalSwap) * 100).toFixed(2)),\n\t\t\t\t\tfreeSwapPercentage: parseFloat((((totalSwap - usedSwap) / totalSwap) * 100).toFixed(2))\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tlogger.warn('Failed to get swap info:', error instanceof Error ? error.message : String(error));\n\t}\n\n\treturn {\n\t\ttotal: memoryInfo\n\t\t\t? {\n\t\t\t\t\ttotalMemMb: memoryInfo.totalMemMb,\n\t\t\t\t\tusedMemMb: memoryInfo.usedMemMb,\n\t\t\t\t\tfreeMemMb: memoryInfo.freeMemMb,\n\t\t\t\t\tusedMemPercentage: memoryInfo.usedMemPercentage,\n\t\t\t\t\tfreeMemPercentage: memoryInfo.freeMemPercentage\n\t\t\t\t}\n\t\t\t: {\n\t\t\t\t\ttotalMemMb: 0,\n\t\t\t\t\tusedMemMb: 0,\n\t\t\t\t\tfreeMemMb: 0,\n\t\t\t\t\tusedMemPercentage: 0,\n\t\t\t\t\tfreeMemPercentage: 0\n\t\t\t\t},\n\t\tswap: swapInfo,\n\t\t// Memory breakdown (if available)\n\t\tbreakdown: {\n\t\t\tbuffers: null,\n\t\t\tcached: null,\n\t\t\tavailable: null,\n\t\t\tactive: null,\n\t\t\tinactive: null\n\t\t}\n\t};\n};\n\n// Fetches network usage statistics\nconst fetchNetworkInfo = async () => {\n\tconst networkStats = await osUtils.network.stats();\n\tconst networkInterfaces = os.networkInterfaces();\n\n\t// Process interface information\n\tconst interfaces = Object.entries(networkInterfaces)\n\t\t.map(([name, info]) => {\n\t\t\tif (!info) return null;\n\n\t\t\treturn {\n\t\t\t\tname,\n\t\t\t\taddresses: info.map((addr) => ({\n\t\t\t\t\taddress: addr.address,\n\t\t\t\t\tnetmask: addr.netmask,\n\t\t\t\t\tfamily: addr.family,\n\t\t\t\t\tmac: addr.mac,\n\t\t\t\t\tinternal: addr.internal,\n\t\t\t\t\tcidr: addr.cidr\n\t\t\t\t}))\n\t\t\t};\n\t\t})\n\t\t.filter(Boolean);\n\n\t// Calculate network throughput\n\tconst now = {\n\t\trx: networkStats.rx_bytes || 0,\n\t\ttx: networkStats.tx_bytes || 0,\n\t\ttimestamp: Date.now()\n\t};\n\n\tlet throughput = {\n\t\trx: 0,\n\t\ttx: 0,\n\t\trxPerSec: 0,\n\t\ttxPerSec: 0\n\t};\n\n\tif (networkBaseline) {\n\t\tconst timeDiffSecs = (now.timestamp - networkBaseline.timestamp) / 1000;\n\t\tif (timeDiffSecs > 0) {\n\t\t\tthroughput = {\n\t\t\t\trx: now.rx - networkBaseline.rx,\n\t\t\t\ttx: now.tx - networkBaseline.tx,\n\t\t\t\trxPerSec: (now.rx - networkBaseline.rx) / timeDiffSecs,\n\t\t\t\ttxPerSec: (now.tx - networkBaseline.tx) / timeDiffSecs\n\t\t\t};\n\t\t}\n\t}\n\n\t// Update baseline for next calculation\n\tnetworkBaseline = now;\n\n\treturn {\n\t\tstats: networkStats,\n\t\tinterfaces,\n\t\tthroughput\n\t};\n};\n\n// Fetches process information including top CPU and memory consumers\nconst fetchProcessInfo = async (): Promise<{\n\tprocesses: Array<{\n\t\tpid: number;\n\t\tname: string;\n\t\tcpu: number;\n\t\tmemory: number;\n\t\trss?: number;\n\t}>;\n}> => {\n\tlet processes: Array<{ pid: number; name: string; cpu: number; memory: number; rss?: number }> = [];\n\n\ttry {\n\t\tif (os.platform() === 'win32') {\n\t\t\t// Windows - use wmic\n\t\t\tconst { stdout } = await execAsync(`wmic process get ProcessId,Name,WorkingSetSize,UserModeTime,KernelModeTime /format:csv`);\n\t\t\tconst lines = stdout\n\t\t\t\t.trim()\n\t\t\t\t.split('\\n')\n\t\t\t\t.filter((line) => line.length > 0);\n\n\t\t\t// Process CSV format (skip header)\n\t\t\tif (lines.length > 1) {\n\t\t\t\tconst processData = lines.slice(1).map((line) => {\n\t\t\t\t\tconst parts = line.split(',');\n\t\t\t\t\tconst totalTime = (parseInt(parts[4] || '0') + parseInt(parts[3] || '0')) / 10000000; // Convert 100ns to seconds\n\t\t\t\t\treturn {\n\t\t\t\t\t\tpid: parseInt(parts[1] || '0'),\n\t\t\t\t\t\tname: parts[2],\n\t\t\t\t\t\tcpu: totalTime,\n\t\t\t\t\t\tmemory: parseInt(parts[5] || '0') / (1024 * 1024) // Convert bytes to MB\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\t// Sort by CPU usage and take top processes\n\t\t\t\tprocesses = processData\n\t\t\t\t\t.filter((p) => p.pid > 0)\n\t\t\t\t\t.sort((a, b) => b.cpu - a.cpu)\n\t\t\t\t\t.slice(0, PROCESS_LIMIT);\n\t\t\t}\n\t\t} else {\n\t\t\t// Linux/Unix - use ps\n\t\t\tconst { stdout } = await execAsync(`ps -eo pid,comm,%cpu,%mem,rss --sort=-%cpu | head -n ${PROCESS_LIMIT + 1}`);\n\t\t\tconst lines = stdout.trim().split('\\n');\n\n\t\t\t// Process each line (skip header)\n\t\t\tif (lines.length > 1) {\n\t\t\t\tprocesses = lines.slice(1).map((line) => {\n\t\t\t\t\tconst parts = line.trim().split(/\\s+/);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tpid: parseInt(parts[0]),\n\t\t\t\t\t\tname: parts[1],\n\t\t\t\t\t\tcpu: parseFloat(parts[2]),\n\t\t\t\t\t\tmemory: parseFloat(parts[3]),\n\t\t\t\t\t\trss: parseInt(parts[4]) / 1024 // Convert KB to MB\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tlogger.warn('Failed to get process info:', error instanceof Error ? error.message : String(error));\n\t}\n\n\treturn { processes };\n};\n\n// Collects overall system information including CPU, disk, memory, and OS details.\nconst getSystemInfo = async (type?: string) => {\n\ttry {\n\t\t// If specific type requested, only fetch that info\n\t\tif (type === 'cpu') return { cpuInfo: await getCachedOrFresh('cpu', fetchCPUInfo) };\n\t\tif (type === 'disk') return { diskInfo: await getCachedOrFresh('disk', fetchDiskInfo) };\n\t\tif (type === 'memory') return { memoryInfo: await getCachedOrFresh('memory', fetchMemoryInfo) };\n\t\tif (type === 'network') return { networkInfo: await getCachedOrFresh('network', fetchNetworkInfo) };\n\t\tif (type === 'process') return { processInfo: await getCachedOrFresh('process', fetchProcessInfo) };\n\n\t\t// For OS info, we don't need to cache as it rarely changes\n\t\tif (type === 'os') {\n\t\t\treturn {\n\t\t\t\tosInfo: {\n\t\t\t\t\tplatform: os.platform(),\n\t\t\t\t\trelease: os.release(),\n\t\t\t\t\ttype: os.type(),\n\t\t\t\t\tarch: os.arch(),\n\t\t\t\t\thostname: os.hostname(),\n\t\t\t\t\tuptime: os.uptime(),\n\t\t\t\t\tloadavg: os.loadavg()\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// If no specific type requested or 'all', fetch all info\n\t\treturn await getCachedOrFresh('all', async () => {\n\t\t\tconst [cpuInfo, diskInfo, memoryInfo, networkInfo, processInfo] = await Promise.all([\n\t\t\t\tfetchCPUInfo(),\n\t\t\t\tfetchDiskInfo(),\n\t\t\t\tfetchMemoryInfo(),\n\t\t\t\tfetchNetworkInfo(),\n\t\t\t\tfetchProcessInfo()\n\t\t\t]);\n\n\t\t\tconst osInfo = {\n\t\t\t\tplatform: os.platform(),\n\t\t\t\trelease: os.release(),\n\t\t\t\ttype: os.type(),\n\t\t\t\tarch: os.arch(),\n\t\t\t\thostname: os.hostname(),\n\t\t\t\tuptime: os.uptime(),\n\t\t\t\tloadavg: os.loadavg()\n\t\t\t};\n\n\t\t\treturn { cpuInfo, diskInfo, memoryInfo, networkInfo, osInfo, processInfo };\n\t\t});\n\t} catch (error) {\n\t\tlogger.error('Error fetching system info:', error instanceof Error ? error.message : String(error));\n\t\tthrow new Error('Failed to fetch system information');\n\t}\n};\n\n// Fetches and returns system information including CPU, disk, memory, and OS details.\nexport const GET: RequestHandler = async ({ url, locals }) => {\n\ttry {\n\t\t// Authentication is handled by hooks.server.ts\n\t\tif (!locals.user) {\n\t\t\tlogger.warn('Unauthorized attempt to access system info');\n\t\t\tthrow error(401, 'Unauthorized');\n\t\t}\n\n\t\t// Check if specific type of information is requested\n\t\tconst type = url.searchParams.get('type') || 'all';\n\n\t\t// Fetch system information\n\t\tconst systemInfo = await getSystemInfo(type);\n\n\t\t// Debug logging for memory type\n\t\tif (type === 'memory') {\n\t\t\tlogger.info('System info memory fetched:', {\n\t\t\t\thasMemoryInfo: !!(systemInfo as any).memoryInfo,\n\t\t\t\tkeys: Object.keys(systemInfo)\n\t\t\t});\n\t\t}\n\t\tlogger.info(`System information (${type}) fetched successfully`, {\n\t\t\tuserId: locals.user?._id,\n\t\t\tuserEmail: locals.user?.email\n\t\t});\n\n\t\t// Return the system information as a JSON response\n\t\treturn new Response(JSON.stringify(systemInfo), {\n\t\t\tstatus: 200,\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t'Cache-Control': 'no-cache, no-store, must-revalidate'\n\t\t\t}\n\t\t});\n\t} catch (err) {\n\t\tconst httpError = err as { status?: number; body?: { message?: string }; message?: string };\n\t\tconst status = httpError.status || 500;\n\t\tconst message = httpError.body?.message || httpError.message || 'Internal Server Error';\n\t\tlogger.error('Error fetching system info:', { error: message, status });\n\n\t\t// Return an error response in case of failure\n\t\treturn new Response(JSON.stringify({ error: message }), {\n\t\t\tstatus,\n\t\t\theaders: { 'Content-Type': 'application/json' }\n\t\t});\n\t}\n};\n"],"names":["error"],"mappings":"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"}