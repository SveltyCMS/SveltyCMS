{"version":3,"file":"_server.ts.js","sources":["../../../../../../../src/routes/api/getTokensProvided/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/getTokensProvided/+server.ts\n * @description API endpoint for checking the availability of external service tokens.\n *\n * This module provides functionality to:\n * - Check if API keys/tokens are provided for Google, Twitch, and TikTok\n * - Return a JSON object indicating which tokens are available\n *\n * Features:\n * - Environment-based token availability check\n * - Logging of token availability status\n *\n * Usage:\n * GET /api/getTokensProvided\n * Returns: JSON object with boolean values for each service token\n * Requires: Admin authentication or system permissions\n */\n\nimport { getPrivateSettingSync } from '@shared/services/settingsService';\nimport { json, type RequestHandler } from '@sveltejs/kit';\n\n// Permissions\n\n// System Logger\nimport { logger } from '@shared/utils/logger.server';\n\ninterface TokenStatus {\n\tgoogle: boolean;\n\ttwitch: boolean;\n\ttiktok: boolean;\n}\n\nexport const GET: RequestHandler = async () => {\n\t// No permission checks needed - hooks already verified:\n\t// 1. User is authenticated\n\t// 2. User has correct role for this API endpoint\n\t// 3. User belongs to correct tenant (if multi-tenant)\n\n\tlogger.debug('Checking provided tokens...');\n\n\tconst tokensProvided: TokenStatus = {\n\t\tgoogle: Boolean(getPrivateSettingSync('GOOGLE_API_KEY')),\n\t\ttwitch: Boolean(getPrivateSettingSync('TWITCH_TOKEN')),\n\t\ttiktok: Boolean(getPrivateSettingSync('TIKTOK_TOKEN'))\n\t};\n\n\tObject.entries(tokensProvided).forEach(([service, isProvided]) => {\n\t\tlogger.debug(`${service} token is ${isProvided ? 'provided' : 'not provided'}.`);\n\t});\n\n\tlogger.info('Tokens provided status', tokensProvided);\n\n\treturn json(tokensProvided);\n};\n"],"names":[],"mappings":";;;AAgCO,MAAM,MAAsB,YAAY;AAM9C,SAAO,MAAM,6BAA6B;AAE1C,QAAM,iBAA8B;AAAA,IACnC,QAAQ,QAAQ,sBAAsB,gBAAgB,CAAC;AAAA,IACvD,QAAQ,QAAQ,sBAAsB,cAAc,CAAC;AAAA,IACrD,QAAQ,QAAQ,sBAAsB,cAAc,CAAC;AAAA,EAAA;AAGtD,SAAO,QAAQ,cAAc,EAAE,QAAQ,CAAC,CAAC,SAAS,UAAU,MAAM;AACjE,WAAO,MAAM,GAAG,OAAO,aAAa,aAAa,aAAa,cAAc,GAAG;AAAA,EAChF,CAAC;AAED,SAAO,KAAK,0BAA0B,cAAc;AAEpD,SAAO,KAAK,cAAc;AAC3B;"}