{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/content/nodes/+server.ts"],"sourcesContent":["/**\n * @file src\\routes\\api\\content\\nodes\\+server.ts\n * @description API endpoint for fetching node children.\n *\n * Security: Protected by hooks, admin-only.\n */\nimport { json } from '@sveltejs/kit';\nimport { contentManager } from '@content/ContentManager';\nimport type { RequestHandler } from './$types';\n\nexport const GET: RequestHandler = async ({ url, locals }) => {\n\tconst parentId = url.searchParams.get('parentId');\n\tconst tenantId = locals.tenantId;\n\n\tif (!parentId) {\n\t\treturn json({ error: 'parentId is required' }, { status: 400 });\n\t}\n\n\ttry {\n\t\tconst children = contentManager.getNodeChildren(parentId, tenantId);\n\n\t\t// Map to NavigationNode format if needed, or just return ContentNode[]\n\t\t// The client expects NavigationNode likely.\n\t\t// Let's use the same strip logic or just return what getNodeChildren returns (ContentNode[])\n\t\t// But ContentNode has heavy fields? No, getNodeChildren returns ContentNode which might have collectionDef.\n\t\t// We should strip it down to NavigationNode to be lightweight.\n\n\t\tconst navigationChildren = children.map((node) => ({\n\t\t\t_id: node._id,\n\t\t\tname: node.name,\n\t\t\tpath: node.path,\n\t\t\ticon: node.icon,\n\t\t\tnodeType: node.nodeType,\n\t\t\torder: node.order,\n\t\t\tparentId: node.parentId,\n\t\t\ttranslations: node.translations,\n\t\t\thasChildren: node.children && node.children.length > 0\n\t\t}));\n\n\t\treturn json({ nodes: navigationChildren });\n\t} catch (err) {\n\t\treturn json({ error: 'Failed to fetch nodes' }, { status: 500 });\n\t}\n};\n"],"names":[],"mappings":";;AAUO,MAAM,MAAsB,OAAO,EAAE,KAAK,aAAa;AAC7D,QAAM,WAAW,IAAI,aAAa,IAAI,UAAU;AAChD,QAAM,WAAW,OAAO;AAExB,MAAI,CAAC,UAAU;AACd,WAAO,KAAK,EAAE,OAAO,uBAAA,GAA0B,EAAE,QAAQ,KAAK;AAAA,EAC/D;AAEA,MAAI;AACH,UAAM,WAAW,eAAe,gBAAgB,UAAU,QAAQ;AAQlE,UAAM,qBAAqB,SAAS,IAAI,CAAC,UAAU;AAAA,MAClD,KAAK,KAAK;AAAA,MACV,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,MACX,MAAM,KAAK;AAAA,MACX,UAAU,KAAK;AAAA,MACf,OAAO,KAAK;AAAA,MACZ,UAAU,KAAK;AAAA,MACf,cAAc,KAAK;AAAA,MACnB,aAAa,KAAK,YAAY,KAAK,SAAS,SAAS;AAAA,IAAA,EACpD;AAEF,WAAO,KAAK,EAAE,OAAO,oBAAoB;AAAA,EAC1C,SAAS,KAAK;AACb,WAAO,KAAK,EAAE,OAAO,wBAAA,GAA2B,EAAE,QAAQ,KAAK;AAAA,EAChE;AACD;"}