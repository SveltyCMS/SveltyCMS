{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/system/health/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/system/health/+server.ts\n * @description Public health check endpoint\n * @summary\n *  - Returns system health status with performance metrics\n *  - Maps overall status to HTTP status codes\n *  - Catches and reports errors gracefully\n *  - No authentication required\n */\n\nimport { json } from '@sveltejs/kit';\nimport type { RequestHandler } from './$types';\nimport { getHealthCheckReport } from '@shared/stores/system';\n\n/**\n * GET /api/system/health\n * Returns system health status with performance metrics\n */\nexport const GET: RequestHandler = async () => {\n\ttry {\n\t\tconst healthReport = getHealthCheckReport();\n\n\t\tconst httpStatus =\n\t\t\thealthReport.overallStatus === 'READY'\n\t\t\t\t? 200\n\t\t\t\t: healthReport.overallStatus === 'DEGRADED'\n\t\t\t\t\t? 200 // Degraded is still operational, so return 200 OK\n\t\t\t\t\t: 503; // FAILED, INITIALIZING, or IDLE are 503 Service Unavailable\n\n\t\treturn json(\n\t\t\t{\n\t\t\t\tsuccess: healthReport.overallStatus === 'READY',\n\t\t\t\t...healthReport\n\t\t\t},\n\t\t\t{ status: httpStatus }\n\t\t);\n\t} catch (error) {\n\t\treturn json(\n\t\t\t{\n\t\t\t\tsuccess: false,\n\t\t\t\toverallStatus: 'FAILED',\n\t\t\t\terror: error instanceof Error ? error.message : 'Health check failed',\n\t\t\t\ttimestamp: Date.now()\n\t\t\t},\n\t\t\t{ status: 500 }\n\t\t);\n\t}\n};\n"],"names":[],"mappings":";;;;AAkBO,MAAM,MAAsB,YAAY;AAC9C,MAAI;AACH,UAAM,eAAe,qBAAA;AAErB,UAAM,aACL,aAAa,kBAAkB,UAC5B,MACA,aAAa,kBAAkB,aAC9B,MACA;AAEL,WAAO;AAAA,MACN;AAAA,QACC,SAAS,aAAa,kBAAkB;AAAA,QACxC,GAAG;AAAA,MAAA;AAAA,MAEJ,EAAE,QAAQ,WAAA;AAAA,IAAW;AAAA,EAEvB,SAAS,OAAO;AACf,WAAO;AAAA,MACN;AAAA,QACC,SAAS;AAAA,QACT,eAAe;AAAA,QACf,OAAO,iBAAiB,QAAQ,MAAM,UAAU;AAAA,QAChD,WAAW,KAAK,IAAA;AAAA,MAAI;AAAA,MAErB,EAAE,QAAQ,IAAA;AAAA,IAAI;AAAA,EAEhB;AACD;"}