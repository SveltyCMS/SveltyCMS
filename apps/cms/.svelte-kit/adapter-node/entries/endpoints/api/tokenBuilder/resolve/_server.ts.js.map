{"version":3,"file":"_server.ts.js","sources":["../../../../../../../../src/routes/api/tokenBuilder/resolve/+server.ts"],"sourcesContent":["/**\n * @file src/routes/api/tokenBuilder/resolve/+server.ts\n * @description Resolve tokens in a given string.\n */\n\nimport { processTokensInResponse } from '@shared/services/token/helper';\nimport { json } from '@sveltejs/kit';\nimport type { RequestHandler } from './$types';\n\nexport const POST: RequestHandler = async ({ request, locals }) => {\n\ttry {\n\t\tconst { text } = await request.json();\n\t\tconst locale = (locals as any).locale || 'en';\n\n\t\t// Resolve tokens\n\t\t// We can merge the provided context with the system context if needed\n\t\t// For now, we mainly rely on the server-side context (user, system)\n\t\t// but we could allow passing specific entry data if needed for preview.\n\n\t\tconst resolved = await processTokensInResponse(text, locals.user ?? undefined, locale);\n\n\t\treturn json({ resolved });\n\t} catch (error) {\n\t\treturn json({ error: 'Failed to resolve tokens' }, { status: 400 });\n\t}\n};\n"],"names":[],"mappings":";;AASO,MAAM,OAAuB,OAAO,EAAE,SAAS,aAAa;AAClE,MAAI;AACH,UAAM,EAAE,KAAA,IAAS,MAAM,QAAQ,KAAA;AAC/B,UAAM,SAAU,OAAe,UAAU;AAOzC,UAAM,WAAW,MAAM,wBAAwB,MAAM,OAAO,QAAQ,QAAW,MAAM;AAErF,WAAO,KAAK,EAAE,UAAU;AAAA,EACzB,SAAS,OAAO;AACf,WAAO,KAAK,EAAE,OAAO,2BAAA,GAA8B,EAAE,QAAQ,KAAK;AAAA,EACnE;AACD;"}