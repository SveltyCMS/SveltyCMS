{"version":3,"file":"_page.svelte.js","sources":["../../../../../../src/routes/graphql-test/+page.svelte"],"sourcesContent":["<!--\n@file src/routes/(app)/graphql-test/+page.svelte\n@component\n**GraphQL Subscription Test Page for SveltyCMS**\n\n### Features:\n- Connects to the GraphQL WebSocket endpoint using graphql-ws.\n- Subscribes to the `postAdded` event and displays new posts in real time.\n- Shows errors if the subscription fails.\n- Demonstrates live updates from the backend using GraphQL subscriptions.\n-->\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { onMount } from 'svelte';\n\timport { createClient } from 'graphql-ws';\n\n\tlet posts: any[] = $state([]);\n\tlet error: any = $state(null);\n\n\tonMount(() => {\n\t\tconst client = createClient({\n\t\t\turl: 'ws://localhost:3001/api/graphql'\n\t\t});\n\n\t\tclient.subscribe(\n\t\t\t{\n\t\t\t\tquery: `\n\t\t\t\t\tsubscription PostAdded {\n\t\t\t\t\t\tpostAdded {\n\t\t\t\t\t\t\t_id\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t`\n\t\t\t},\n\t\t\t{\n\t\t\t\tnext: (data) => {\n\t\t\t\t\tif (data?.data?.postAdded) {\n\t\t\t\t\t\tposts = [...posts, data.data.postAdded];\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: (err) => {\n\t\t\t\t\terror = err;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tlogger.debug('Subscription complete');\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t});\n</script>\n\n<h1>GraphQL Subscription Test</h1>\n\n{#if error}\n\t<p style=\"color: red\">{JSON.stringify(error, null, 2)}</p>\n{/if}\n\n<h2>New Posts:</h2>\n<ul>\n\t{#each posts as post}\n\t\t<li>{post.title} ({post._id})</li>\n\t{/each}\n</ul>\n"],"names":["$$renderer","$.escape"],"mappings":";;;wCAWA;QAKK,QAAY,CAAA;;;;;;yCA4CT,KAAK;;UAAI,OAAI,WAAA,OAAA;AACd,MAAAA,YAAA,KAAA,OAAAC,YAAA,KAAK,KAAK,CAAA,KAAAA,YAAI,KAAK,GAAG,CAAA,QAAA;AAAA;;EAXrB,CAAA;;"}