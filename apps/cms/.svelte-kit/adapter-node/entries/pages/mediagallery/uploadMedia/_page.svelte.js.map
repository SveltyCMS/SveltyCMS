{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/routes/mediagallery/uploadMedia/LocalUpload.svelte","../../../../../../../src/routes/mediagallery/uploadMedia/RemoteUpload.svelte","../../../../../../../src/routes/mediagallery/uploadMedia/+page.svelte"],"sourcesContent":["<!-- \n@files src/routes/(app)/mediagallery/uploadMedia/LocalUpload.svelte\n@component\n**This page is used to local upload media to the media gallery**\n\n## Props\n- \n\n### Features:\n- Drag and drop file upload\n- File validation (size, type)\n- Duplicate file detection\n- Thumbnail generation\n- File upload progress\n- Cancel upload\n\t\n-->\n<script lang=\"ts\">\n\timport { logger } from '@shared/utils/logger';\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { goto } from '$app/navigation';\n\timport { untrack } from 'svelte';\n\n\timport { Tooltip, Portal } from '@skeletonlabs/skeleton-svelte';\n\n\tlet files: File[] = $state([]);\n\tlet input: HTMLInputElement | null = $state(null);\n\tlet dropZone: HTMLDivElement | null = $state(null);\n\tlet uploadProgress = $state(0);\n\tlet uploadSpeed = $state(0);\n\tlet isUploading = $state(false);\n\n\t// Internal state moved from ModalUploadMedia\n\tlet fileSet = $state(new Set<string>());\n\n\tlet objectUrls = $state<Map<string, string>>(new Map());\n\n\tconst MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB\n\tconst ALLOWED_TYPES = [\n\t\t'image/jpeg',\n\t\t'image/png',\n\t\t'image/gif',\n\t\t'image/webp',\n\t\t'image/svg+xml',\n\t\t'video/mp4',\n\t\t'video/webm',\n\t\t'audio/mpeg',\n\t\t'audio/wav',\n\t\t'application/pdf',\n\t\t'application/msword',\n\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n\t];\n\n\t// Async Thumbnail Generation Effect\n\t$effect(() => {\n\t\tconst currentFiles = files;\n\t\tconst previousObjectUrls = untrack(() => new Map(objectUrls));\n\n\t\t// Use a local map to track progress during this run\n\t\tconst nextObjectUrls = new Map(previousObjectUrls);\n\t\tlet isActive = true;\n\n\t\tasync function generateThumbnails() {\n\t\t\tfor (const file of currentFiles) {\n\t\t\t\tif (!isActive) return;\n\n\t\t\t\tconst fileKey = `${file.name}-${file.size}`;\n\n\t\t\t\t// Skip if we already have a URL for this file\n\t\t\t\tif (!nextObjectUrls.has(fileKey)) {\n\t\t\t\t\tif (file.type?.startsWith('image/') || file.type?.startsWith('audio/')) {\n\t\t\t\t\t\tconst url = URL.createObjectURL(file);\n\t\t\t\t\t\tnextObjectUrls.set(fileKey, url);\n\n\t\t\t\t\t\t// Update state incrementally to show progress without freezing\n\t\t\t\t\t\tobjectUrls = new Map(nextObjectUrls);\n\n\t\t\t\t\t\t// Yield to main thread to allow UI rendering\n\t\t\t\t\t\tawait new Promise((resolve) => requestAnimationFrame(resolve));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cleanup phase: Remove URLs for files that are no longer present\n\t\t\tif (isActive) {\n\t\t\t\tconst currentFileKeys = new Set(currentFiles.map((f) => `${f.name}-${f.size}`));\n\t\t\t\tfor (const [key, url] of previousObjectUrls) {\n\t\t\t\t\tif (!currentFileKeys.has(key)) {\n\t\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t\t\tnextObjectUrls.delete(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Final state update\n\t\t\t\tobjectUrls = nextObjectUrls;\n\t\t\t}\n\t\t}\n\n\t\tgenerateThumbnails();\n\n\t\treturn () => {\n\t\t\tisActive = false;\n\t\t};\n\t});\n\n\t// Cleanup on destroy\n\t$effect(() => {\n\t\treturn () => {\n\t\t\tobjectUrls.forEach((url) => URL.revokeObjectURL(url));\n\t\t};\n\t});\n\n\t// Helper: Get icon string\n\tfunction getFileIcon(file: File): string {\n\t\tconst fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();\n\t\tswitch (true) {\n\t\t\tcase file.type?.startsWith('image/'):\n\t\t\t\treturn 'fa-solid:image';\n\t\t\tcase file.type?.startsWith('video/'):\n\t\t\t\treturn 'fa-solid:video';\n\t\t\tcase file.type?.startsWith('audio/'):\n\t\t\t\treturn 'fa-solid:play-circle';\n\t\t\tcase fileExt === '.pdf':\n\t\t\t\treturn 'vscode-icons:file-type-pdf2';\n\t\t\tcase fileExt === '.doc' || fileExt === '.docx' || fileExt === '.docm':\n\t\t\t\treturn 'vscode-icons:file-type-word';\n\t\t\tcase fileExt === '.ppt' || fileExt === '.pptx':\n\t\t\t\treturn 'vscode-icons:file-type-powerpoint';\n\t\t\tcase fileExt === '.xls' || fileExt === '.xlsx':\n\t\t\t\treturn 'vscode-icons:file-type-excel';\n\t\t\tcase fileExt === '.txt':\n\t\t\t\treturn 'fa-solid:file-lines';\n\t\t\tcase fileExt === '.zip' || fileExt === '.rar':\n\t\t\t\treturn 'fa-solid:file-zipper';\n\t\t\tdefault:\n\t\t\t\treturn 'vscode-icons:file';\n\t\t}\n\t}\n\n\t// Format MIME type for display\n\tfunction formatMimeType(mime?: string): string {\n\t\tif (!mime) return 'Unknown';\n\t\tconst parts = mime.split('/');\n\t\treturn parts[1] ? parts[1].toUpperCase() : parts[0].toUpperCase();\n\t}\n\n\tfunction validateAndAddFiles(newFiles: File[]) {\n\t\tconst validFiles: File[] = [];\n\t\tconst errors: string[] = [];\n\n\t\tnewFiles.forEach((file) => {\n\t\t\tif (file.size > MAX_FILE_SIZE) {\n\t\t\t\terrors.push(`${file.name} exceeds maximum file size of 50MB`);\n\t\t\t} else if (!ALLOWED_TYPES.includes(file.type)) {\n\t\t\t\terrors.push(`${file.name} is not an allowed file type`);\n\t\t\t} else {\n\t\t\t\t// Check for duplicates\n\t\t\t\tconst fileKey = `${file.name}-${file.size}`;\n\t\t\t\tif (fileSet.has(fileKey)) {\n\t\t\t\t\t// Silent skip or warn? using simple toast if needed, but usually redundant\n\t\t\t\t} else {\n\t\t\t\t\tvalidFiles.push(file);\n\t\t\t\t\tfileSet.add(fileKey);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (errors.length > 0) {\n\t\t\ttoaster.error({ description: errors.join('\\n') });\n\t\t}\n\n\t\tif (validFiles.length > 0) {\n\t\t\tfiles = [...files, ...validFiles];\n\t\t}\n\t}\n\n\tfunction handleFileDrop(event: DragEvent) {\n\t\tevent.preventDefault();\n\t\tif (!event.dataTransfer) return;\n\t\tvalidateAndAddFiles(Array.from(event.dataTransfer.files));\n\t}\n\n\tfunction onChange() {\n\t\tif (!input || !input.files) return;\n\t\tvalidateAndAddFiles(Array.from(input.files));\n\t\tif (input) input.value = '';\n\t}\n\n\tfunction handleDragOver(e: DragEvent) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (dropZone) dropZone.style.borderColor = '#5fd317';\n\t}\n\n\tfunction handleDragLeave(e: DragEvent) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tdropZone?.style.removeProperty('border-color');\n\t}\n\n\tfunction handleDeleteFile(file: File) {\n\t\tconst fileKey = `${file.name}-${file.size}`;\n\t\tfiles = files.filter((f) => f !== file);\n\t\tfileSet.delete(fileKey);\n\t}\n\n\tfunction handleCancel() {\n\t\tfiles = [];\n\t\tfileSet.clear();\n\t\t// Revoke immediately\n\t\tobjectUrls.forEach((url) => URL.revokeObjectURL(url));\n\t\tobjectUrls = new Map();\n\t}\n\n\t// Format bytes for display\n\tfunction formatBytes(bytes: number): string {\n\t\tif (bytes === 0) return '0 Bytes';\n\t\tconst k = 1024;\n\t\tconst sizes = ['Bytes', 'KB', 'MB', 'GB'];\n\t\tconst i = Math.floor(Math.log(bytes) / Math.log(k));\n\t\treturn parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n\t}\n\n\tasync function uploadLocalFiles() {\n\t\tif (files.length === 0) {\n\t\t\ttoaster.warning({ description: 'No files selected for upload' });\n\t\t\treturn;\n\t\t}\n\n\t\tisUploading = true;\n\t\tuploadProgress = 0;\n\t\tconst startTime = Date.now();\n\t\tlet lastLoaded = 0;\n\n\t\tconst formData = new FormData();\n\t\tfiles.forEach((file) => {\n\t\t\tformData.append('files', file);\n\t\t});\n\n\t\ttry {\n\t\t\tconst xhr = new XMLHttpRequest();\n\n\t\t\t// Track upload progress\n\t\t\txhr.upload.addEventListener('progress', (e) => {\n\t\t\t\tif (e.lengthComputable) {\n\t\t\t\t\tuploadProgress = Math.round((e.loaded * 100) / e.total);\n\n\t\t\t\t\t// Calculate upload speed (bytes per second)\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst timeDiff = (currentTime - startTime) / 1000; // in seconds\n\t\t\t\t\tconst loadedDiff = e.loaded - lastLoaded;\n\t\t\t\t\tuploadSpeed = timeDiff > 0 ? loadedDiff / timeDiff : 0;\n\t\t\t\t\tlastLoaded = e.loaded;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Handle completion\n\t\t\tconst uploadPromise = new Promise((resolve, reject) => {\n\t\t\t\txhr.onload = () => {\n\t\t\t\t\tif (xhr.status >= 200 && xhr.status < 300) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst response = JSON.parse(xhr.responseText);\n\t\t\t\t\t\t\tlet data = response.data;\n\n\t\t\t\t\t\t\t// Check if data is a JSON string that needs parsing\n\t\t\t\t\t\t\tif (typeof data === 'string') {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t\t\t\t\tlogger.debug('Parsed stringified data:', data);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tlogger.warn('Data is a string but not valid JSON:', data);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (response.type === 'success' && data) resolve(data);\n\t\t\t\t\t\t\telse if (response.success !== undefined) resolve(response);\n\t\t\t\t\t\t\telse reject(new Error('Invalid response format'));\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treject(new Error('Invalid response format'));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error(`Upload failed: ${xhr.status}`));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\txhr.onerror = () => reject(new Error('Network error'));\n\t\t\t});\n\n\t\t\t// Post to the parent route's upload form action\n\t\t\txhr.open('POST', '/mediagallery?/upload');\n\t\t\txhr.send(formData);\n\n\t\t\tconst result: any = await uploadPromise;\n\t\t\tconst success = Array.isArray(result) ? result[0]?.success : result?.success;\n\n\t\t\tif (success) {\n\t\t\t\ttoaster.success({ description: 'Files uploaded successfully' });\n\t\t\t\thandleCancel();\n\t\t\t\tgoto('/mediagallery', { invalidateAll: true });\n\t\t\t} else {\n\t\t\t\tthrow new Error((Array.isArray(result) ? result[0]?.error : result?.error) || 'Upload failed');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error('Error uploading files:', error);\n\t\t\ttoaster.error({ description: 'Error uploading files: ' + (error instanceof Error ? error.message : 'Unknown error') });\n\t\t} finally {\n\t\t\tisUploading = false;\n\t\t}\n\t}\n</script>\n\n{#if files.length === 0}\n\t<!-- Drop Zone State -->\n\t<div\n\t\tbind:this={dropZone}\n\t\tondrop={handleFileDrop}\n\t\tondragover={handleDragOver}\n\t\tondragleave={handleDragLeave}\n\t\tclass=\"mt-2 flex h-[200px] w-full max-w-full select-none flex-col items-center justify-center gap-4 rounded border-2 border-dashed border-surface-600 bg-secondary-50 dark:border-surface-500 dark:bg-surface-700\"\n\t\trole=\"region\"\n\t\taria-label=\"File drop zone\"\n\t>\n\t\t<div class=\"grid grid-cols-6 items-center p-4\">\n\t\t\t<iconify-icon icon=\"fa6-solid:file-arrow-up\" width=\"40\" aria-hidden=\"true\"></iconify-icon>\n\n\t\t\t<div class=\"col-span-5 space-y-4 text-center\">\n\t\t\t\t<p class=\"font-bold\">\n\t\t\t\t\t<span class=\"text-tertiary-500 dark:text-primary-500\">Media Upload</span>\n\t\t\t\t\tDrag files here to upload\n\t\t\t\t</p>\n\n\t\t\t\t<p class=\"text-sm opacity-75\">Multiple files allowed</p>\n\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonclick={() => input?.click()}\n\t\t\t\t\tclass=\"preset-filled-tertiary-500 btn mt-3 dark:preset-filled-primary-500\"\n\t\t\t\t\tdisabled={isUploading}\n\t\t\t\t>\n\t\t\t\t\tBrowse Files\n\t\t\t\t</button>\n\n\t\t\t\t<!-- File Size Limit -->\n\t\t\t\t<p class=\"mt-2 text-sm text-tertiary-500 dark:text-primary-500\">Max File Size: 50 MB</p>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- File Input -->\n\t\t<input bind:this={input} type=\"file\" class=\"sr-only\" hidden multiple onchange={onChange} aria-hidden=\"true\" tabindex=\"-1\" />\n\t</div>\n{:else}\n\t<div class=\"mb-5 text-center sm:text-left\">\n\t\t<p class=\"text-center text-tertiary-500 dark:text-primary-500\">\n\t\t\tThis area facilitates the queuing and previewing of media files before they are officially uploaded to the gallery. Verify your selection below,\n\t\t\tthen confirm to complete the transfer.\n\t\t</p>\n\t</div>\n\t<!-- Grid View State -->\n\t<div class=\"flex flex-col space-y-4\">\n\t\t<!-- File Grid -->\n\t\t<div class=\"grid grid-cols-3 gap-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6\">\n\t\t\t{#each files as file (file.name + file.size)}\n\t\t\t\t{@const fileKey = `${file.name}-${file.size}`}\n\t\t\t\t{@const previewUrl = objectUrls.get(fileKey)}\n\t\t\t\t{@const iconName = getFileIcon(file)}\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\"group relative overflow-hidden rounded border border-surface-200 shadow-sm transition-all hover:shadow-md dark:border-surface-500\"\n\t\t\t\t>\n\t\t\t\t\t<!-- Delete button -->\n\t\t\t\t\t<div class=\"absolute right-1 top-1 z-10 flex cursor-pointer shadow-sm\">\n\t\t\t\t\t\t<Tooltip positioning={{ placement: 'top' }}>\n\t\t\t\t\t\t\t<Tooltip.Trigger>\n\t\t\t\t\t\t\t\t<button type=\"button\" onclick={() => handleDeleteFile(file)} class=\"btn-icon rounded-full\" aria-label=\"Remove file\">\n\t\t\t\t\t\t\t\t\t<iconify-icon icon=\"material-symbols:delete\" width=\"24\" class=\"text-error-500\"></iconify-icon>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip.Trigger>\n\t\t\t\t\t\t\t<Portal>\n\t\t\t\t\t\t\t\t<Tooltip.Positioner>\n\t\t\t\t\t\t\t\t\t<Tooltip.Content class=\"rounded bg-surface-900 px-2 py-1 text-xs text-white shadow-xl dark:bg-surface-100 dark:text-black\">\n\t\t\t\t\t\t\t\t\t\tRemove file\n\t\t\t\t\t\t\t\t\t\t<Tooltip.Arrow class=\"fill-surface-900 dark:fill-surface-100\" />\n\t\t\t\t\t\t\t\t\t</Tooltip.Content>\n\t\t\t\t\t\t\t\t</Tooltip.Positioner>\n\t\t\t\t\t\t\t</Portal>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Preview -->\n\t\t\t\t\t<div class=\"flex aspect-square items-center justify-center\">\n\t\t\t\t\t\t{#if file.type?.startsWith('image/') && previewUrl}\n\t\t\t\t\t\t\t<img src={previewUrl} alt={file.name} class=\"h-full w-full object-contain\" />\n\t\t\t\t\t\t{:else if file.type?.startsWith('audio/') && previewUrl}\n\t\t\t\t\t\t\t<audio controls class=\"max-w-full\">\n\t\t\t\t\t\t\t\t<source src={previewUrl} type={file.type} />\n\t\t\t\t\t\t\t</audio>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<iconify-icon icon={iconName} width=\"48\" class=\"opacity-50\"></iconify-icon>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Media Filename -->\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"label overflow-hidden text-ellipsis whitespace-nowrap p-1 text-center font-bold text-xs text-tertiary-500 dark:text-primary-500\"\n\t\t\t\t\t\ttitle={file.name}\n\t\t\t\t\t>\n\t\t\t\t\t\t{file.name}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<!-- Media Type & Size (Footer) -->\n\t\t\t\t\t<div class=\"flex grow items-center justify-between p-1 text-white\">\n\t\t\t\t\t\t<!-- Type -->\n\t\t\t\t\t\t<div class=\"bg-tertiary-500 dark:bg-primary-500/50 badge flex items-center gap-1 overflow-hidden\" title={file.type}>\n\t\t\t\t\t\t\t<iconify-icon icon={iconName} width=\"12\" height=\"12\"></iconify-icon>\n\t\t\t\t\t\t\t<span class=\"truncate text-[10px] uppercase\">{formatMimeType(file.type)}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- Size -->\n\t\t\t\t\t\t<p class=\"bg-tertiary-500 dark:bg-primary-500/50 badge flex shrink-0 items-center gap-1 text-[10px]\">\n\t\t\t\t\t\t\t<span class=\"\">{(file.size / 1024).toFixed(2)}</span>\n\t\t\t\t\t\t\tKB\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\n\t\t\t<!-- Add File Card -->\n\t\t\t<button type=\"button\" class=\"btn preset-tonal flex-col items-center gap-2\" onclick={() => input?.click()}>\n\t\t\t\t<iconify-icon icon=\"mingcute:add-fill\" width=\"32\" class=\"text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t<span class=\"font-bold\">Add Files</span>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<!-- Hidden Input for Add Card -->\n\t\t<input bind:this={input} type=\"file\" class=\"hidden\" multiple onchange={onChange} />\n\n\t\t<!-- Actions Footer -->\n\t\t<div class=\"flex items-center justify-between border-t border-surface-200 pt-4 dark:border-surface-700\">\n\t\t\t<button type=\"button\" class=\"btn preset-outlined-surface-500\" onclick={handleCancel}>Cancel</button>\n\t\t\t<button type=\"button\" class=\"btn dark:preset-filled-primary-500 preset-filled-tertiary-500\" onclick={uploadLocalFiles} disabled={isUploading}>\n\t\t\t\t{#if isUploading}\n\t\t\t\t\t<iconify-icon icon=\"eos-icons:loading\" class=\"animate-spin\"></iconify-icon>\n\t\t\t\t\t<span>Uploading... {uploadProgress}%</span>\n\t\t\t\t{:else}\n\t\t\t\t\t<iconify-icon icon=\"mingcute:check-fill\"></iconify-icon>\n\t\t\t\t\t<span>Upload {files.length} File{files.length !== 1 ? 's' : ''}</span>\n\t\t\t\t{/if}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n{/if}\n\n<!-- Upload Progress Overlay (Optional, or keep inline in button) -->\n{#if isUploading}\n\t<div class=\"mt-4 w-full rounded border border-surface-400 bg-surface-100 p-4 dark:bg-surface-700\">\n\t\t<!-- Progress Bar -->\n\t\t<div class=\"mb-2 h-2 w-full overflow-hidden rounded-full bg-surface-300 dark:bg-surface-600\">\n\t\t\t<div class=\"h-full bg-primary-500 transition-all duration-300\" style=\"width: {uploadProgress}%\"></div>\n\t\t</div>\n\t\t<div class=\"flex items-center justify-between text-xs text-surface-600 dark:text-surface-50\">\n\t\t\t<span>Speed: {formatBytes(uploadSpeed)}/s</span>\n\t\t</div>\n\t</div>\n{/if}\n","<!-- \n@files src/routes/(app)/mediagallery/uploadMedia/RemoteUpload.svelte\n@component\n**This page is used to Remote Urls to the media gallery**\n\n@example\n<RemoteUpload remoteUrls={remoteUrls} toastStore={toastStore} />\n\n### Props\n- `remoteUrls` {string[]} - Array of remote URLs\n- `toastStore` {any} - Toast store\n\n### Features\n- Displays a collection of media files based on the specified media type.\n- Provides a user-friendly interface for searching, filtering, and navigating through media files.\n- Emits the `mediaDeleted` event when a media file is deleted.\n-->\n\n<script lang=\"ts\">\n\timport { showToast } from '@shared/utils/toast';\n\timport { logger } from '@shared/utils/logger';\n\n\tlet remoteUrls: string[] = $state([]);\n\n\tfunction handleRemoteUrlInput(event: Event) {\n\t\tconst target = event.target as HTMLTextAreaElement | null;\n\t\tif (target) {\n\t\t\tremoteUrls = target.value.split('\\n').filter((url) => url.trim() !== '');\n\t\t}\n\t}\n\n\tasync function uploadRemoteUrls() {\n\t\tif (remoteUrls.length === 0) {\n\t\t\tshowToast('No URLs entered for upload', 'warning');\n\t\t\treturn;\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\tformData.append('remoteUrls', JSON.stringify(remoteUrls));\n\n\t\ttry {\n\t\t\tconst response = await fetch('?/remoteUpload', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: formData\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow Error('Upload failed');\n\t\t\t}\n\n\t\t\tconst result = await response.json();\n\n\t\t\tif (result.success) {\n\t\t\t\tshowToast('URLs uploaded successfully', 'success');\n\t\t\t\tremoteUrls = []; // Clear the remote URLs array after successful upload\n\t\t\t} else {\n\t\t\t\tthrow Error(result.error || 'Upload failed');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tlogger.error('Error uploading URLs:', error);\n\t\t\tshowToast('Error uploading URLs: ' + (error instanceof Error ? error.message : 'Unknown error'), 'error');\n\t\t}\n\t}\n</script>\n\n<div class=\"space-y-4\">\n\t<textarea\n\t\tbind:value={remoteUrls}\n\t\tplaceholder=\"Paste Remote URLs here, one per line...\"\n\t\trows=\"6\"\n\t\tclass=\"textarea w-full bg-secondary-50 dark:bg-secondary-800\"\n\t\toninput={handleRemoteUrlInput}\n\t></textarea>\n\t<!-- Upload Button -->\n\t<button class=\"preset-filled-tertiary-500 btn mt-2 dark:preset-filled-primary-500\" onclick={uploadRemoteUrls}> Upload URLs </button>\n</div>\n","<!-- \n@files src/routes/(app)/mediagallery/uploadMedia/+page.svelte\n@component\n**This page is used to upload media to the media gallery**\n\n@example\n<ModalUploadMedia parent={parent} sectionName={sectionName} files={files} onDelete={onDelete} uploadFiles={uploadFiles} />\n\n### Props\n- `parent` {any} - Parent component\n- `sectionName` {string} - Name of the section\n- `files` {File[]} - Array of files to be uploaded **Optional**\n- `onDelete` {Function} - Function to delete a file\n- `uploadFiles` {Function} - Function to upload files\n\n### Features\n- Displays a collection of media files based on the specified media type.\n- Provides a user-friendly interface for searching, filtering, and navigating through media files.\n- Emits the `mediaDeleted` event when a media file is deleted.\n-->\n\n<script lang=\"ts\">\n\t// ParaglideJS\n\timport * as m from '@shared/paraglide/messages';\n\n\t// Components\n\timport PageTitle from '@cms/components/PageTitle.svelte';\n\timport LocalUpload from './LocalUpload.svelte';\n\timport RemoteUpload from './RemoteUpload.svelte';\n\n\t// Skeleton\n\timport { Tabs } from '@skeletonlabs/skeleton-svelte';\n\n\tlet tabSet = $state('0');\n</script>\n\n<!-- PageTitle -->\n<div class=\"mb-4 flex items-center justify-between\">\n\t<PageTitle name={m.uploadMedia_title()} icon=\"bi:images\" iconColor=\"text-tertiary-500 dark:text-primary-500\" />\n\n\t<!-- Back -->\n\t<button\n\t\tonclick={() => history.back()}\n\t\taria-label=\"Back\"\n\t\tclass=\"preset-outlined-tertiary-500 btn-icon rounded-full dark:preset-outlined-primary-500\"\n\t>\n\t\t<iconify-icon icon=\"ri:arrow-left-line\" width=\"20\"></iconify-icon>\n\t</button>\n</div>\n\n<div class=\"wrapper\">\n\t<Tabs value={tabSet} onValueChange={(e) => (tabSet = e.value)}>\n\t\t<Tabs.List class=\"flex border-b border-surface-200-800 font-bold\">\n\t\t\t<Tabs.Trigger value=\"0\" class=\"flex-1\">\n\t\t\t\t<div class=\"flex items-center justify-center gap-2 py-4\">\n\t\t\t\t\t<iconify-icon icon=\"material-symbols:database\" width=\"28\"></iconify-icon>\n\t\t\t\t\t<p class=\"text-tertiary-500 dark:text-primary-500\">Local Upload</p>\n\t\t\t\t</div>\n\t\t\t</Tabs.Trigger>\n\t\t\t<Tabs.Trigger value=\"1\" class=\"flex-1\">\n\t\t\t\t<div class=\"flex items-center justify-center gap-2 py-4\">\n\t\t\t\t\t<iconify-icon icon=\"arcticons:tautulli-remote\" width=\"28\"></iconify-icon>\n\t\t\t\t\t<p class=\"text-tertiary-500 dark:text-primary-500\">Remote Upload</p>\n\t\t\t\t</div>\n\t\t\t</Tabs.Trigger>\n\t\t\t<Tabs.Indicator />\n\t\t</Tabs.List>\n\n\t\t<Tabs.Content value=\"0\">\n\t\t\t<div class=\"p-4\">\n\t\t\t\t<LocalUpload />\n\t\t\t</div>\n\t\t</Tabs.Content>\n\t\t<Tabs.Content value=\"1\">\n\t\t\t<div class=\"p-4\">\n\t\t\t\t<RemoteUpload />\n\t\t\t</div>\n\t\t</Tabs.Content>\n\t</Tabs>\n</div>\n"],"names":["$.attr","$.escape","m.uploadMedia_title"],"mappings":";;;;;;;;;;;;;;;wCAiBA;QAQK,QAAa,CAAA;AAKb,QAAA,cAAqB;AAKrB,QAAA,iCAA6C,IAAG;aA6E3C,YAAY,MAAoB;AAClC,YAAA,UAAU,KAAK,KAAK,UAAU,KAAK,KAAK,YAAY,GAAG,GAAG,YAAW;cACnE,MAAI;AAAA,QACN,KAAA,KAAK,MAAM,WAAW,QAAQ;iBAC3B;AAAA,QACH,KAAA,KAAK,MAAM,WAAW,QAAQ;iBAC3B;AAAA,QACH,KAAA,KAAK,MAAM,WAAW,QAAQ;iBAC3B;AAAA,QACH,KAAA,YAAY;iBACT;AAAA,cACH,YAAY,UAAU,YAAY,WAAW,YAAY;iBACtD;AAAA,QACH,MAAA,YAAY,UAAU,YAAY;iBAC/B;AAAA,QACH,MAAA,YAAY,UAAU,YAAY;iBAC/B;AAAA,QACH,KAAA,YAAY;iBACT;AAAA,QACH,MAAA,YAAY,UAAU,YAAY;iBAC/B;AAAA;iBAEA;AAAA;IAEV;aAGS,eAAe,MAAuB;AACzC,UAAA,CAAA,aAAa;AACZ,YAAA,QAAQ,KAAK,MAAM,GAAG;AACrB,aAAA,MAAM,CAAC,IAAI,MAAM,CAAC,EAAE,YAAW,IAAK,MAAM,CAAC,EAAE,YAAW;AAAA,IAChE;QAqKI,MAAM,WAAW,GAAC;;2vBA0BR,aAAW,IAAA,CAAA,4NAAA;AAAA;;;;2CAwBhB,KAAK;;YAAI,OAAI,WAAA,OAAA;AACX,cAAA,aAAa,KAAK,IAAI,IAAI,KAAK,IAAI;AACnC,cAAA,aAAa,WAAW,IAAI,OAAO;cACnC,WAAW,YAAY,IAAI;;;UAOT,aAAA,EAAA,WAAW,MAAK;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmBnC,YAAA,KAAK,MAAM,WAAW,QAAQ,KAAK,YAAU;;8CACvC,UAAU,CAAA,GAAAA,KAAA,OAAO,KAAK,IAAI,CAAA,yCAAA;AAAA;;AAC3B,cAAA,KAAK,MAAM,WAAW,QAAQ,KAAK,YAAU;;sFAExC,UAAU,CAAA,GAAAA,KAAA,QAAQ,KAAK,IAAI,CAAA,YAAA;AAAA;;0DAGrB,QAAQ,CAAA,gDAAA;AAAA;;;qMAOtB,KAAK,IAAI,CAAA,IAAAC,YAEf,KAAK,IAAI,CAAA,8KAAAD,KAAA,SAM+F,KAAK,IAAI,CAAA,iBAAAA,KAAA,QAC7F,QAAQ,CAAA,wFAAAC,YACkB,eAAe,KAAK,IAAI,CAAA,CAAA,4HAAAA,aAIrD,KAAK,OAAO,MAAM,QAAQ,CAAC,CAAA,CAAA,4BAAA;AAAA;umBAoBiF,aAAW,IAAA,CAAA,GAAA;;;8GAM5H,MAAM,MAAM,CAAA,QAAAA,YAAO,MAAM,WAAW,IAAI,MAAM,EAAE,CAAA,SAAA;AAAA;;;;;;;;EAvI3D,CAAA;;;wCChSR;QAIK,aAAoB,CAAA;;+BA6CX,UAAU;;;;;EAJhB,CAAA;;;wCC1CR;AAYK,QAAA,SAAgB;;;MAKH,MAAAC,mBAAmB;AAAA;;;;;aAavB;AAAA,MAAwB,eAAA,CAAA,MAAO,SAAS,EAAE;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAjBhD,CAAA;;"}