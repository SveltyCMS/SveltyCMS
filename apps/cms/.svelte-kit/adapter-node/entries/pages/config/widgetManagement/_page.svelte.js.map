{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/routes/config/components/WidgetDashboard.svelte","../../../../../../../src/routes/config/widgetManagement/+page.svelte"],"sourcesContent":["<!--\n@component WidgetDashboard\n**Widget Management Dashboard with 3-Pillar Architecture Support**\n\nFeatures:\n- Full 3-pillar architecture visibility\n- Enhanced widget metadata display\n- Better filtering and search\n- Improved UX with widget cards\n- Multi-tenant support\n- Integrated marketplace tab\n-->\n<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport { logger } from '@shared/utils/logger';\n\timport WidgetCard from './WidgetCard.svelte';\n\timport { widgetStoreActions } from '@shared/stores/widgetStore.svelte';\n\n\t// Props\n\tconst { data }: { data: any } = $props();\n\n\t// Define the Widget type\n\tinterface Widget {\n\t\tname: string;\n\t\tisCore: boolean;\n\t\tisActive: boolean;\n\t\tdescription?: string;\n\t\ticon: string;\n\t\tdependencies: string[];\n\t\tcanDisable: boolean;\n\t\tpillar?: {\n\t\t\tinput?: { exists: boolean };\n\t\t\tdisplay?: { exists: boolean };\n\t\t};\n\t}\n\n\t// State\n\tlet widgets: Widget[] = $state([]);\n\tlet isLoading = $state(true);\n\tlet searchQuery = $state('');\n\tlet activeFilter = $state('all');\n\tlet activeTab = $state('installed');\n\tlet error: string | null = $state(null);\n\n\t// Get tenant info from page data or user session\n\tconst tenantId = $derived(data?.user?.tenantId || data?.tenantId || 'default-tenant');\n\n\t// User permissions\n\tconst userRole = $derived(data?.user?.role || 'user');\n\tconst userPermissions = $derived(data?.user?.permissions || []);\n\tconst canManageWidgets = $derived(\n\t\tuserRole === 'admin' || userRole === 'super-admin' || userPermissions.includes('manage_widgets') || userPermissions.includes('widget_management')\n\t);\n\n\t// Computed stats\n\tconst stats = $derived({\n\t\ttotal: widgets.length,\n\t\tcore: widgets.filter((w) => w.isCore).length,\n\t\tcustom: widgets.filter((w) => !w.isCore).length,\n\t\tactive: widgets.filter((w) => w.isActive).length,\n\t\tinactive: widgets.filter((w) => !w.isActive).length,\n\t\twithInput: widgets.filter((w) => w.pillar?.input?.exists).length,\n\t\twithDisplay: widgets.filter((w) => w.pillar?.display?.exists).length\n\t});\n\n\t// Filtered widgets\n\tconst filteredWidgets = $derived(\n\t\twidgets.filter((widget) => {\n\t\t\t// Search filter\n\t\t\tconst matchesSearch =\n\t\t\t\tsearchQuery === '' ||\n\t\t\t\twidget.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n\t\t\t\twidget.description?.toLowerCase().includes(searchQuery.toLowerCase());\n\n\t\t\t// Category filter\n\t\t\tlet matchesFilter = false;\n\t\t\tswitch (activeFilter) {\n\t\t\t\tcase 'all':\n\t\t\t\t\tmatchesFilter = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'core':\n\t\t\t\t\tmatchesFilter = widget.isCore;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'custom':\n\t\t\t\t\tmatchesFilter = !widget.isCore;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'active':\n\t\t\t\t\tmatchesFilter = widget.isActive;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'inactive':\n\t\t\t\t\tmatchesFilter = !widget.isActive;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn matchesSearch && matchesFilter;\n\t\t})\n\t);\n\n\tonMount(() => {\n\t\tloadWidgets();\n\n\t\t// Keyboard shortcuts\n\t\tconst handleKeyboard = (e: KeyboardEvent) => {\n\t\t\t// Ctrl/Cmd + F: Focus search\n\t\t\tif ((e.ctrlKey || e.metaKey) && e.key === 'f') {\n\t\t\t\te.preventDefault();\n\t\t\t\t(document.querySelector('input[type=\"text\"]') as HTMLElement)?.focus();\n\t\t\t}\n\t\t\t// Escape: Clear search\n\t\t\tif (e.key === 'Escape' && searchQuery) {\n\t\t\t\tsearchQuery = '';\n\t\t\t}\n\t\t};\n\n\t\twindow.addEventListener('keydown', handleKeyboard);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('keydown', handleKeyboard);\n\t\t};\n\t});\n\n\tasync function loadWidgets() {\n\t\tisLoading = true;\n\t\terror = null;\n\n\t\ttry {\n\t\t\tconst response = await fetch(`/api/widgets/list?tenantId=${tenantId}`);\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(`Failed to load widgets: ${response.statusText}`);\n\t\t\t}\n\n\t\t\tconst result = await response.json();\n\t\t\twidgets = result.widgets || [];\n\n\t\t\tconsole.info('Loaded widgets:', {\n\t\t\t\ttotal: widgets.length,\n\t\t\t\tcore: widgets.filter((w) => w.isCore).length,\n\t\t\t\tcustom: widgets.filter((w) => !w.isCore).length\n\t\t\t});\n\t\t} catch (err) {\n\t\t\terror = err instanceof Error ? err.message : 'Failed to load widgets';\n\t\t\tlogger.error('Error loading widgets:', err);\n\t\t} finally {\n\t\t\tisLoading = false;\n\t\t}\n\t}\n\n\tasync function toggleWidget(widgetName: string) {\n\t\tif (!canManageWidgets) {\n\t\t\talert('You do not have permission to manage widgets. Contact your administrator.');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst widget = widgets.find((w) => w.name === widgetName);\n\t\t\tif (!widget) return;\n\n\t\t\tconst newStatus = !widget.isActive;\n\n\t\t\tconst response = await fetch('/api/widgets/status', {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'X-Tenant-ID': tenantId\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\twidgetName,\n\t\t\t\t\tisActive: newStatus\n\t\t\t\t})\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(`Failed to update widget status: ${response.statusText}`);\n\t\t\t}\n\n\t\t\t// Force refresh: Clear cache and reload widget store + widget list\n\t\t\t// This ensures the UI is perfectly in sync with database\n\t\t\tawait widgetStoreActions.initializeWidgets(tenantId);\n\t\t\tawait loadWidgets();\n\n\t\t\tconsole.info(`Widget ${widgetName} ${newStatus ? 'activated' : 'deactivated'} - Store and UI refreshed`);\n\t\t} catch (err) {\n\t\t\tconst message = err instanceof Error ? err.message : 'Failed to update widget status';\n\t\t\tlogger.error('Error toggling widget:', err);\n\t\t\talert(`Error: ${message}`);\n\t\t}\n\t}\n\n\tasync function uninstallWidget(widgetName: string) {\n\t\tif (!canManageWidgets) {\n\t\t\talert('You do not have permission to uninstall widgets. Contact your administrator.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!confirm(`Are you sure you want to uninstall the widget \"${widgetName}\"?`)) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await fetch(`/api/widgets/uninstall`, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t'X-Tenant-ID': tenantId\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ widgetName })\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(`Failed to uninstall widget: ${response.statusText}`);\n\t\t\t}\n\n\t\t\t// Reload widgets after uninstallation\n\t\t\tawait loadWidgets();\n\t\t\tconsole.info(`Widget ${widgetName} uninstalled`);\n\t\t} catch (err) {\n\t\t\tconst message = err instanceof Error ? err.message : 'Failed to uninstall widget';\n\t\t\tlogger.error('Error uninstalling widget:', err);\n\t\t\talert(`Error: ${message}`);\n\t\t}\n\t}\n</script>\n\n<div class=\"wrapper h-full max-h-screen space-y-6 overflow-y-auto p-4 pb-16\">\n\t{#if isLoading}\n\t\t<div class=\"flex items-center justify-center p-8\">\n\t\t\t<div class=\"h-8 w-8 animate-spin rounded-full border-2 border-blue-600 border-t-transparent\"></div>\n\t\t\t<span class=\"ml-3 text-lg\">Loading widgets...</span>\n\t\t</div>\n\t{:else if error}\n\t\t<div class=\"rounded-lg border border-red-200 bg-red-50 p-4 dark:bg-red-900/20\">\n\t\t\t<div class=\"flex items-start gap-3\">\n\t\t\t\t<iconify-icon icon=\"mdi:alert-circle\" class=\"mt-1 text-xl text-red-600\"></iconify-icon>\n\t\t\t\t<div>\n\t\t\t\t\t<h3 class=\"font-semibold text-red-800 dark:text-red-300\">Error Loading Widgets</h3>\n\t\t\t\t\t<p class=\"text-red-700 dark:text-red-400\">{error}</p>\n\t\t\t\t\t<button onclick={() => loadWidgets()} class=\"mt-2 rounded-lg bg-red-600 px-3 py-1 text-sm text-white hover:bg-red-700\"> Retry </button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t{:else}\n\t\t<!-- Permission Notice -->\n\t\t{#if !canManageWidgets}\n\t\t\t<div class=\"rounded-lg border border-amber-200 bg-amber-50 p-4 dark:bg-amber-900/20\">\n\t\t\t\t<div class=\"flex items-start gap-3\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:shield-alert\" class=\"mt-1 text-xl text-amber-600\"></iconify-icon>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h3 class=\"font-semibold text-amber-800 dark:text-amber-300\">Limited Access</h3>\n\t\t\t\t\t\t<p class=\"text-amber-700 dark:text-amber-400\">\n\t\t\t\t\t\t\tYou have read-only access to widget management. Contact your administrator to request widget management permissions.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<!-- Tab Navigation -->\n\t\t<div class=\"flex gap-2 border-b border-gray-200 dark:border-gray-700\">\n\t\t\t<button\n\t\t\t\tonclick={() => (activeTab = 'installed')}\n\t\t\t\tclass=\"border-b-2 px-6 py-3 font-medium transition-colors {activeTab === 'installed'\n\t\t\t\t\t? 'border-blue-600 text-blue-600 dark:border-blue-400 dark:text-blue-400'\n\t\t\t\t\t: 'border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200'}\"\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:puzzle\" class=\"text-xl\"></iconify-icon>\n\t\t\t\t\t<span>Installed Widgets</span>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tonclick={() => (activeTab = 'marketplace')}\n\t\t\t\tclass=\"border-b-2 px-6 py-3 font-medium transition-colors {activeTab === 'marketplace'\n\t\t\t\t\t? 'border-blue-600 text-blue-600 dark:border-blue-400 dark:text-blue-400'\n\t\t\t\t\t: 'border-transparent text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200'}\"\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:store\" class=\"text-xl\"></iconify-icon>\n\t\t\t\t\t<span>Marketplace</span>\n\t\t\t\t\t<span class=\"rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700 dark:bg-blue-900/30 dark:text-blue-300\">\n\t\t\t\t\t\tComing Soon\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t</div>\n\n\t\t{#if activeTab === 'installed'}\n\t\t\t<!-- Summary Cards with Colored Backgrounds and Tooltips -->\n\t\t\t<div class=\"grid grid-cols-2 gap-4 md:grid-cols-4\" data-testid=\"widget-stats\">\n\t\t\t\t<!-- Total Widgets -->\n\t\t\t\t<div class=\"relative rounded-lg bg-blue-50 p-4 shadow-sm transition-all hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon btn-icon-sm absolute right-2 top-2 text-blue-600 dark:text-blue-400\"\n\t\t\t\t\t\taria-label=\"Information about total widgets\"\n\t\t\t\t\t\ttitle=\"All registered widgets in the system (core + custom)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:information-outline\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"flex items-center gap-3\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:widgets\" class=\"text-2xl text-blue-600 dark:text-blue-400\"></iconify-icon>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 class=\"font-semibold text-blue-800 dark:text-blue-300\">Total</h3>\n\t\t\t\t\t\t\t<p class=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{stats.total}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Active Widgets -->\n\t\t\t\t<div class=\"relative rounded-lg bg-green-50 p-4 shadow-sm transition-all hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/30\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon btn-icon-sm absolute right-2 top-2 text-primary-500\"\n\t\t\t\t\t\taria-label=\"Information about active widgets\"\n\t\t\t\t\t\ttitle=\"Widgets currently enabled and available for use in collections\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:information-outline\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"flex items-center gap-3\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:check-circle\" class=\"text-2xl text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 class=\"font-semibold text-primary-500\">Active</h3>\n\t\t\t\t\t\t\t<p class=\"text-2xl font-bold text-primary-500\">{stats.active}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Core Widgets -->\n\t\t\t\t<div class=\"relative rounded-lg bg-blue-50 p-4 shadow-sm transition-all hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon btn-icon-sm absolute right-2 top-2 text-blue-600 dark:text-blue-400\"\n\t\t\t\t\t\taria-label=\"Information about core widgets\"\n\t\t\t\t\t\ttitle=\"Essential system widgets that are always active and cannot be disabled\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:information-outline\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"flex items-center gap-3\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:puzzle\" class=\"text-2xl text-blue-600 dark:text-blue-400\"></iconify-icon>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 class=\"font-semibold text-blue-800 dark:text-blue-300\">Core</h3>\n\t\t\t\t\t\t\t<p class=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{stats.core}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Custom Widgets -->\n\t\t\t\t<div\n\t\t\t\t\tclass=\"relative rounded-lg bg-yellow-50 p-4 shadow-sm transition-all hover:bg-yellow-100 dark:bg-yellow-900/20 dark:hover:bg-yellow-900/30\"\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"btn-icon btn-icon-sm absolute right-2 top-2 text-yellow-600 dark:text-yellow-400\"\n\t\t\t\t\t\taria-label=\"Information about custom widgets\"\n\t\t\t\t\t\ttitle=\"Optional widgets that can be toggled on/off as needed\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:information-outline\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class=\"flex items-center gap-3\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:puzzle-plus\" class=\"text-2xl text-yellow-600 dark:text-yellow-400\"></iconify-icon>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 class=\"font-semibold text-yellow-800 dark:text-yellow-300\">Custom</h3>\n\t\t\t\t\t\t\t<p class=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">{stats.custom}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<!-- Filters and Search -->\n\t\t\t<div class=\"card preset-filled-surface-500 mt-6 space-y-4 p-4\">\n\t\t\t\t<!-- Search and Sync Button Row -->\n\t\t\t\t<div class=\"flex flex-col gap-3 sm:flex-row sm:items-center\">\n\t\t\t\t\t<!-- Search -->\n\t\t\t\t\t<div class=\"relative flex-1\">\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:magnify\" class=\"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-gray-400\"></iconify-icon>\n\t\t\t\t\t\t<input type=\"text\" bind:value={searchQuery} placeholder=\"Search widgets... (Ctrl+F)\" class=\"input py-2 pl-10 pr-10 dark:text-white\" />\n\t\t\t\t\t\t{#if searchQuery}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonclick={() => (searchQuery = '')}\n\t\t\t\t\t\t\t\tclass=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200\"\n\t\t\t\t\t\t\t\taria-label=\"Clear search\"\n\t\t\t\t\t\t\t\ttitle=\"Clear search (Esc)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:close-circle\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Badges Counts -->\n\t\t\t\t<div class=\"flex flex-wrap gap-2\">\n\t\t\t\t\t{#each [{ value: 'all' as const, label: 'All', count: stats.total, icon: 'mdi:widgets' }, { value: 'active' as const, label: 'Active', count: stats.active, icon: 'mdi:check-circle' }, { value: 'inactive' as const, label: 'Inactive', count: stats.inactive, icon: 'mdi:pause-circle' }, { value: 'core' as const, label: 'Core', count: stats.core, icon: 'mdi:puzzle' }, { value: 'custom' as const, label: 'Custom', count: stats.custom, icon: 'mdi:puzzle-plus' }] as filter}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonclick={() => (activeFilter = filter.value)}\n\t\t\t\t\t\t\tclass=\"btn {activeFilter === filter.value ? 'preset-filled-tertiary-500 text-white' : 'preset-ghost-secondary-500 '}\"\n\t\t\t\t\t\t\taria-label=\"{filter.label} widgets ({filter.count})\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<iconify-icon icon={filter.icon} class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t\t\t<span>{filter.label}</span>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"rounded-full px-2 py-0.5 text-xs font-semibold {activeFilter === filter.value\n\t\t\t\t\t\t\t\t\t? 'bg-blue-500 text-white'\n\t\t\t\t\t\t\t\t\t: 'bg-gray-300 text-gray-700 dark:bg-gray-600 dark:text-gray-300'}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{filter.count}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<!-- Widgets Grid - 2 Column Layout for Desktop -->\n\t\t\t<div class=\"mb-12 grid grid-cols-1 gap-4 lg:grid-cols-2\" data-testid=\"widget-grid\">\n\t\t\t\t{#if filteredWidgets.length === 0}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"col-span-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-12 text-center dark:border-gray-600 dark:bg-gray-800\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<iconify-icon icon=\"mdi:package-preset-closed\" class=\"mx-auto text-6xl text-gray-400\"></iconify-icon>\n\t\t\t\t\t\t<h3 class=\"mt-4 text-lg font-semibold text-gray-900 dark:text-white\">No Widgets Found</h3>\n\t\t\t\t\t\t<p class=\"mt-2 text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t{#if searchQuery}\n\t\t\t\t\t\t\t\tNo widgets match your search \"<strong>{searchQuery}</strong>\"\n\t\t\t\t\t\t\t{:else if activeFilter !== 'all'}\n\t\t\t\t\t\t\t\tNo {activeFilter} widgets available\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\tNo widgets match your criteria\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{#if searchQuery || activeFilter !== 'all'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\tsearchQuery = '';\n\t\t\t\t\t\t\t\t\tactiveFilter = 'all';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tclass=\"mt-6 inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n\t\t\t\t\t\t\t\taria-label=\"Clear all filters and search\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:filter-remove\" class=\"text-lg\"></iconify-icon>\n\t\t\t\t\t\t\t\tClear All Filters\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t{#each filteredWidgets as widget (widget.name)}\n\t\t\t\t\t\t<WidgetCard {widget} onToggle={toggleWidget} onUninstall={uninstallWidget} canManage={canManageWidgets} />\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<!-- Marketplace Tab -->\n\t\t\t<div class=\"rounded-lg border border-gray-200 bg-gray-50 p-12 text-center dark:border-gray-700 dark:bg-gray-800\">\n\t\t\t\t<div class=\"mx-auto max-w-md\">\n\t\t\t\t\t<iconify-icon icon=\"mdi:store\" class=\"mx-auto text-6xl text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t<h3 class=\"mt-4 text-xl font-semibold text-gray-900 dark:text-white\">Marketplace Coming Soon</h3>\n\t\t\t\t\t<p class=\"mt-2 text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\tThe Widget Marketplace will allow you to discover, install, and manage premium and community widgets to extend your SveltyCMS\n\t\t\t\t\t\tfunctionality.\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class=\"mt-6 space-y-2 text-left\">\n\t\t\t\t\t\t<div class=\"flex items-start gap-3 text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:check-circle\" class=\"mt-0.5 text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t<span>Browse hundreds of widgets across multiple categories</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex items-start gap-3 text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:check-circle\" class=\"mt-0.5 text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t<span>One-click installation and automatic updates</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex items-start gap-3 text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:check-circle\" class=\"mt-0.5 text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t<span>Community ratings and reviews</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex items-start gap-3 text-sm text-gray-600 dark:text-gray-400\">\n\t\t\t\t\t\t\t<iconify-icon icon=\"mdi:check-circle\" class=\"mt-0.5 text-tertiary-500 dark:text-primary-500\"></iconify-icon>\n\t\t\t\t\t\t\t<span>Support for both free and premium widgets</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t\tclass=\"mt-6 cursor-not-allowed rounded-lg bg-gray-300 px-6 py-3 font-medium text-gray-500 dark:bg-gray-700 dark:text-gray-500\"\n\t\t\t\t\t>\n\t\t\t\t\t\tComing in Future Update\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t{/if}\n</div>\n\n<!-- Tooltip Popups for Metric Cards - Uniform Dark/Light Theme -->\n<div class=\"card preset-filled z-50 max-w-xs p-3 shadow-xl\" data-popup=\"totalTooltip\">\n\t<p class=\"text-sm\">All registered widgets in the system (core + custom)</p>\n\t<div class=\"preset-filled arrow\"></div>\n</div>\n\n<div class=\"card preset-filled z-50 max-w-xs p-3 shadow-xl\" data-popup=\"activeTooltip\">\n\t<p class=\"text-sm\">Widgets currently enabled and available for use in collections</p>\n\t<div class=\"preset-filled arrow\"></div>\n</div>\n\n<div class=\"card preset-filled z-50 max-w-xs p-3 shadow-xl\" data-popup=\"coreTooltip\">\n\t<p class=\"text-sm\">Essential system widgets that are always active and cannot be disabled</p>\n\t<div class=\"preset-filled arrow\"></div>\n</div>\n\n<div class=\"card preset-filled z-50 max-w-xs p-3 shadow-xl\" data-popup=\"customTooltip\">\n\t<p class=\"text-sm\">Optional widgets that can be toggled on/off as needed</p>\n\t<div class=\"preset-filled arrow\"></div>\n</div>\n","<!--\n@file src/routes/(app)/config/widgetManagement/+page.svelte\n@component\n**Widget Management Configuration Page - Provides interface for managing content widgets and their activation status with 3-pillar architecture support.**\n\nFeatures:\n- List all available content widgets (core and custom)\n- Toggle widget status (active/inactive)\n- View widget dependencies and requirements\n- Display 3-pillar architecture components (Definition, Input, Display)\n- Bulk activate required widgets\n- Collection validation against active widgets\n- Multi-tenant widget configuration\n-->\n\n<script lang=\"ts\">\n\t// ParaglideJS\n\t// import * as m from '@shared/paraglide/messages';\n\n\t// Components\n\timport PageTitle from '@cms/components/PageTitle.svelte';\n\timport WidgetDashboard from '../components/WidgetDashboard.svelte';\n\n\tinterface Props {\n\t\tdata: any;\n\t}\n\n\tconst { data }: Props = $props();\n</script>\n\n<!-- Page Title with Back Button -->\n<PageTitle name=\"Widget Management\" icon=\"mdi:widgets\" showBackButton={true} backUrl=\"/config\" />\n\n<!-- Widget Management Dashboard with 3-Pillar Architecture Support -->\n<WidgetDashboard {data} />\n"],"names":[],"mappings":";;;;;wCAYA;YAOS,KAAI,IAAA;QAkBR,UAAiB,CAAA;AAGjB,QAAA,eAAsB;AAKA,UAAM,MAAM,YAAY,MAAM,YAAY;AAG9D,UAAA,WAAoB,MAAM,MAAM,QAAQ;AACxC,UAAA,kBAA2B,MAAM,MAAM,eAAW,CAAA;AAEvD,iBAAa,WAAW,aAAa,iBAAiB,gBAAgB,SAAS,gBAAgB,KAAK,gBAAgB,SAAS,mBAAmB;KAItI;AAAA,MAEV,MAAM,QAAQ,OAAM,CAAE,MAAM,EAAE,MAAM,EAAE;AAAA,MACtC,QAAQ,QAAQ,OAAM,CAAE,MAAC,CAAM,EAAE,MAAM,EAAE;AAAA,MACzC,QAAQ,QAAQ,OAAM,CAAE,MAAM,EAAE,QAAQ,EAAE;AAAA,MAC1C,UAAU,QAAQ,OAAM,CAAE,MAAC,CAAM,EAAE,QAAQ,EAAE;AAAA,MAC7C,WAAW,QAAQ,QAAQ,MAAM,EAAE,QAAQ,OAAO,MAAM,EAAE;AAAA,MAC1D,aAAa,QAAQ,QAAQ,MAAM,EAAE,QAAQ,SAAS,MAAM,EAAE;AAAA;AAK9D,YAAQ,OAAM,CAAE,WAAW;AAQtB,UAAA,gBAAgB;cACZ,cAAY;AAAA,aACd;AACJ,0BAAgB;;aAEZ;AACJ,0BAAgB,OAAO;;aAEnB;AACJ,0BAAa,CAAI,OAAO;;aAEpB;AACJ,0BAAgB,OAAO;;aAEnB;AACJ,0BAAa,CAAI,OAAO;;;AAInB,aAAiB;AAAA,IACzB,CAAC;;AAkIY;;;;;EAHP,CAAA;;oCC/MR;UAYS,KAAI,IAAA;;;;oBAI0D;AAAA;;;gCAGrD,MAAI;;AANd;"}