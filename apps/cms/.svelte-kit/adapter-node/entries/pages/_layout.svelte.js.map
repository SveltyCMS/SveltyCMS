{"version":3,"file":"_layout.svelte.js","sources":["../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/root-context.js","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/action-trigger.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/internal/components/x.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/close-trigger.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/description.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/group-context.js","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/group.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/message.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/root-context.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/root.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/anatomy/title.svelte","../../../../../../../node_modules/@skeletonlabs/skeleton-svelte/dist/components/toast/modules/anatomy.js","../../../../../../../shared/components/src/system/ToastManager.svelte","../../../../../../../shared/stores/src/statusStore.svelte.ts","../../../../../src/routes/+layout.svelte"],"sourcesContent":["import { createContext } from '../../../internal/create-context.js';\nexport const RootContext = createContext();\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastActionTriggerProps extends PropsWithElement<'button'>, HTMLAttributes<'button'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastActionTriggerProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getActionTriggerProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<button {...attributes}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../html-attributes.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\texport type XProps = HTMLAttributes<'svg', 'children'>;\n</script>\n\n<script lang=\"ts\">\n\tconst props: XProps = $props();\n\n\tconst { ...rest } = $derived(props);\n\n\tconst attributes = $derived(\n\t\tmergeProps(\n\t\t\t{\n\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\n\t\t\t\twidth: '24',\n\t\t\t\theight: '24',\n\t\t\t\tviewBox: '0 0 24 24',\n\t\t\t\tfill: 'none',\n\t\t\t\tstroke: 'currentColor',\n\t\t\t\t'stroke-width': '2',\n\t\t\t\t'stroke-linecap': 'round',\n\t\t\t\t'stroke-linejoin': 'round',\n\t\t\t},\n\t\t\trest,\n\t\t),\n\t);\n</script>\n\n<svg {...attributes}>\n\t<path d=\"M18 6 6 18\" />\n\t<path d=\"m6 6 12 12\" />\n</svg>\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastCloseTriggerProps extends PropsWithElement<'button'>, HTMLAttributes<'button'> {}\n</script>\n\n<script lang=\"ts\">\n\timport X from '../../../internal/components/x.svelte';\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastCloseTriggerProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children = x, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getCloseTriggerProps(), rest));\n</script>\n\n{#snippet x()}\n\t<X />\n{/snippet}\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<button {...attributes}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastDescriptionProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastDescriptionProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getDescriptionProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","import { createContext } from '../../../internal/create-context.js';\nexport const GroupContext = createContext();\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { Props, Store } from '@zag-js/toast';\n\timport type { Snippet } from 'svelte';\n\n\texport interface ToastGroupProps extends PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir' | 'children'> {\n\t\ttoaster: Store;\n\t\tchildren?: Snippet<[Props]>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { GroupContext } from '../modules/group-context.js';\n\timport { mergeProps, normalizeProps, useMachine } from '@zag-js/svelte';\n\timport { group } from '@zag-js/toast';\n\n\tconst props: ToastGroupProps = $props();\n\n\tconst { element, children, toaster, ...rest } = $derived(props);\n\n\tconst id = $props.id();\n\tconst service = useMachine(group.machine, () => ({\n\t\tid: id,\n\t\tstore: toaster,\n\t}));\n\tconst api = $derived(group.connect(service, normalizeProps));\n\n\tconst attributes = $derived(mergeProps(api.getGroupProps(), rest));\n\n\tGroupContext.provide(() => service);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{#each api.getToasts() as toast (toast.id)}\n\t\t\t{@render children?.(toast)}\n\t\t{/each}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastMessageProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastMessageProps = $props();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(\n\t\tmergeProps(\n\t\t\t{\n\t\t\t\t'data-scope': 'toast',\n\t\t\t\t'data-part': 'message',\n\t\t\t},\n\t\t\trest,\n\t\t),\n\t);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { PropTypes } from '@zag-js/svelte';\n\timport type { Api } from '@zag-js/toast';\n\timport type { Snippet } from 'svelte';\n\n\texport interface ToastRootContextProps {\n\t\tchildren: Snippet<[() => Api<PropTypes>]>;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\n\tconst props: ToastRootContextProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { children } = $derived(props);\n</script>\n\n{@render children(toast)}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\timport type { Options } from '@zag-js/toast';\n\n\texport interface ToastRootProps extends PropsWithElement<'div'>, HTMLAttributes<'div', 'id' | 'dir'> {\n\t\ttoast: Options;\n\t}\n</script>\n\n<script lang=\"ts\">\n\timport { GroupContext } from '../modules/group-context.js';\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps, normalizeProps, useMachine } from '@zag-js/svelte';\n\timport { connect, machine } from '@zag-js/toast';\n\n\tconst props: ToastRootProps = $props();\n\n\tconst group = GroupContext.consume();\n\n\tconst { element, children, toast: toastProps, ...rest } = $derived(props);\n\n\tconst service = useMachine(machine, () => ({\n\t\t...toastProps,\n\t\tparent: group(),\n\t}));\n\tconst toast = $derived(connect(service, normalizeProps));\n\n\tconst attributes = $derived(mergeProps(toast.getRootProps(), rest));\n\n\tRootContext.provide(() => toast);\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t<div {...toast.getGhostBeforeProps()}></div>\n\t\t{@render children?.()}\n\t\t<div {...toast.getGhostAfterProps()}></div>\n\t</div>\n{/if}\n","<script lang=\"ts\" module>\n\timport type { HTMLAttributes } from '../../../internal/html-attributes.js';\n\timport type { PropsWithElement } from '../../../internal/props-with-element.js';\n\n\texport interface ToastTitleProps extends PropsWithElement<'div'>, HTMLAttributes<'div'> {}\n</script>\n\n<script lang=\"ts\">\n\timport { RootContext } from '../modules/root-context.js';\n\timport { mergeProps } from '@zag-js/svelte';\n\n\tconst props: ToastTitleProps = $props();\n\n\tconst toast = RootContext.consume();\n\n\tconst { element, children, ...rest } = $derived(props);\n\n\tconst attributes = $derived(mergeProps(toast().getTitleProps(), rest));\n</script>\n\n{#if element}\n\t{@render element(attributes)}\n{:else}\n\t<div {...attributes}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","import ActionTrigger from '../anatomy/action-trigger.svelte';\nimport CloseTrigger from '../anatomy/close-trigger.svelte';\nimport Description from '../anatomy/description.svelte';\nimport Group from '../anatomy/group.svelte';\nimport Message from '../anatomy/message.svelte';\nimport RootContext from '../anatomy/root-context.svelte';\nimport Root from '../anatomy/root.svelte';\nimport Title from '../anatomy/title.svelte';\nexport const Toast = Object.assign(Root, {\n    Context: RootContext,\n    Group: Group,\n    Message: Message,\n    Title: Title,\n    Description: Description,\n    ActionTrigger: ActionTrigger,\n    CloseTrigger: CloseTrigger,\n});\n","<!--\n@file src/components/system/ToastManager.svelte\n@component\n**Enterprise-Ready Toast Notification Manager**\n\nA flexible, accessible toast notification system built on Skeleton v4.\nSupports multiple toast types with gradient styling, progress indicators,\noptional actions, and smooth animations.\n\n@example\n<ToastManager position=\"bottom-right\" />\n\n@features\n- Type-based gradient styling (success, warning, error, info)\n- Auto-dismiss with optional progress bar\n- Optional action buttons in toasts\n- Configurable positioning (top-right, bottom-right, etc.)\n- Accessible with proper ARIA attributes\n- Smooth enter/exit animations\n- Dark mode support\n-->\n\n<script lang=\"ts\">\n\timport { Toast } from '@skeletonlabs/skeleton-svelte';\n\timport { toaster } from '@shared/stores/store.svelte';\n\timport { fly, fade } from 'svelte/transition';\n\n\tinterface Props {\n\t\t/** Position of the toast container */\n\t\tposition?: 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left' | 'top-center' | 'bottom-center';\n\t\t/** Show progress bar for auto-dismiss */\n\t\tshowProgress?: boolean;\n\t}\n\n\tconst { position = 'top-right', showProgress = true }: Props = $props();\n\n\t// Position classes mapping - fixed inset ensures proper viewport positioning\n\tconst positionClasses: Record<string, string> = {\n\t\t'top-right': 'top-4 right-4 inset-auto items-end',\n\t\t'top-left': 'top-4 left-4 inset-auto items-start',\n\t\t'bottom-right': 'bottom-4 right-4 inset-auto items-end justify-end',\n\t\t'bottom-left': 'bottom-4 left-4 inset-auto items-start justify-end',\n\t\t'top-center': 'top-4 left-1/2 -translate-x-1/2 inset-auto items-center',\n\t\t'bottom-center': 'bottom-4 left-1/2 -translate-x-1/2 inset-auto items-center justify-end'\n\t};\n\n\t// Toast type configuration\n\tconst toastConfig = {\n\t\tsuccess: {\n\t\t\tgradient: 'gradient-primary',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:check-circle',\n\t\t\tdefaultTitle: 'Success'\n\t\t},\n\t\twarning: {\n\t\t\tgradient: 'gradient-warning',\n\t\t\ttextColor: 'text-black',\n\t\t\ticon: 'mdi:alert',\n\t\t\tdefaultTitle: 'Warning'\n\t\t},\n\t\terror: {\n\t\t\tgradient: 'gradient-error',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:alert-circle',\n\t\t\tdefaultTitle: 'Error'\n\t\t},\n\t\tinfo: {\n\t\t\tgradient: 'gradient-tertiary',\n\t\t\ttextColor: 'text-white',\n\t\t\ticon: 'mdi:information',\n\t\t\tdefaultTitle: 'Info'\n\t\t}\n\t} as const;\n\n\ttype ToastType = keyof typeof toastConfig;\n\n\t// Get toast styling based on type\n\tfunction getToastClasses(type: string | undefined): string {\n\t\tif (!type || !(type in toastConfig)) {\n\t\t\treturn 'bg-surface-100 dark:bg-surface-800 text-surface-900 dark:text-surface-100 border border-surface-300 dark:border-surface-600';\n\t\t}\n\t\tconst config = toastConfig[type as ToastType];\n\t\treturn `${config.gradient} ${config.textColor}`;\n\t}\n\n\t// Get icon for toast type\n\tfunction getToastIcon(type: string | undefined): string | null {\n\t\tif (!type || !(type in toastConfig)) return null;\n\t\treturn toastConfig[type as ToastType].icon;\n\t}\n\n\t// Get animation direction based on position (reactive)\n\tconst animParams = $derived.by(() => {\n\t\tif (position.includes('right')) return { x: 100, duration: 300 };\n\t\tif (position.includes('left')) return { x: -100, duration: 300 };\n\t\tif (position.includes('top')) return { y: -50, duration: 300 };\n\t\treturn { y: 50, duration: 300 };\n\t});\n</script>\n\n<Toast.Group {toaster} class=\"fixed z-9999 flex {position.includes('bottom') ? 'flex-col-reverse' : 'flex-col'} gap-3 {positionClasses[position]}\">\n\t{#snippet children(toast)}\n\t\t<div in:fly={animParams} out:fade={{ duration: 200 }} class=\"relative\" role=\"alert\" aria-live=\"polite\">\n\t\t\t<Toast {toast} class=\"card min-w-80 max-w-100 shadow-2xl rounded-xl overflow-hidden {getToastClasses(toast.type)}\">\n\t\t\t\t<!-- Toast Message Container (Skeleton v4 anatomy) -->\n\t\t\t\t<Toast.Message class=\"flex flex-col gap-1 p-4 pr-10 relative\">\n\t\t\t\t\t<!-- Header with Icon and Title -->\n\t\t\t\t\t{#if toast.title}\n\t\t\t\t\t\t<Toast.Title class=\"font-bold text-base flex items-center gap-2\">\n\t\t\t\t\t\t\t{#if getToastIcon(toast.type)}\n\t\t\t\t\t\t\t\t<iconify-icon icon={getToastIcon(toast.type)} width=\"22\" class=\"shrink-0\"></iconify-icon>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t<span>{toast.title}</span>\n\t\t\t\t\t\t</Toast.Title>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<!-- Description -->\n\t\t\t\t\t<Toast.Description class=\"text-sm opacity-95 leading-relaxed\">\n\t\t\t\t\t\t{toast.description}\n\t\t\t\t\t</Toast.Description>\n\n\t\t\t\t\t<!-- Optional Action Buttons -->\n\t\t\t\t\t{#if toast.action}\n\t\t\t\t\t\t<div class=\"mt-3 flex gap-2\">\n\t\t\t\t\t\t\t<Toast.ActionTrigger\n\t\t\t\t\t\t\t\tclass=\"btn-sm {toast.type === 'warning' ? 'preset-filled-surface-900' : 'preset-filled-surface-50'} text-xs font-medium\"\n\t\t\t\t\t\t\t\tonclick={() => {\n\t\t\t\t\t\t\t\t\ttoast.action?.onClick?.();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{toast.action.label}\n\t\t\t\t\t\t\t</Toast.ActionTrigger>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</Toast.Message>\n\n\t\t\t\t<!-- Close Button -->\n\t\t\t\t<Toast.CloseTrigger\n\t\t\t\t\tclass=\"absolute right-2 top-2 p-1.5 rounded-full opacity-70 hover:opacity-100 hover:bg-black/10 dark:hover:bg-white/10 transition-opacity\"\n\t\t\t\t\taria-label=\"Dismiss notification\"\n\t\t\t\t>\n\t\t\t\t\t<iconify-icon icon=\"mdi:close\" width=\"18\"></iconify-icon>\n\t\t\t\t</Toast.CloseTrigger>\n\n\t\t\t\t<!-- Progress Bar for Auto-dismiss -->\n\t\t\t\t{#if showProgress && toast.duration && toast.duration > 0}\n\t\t\t\t\t<div class=\"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10\">\n\t\t\t\t\t\t<div class=\"h-full bg-current opacity-50 animate-shrink\" style=\"animation-duration: {toast.duration}ms;\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</Toast>\n\t\t</div>\n\t{/snippet}\n</Toast.Group>\n\n<style>\n\t/* Progress bar shrink animation */\n\t@keyframes shrink {\n\t\tfrom {\n\t\t\twidth: 100%;\n\t\t}\n\t\tto {\n\t\t\twidth: 0%;\n\t\t}\n\t}\n\n\t.animate-shrink {\n\t\tanimation: shrink linear forwards;\n\t}\n</style>\n","/**\n * @file src/stores/statusStore.svelte.ts\n * @description Centralized status logic for collection entries.\n * simplifies status management by deriving state directly from collectionValue.\n */\n\nimport { collections } from '@shared/stores/collectionStore.svelte';\nimport { updateEntryStatus } from '@shared/utils/apiClient';\nimport { showToast } from '@shared/utils/toast';\nimport type { StatusType } from '@cms-types/content';\nimport { StatusTypes } from '@cms-types/content';\nimport { logger } from '@shared/utils/logger';\n\n// Only track transient UI state\nconst statusState = $state({\n\tisLoading: false,\n\tlastToggleTime: 0\n});\n\n/**\n * Helper to determine if entry is published\n * Single source of truth: collectionValue.status\n */\nfunction getIsPublish(): boolean {\n\tconst cv = collections.activeValue;\n\n\t// 1. If we have an entry with explicit status, use it\n\tif (cv?.status) {\n\t\treturn cv.status === StatusTypes.publish;\n\t}\n\n\t// 2. Fall back to collection default status\n\tconst collectionStatus = collections.active?.status;\n\tconst defaultStatus = collectionStatus || StatusTypes.unpublish;\n\treturn defaultStatus === StatusTypes.publish;\n}\n\n// Reactively derive the publish state\nconst isPublish = $derived.by(getIsPublish);\n\n/**\n * Get current status as StatusType enum\n */\nfunction getCurrentStatus(): StatusType {\n\tconst cv = collections.activeValue;\n\n\tif (cv?.status) {\n\t\treturn cv.status as StatusType;\n\t}\n\n\tconst collectionStatus = collections.active?.status;\n\treturn (collectionStatus || StatusTypes.unpublish) as StatusType;\n}\n\nexport const statusStore = {\n\t/**\n\t * Check if current entry is published\n\t */\n\tget isPublish() {\n\t\treturn isPublish;\n\t},\n\n\t/**\n\t * Check if status operation is in progress\n\t */\n\tget isLoading() {\n\t\treturn statusState.isLoading;\n\t},\n\n\t/**\n\t * Get current status value\n\t */\n\tget currentStatus(): StatusType {\n\t\treturn getCurrentStatus();\n\t},\n\n\t/**\n\t * Toggle entry status between publish/unpublish\n\t *\n\t * @param newValue - true for publish, false for unpublish\n\t * @param componentName - Name of calling component (for logging)\n\t * @returns Promise<boolean> - true if successful\n\t */\n\tasync toggleStatus(newValue: boolean, componentName: string = 'Component'): Promise<boolean> {\n\t\t// Prevent redundant toggles\n\t\tif (newValue === isPublish) {\n\t\t\tlogger.debug(`[StatusStore] Status already ${newValue ? 'published' : 'unpublished'}`);\n\t\t\treturn true;\n\t\t}\n\n\t\t// Prevent concurrent toggles\n\t\tif (statusState.isLoading) {\n\t\t\tlogger.warn('[StatusStore] Status toggle already in progress');\n\t\t\treturn false;\n\t\t}\n\n\t\t// Throttle rapid toggles (prevent double-click issues)\n\t\tconst now = Date.now();\n\t\tif (now - statusState.lastToggleTime < 500) {\n\t\t\tlogger.debug('[StatusStore] Throttling rapid status toggle');\n\t\t\treturn false;\n\t\t}\n\n\t\tstatusState.isLoading = true;\n\t\tstatusState.lastToggleTime = now;\n\n\t\tconst newStatus = newValue ? StatusTypes.publish : StatusTypes.unpublish;\n\t\tlogger.debug(`[StatusStore] Toggling status to ${newStatus} (from ${componentName})`);\n\n\t\ttry {\n\t\t\t// Case 1: Entry exists - update via API\n\t\t\tif (collections.activeValue?._id && collections.active?._id) {\n\t\t\t\tconst result = await updateEntryStatus(String(collections.active._id), String(collections.activeValue._id), newStatus);\n\n\t\t\t\tif (result.success) {\n\t\t\t\t\t// Update local state\n\t\t\t\t\tcollections.setCollectionValue({\n\t\t\t\t\t\t...collections.activeValue,\n\t\t\t\t\t\tstatus: newStatus,\n\t\t\t\t\t\t// Clear schedule when manually toggling\n\t\t\t\t\t\t_scheduled: undefined\n\t\t\t\t\t});\n\n\t\t\t\t\tshowToast(newValue ? 'Entry published successfully' : 'Entry unpublished successfully', 'success');\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tshowToast(result.error || `Failed to ${newStatus} entry`, 'error');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Case 2: New entry (no ID yet) - update local state only\n\t\t\telse {\n\t\t\t\tcollections.setCollectionValue({\n\t\t\t\t\t...collections.activeValue,\n\t\t\t\t\tstatus: newStatus\n\t\t\t\t});\n\n\t\t\t\tlogger.debug(`[StatusStore] Status set to ${newStatus} (unsaved entry)`);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconst error = e as Error;\n\t\t\tshowToast(`Error updating status: ${error.message}`, 'error');\n\t\t\tlogger.error(`[StatusStore] Error in ${componentName}:`, error);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tstatusState.isLoading = false;\n\t\t}\n\t},\n\n\t/**\n\t * Get status value for save operations\n\t * Useful when preparing data to send to API\n\t */\n\tgetStatusForSave(): StatusType {\n\t\treturn getCurrentStatus();\n\t},\n\n\t/**\n\t * Set status directly (without API call)\n\t * Use for initialization or when status is set as part of larger save\n\t */\n\tsetStatusLocal(status: StatusType): void {\n\t\tlogger.debug(`[StatusStore] Setting status locally to ${status}`);\n\t\tcollections.setCollectionValue({\n\t\t\t...collections.activeValue,\n\t\t\tstatus\n\t\t});\n\t},\n\n\t/**\n\t * Check if entry is in a specific status\n\t */\n\thasStatus(status: StatusType): boolean {\n\t\treturn getCurrentStatus() === status;\n\t},\n\n\t/**\n\t * Check if entry is scheduled\n\t */\n\tget isScheduled(): boolean {\n\t\treturn getCurrentStatus() === StatusTypes.schedule && !!collections.activeValue?._scheduled;\n\t}\n};\n","<!--\n @file src/routes/+layout.svelte\n @component\n **This Svelte component serves as the layout for the entire application**\n\n ### Features\n - Paraglide i18n integration\n - Theme Management\n - Skeleton v4 Toasts & Modals\n -->\n\n<script lang=\"ts\">\n\t// Selected theme\n\timport '@shared/theme/app.css';\n\t// Register Iconify custom element globally\n\timport 'iconify-icon';\n\n\timport { page } from '$app/state';\n\timport { onMount, untrack } from 'svelte';\n\timport { browser } from '$app/environment';\n\n\t// Skeleton v4\n\timport { app } from '@shared/stores/store.svelte';\n\timport ToastManager from '@cms/components/system/ToastManager.svelte';\n\t// import DialogManager from '@shared/components/system/DialogManager.svelte';\n\n\t// Paraglide locale bridge\n\timport { locales as availableLocales, getLocale, setLocale } from '@shared/paraglide/runtime';\n\n\t// Theme management\n\timport { themeStore, initializeThemeStore, initializeDarkMode } from '@shared/stores/themeStore.svelte';\n\n\t// Global Settings\n\timport { initPublicEnv, publicEnv } from '@shared/stores/globalSettings.svelte';\n\n\t// Stores\n\timport { ui } from '@shared/stores/UIStore.svelte';\n\n\t// Components\n\timport LeftSidebar from '@shared/components/LeftSidebar.svelte';\n\timport RightSidebar from '@shared/components/RightSidebar.svelte';\n\n\t// Props\n\tinterface Props {\n\t\tchildren?: import('svelte').Snippet;\n\t}\n\tconst { children }: Props = $props();\n\n\t// ============================================================================\n\t// State Management\n\t// ============================================================================\n\n\tlet currentLocale = $state(getLocale());\n\tlet isMounted = $state(false);\n\n\t// ============================================================================\n\t// Initialization\n\t// ============================================================================\n\n\t// Initialize public environment settings from server data\n\t// Note: Only access page.data after mount to avoid hydration issues\n\t$effect(() => {\n\t\tif (browser && page.data?.settings) {\n\t\t\tinitPublicEnv(page.data.settings);\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Mount Lifecycle\n\t// ============================================================================\n\n\tonMount(() => {\n\t\tconsole.log('[RootLayout] Mounting in', browser ? 'browser' : 'server');\n\n\t\t// URL is the source of truth on initial load\n\t\tconst urlLocale = getLocale();\n\t\tif (urlLocale && availableLocales.includes(urlLocale as any)) {\n\t\t\tif (app.systemLanguage !== urlLocale) {\n\t\t\t\tconsole.log(`[RootLayout] Aligning store (${app.systemLanguage}) to URL (${urlLocale})`);\n\t\t\t\tapp.systemLanguage = urlLocale as any;\n\t\t\t\tcurrentLocale = urlLocale;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize dark mode\n\t\tinitializeDarkMode();\n\n\t\tisMounted = true;\n\n\t\t// Check for flash messages (e.g., from login redirect)\n\t\tconst flashMessageJson = sessionStorage.getItem('flashMessage');\n\t\tif (flashMessageJson) {\n\t\t\ttry {\n\t\t\t\tconst flashMessage = JSON.parse(flashMessageJson);\n\t\t\t\tsessionStorage.removeItem('flashMessage');\n\n\t\t\t\t// Import toaster dynamically to avoid circular deps (though it's available in stores)\n\t\t\t\t// We can also import it directly if we want, but dynamic is safer for layout\n\t\t\t\timport('@shared/stores/store.svelte').then(({ toaster }) => {\n\t\t\t\t\tconst opts = {\n\t\t\t\t\t\ttitle: flashMessage.title,\n\t\t\t\t\t\tdescription: flashMessage.description,\n\t\t\t\t\t\tduration: flashMessage.duration || 4000\n\t\t\t\t\t};\n\n\t\t\t\t\t// Small delay to ensure ToastManager is ready\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (flashMessage.type === 'success') {\n\t\t\t\t\t\t\ttoaster.success(opts);\n\t\t\t\t\t\t} else if (flashMessage.type === 'warning') {\n\t\t\t\t\t\t\ttoaster.warning(opts);\n\t\t\t\t\t\t} else if (flashMessage.type === 'error') {\n\t\t\t\t\t\t\ttoaster.error(opts);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoaster.info(opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('Failed to parse flash message:', e);\n\t\t\t\tsessionStorage.removeItem('flashMessage');\n\t\t\t}\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Reactive Locale Syncing\n\t// ============================================================================\n\n\t$effect(() => {\n\t\t// Guard: Only sync after mount\n\t\tif (!isMounted) return;\n\n\t\tconst desired = app.systemLanguage;\n\t\tconst current = untrack(() => currentLocale);\n\n\t\t// Only update if there's an actual change\n\t\tif (desired && availableLocales.includes(desired as any) && current !== desired) {\n\t\t\tconsole.log('[RootLayout] Store changed, updating locale:', desired);\n\n\t\t\t// Update Paraglide locale (handles routing internally)\n\t\t\tsetLocale(desired as any, { reload: false });\n\t\t\tcurrentLocale = desired;\n\t\t}\n\t});\n\n\t// ============================================================================\n\t// Theme Auto-Refresh\n\t// ============================================================================\n\n\t$effect(() => {\n\t\tif (!themeStore.autoRefreshEnabled || !browser) return;\n\n\t\tconst interval = 30 * 60 * 1000; // 30 minutes\n\t\tconst intervalId = setInterval(() => {\n\t\t\tinitializeThemeStore().catch(console.error);\n\t\t}, interval);\n\n\t\treturn () => clearInterval(intervalId);\n\t});\n\n\t// ============================================================================\n\t// Derived State\n\t// ============================================================================\n\n\t// Get the site name from publicEnv store (safer for SSR/CSR transitions)\n\tconst siteName = $derived(publicEnv?.SITE_NAME || 'SveltyCMS');\n\n\t// Determine if we should show sidebars based on the current route\n\t// Sidebars are hidden on login and setup pages\n\tconst showSidebars = $derived.by(() => {\n\t\tconst path = page.url.pathname;\n\t\tconst isAuthRoute = path.includes('/login') || path.includes('/register');\n\t\tconst isSetupRoute = path.includes('/setup');\n\t\treturn !isAuthRoute && !isSetupRoute && isMounted;\n\t});\n</script>\n\n<svelte:head>\n\t<title>{siteName}</title>\n</svelte:head>\n\n{#key currentLocale}\n\t<ToastManager position=\"bottom-right\" />\n\n\t<div class=\"flex h-screen w-screen overflow-hidden bg-surface-50 dark:bg-surface-900\">\n\t\t{#if showSidebars && ui.isLeftSidebarVisible}\n\t\t\t<aside\n\t\t\t\tclass=\"h-full border-r border-surface-200 bg-white transition-all duration-300 dark:border-surface-800 dark:bg-surface-900 {ui.state\n\t\t\t\t\t.leftSidebar === 'full'\n\t\t\t\t\t? 'w-72'\n\t\t\t\t\t: 'w-20'}\"\n\t\t\t>\n\t\t\t\t<LeftSidebar />\n\t\t\t</aside>\n\t\t{/if}\n\n\t\t<main class=\"relative flex h-full flex-1 flex-col overflow-hidden\">\n\t\t\t<div class=\"h-full w-full overflow-auto\">\n\t\t\t\t{@render children?.()}\n\t\t\t</div>\n\t\t</main>\n\n\t\t{#if showSidebars && ui.isRightSidebarVisible}\n\t\t\t<aside class=\"h-full w-72 border-l border-surface-200 bg-white transition-all duration-300 dark:border-surface-800 dark:bg-surface-900\">\n\t\t\t\t<RightSidebar />\n\t\t\t</aside>\n\t\t{/if}\n\t</div>\n{/key}\n"],"names":["attributes","$$renderer","$.props_id","toaster","$.ensure_array_like","group","$.attributes","RootContext","ActionTrigger","CloseTrigger","$.escape","$.attr_style","$.stringify"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11]}