---
path: 'docs/services.mdx'
title: 'Service Architecture'
description: 'Comprehensive guide to the core services powering SveltyCMS, including configuration, security, and media management.'
order: 3
icon: 'mdi:server-network'
author: 'admin'
created: '2025-12-04'
updated: '2025-12-04'
tags:
  - 'architecture'
  - 'services'
  - 'backend'
  - 'security'
---

# Service Architecture

SveltyCMS relies on a set of robust, specialized services to handle core functionality. These services are designed to be modular, secure, and performant, adhering to enterprise standards.

---

## Core Services

### 1. ConfigService (`src/services/ConfigService.ts`)

**Purpose**: Manages the synchronization of configuration (collections, schemas) between the filesystem and the database.

**Enterprise Value**:

- **GitOps Ready**: Allows configuration to be version-controlled in Git.
- **Environment Sync**: Facilitates moving configuration between Dev, Staging, and Production.
- **Consistency**: Ensures the database schema always matches the code definition.

**Usage**:
Used primarily during system startup and deployment to apply changes detected in the codebase to the active database.

### 2. SettingsService (`src/services/settingsService.ts`)

**Purpose**: Provides a high-performance caching layer for system settings.

**Enterprise Value**:

- **Performance**: Eliminates database round-trips for frequently accessed settings (e.g., site title, feature flags).
- **Type Safety**: Distinguishes between `PublicEnv` (safe for client) and `PrivateEnv` (server-only).

**Usage**:

```typescript
import { getPublicSettingSync } from '@src/services/settingsService';
const siteName = getPublicSettingSync('SITE_NAME');
```

### 3. MediaService (`src/services/MediaService.server.ts`)

**Purpose**: Handles all file operations, including upload, storage, resizing, and access control.

**Enterprise Value**:

- **Security**: Enforces strict MIME type validation and file size limits.
- **Optimization**: Automatically generates thumbnails and optimizes images.
- **Deduplication**: Stores files by content hash to save storage space.

---

## Security Services

### 4. SecurityResponseService (`src/services/SecurityResponseService.ts`)

**Purpose**: Acts as an internal Web Application Firewall (WAF).

**Enterprise Value**:

- **Active Protection**: Detects and blocks SQL Injection (SQLi) and Cross-Site Scripting (XSS) attempts.
- **Rate Limiting**: Prevents abuse and DoS attacks.
- **Automated Response**: Can automatically block malicious IPs.

**Usage**:
Invoked via hooks on every incoming request to sanitize and validate payloads.

### 5. AuditLogService (`src/services/auditLogService.ts`)

**Purpose**: Records all critical system actions for compliance and debugging.

**Enterprise Value**:

- **Compliance**: Essential for meeting regulatory requirements (GDPR, SOC2).
- **Accountability**: Tracks "who did what and when".

---

## Observability Services

### 6. MetricsService (`src/services/MetricsService.ts`)

**Purpose**: Collects performance metrics and system health data.

**Enterprise Value**:

- **Monitoring**: Exposes metrics compatible with Prometheus/Grafana.
- **Insight**: Helps identify bottlenecks and optimize resource usage.

### 7. TelemetryService (`src/services/TelemetryService.ts`)

**Purpose**: Checks for updates and security advisories.

**Enterprise Value**:

- **Proactive Security**: Notifies administrators of known vulnerabilities in the current version.

---

## Widget Services

### 8. WidgetRegistryService (`src/services/WidgetRegistryService.ts`)

**Purpose**: Loads and manages the code for all available widgets.

**Enterprise Value**:

- **Extensibility**: Allows third-party developers to add new field types without modifying core code.

### 9. WidgetDiscoveryService (`src/services/widgetDiscovery.ts`)

**Purpose**: Scans the filesystem for new widgets and registers them in the database.

**Enterprise Value**:

- **Automation**: Automatically detects new widgets added to the project.

---

## Best Practices

- **Dependency Injection**: Services should rely on the `dbAdapter` rather than direct database connections.
- **Statelessness**: Services should be stateless to allow for horizontal scaling.
- **Error Handling**: All service methods should throw typed errors or return standardized result objects.
