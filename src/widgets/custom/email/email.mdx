---
path: 'src/widgets/custom/Email/email.mdx'
title: 'Email Widget'
description: 'Email input widget with HTML5 validation, disposable email blocking, and semantic mobile keyboards.'
order: 1
icon: 'ic:outline-email'
author: 'admin'
created: '2025-10-01'
updated: '2026-02-03'
tags:
  - 'widget'
  - 'email'
  - 'form'
  - 'validation'
  - 'security'
  - 'custom'
---

# Email Widget

The **Email Widget** is a specialized input component designed exclusively for email address entry. It provides HTML5 email validation, disposable email blocking, semantic mobile keyboards, and proper data handling for email fields.

---

## Overview

The Email widget is part of the SveltyCMS specialized widget collection and provides features specifically tailored for email address input. Unlike the generic Input widget, it correctly treats email addresses as non-translatable data and provides email-specific validation with security enhancements.

### Key Features

| Feature                          | Description                                                |
| -------------------------------- | ---------------------------------------------------------- |
| ✅ **Email Validation**          | Valibot's `email()` validator for strong format checking   |
| ✅ **Disposable Email Blocking** | Blocks common disposable email domains                     |
| ✅ **Non-Translatable**          | Correctly treats email as universal data                   |
| ✅ **Semantic HTML**             | Uses `type="email"` for proper mobile keyboards            |
| ✅ **Security Sanitization**     | Removes zero-width characters and homograph attack vectors |
| ✅ **Debounced Validation**      | Performance-optimized validation (300ms)                   |
| ✅ **Touch State Management**    | Errors only show after user interaction                    |
| ✅ **Full Accessibility**        | ARIA support and semantic HTML                             |
| ✅ **Auto-Focus**                | Focus management for required fields                       |

---

## When to Use

**Use the Email widget for:**

- User email addresses
- Contact form email fields
- Newsletter subscription emails
- Any field that stores email addresses

**Don't use for:**

- Plain text that happens to contain @ symbol
- Usernames (use Input widget instead)
- Complex text with email-like patterns

---

## Security Features

### Disposable Email Blocking

The widget blocks common disposable email domains to prevent abuse:

```typescript
// Blocked domains (from index.ts)
const DISPOSABLE_DOMAINS = [
	'tempmail.com',
	'guerrillamail.com',
	'10minutemail.com',
	'mailinator.com',
	'throwaway.email',
	'yopmail.com',
	'temp-mail.org',
	'getnada.com'
];
```

### Input Sanitization

The Input component applies security sanitization:

```typescript
function sanitizeInput(input: string): string {
	// Remove zero-width characters that could be used for spoofing
	const sanitized = input.replace(/[\u200B-\u200D\uFEFF]/g, '');

	// Normalize Unicode to prevent homograph attacks
	return sanitized.normalize('NFKC');
}
```

---

## Configuration

### Basic Setup

```typescript
import widgets from '@widgets';

widgets.Email({
	label: 'Email Address',
	db_fieldName: 'email',
	required: true
});
```

### With Custom Placeholder

```typescript
widgets.Email({
	label: 'Contact Email',
	db_fieldName: 'contact_email',
	placeholder: 'user@example.com',
	required: false
});
```

### With Icon and Helper Text

```typescript
widgets.Email({
	label: 'Newsletter Email',
	db_fieldName: 'newsletter_email',
	icon: 'material-symbols:mail-outline',
	helper: 'We will never share your email address',
	required: true
});
```

---

## Properties

### Required Properties

| Property | Type     | Description                 |
| -------- | -------- | --------------------------- |
| `label`  | `string` | Display label for the field |

### Optional Properties

| Property       | Type      | Default        | Description                   |
| -------------- | --------- | -------------- | ----------------------------- |
| `db_fieldName` | `string`  | auto-generated | Database field name           |
| `required`     | `boolean` | `false`        | Whether the field is required |
| `placeholder`  | `string`  | `db_fieldName` | Placeholder text              |
| `readonly`     | `boolean` | `false`        | Make field read-only          |
| `disabled`     | `boolean` | `false`        | Disable the field             |
| `icon`         | `string`  | -              | Iconify icon name             |
| `width`        | `number`  | -              | Column width (1-12)           |
| `helper`       | `string`  | -              | Helper text displayed below   |
| `prefix`       | `string`  | -              | Visual text before input      |
| `suffix`       | `string`  | -              | Visual text after input       |

### Fixed Properties

These properties are set automatically and cannot be changed:

| Property     | Value   | Reason                                    |
| ------------ | ------- | ----------------------------------------- |
| `translated` | `false` | Email addresses are not language-specific |

---

## Validation

The Email widget provides comprehensive email validation:

### Validation Schema

```typescript
// From index.ts - validation includes disposable email blocking
const validationSchema = (field: FieldInstance) => {
	const baseSchema = pipe(string(), email('Please enter a valid email address.'), blockDisposableEmail);

	const schema = field.required
		? pipe(string(), minLength(1, 'This field is required.'), email('Please enter a valid email address.'), blockDisposableEmail)
		: baseSchema;

	return field.required ? schema : optional(schema, '');
};
```

### Validation Messages

| Condition            | Error Message                                |
| -------------------- | -------------------------------------------- |
| Empty required field | `This field is required`                     |
| Invalid email format | `Please enter a valid email address`         |
| Disposable email     | `Disposable email addresses are not allowed` |

### Validation Behavior

- **On Input**: Validation debounced (300ms) for performance
- **On Blur**: Immediate validation when field loses focus
- **Touch State**: Errors only show after user has interacted
- **Visual Feedback**: Blue border with spinner during validation, red border on error

---

## Data Structure

### Storage Format

Email addresses are stored as non-translatable data:

```json
{
	"email": "user@example.com"
}
```

### Why Non-Translatable?

Email addresses are universal identifiers that don't change based on language:

- Same email works globally
- No need for translations
- Reduces storage complexity
- Prevents data inconsistency

---

## Examples

### User Registration Email

```typescript
widgets.Email({
	label: 'Email Address',
	db_fieldName: 'email',
	required: true,
	placeholder: 'Enter your email',
	icon: 'mdi:email',
	helper: 'We will send a verification email'
});
```

### Contact Form Email

```typescript
widgets.Email({
	label: 'Your Email',
	db_fieldName: 'contact_email',
	required: true,
	placeholder: 'your.email@example.com',
	icon: 'material-symbols:mail',
	helper: 'So we can respond to your inquiry'
});
```

### Optional Newsletter Email

```typescript
widgets.Email({
	label: 'Newsletter Subscription',
	db_fieldName: 'newsletter_email',
	required: false,
	placeholder: 'Subscribe to updates (optional)',
	icon: 'mdi:email-newsletter',
	helper: 'Leave blank if you prefer not to subscribe'
});
```

### Author Email (Read-Only)

```typescript
widgets.Email({
	label: 'Author Email',
	db_fieldName: 'author_email',
	readonly: true,
	icon: 'mdi:account-circle',
	helper: 'Contact the system administrator to change'
});
```

---

## Mobile Experience

### Email Keyboard

The widget automatically triggers the email-specific keyboard on mobile devices:

- **@ key**: Easily accessible
- **. key**: Positioned for domain extensions
- **No space bar**: Emails don't contain spaces
- **Quick domain suggestions**: Common domains (gmail.com, etc.)

### Browser Support

- iOS: Email keyboard with @ and .com shortcuts
- Android: Email keyboard layout
- Desktop: Standard keyboard with email auto-complete

---

## Best Practices

### Validation

1. **Always validate email format**: The widget handles this automatically
2. **Use required appropriately**: Only require email when necessary
3. **Provide clear error messages**: Default messages are user-friendly
4. **Consider verification**: For critical emails, implement email verification

### User Experience

1. **Clear labels**: Use descriptive labels like "Email Address" not just "Email"
2. **Helpful placeholders**: Show example email format (user@example.com)
3. **Helper text**: Explain why you need the email and how it will be used
4. **Privacy assurance**: Add helper text about data protection if appropriate

### Accessibility

1. **Use semantic HTML**: The widget uses `type="email"` automatically
2. **Provide labels**: Always include a clear label
3. **Error association**: Errors are automatically linked via ARIA attributes
4. **Keyboard navigation**: Fully keyboard accessible

### Data Handling

1. **Trim whitespace**: The widget automatically trims spaces
2. **Lowercase normalization**: Consider normalizing to lowercase in backend
3. **Unique constraints**: Enforce email uniqueness at database level if needed
4. **Validation backend**: Always validate email on server-side too

---

## Technical Details

### Valibot Schema

```typescript
// Required email with disposable blocking
pipe(string(), minLength(1, 'This field is required'), email('Please enter a valid email address'), blockDisposableEmail);

// Optional email
optional(pipe(string(), email('Please enter a valid email address'), blockDisposableEmail), '');
```

### State Management

Uses Svelte 5 runes for reactive state:

```typescript
$state: isTouched, isValidating, inputElement
$derived: safeValue, validationError, emailSchema, fieldName, _language
$effect: value initialization, cleanup
```

### Store Integration

Connects to global validation store:

```typescript
validationStore.setError(fieldName, errorMessage);
validationStore.clearError(fieldName);
validationStore.getError(fieldName);
```

---

## Comparison with Input Widget

| Feature             | Email Widget         | Input Widget       |
| ------------------- | -------------------- | ------------------ |
| **Data Type**       | string (email)       | string (text)      |
| **Translatable**    | ❌ false (fixed)     | ✅ true (default)  |
| **HTML Type**       | email                | text               |
| **Validation**      | Email + disposable   | Length only        |
| **Mobile Keyboard** | Email-specific       | Standard           |
| **Security**        | Homograph protection | Basic sanitization |
| **Use Case**        | Email addresses      | General text       |
| **Auto-complete**   | email                | off                |

---

## Migration Guide

If you were using the Input widget with `inputType: 'email'`, migrate to the Email widget:

### Before (Deprecated)

```typescript
// ❌ Old approach
widgets.Input({
	inputType: 'email',
	label: 'Email',
	db_fieldName: 'email',
	translated: false // Had to remember this!
});
```

### After (Recommended)

```typescript
// ✅ New approach
widgets.Email({
	label: 'Email',
	db_fieldName: 'email'
	// translated: false is automatic
	// disposable email blocking is automatic
});
```

---

## Troubleshooting

### Common Issues

**Email shows as translated**

- This should not happen - Email widget forces `translated: false`
- Check you're using `widgets.Email()` not `widgets.Input()`

**Validation not working**

- Ensure field has proper `db_fieldName`
- Check browser console for errors
- Verify validationStore is initialized

**Disposable email not blocked**

- Verify the domain is in the blocklist
- Check that validation is running (not debounced)
- Server-side validation should also block these

**Mobile keyboard not showing**

- Verify you're using the Email widget (not Input)
- Check browser supports `type="email"`
- Test on actual device (simulators may differ)

**Auto-complete not working**

- Ensure `autocomplete="email"` is set (automatic)
- Check browser settings allow auto-complete
- Verify the field name suggests email context

---

## Security Considerations

### Input Validation

1. **Client-side validation**: The widget provides user-friendly feedback
2. **Server-side validation**: Always validate email format on backend
3. **SQL injection**: Use parameterized queries
4. **XSS prevention**: Sanitize email output in display context
5. **Homograph attacks**: Widget applies NFKC normalization

### Privacy

1. **GDPR compliance**: Document why you collect emails
2. **Data retention**: Implement proper data lifecycle
3. **Encryption**: Store emails securely in database
4. **Access control**: Limit who can view email addresses

---

## API Reference

### Widget Configuration

```typescript
type EmailProps = {
	// Required
	label: string;

	// Optional
	db_fieldName?: string;
	required?: boolean;
	placeholder?: string;
	icon?: string;
	width?: number;
	helper?: string;
	readonly?: boolean;
	disabled?: boolean;
	prefix?: string;
	suffix?: string;

	// Fixed (cannot be changed)
	translated: false; // Always false for email
};
```

### Component Props

```typescript
interface EmailInputProps {
	field: FieldType;
	value?: string | Record<string, string> | null | undefined; // Bindable
}
```

### Exported Types

```typescript
export type FieldType = ReturnType<typeof EmailWidget>;
export type EmailWidgetData = ValibotInput<ReturnType<typeof validationSchema>>;
```

---

## Related Widgets

- [Input Widget]( $args[0].Value.ToLower() ) - For general text input
- [Number Widget]( $args[0].Value.ToLower() ) - For numeric values
- [PhoneNumber Widget]( $args[0].Value.ToLower() ) - For phone numbers

---

## Support

For questions, bug reports, or feature requests:

- [GitHub Issues](https://github.com/Svelte-CMS/SveltyCMS/issues)
- [Documentation](https://docs.sveltycms.dev)
- [Discord Community](https://discord.gg/sveltycms)

## Contributing

Contributions are welcome! Please read our [Contributing Guide](https://github.com/Svelte-CMS/SveltyCMS/blob/main/CONTRIBUTING.md) before submitting PRs.
